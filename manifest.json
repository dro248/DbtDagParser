{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v1.json", "dbt_version": "0.19.0", "generated_at": "2021-08-11T16:18:41.619548Z", "invocation_id": "977bd4c8-4212-41fb-b2f3-83f9ef02897f", "env": {}, "project_id": "07623abe61acc0b129f1658dcdb9b1ee", "user_id": "528fc94c-5457-4351-841c-12b624994060", "send_anonymous_usage_stats": true, "adapter_type": "snowflake"}, "nodes": {"model.sdna_project.inegi_2pbi_stg": {"raw_sql": "select\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case\n        when p15a29a >= 0\n        then round(p15a29a*.8)\n        else 0\n    end as genz,\n    case\n        when p15a29a >= 0 or p30a59a >= 0\n        then round(sum((p15a29a*.2) + (p30a59a*.37)))\n        else 0\n    end as millenial,\n    case\n        when p30a59a >= 0\n        then round(sum(p30a59a*.5))\n        else 0\n    end as genx,\n    case\n        when p30a59a >= 0 or p_60ymas >= 0\n        then round(sum((p30a59a*.13) + p_60ymas))\n        else 0\n    end as baby_boomer,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid\nfrom {{ ref('inegi_2') }}\ngroup by\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi_2pbi_stg"], "unique_id": "model.sdna_project.inegi_2pbi_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi_2pbi_stg.sql", "original_file_path": "models/sdna_mx/intermediate/inegi_2pbi_stg.sql", "name": "inegi_2pbi_stg", "resource_type": "model", "alias": "inegi_2pbi_stg", "checksum": {"name": "sha256", "checksum": "67779fbca9b05054667446996259ef15ac9e905c3e932bad171da4cfc3a2d2c4"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mx_stores_stg": {"raw_sql": "select distinct\n    a11.id_cliente id_cliente,\n    a12.des_cliente des_cliente,\n    concat(a12.des_numero, a12.des_calle) direccion,\n    a12.des_municipio des_municipio,\n    a12.des_edo des_edo,\n    a12.des_cp des_cp,\n    a12.des_corx lat,\n    a12.des_cory long,\n    a11.id_cia_ruta idcia_ruta,\n    a17.des_cia_ruta des_cia_ruta,\n    a14.id_zona id_zona,\n    a14.des_zona des_zona,\n    a14.id_division id_division,\n    concat(a14.id_div_ods, ' ', a14.des_division) division,\n    a12.id_sucursal id_sucursal,\n    concat(a14.id_suc_corp, '  ', coalesce(a14.des_sucursal, '')) sucursal,\n    a19.id_tiporuta id_tiporuta,\n    a111.des_tiporuta des_tiporuta,\n    a111.tru_clave tru_clave,\n    a11.id_ruta id_ruta,\n    concat(a19.id_ruta_corp, '  ', coalesce(a19.des_ruta, '')) ruta,\n    a19.id_ruta_corp id_ruta_corp,\n    a12.id_cli_corp id_cli_corp,\n    a11.id_tipocliente id_tipocliente,\n    concat(a110.id_tcl_corp, '  ', a110.des_tipocliente) tipocliente,\n    a11.id_nivelcliente id_nivelcliente,\n    a18.id_ncl_corp des_nivelcliente \nfrom\n    {{ ref('dls_latam_ins_vtaclipro_sem_v') }} a11\n    join\n        {{ ref('dls_latam_ins_maestrocliente') }} a12\n        on (a11.id_cliente = a12.id_cliente)\n    join\n        {{ ref('dls_latam_ins_sucursal') }} a14\n        on (a12.id_sucursal = a14.id_sucursal)\n    join\n        {{ ref('dls_latam_ins_cia_ruta') }} a17\n        on (a11.id_cia_ruta = a17.id_cia_ruta)\n    join\n        {{ ref('dls_latam_ins_nivelcliente') }} a18\n        on (a11.id_cia_ruta = a18.id_cia_ruta\n        and a11.id_nivelcliente = a18.id_nivelcliente) \n    join\n        {{ ref('dls_latam_ins_ruta') }} a19\n        on (a11.id_cia_ruta = a19.id_cia_ruta\n        and a11.id_ruta = a19.id_ruta \n        and a14.id_sucursal = a19.id_sucursal) \n    join\n        {{ ref('dls_latam_ins_tipocliente') }} a110\n        on (a11.id_tipocliente = a110.id_tipocliente)\n    join\n        {{ ref('dls_latam_ins_tiporuta') }} a111\n        on (try_cast(a19.id_tiporuta as number) = a111.id_tiporuta)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "mx_stores_stg"], "unique_id": "model.sdna_project.mx_stores_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/mx_stores_stg.sql", "original_file_path": "models/sdna_mx/intermediate/mx_stores_stg.sql", "name": "mx_stores_stg", "resource_type": "model", "alias": "mx_stores_stg", "checksum": {"name": "sha256", "checksum": "f44884588b4b24c01d3f21d8803a09c8653f51958deb81fd63cb9d0b58a02270"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["dls_latam_ins_vtaclipro_sem_v"], ["dls_latam_ins_maestrocliente"], ["dls_latam_ins_sucursal"], ["dls_latam_ins_cia_ruta"], ["dls_latam_ins_nivelcliente"], ["dls_latam_ins_ruta"], ["dls_latam_ins_tipocliente"], ["dls_latam_ins_tiporuta"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dls_latam_ins_vtaclipro_sem_v", "model.sdna_project.dls_latam_ins_maestrocliente", "model.sdna_project.dls_latam_ins_sucursal", "model.sdna_project.dls_latam_ins_cia_ruta", "model.sdna_project.dls_latam_ins_nivelcliente", "model.sdna_project.dls_latam_ins_ruta", "model.sdna_project.dls_latam_ins_tipocliente", "model.sdna_project.dls_latam_ins_tiporuta"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_dataplor_coordinates": {"raw_sql": "select distinct\n    dataplor_id,\n    to_geography(st_makepoint(longitude, latitude)) as coords\nfrom {{ ref('dataplor') }}\nwhere country = 'Mexico'\n-- filters out invalid lat / long values\nand latitude between -90 and 90\nand longitude between -180 and 180", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "stg_dataplor_coordinates"], "unique_id": "model.sdna_project.stg_dataplor_coordinates", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/stg_dataplor_coordinates.sql", "original_file_path": "models/sdna_mx/intermediate/stg_dataplor_coordinates.sql", "name": "stg_dataplor_coordinates", "resource_type": "model", "alias": "stg_dataplor_coordinates", "checksum": {"name": "sha256", "checksum": "85a8bdaf9c443acdc9cc870f576351d365ecfaee805ad3dcf78932c3151259f9"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["dataplor"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dataplor"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_mx_store_coordinates": {"raw_sql": "select distinct\n    id_cliente,\n    lat,\n    long,\n    to_geography(st_makepoint(long, lat)) as coords\nfrom {{ ref('mx_stores') }}\n-- filters out invalid lat / long values\nwhere lat between -90 and 90\nand long between -180 and 180", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "stg_mx_store_coordinates"], "unique_id": "model.sdna_project.stg_mx_store_coordinates", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/stg_mx_store_coordinates.sql", "original_file_path": "models/sdna_mx/intermediate/stg_mx_store_coordinates.sql", "name": "stg_mx_store_coordinates", "resource_type": "model", "alias": "stg_mx_store_coordinates", "checksum": {"name": "sha256", "checksum": "c6b19bd928c8c362d4d270bfa7c80298d18432a1d69616c3ce87e27b9dfbe4bd"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.inegi2_step1": {"raw_sql": "with x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from {{ ref('inegi_2_stg') }}\n)\nselect distinct\n    *\nfrom x", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi", "inegi2_step1"], "unique_id": "model.sdna_project.inegi2_step1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi/inegi2_step1.sql", "original_file_path": "models/sdna_mx/intermediate/inegi/inegi2_step1.sql", "name": "inegi2_step1", "resource_type": "model", "alias": "inegi2_step1", "checksum": {"name": "sha256", "checksum": "8bfe8bfa0cf5873ebfee86471d1e96dab5139f723c533507ef844eab002d4596"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi_2_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi_2_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/compiled/sdna_project/models/sdna_mx/intermediate/inegi/inegi2_step1.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}, "compiled_sql": "with x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null}, "model.sdna_project.inegi2_step2": {"raw_sql": "with x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from {{ ref('inegi2_step1') }}\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from {{ ref('urbanicity') }}\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi", "inegi2_step2"], "unique_id": "model.sdna_project.inegi2_step2", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi/inegi2_step2.sql", "original_file_path": "models/sdna_mx/intermediate/inegi/inegi2_step2.sql", "name": "inegi2_step2", "resource_type": "model", "alias": "inegi2_step2", "checksum": {"name": "sha256", "checksum": "7839532689c0a8ad803698020bc6cd9b95620c77d16312052d61aa10a3797097"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi2_step1"], ["urbanicity"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi2_step1", "model.sdna_project.urbanicity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/compiled/sdna_project/models/sdna_mx/intermediate/inegi/inegi2_step2.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}, "compiled_sql": "with x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo", "extra_ctes_injected": true, "extra_ctes": [{"id": "model.sdna_project.inegi2_step1", "sql": " __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n)"}], "relation_name": null}, "model.sdna_project.inegi2_step3": {"raw_sql": "select distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom {{ ref('inegi2_step2') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi", "inegi2_step3"], "unique_id": "model.sdna_project.inegi2_step3", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi/inegi2_step3.sql", "original_file_path": "models/sdna_mx/intermediate/inegi/inegi2_step3.sql", "name": "inegi2_step3", "resource_type": "model", "alias": "inegi2_step3", "checksum": {"name": "sha256", "checksum": "b810bb0c040deb23d4568006e32550d020b36875768e54f9a1b6ac4a035f2fa0"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi2_step2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi2_step2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/compiled/sdna_project/models/sdna_mx/intermediate/inegi/inegi2_step3.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}, "compiled_sql": "select distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step2", "extra_ctes_injected": true, "extra_ctes": [{"id": "model.sdna_project.inegi2_step1", "sql": " __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n)"}, {"id": "model.sdna_project.inegi2_step2", "sql": " __dbt__CTE__inegi2_step2 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo\n)"}], "relation_name": null}, "model.sdna_project.inegi2_step4": {"raw_sql": "select distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case when p15a29a >= 0 then round(p15a29a*.8) else 0 end as genz,\n    case when p15a29a >= 0 or p30a59a >= 0 then round((p15a29a*.2) + (p30a59a*.37)) else 0 end as millenial,\n    case when p30a59a >= 0  then round(p30a59a*.5) else 0 end as genx,\n    case when p30a59a >= 0 or p_60ymas >= 0 then round((p30a59a*.13) + p_60ymas) else 0 end as baby_boomer,\n    case when pobtot >= 0 then round(pobtot*a_b) else 0 end as a_b,\n    case when pobtot >= 0 then round(pobtot*c_plus) else 0 end as c_plus,\n    case when pobtot >= 0 then round(pobtot*c) else 0 end as c,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as c_minus,\n    case when pobtot >= 0 then round(pobtot*d_plus) else 0 end as d_plus,\n    case when pobtot >= 0 then round(pobtot*d) else 0 end as d,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as e,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    x.ent,\n    x.nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom {{ ref('inegi2_step3') }} x\njoin {{ ref('nse') }} y\non x.ent = y.ent", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi", "inegi2_step4"], "unique_id": "model.sdna_project.inegi2_step4", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi/inegi2_step4.sql", "original_file_path": "models/sdna_mx/intermediate/inegi/inegi2_step4.sql", "name": "inegi2_step4", "resource_type": "model", "alias": "inegi2_step4", "checksum": {"name": "sha256", "checksum": "e979607225ce7c2487d652b0774b18d44f50cf4f7425e2520c50f0ca11a480ab"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi2_step3"], ["nse"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi2_step3", "model.sdna_project.nse"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/compiled/sdna_project/models/sdna_mx/intermediate/inegi/inegi2_step4.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}, "compiled_sql": "select distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case when p15a29a >= 0 then round(p15a29a*.8) else 0 end as genz,\n    case when p15a29a >= 0 or p30a59a >= 0 then round((p15a29a*.2) + (p30a59a*.37)) else 0 end as millenial,\n    case when p30a59a >= 0  then round(p30a59a*.5) else 0 end as genx,\n    case when p30a59a >= 0 or p_60ymas >= 0 then round((p30a59a*.13) + p_60ymas) else 0 end as baby_boomer,\n    case when pobtot >= 0 then round(pobtot*a_b) else 0 end as a_b,\n    case when pobtot >= 0 then round(pobtot*c_plus) else 0 end as c_plus,\n    case when pobtot >= 0 then round(pobtot*c) else 0 end as c,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as c_minus,\n    case when pobtot >= 0 then round(pobtot*d_plus) else 0 end as d_plus,\n    case when pobtot >= 0 then round(pobtot*d) else 0 end as d,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as e,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    x.ent,\n    x.nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step3 x\njoin DP_SDNA_MX.SDNA_MX_DEV.nse y\non x.ent = y.ent", "extra_ctes_injected": true, "extra_ctes": [{"id": "model.sdna_project.inegi2_step1", "sql": " __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n)"}, {"id": "model.sdna_project.inegi2_step2", "sql": " __dbt__CTE__inegi2_step2 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo\n)"}, {"id": "model.sdna_project.inegi2_step3", "sql": " __dbt__CTE__inegi2_step3 as (\nselect distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step2\n)"}], "relation_name": null}, "model.sdna_project.inegi2_step5": {"raw_sql": "with x as (\n    select\n        cvegeo,\n        round(p_0a2_f + p_3a5_f + p_6a11_f + p_12a14_f + (pob15_64*.51) + (pob65_mas*.51)) as f_pob,\n        round(p_0a2_m + p_3a5_m + p_6a11_m + p_12a14_m + (pob15_64*.49) + (pob65_mas*.49)) as m_pob\n    from\n        {{ ref('inegi') }}\n    group by\n        cvegeo,\n        p_0a2_f,\n        p_0a2_m,\n        p_3a5_f,\n        p_3a5_m,\n        p_6a11_f,\n        p_6a11_m,\n        p_12a14_f,\n        p_12a14_m,\n        pob15_64,\n        pob65_mas\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.genz,\n    a.millenial,\n    a.genx,\n    a.baby_boomer,\n    a.a_b,\n    a.c_plus,\n    a.c,\n    a.c_minus,\n    a.d_plus,\n    a.d,\n    a.e,\n    f_pob,\n    m_pob,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    a.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry\nfrom {{ ref('inegi2_step4') }} a\njoin x\non a.cvegeo = x.cvegeo", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "inegi", "inegi2_step5"], "unique_id": "model.sdna_project.inegi2_step5", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/inegi/inegi2_step5.sql", "original_file_path": "models/sdna_mx/intermediate/inegi/inegi2_step5.sql", "name": "inegi2_step5", "resource_type": "model", "alias": "inegi2_step5", "checksum": {"name": "sha256", "checksum": "19ed0c537b96981830a7b1a063f5ab4aa88b696dd0251a5a9342a1e0e214695a"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["inegi"], ["inegi2_step4"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi", "model.sdna_project.inegi2_step4"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/compiled/sdna_project/models/sdna_mx/intermediate/inegi/inegi2_step5.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}, "compiled_sql": "with x as (\n    select\n        cvegeo,\n        round(p_0a2_f + p_3a5_f + p_6a11_f + p_12a14_f + (pob15_64*.51) + (pob65_mas*.51)) as f_pob,\n        round(p_0a2_m + p_3a5_m + p_6a11_m + p_12a14_m + (pob15_64*.49) + (pob65_mas*.49)) as m_pob\n    from\n        DP_SDNA_MX.SDNA_MX_DEV.inegi\n    group by\n        cvegeo,\n        p_0a2_f,\n        p_0a2_m,\n        p_3a5_f,\n        p_3a5_m,\n        p_6a11_f,\n        p_6a11_m,\n        p_12a14_f,\n        p_12a14_m,\n        pob15_64,\n        pob65_mas\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.genz,\n    a.millenial,\n    a.genx,\n    a.baby_boomer,\n    a.a_b,\n    a.c_plus,\n    a.c,\n    a.c_minus,\n    a.d_plus,\n    a.d,\n    a.e,\n    f_pob,\n    m_pob,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    a.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry\nfrom __dbt__CTE__inegi2_step4 a\njoin x\non a.cvegeo = x.cvegeo", "extra_ctes_injected": true, "extra_ctes": [{"id": "model.sdna_project.inegi2_step1", "sql": " __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n)"}, {"id": "model.sdna_project.inegi2_step2", "sql": " __dbt__CTE__inegi2_step2 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo\n)"}, {"id": "model.sdna_project.inegi2_step3", "sql": " __dbt__CTE__inegi2_step3 as (\nselect distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step2\n)"}, {"id": "model.sdna_project.inegi2_step4", "sql": " __dbt__CTE__inegi2_step4 as (\nselect distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case when p15a29a >= 0 then round(p15a29a*.8) else 0 end as genz,\n    case when p15a29a >= 0 or p30a59a >= 0 then round((p15a29a*.2) + (p30a59a*.37)) else 0 end as millenial,\n    case when p30a59a >= 0  then round(p30a59a*.5) else 0 end as genx,\n    case when p30a59a >= 0 or p_60ymas >= 0 then round((p30a59a*.13) + p_60ymas) else 0 end as baby_boomer,\n    case when pobtot >= 0 then round(pobtot*a_b) else 0 end as a_b,\n    case when pobtot >= 0 then round(pobtot*c_plus) else 0 end as c_plus,\n    case when pobtot >= 0 then round(pobtot*c) else 0 end as c,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as c_minus,\n    case when pobtot >= 0 then round(pobtot*d_plus) else 0 end as d_plus,\n    case when pobtot >= 0 then round(pobtot*d) else 0 end as d,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as e,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    x.ent,\n    x.nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step3 x\njoin DP_SDNA_MX.SDNA_MX_DEV.nse y\non x.ent = y.ent\n)"}], "relation_name": null}, "model.sdna_project.stg_lookup": {"raw_sql": "select\n    unit_code as geo_code,\n    name as state,\n    centroid as centroid\n\nfrom dp_data_share_aws_to_az_replica.mapbox.mapbox_lookup_adm1\nwhere country = 'MX'", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "mobility", "stg_lookup"], "unique_id": "model.sdna_project.stg_lookup", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/mobility/stg_lookup.sql", "original_file_path": "models/sdna_mx/intermediate/mobility/stg_lookup.sql", "name": "stg_lookup", "resource_type": "model", "alias": "stg_lookup", "checksum": {"name": "sha256", "checksum": "832e570a21ea7d6c300a19a222465dbe93b02d856962b5511bc9851ae8967bc4"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "Geocode lookup", "columns": {"geo_code": {"name": "geo_code", "description": "The primary key for this table", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/sdna_mx/transformations/mobility/mobility.yml", "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_mobility_data": {"raw_sql": "select\n    geography as geo_code,\n    agg_day_period as agg_day,\n    activity_index_total as activity_index_total\n\nfrom dp_data_share_aws_to_az_replica.mapbox.mapbox_v0_2_daily_adm1_total\nwhere country = 'MX'", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "mobility", "stg_mobility_data"], "unique_id": "model.sdna_project.stg_mobility_data", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/mobility/stg_mobility_data.sql", "original_file_path": "models/sdna_mx/intermediate/mobility/stg_mobility_data.sql", "name": "stg_mobility_data", "resource_type": "model", "alias": "stg_mobility_data", "checksum": {"name": "sha256", "checksum": "f24da07991d7b2434e4d9fb8528a730fbe408af74b4e73b3ffd5bf52b8bb2a20"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "Raw mobility data", "columns": {"geo_code": {"name": "geo_code", "description": "Foreign key -- lookup table", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/sdna_mx/transformations/mobility/mobility.yml", "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_df_lf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere (\n   format = 'LF' and des_edo in   ('DISTRITO FEDERAL', '%D F%', 'D. F.', 'D.F.', 'DISTITO FEDERAL')\n   or format = 'LF' and des_edo like 'nuevo leon'           and des_municipio like 'monterrey'\n   or format = 'LF' and des_edo like 'jalisco'              and des_municipio like 'Guadalajara'\n   or format = 'LF' and des_edo in   ('Puebla', 'Tlaxcala') and des_municipio in   ('Puebla', 'Tlaxcala', 'Puebla-Tlaxcala')\n   or format = 'LF' and des_edo like 'mexico'               and des_municipio like 'toluca'\n)\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 1000)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_df_lf"], "unique_id": "model.sdna_project.tradearea_df_lf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_df_lf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_df_lf.sql", "name": "tradearea_df_lf", "resource_type": "model", "alias": "tradearea_df_lf", "checksum": {"name": "sha256", "checksum": "7009ab3ac674bc6f6a5b37404544f82f2eab45f7b7bdf223688552d0740fd2b1"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_df_sf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere (\n    format = 'SF' and des_edo in   ('DISTRITO FEDERAL', '%D F%', 'D. F.', 'D.F.', 'DISTITO FEDERAL')\n    or format = 'SF' and des_edo like 'nuevo leon'           and des_municipio like 'monterrey'\n    or format = 'SF' and des_edo like 'jalisco'              and des_municipio like 'Guadalajara'\n    or format = 'SF' and des_edo in   ('Puebla', 'Tlaxcala') and des_municipio in   ('Puebla', 'Tlaxcala', 'Puebla-Tlaxcala')\n    or format = 'SF' and des_edo like 'mexico'               and des_municipio like 'toluca'\n)\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 500)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_df_sf"], "unique_id": "model.sdna_project.tradearea_df_sf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_df_sf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_df_sf.sql", "name": "tradearea_df_sf", "resource_type": "model", "alias": "tradearea_df_sf", "checksum": {"name": "sha256", "checksum": "7b614bca23eeb3e4480056afbd738903b21fba392d20bad7d7e4eae4a518ea82"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_r_lf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere ambito in ('R', null)\n    and format = 'LF'\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 5000)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_r_lf"], "unique_id": "model.sdna_project.tradearea_r_lf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_r_lf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_r_lf.sql", "name": "tradearea_r_lf", "resource_type": "model", "alias": "tradearea_r_lf", "checksum": {"name": "sha256", "checksum": "1937b272f8890e0261098af79fe9bf4ac987741de6d444c37672c465979fa030"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_r_sf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere ambito in ('R', null)\n    and format = 'SF'\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 5000)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_r_sf"], "unique_id": "model.sdna_project.tradearea_r_sf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_r_sf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_r_sf.sql", "name": "tradearea_r_sf", "resource_type": "model", "alias": "tradearea_r_sf", "checksum": {"name": "sha256", "checksum": "525fe745e60b8c0af256ea4f45d84e931b35f72d0559739be5a409d0e4e7976c"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_u_lf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere ambito = 'U'\n    and format = 'LF'\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 2000)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_u_lf"], "unique_id": "model.sdna_project.tradearea_u_lf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_u_lf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_u_lf.sql", "name": "tradearea_u_lf", "resource_type": "model", "alias": "tradearea_u_lf", "checksum": {"name": "sha256", "checksum": "3f40da93ec3595b719aab3259d35b662d7ffd19cadb9368e64fce26560458893"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.tradearea_u_sf": {"raw_sql": "select\n    id_cliente,\n    count(cvegeo) as manzana_count,\n    sum(vivtot) as vivtot,\n    sum(tvivhab) as tvivhab,\n    avg(p_tvivhab) as p_tvivhab,\n    sum(tvivpar) as tvivpar,\n    avg(p_tvivpar) as p_tvivpar,\n    sum(tvivparhab) as tvivparhab,\n    avg(pvivparhab) as pvivparhab,\n    sum(vivpar_des) as vivpar_des,\n    avg(p_vivpar_d) as p_vivpar_d,\n    sum(vivpar_ut) as vivpar_ut,\n    avg(p_vivpar_u) as p_vivpar_u,\n    sum(vivnohab) as vivnohab,\n    avg(p_vivnohab) as p_vivnohab,\n    avg(proocup_c) as proocup_c,\n    sum(pobtot) as pobtot,\n    sum(p0a14a) as p0a14a,\n    avg(pp0a14a) as pp0a14a,\n    sum(p15a29a) as p15a29a,\n    avg(pp15a29a) as pp15a29a,\n    sum(p30a59a) as p30a59a,\n    avg(pp30a59a) as pp30a59a,\n    sum(p_60ymas) as p_60ymas,\n    avg(pp_60ymas) as pp_60ymas,\n    sum(genz) as genz,\n    sum(millenial) as millenial,\n    sum(genx) as genx,\n    sum(baby_boomer) as baby_boomer,\n    sum(a_b) as a_b,\n    sum(c_plus) as c_plus,\n    sum(c) as c,\n    sum(c_minus) as c_minus,\n    sum(d_plus) as d_plus,\n    sum(d) as d,\n    sum(e) as e,\n    sum(f_pob) as f_pob,\n    sum(m_pob) as m_pob,\n    sum(pcon_lim) as pcon_lim,\n    avg(ppcon_lim) as ppcon_lim,\n    avg(graproes) as graproes,\n    format\nfrom {{ ref('mx_stores') }}\njoin {{ ref('inegi_2') }}\nwhere ambito = 'U'\n    and format = 'SF'\n    and st_dwithin(to_geography(st_makepoint(long ,lat)), geometry, 1000)\ngroup by\n    id_cliente,\n    format", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "intermediate", "tradearea", "tradearea_u_sf"], "unique_id": "model.sdna_project.tradearea_u_sf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/intermediate/tradearea/tradearea_u_sf.sql", "original_file_path": "models/sdna_mx/intermediate/tradearea/tradearea_u_sf.sql", "name": "tradearea_u_sf", "resource_type": "model", "alias": "tradearea_u_sf", "checksum": {"name": "sha256", "checksum": "991a9dab27e32e25509078b211beda31c307d6a35d38801d39207cfe05295a54"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null}, "tags": [], "refs": [["mx_stores"], ["inegi_2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores", "model.sdna_project.inegi_2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "ephemeral", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dataplor": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AWS_EXTERNAL_DATA_DELIVERY_BUCKET',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/MX/dataplor/2021-06-04.csv.gz') }}", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dataplor"], "unique_id": "model.sdna_project.dataplor", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dataplor.sql", "original_file_path": "models/sdna_mx/loads/dataplor.sql", "name": "dataplor", "resource_type": "model", "alias": "dataplor", "checksum": {"name": "sha256", "checksum": "d69edf77d6a0218bec2bf8153c0edb477d41f6baf9c66f980db2a29688c8aada"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.dls_latam_ins_categoria": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_categoria') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fd1dbc2a50aeca3e0ef/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_categoria"], "unique_id": "model.sdna_project.dls_latam_ins_categoria", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_categoria.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_categoria.sql", "name": "dls_latam_ins_categoria", "resource_type": "model", "alias": "dls_latam_ins_categoria", "checksum": {"name": "sha256", "checksum": "245b7071d2cda7c5d4f0f625af228752e38fdfe61b8d1ed4957d15a7f59430ff"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_cia_ruta": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_cia_ruta') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fd1dbc2a50aeca3e0f0/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_cia_ruta"], "unique_id": "model.sdna_project.dls_latam_ins_cia_ruta", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_cia_ruta.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_cia_ruta.sql", "name": "dls_latam_ins_cia_ruta", "resource_type": "model", "alias": "dls_latam_ins_cia_ruta", "checksum": {"name": "sha256", "checksum": "1132b87c8b4f435f2192013b209c54a019da3bfe2a9ce8f96d78ea64f48b3d9a"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_maestrocliente": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_maestrocliente') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fd7dbc2a50aeca3e104/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_maestrocliente"], "unique_id": "model.sdna_project.dls_latam_ins_maestrocliente", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_maestrocliente.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_maestrocliente.sql", "name": "dls_latam_ins_maestrocliente", "resource_type": "model", "alias": "dls_latam_ins_maestrocliente", "checksum": {"name": "sha256", "checksum": "6914893661f6726c165052ed8cfa01beb33eff23dbb99f0c727408d15166570f"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_nivelcliente": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_nivelcliente') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fd9dbc2a50aeca3e10b/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_nivelcliente"], "unique_id": "model.sdna_project.dls_latam_ins_nivelcliente", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_nivelcliente.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_nivelcliente.sql", "name": "dls_latam_ins_nivelcliente", "resource_type": "model", "alias": "dls_latam_ins_nivelcliente", "checksum": {"name": "sha256", "checksum": "6b64c1aef5091cba23d782e955724f5de76cb1106547598bb865b616c158961b"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_producto": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_producto') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fdbdbc2a50aeca3e111/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_producto"], "unique_id": "model.sdna_project.dls_latam_ins_producto", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_producto.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_producto.sql", "name": "dls_latam_ins_producto", "resource_type": "model", "alias": "dls_latam_ins_producto", "checksum": {"name": "sha256", "checksum": "5ef5d205a838682984cc642870d9829b434993a3e9b1bc59a570c47ef65404a5"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_ruta": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_ruta') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fdddbc2a50aeca3e115/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_ruta"], "unique_id": "model.sdna_project.dls_latam_ins_ruta", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_ruta.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_ruta.sql", "name": "dls_latam_ins_ruta", "resource_type": "model", "alias": "dls_latam_ins_ruta", "checksum": {"name": "sha256", "checksum": "2a3c3fcf9625c7c6e6321470b574995012a991ec1cdffb0cd95545ec2742d0c2"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_semana": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_semana') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fdddbc2a50aeca3e118/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_semana"], "unique_id": "model.sdna_project.dls_latam_ins_semana", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_semana.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_semana.sql", "name": "dls_latam_ins_semana", "resource_type": "model", "alias": "dls_latam_ins_semana", "checksum": {"name": "sha256", "checksum": "84f9741da56df4f3d90cd49bbd7d9dda7e38d183edcf9a8fee0887f110c0fb9e"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_sucursal": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_sucursal') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fdfdbc2a50aeca3e11e/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_sucursal"], "unique_id": "model.sdna_project.dls_latam_ins_sucursal", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_sucursal.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_sucursal.sql", "name": "dls_latam_ins_sucursal", "resource_type": "model", "alias": "dls_latam_ins_sucursal", "checksum": {"name": "sha256", "checksum": "1cd2652d2e8dff316f1d42b13a62f4a30300b759c59ab37212eed368175dadb8"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_tipocliente": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_tipocliente') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb4fdfdbc2a50aeca3e120/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_tipocliente"], "unique_id": "model.sdna_project.dls_latam_ins_tipocliente", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_tipocliente.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_tipocliente.sql", "name": "dls_latam_ins_tipocliente", "resource_type": "model", "alias": "dls_latam_ins_tipocliente", "checksum": {"name": "sha256", "checksum": "a1cff3e88734cd3718dc658f7252a75a8c087b880cc163e54620cfadaba4c30c"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_tiporuta": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dls_latam_ins_tiporuta') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/5feb50a8dbc2a50aeca3e53a/merged/part-0000') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_tiporuta"], "unique_id": "model.sdna_project.dls_latam_ins_tiporuta", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_tiporuta.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_tiporuta.sql", "name": "dls_latam_ins_tiporuta", "resource_type": "model", "alias": "dls_latam_ins_tiporuta", "checksum": {"name": "sha256", "checksum": "09aaf4b03e49edea5a35d309c9ae8ce786c05316363674c45f0a9dcf1f8bb594"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "copy_transform": true}}, "model.sdna_project.dls_latam_ins_vtaclipro_sem_v": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_EDA_CONTAINER_PARQUET',\n    file_format_name='PARQUET_PARSER',\n    pattern='.*snappy.parquet',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    $1:id_cliente AS id_cliente,\n    $1:id_ruta AS id_ruta,\n    $1:id_producto AS id_producto,\n    $1:id_dia AS id_dia,\n    $1:semana AS semana,\n    $1:id_cia_ruta AS id_cia_ruta,\n    $1:id_nivelcliente AS id_nivelcliente,\n    $1:id_tipocliente AS id_tipocliente,\n    $1:id_tipodistribucion AS id_tipodistribucion,\n    $1:venta_capt_uni AS venta_capt_uni,\n    $1:venta_capt_pes AS venta_capt_pes,\n    $1:precio_venta AS precio_venta,\n    $1:precio_cliente AS precio_cliente,\n    $1:hhc_inv_inicial AS hhc_inv_inicial,\n    $1:hhc_uni_devueltAS AS hhc_uni_devueltAS,\n    $1:hhc_uni_rotadAS AS hhc_uni_rotadAS,\n    $1:hhc_uni_capturadAS AS hhc_uni_capturadAS,\n    $1:hhc_uni_sugeridAS AS hhc_uni_sugeridAS,\n    $1:hhc_uni_faltantes AS hhc_uni_faltantes,\n    $1:num_ctedispro AS num_ctedispro,\n    $1:dw_sys_id AS dw_sys_id,\n    $1:cru_id AS cru_id,\n    $1:dw_crtd_dtm AS dw_crtd_dtm,\n    $1:dw_updt_dtm AS dw_updt_dtm,\n    $1:dw_btch_id AS dw_btch_id,\n    $1:dw_step_id AS dw_step_id,\n    substr(regexp_substr(METADATA$FILENAME,'\\=[0-9]*'),2) AS id_semana,\n    $1:ziw_target_timestamp AS ziw_target_timestamp,\n    $1:ziw_is_deleted AS ziw_is_deleted,\n    current_timestamp() AS last_updt_dt\nFROM\n{{ external_stage('/latam/teradata/edw_latam_sem_extrct_teradata/DLS_LATAM_INS_VTACLIPRO_SEM/id') }}\n)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "dls_latam_ins_vtaclipro_sem_v"], "unique_id": "model.sdna_project.dls_latam_ins_vtaclipro_sem_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/dls_latam_ins_vtaclipro_sem_v.sql", "original_file_path": "models/sdna_mx/loads/dls_latam_ins_vtaclipro_sem_v.sql", "name": "dls_latam_ins_vtaclipro_sem_v", "resource_type": "model", "alias": "dls_latam_ins_vtaclipro_sem_v", "checksum": {"name": "sha256", "checksum": "94f52309b8947e12ebb918be3af1abe3c96c85f96dad8ef5ab9262352ead0f02"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "pattern": ".*snappy.parquet", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_EDA_CONTAINER_PARQUET", "file_format_name": "PARQUET_PARSER", "pattern": ".*snappy.parquet", "copy_transform": true}}, "model.sdna_project.inegi_2_stg": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AWS_EXTERNAL_DATA_DELIVERY_BUCKET',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/MX/INEGI-based-polygons/inegi2.csv') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "inegi_2_stg"], "unique_id": "model.sdna_project.inegi_2_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/inegi_2_stg.sql", "original_file_path": "models/sdna_mx/loads/inegi_2_stg.sql", "name": "inegi_2_stg", "resource_type": "model", "alias": "inegi_2_stg", "checksum": {"name": "sha256", "checksum": "ee04cb15ac9dfc5fbeb5665284b3d6e137c4fb8af9572bd2c573c54e807ae0df"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage", "macro.dbt.run_hooks", "macro.dbt.statement"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/loads/inegi_2_stg.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "compiled_sql": "\n\n    @DP_SDNA_MX.SDNA_MX_DEV.__STAGE_TOKEN__/MX/INEGI-based-polygons/inegi2.csv\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg"}, "model.sdna_project.inegi_stg": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AWS_EXTERNAL_DATA_DELIVERY_BUCKET',\n    file_format_name='CSV_PIPE_PARSER',\n  )\n}}\n{{ external_stage('/MX/INEGI-based-polygons/full_mex.csv') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "inegi_stg"], "unique_id": "model.sdna_project.inegi_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/inegi_stg.sql", "original_file_path": "models/sdna_mx/loads/inegi_stg.sql", "name": "inegi_stg", "resource_type": "model", "alias": "inegi_stg", "checksum": {"name": "sha256", "checksum": "82b54d6bff70403d948338c94ef2d3a1ff0128e541dc8db743d27cbeaec1805a"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage", "macro.dbt.run_hooks", "macro.dbt.statement"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/loads/inegi_stg.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_PIPE_PARSER"}, "compiled_sql": "\n\n    @DP_SDNA_MX.SDNA_MX_DEV.__STAGE_TOKEN__/MX/INEGI-based-polygons/full_mex.csv\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.inegi_stg"}, "model.sdna_project.nse_stg": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AWS_EXTERNAL_DATA_DELIVERY_BUCKET',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/MX/INEGI-based-polygons/nse.csv') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "nse_stg"], "unique_id": "model.sdna_project.nse_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/nse_stg.sql", "original_file_path": "models/sdna_mx/loads/nse_stg.sql", "name": "nse_stg", "resource_type": "model", "alias": "nse_stg", "checksum": {"name": "sha256", "checksum": "af1cf3e622499b06c3311cb8b075205c3d4508998e5c3040d298e96d95fb2f7a"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage", "macro.dbt.run_hooks", "macro.dbt.statement"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/loads/nse_stg.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "compiled_sql": "\n\n    @DP_SDNA_MX.SDNA_MX_DEV.__STAGE_TOKEN__/MX/INEGI-based-polygons/nse.csv\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.nse_stg"}, "model.sdna_project.urbanicity_stg": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AWS_EXTERNAL_DATA_DELIVERY_BUCKET',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/MX/INEGI-based-polygons/urban_rural.csv') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "loads", "urbanicity_stg"], "unique_id": "model.sdna_project.urbanicity_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/loads/urbanicity_stg.sql", "original_file_path": "models/sdna_mx/loads/urbanicity_stg.sql", "name": "urbanicity_stg", "resource_type": "model", "alias": "urbanicity_stg", "checksum": {"name": "sha256", "checksum": "1579691d00e41db90827caf28b137a9d1402e53d57928ed1e2d0944c43a9bff4"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage", "macro.dbt.run_hooks", "macro.dbt.statement"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/loads/urbanicity_stg.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "from_external_stage", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AWS_EXTERNAL_DATA_DELIVERY_BUCKET", "file_format_name": "CSV_COMMA_PARSER"}, "compiled_sql": "\n\n    @DP_SDNA_MX.SDNA_MX_DEV.__STAGE_TOKEN__/MX/INEGI-based-polygons/urban_rural.csv\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.urbanicity_stg"}, "model.sdna_project.inegi": {"raw_sql": "select distinct\n    lpad(entidad, 2, 0) as entidad,\n    lpad(mun, 3, 0) as mun,\n    lpad(loc, 4, 0) as loc,\n    lpad(ageb, 4, 0) as ageb,\n    lpad(mza, 3, 0) as mza,\n    cvegeo,\n    ambito,\n    p_0a2,\n    p_0a2_f,\n    p_0a2_m,\n    p_3a5,\n    p_3a5_f,\n    p_3a5_m,\n    p_6a11,\n    p_6a11_f,\n    p_6a11_m,\n    p_12a14,\n    p_12a14_f,\n    p_12a14_m,\n    p_15a17,\n    p_15a17_f,\n    p_15a17_m,\n    p_18a24,\n    p_18a24_f,\n    p_18a24_m,\n    p_60ymas,\n    p_60ymas_f,\n    p_60ymas_m,\n    pob0_14,\n    p_15a49_f,\n    pob15_64,\n    pob65_mas,\n    tipomza,\n    total_homes,\n    total_inhabited_dwellings,\n    total_inhabited_private_dwellings,\n    total_private_homes,\n    private_homes_for_temporary_use,\n    occupants_in_inhabited_private_dwellings,\n    inhabited_private_homes,\n    uninhabited_private_homes,\n    geometry,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('inegi_stg') }}", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "inegi"], "unique_id": "model.sdna_project.inegi", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/inegi.sql", "original_file_path": "models/sdna_mx/transformations/inegi.sql", "name": "inegi", "resource_type": "model", "alias": "inegi", "checksum": {"name": "sha256", "checksum": "990215b1d3fd0a00486df0474d1fb12944d547527c095432584d03f5e7efc115"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["inegi_stg"]], "sources": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": ["model.sdna_project.inegi_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/transformations/inegi.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}, "compiled_sql": "select distinct\n    lpad(entidad, 2, 0) as entidad,\n    lpad(mun, 3, 0) as mun,\n    lpad(loc, 4, 0) as loc,\n    lpad(ageb, 4, 0) as ageb,\n    lpad(mza, 3, 0) as mza,\n    cvegeo,\n    ambito,\n    p_0a2,\n    p_0a2_f,\n    p_0a2_m,\n    p_3a5,\n    p_3a5_f,\n    p_3a5_m,\n    p_6a11,\n    p_6a11_f,\n    p_6a11_m,\n    p_12a14,\n    p_12a14_f,\n    p_12a14_m,\n    p_15a17,\n    p_15a17_f,\n    p_15a17_m,\n    p_18a24,\n    p_18a24_f,\n    p_18a24_m,\n    p_60ymas,\n    p_60ymas_f,\n    p_60ymas_m,\n    pob0_14,\n    p_15a49_f,\n    pob15_64,\n    pob65_mas,\n    tipomza,\n    total_homes,\n    total_inhabited_dwellings,\n    total_inhabited_private_dwellings,\n    total_private_homes,\n    private_homes_for_temporary_use,\n    occupants_in_inhabited_private_dwellings,\n    inhabited_private_homes,\n    uninhabited_private_homes,\n    geometry,\n    current_timestamp() as last_updt_dt\nfrom DP_SDNA_MX.SDNA_MX_DEV.inegi_stg", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.inegi"}, "model.sdna_project.inegi_2": {"raw_sql": "with x as(\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        genz,\n        millenial,\n        genx,\n        baby_boomer,\n        a_b,\n        c_plus,\n        c,\n        c_minus,\n        d_plus,\n        d,\n        e,\n        f_pob,\n        m_pob,\n        (genz + millenial + p0a14a) as y_fam,\n        (genx + baby_boomer + p0a14a) as o_fam,\n        (genz + millenial) as pre_fam,\n        (genx + baby_boomer) as post_fam,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        ageb,\n        mza,\n        ambito,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from {{ ref('inegi2_step5') }}\n)\nselect distinct * from x", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "inegi_2"], "unique_id": "model.sdna_project.inegi_2", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/inegi_2.sql", "original_file_path": "models/sdna_mx/transformations/inegi_2.sql", "name": "inegi_2", "resource_type": "model", "alias": "inegi_2", "checksum": {"name": "sha256", "checksum": "5f137bd916e5672587ca631d17ae6059c2dd80de2526130e395205ba7c8a4a89"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["inegi2_step5"]], "sources": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": ["model.sdna_project.inegi2_step5"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/transformations/inegi_2.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}, "compiled_sql": "with  __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n),  __dbt__CTE__inegi2_step2 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo\n),  __dbt__CTE__inegi2_step3 as (\nselect distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step2\n),  __dbt__CTE__inegi2_step4 as (\nselect distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case when p15a29a >= 0 then round(p15a29a*.8) else 0 end as genz,\n    case when p15a29a >= 0 or p30a59a >= 0 then round((p15a29a*.2) + (p30a59a*.37)) else 0 end as millenial,\n    case when p30a59a >= 0  then round(p30a59a*.5) else 0 end as genx,\n    case when p30a59a >= 0 or p_60ymas >= 0 then round((p30a59a*.13) + p_60ymas) else 0 end as baby_boomer,\n    case when pobtot >= 0 then round(pobtot*a_b) else 0 end as a_b,\n    case when pobtot >= 0 then round(pobtot*c_plus) else 0 end as c_plus,\n    case when pobtot >= 0 then round(pobtot*c) else 0 end as c,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as c_minus,\n    case when pobtot >= 0 then round(pobtot*d_plus) else 0 end as d_plus,\n    case when pobtot >= 0 then round(pobtot*d) else 0 end as d,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as e,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    x.ent,\n    x.nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step3 x\njoin DP_SDNA_MX.SDNA_MX_DEV.nse y\non x.ent = y.ent\n),  __dbt__CTE__inegi2_step5 as (\nwith x as (\n    select\n        cvegeo,\n        round(p_0a2_f + p_3a5_f + p_6a11_f + p_12a14_f + (pob15_64*.51) + (pob65_mas*.51)) as f_pob,\n        round(p_0a2_m + p_3a5_m + p_6a11_m + p_12a14_m + (pob15_64*.49) + (pob65_mas*.49)) as m_pob\n    from\n        DP_SDNA_MX.SDNA_MX_DEV.inegi\n    group by\n        cvegeo,\n        p_0a2_f,\n        p_0a2_m,\n        p_3a5_f,\n        p_3a5_m,\n        p_6a11_f,\n        p_6a11_m,\n        p_12a14_f,\n        p_12a14_m,\n        pob15_64,\n        pob65_mas\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.genz,\n    a.millenial,\n    a.genx,\n    a.baby_boomer,\n    a.a_b,\n    a.c_plus,\n    a.c,\n    a.c_minus,\n    a.d_plus,\n    a.d,\n    a.e,\n    f_pob,\n    m_pob,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    a.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry\nfrom __dbt__CTE__inegi2_step4 a\njoin x\non a.cvegeo = x.cvegeo\n),x as(\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        genz,\n        millenial,\n        genx,\n        baby_boomer,\n        a_b,\n        c_plus,\n        c,\n        c_minus,\n        d_plus,\n        d,\n        e,\n        f_pob,\n        m_pob,\n        (genz + millenial + p0a14a) as y_fam,\n        (genx + baby_boomer + p0a14a) as o_fam,\n        (genz + millenial) as pre_fam,\n        (genx + baby_boomer) as post_fam,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        ageb,\n        mza,\n        ambito,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from __dbt__CTE__inegi2_step5\n)\nselect distinct * from x", "extra_ctes_injected": true, "extra_ctes": [{"id": "model.sdna_project.inegi2_step1", "sql": " __dbt__CTE__inegi2_step1 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        lpad(ent, 2, 0) as ent,\n        nom_ent,\n        lpad(mun, 3, 0) as mun,\n        nom_mun,\n        lpad(loc, 4, 0) as loc,\n        nom_loc,\n        lpad(ageb, 4, 0) as ageb,\n        lpad(mza, 3, 0) as mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry\n    from DP_SDNA_MX.SDNA_MX_DEV.inegi_2_stg\n)\nselect distinct\n    *\nfrom x\n)"}, {"id": "model.sdna_project.inegi2_step2", "sql": " __dbt__CTE__inegi2_step2 as (\nwith x as (\n    select distinct\n        cvegeo,\n        vivtot,\n        tvivhab,\n        p_tvivhab,\n        tvivpar,\n        p_tvivpar,\n        tvivparhab,\n        pvivparhab,\n        vivpar_des,\n        p_vivpar_d,\n        vivpar_ut,\n        p_vivpar_u,\n        vivnohab,\n        p_vivnohab,\n        proocup_c,\n        pobtot,\n        p0a14a,\n        pp0a14a,\n        p15a29a,\n        pp15a29a,\n        p30a59a,\n        pp30a59a,\n        p_60ymas,\n        pp_60ymas,\n        pcon_lim,\n        ppcon_lim,\n        graproes,\n        ent,\n        nom_ent,\n        mun,\n        nom_mun,\n        loc,\n        nom_loc,\n        concat(ent, mun, loc) as loc_cod,\n        ageb,\n        mza,\n        fecha_poli,\n        fecha_inf,\n        fecha_ceu,\n        oid,\n        geometry \n    from __dbt__CTE__inegi2_step1\n),\nurb as (\n    select distinct\n        localidad_codigo,\n        ambito \n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    b.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry \nfrom x a\njoin urb b\non a.loc_cod = b.localidad_codigo\n)"}, {"id": "model.sdna_project.inegi2_step3", "sql": " __dbt__CTE__inegi2_step3 as (\nselect distinct\n    cvegeo,\n    case when vivtot in ('N.D.','*','*********') then 0 else cast(vivtot as int) end as vivtot,\n    case when tvivhab in ('N.D.','*','*********') then 0 else cast(tvivhab as int) end as tvivhab,\n    case when p_tvivhab in ('N.D.','*','*********') then 0 else cast(p_tvivhab as decimal(5,2)) end as p_tvivhab,\n    case when tvivpar in ('N.D.','*','*********') then 0 else cast(tvivpar as int) end as tvivpar,\n    case when p_tvivpar in ('N.D.','*','*********') then 0 else cast(p_tvivpar as decimal(5,2)) end as p_tvivpar,\n    case when tvivparhaB in ('N.D.','*','*********') then 0 else cast(tvivparhab as int) end as tvivparhab,\n    case when pvivparhaB in ('N.D.','*','*********') then 0 else cast(pvivparhab as decimal(5,2)) end as pvivparhab,\n    case when vivpar_deS in ('N.D.','*','*********') then 0 else cast(vivpar_des as int) end as vivpar_des,\n    case when p_vivpar_D in ('N.D.','*','*********') then 0 else cast(p_vivpar_d as decimal(5,2)) end as p_vivpar_d,\n    case when vivpar_ut in ('N.D.','*','*********') then 0 else cast(vivpar_ut as int) end as vivpar_ut,\n    case when p_vivpar_U in ('N.D.','*','*********') then 0 else cast(p_vivpar_u as decimal(5,2)) end as p_vivpar_u,\n    case when vivnohab in ('N.D.','*','*********') then 0 else cast(vivnohab as int) end as vivnohab,\n    case when p_vivnohaB in ('N.D.','*','*********') then 0 else cast(p_vivnohab as decimal(5,2)) end as p_vivnohab,\n    case when proocup_c in ('N.D.','*','*********') then 0 else cast(proocup_c as decimal(10,2)) end as proocup_c,\n    case when pobtot in ('N.D.','*','*********') then 0 else cast(pobtot as int) end as pobtot,\n    case when p0a14a in ('N.D.','*','*********') then 0 else cast(p0a14a as int) end as p0a14a,\n    case when pp0a14a in ('N.D.','*','*********') then 0 else cast(pp0a14a as decimal(5,2)) end as pp0a14a,\n    case when p15a29a in ('N.D.','*','*********') then 0 else cast(p15a29a as int) end as p15a29a,\n    case when pp15a29a in ('N.D.','*','*********') then 0 else cast(pp15a29a as decimal(5,2)) end as pp15a29a,\n    case when p30a59a in ('N.D.','*','*********') then 0 else cast(p30a59a as int) end as p30a59a,\n    case when pp30a59a in ('N.D.','*','*********') then 0 else cast(pp30a59a as decimal(5,2)) end as pp30a59a,\n    case when p_60ymas in ('N.D.','*','*********') then 0 else cast(p_60ymas as int) end as p_60ymas,\n    case when pp_60ymas in ('N.D.','*','*********') then 0 else cast(pp_60ymas as decimal(5,2)) end as pp_60ymas,\n    case when pcon_lim in ('N.D.','*','*********') then 0 else cast(pcon_lim as int) end as pcon_lim,\n    case when ppcon_lim in ('N.D.','*','*********') then 0 else cast(ppcon_lim as decimal(5,2)) end as ppcon_lim,\n    case when graproes in ('N.D.','*','*********') then 0 else cast(graproes as decimal(10,2)) end as graproes,\n    ent,\n    nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step2\n)"}, {"id": "model.sdna_project.inegi2_step4", "sql": " __dbt__CTE__inegi2_step4 as (\nselect distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    case when p15a29a >= 0 then round(p15a29a*.8) else 0 end as genz,\n    case when p15a29a >= 0 or p30a59a >= 0 then round((p15a29a*.2) + (p30a59a*.37)) else 0 end as millenial,\n    case when p30a59a >= 0  then round(p30a59a*.5) else 0 end as genx,\n    case when p30a59a >= 0 or p_60ymas >= 0 then round((p30a59a*.13) + p_60ymas) else 0 end as baby_boomer,\n    case when pobtot >= 0 then round(pobtot*a_b) else 0 end as a_b,\n    case when pobtot >= 0 then round(pobtot*c_plus) else 0 end as c_plus,\n    case when pobtot >= 0 then round(pobtot*c) else 0 end as c,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as c_minus,\n    case when pobtot >= 0 then round(pobtot*d_plus) else 0 end as d_plus,\n    case when pobtot >= 0 then round(pobtot*d) else 0 end as d,\n    case when pobtot >= 0 then round(pobtot*c_minus) else 0 end as e,\n    pcon_lim,\n    ppcon_lim,\n    graproes,\n    x.ent,\n    x.nom_ent,\n    mun,\n    nom_mun,\n    loc,\n    nom_loc,\n    ageb,\n    mza,\n    ambito,\n    fecha_poli,\n    fecha_inf,\n    fecha_ceu,\n    oid,\n    geometry\nfrom __dbt__CTE__inegi2_step3 x\njoin DP_SDNA_MX.SDNA_MX_DEV.nse y\non x.ent = y.ent\n)"}, {"id": "model.sdna_project.inegi2_step5", "sql": " __dbt__CTE__inegi2_step5 as (\nwith x as (\n    select\n        cvegeo,\n        round(p_0a2_f + p_3a5_f + p_6a11_f + p_12a14_f + (pob15_64*.51) + (pob65_mas*.51)) as f_pob,\n        round(p_0a2_m + p_3a5_m + p_6a11_m + p_12a14_m + (pob15_64*.49) + (pob65_mas*.49)) as m_pob\n    from\n        DP_SDNA_MX.SDNA_MX_DEV.inegi\n    group by\n        cvegeo,\n        p_0a2_f,\n        p_0a2_m,\n        p_3a5_f,\n        p_3a5_m,\n        p_6a11_f,\n        p_6a11_m,\n        p_12a14_f,\n        p_12a14_m,\n        pob15_64,\n        pob65_mas\n)\nselect distinct\n    a.cvegeo,\n    a.vivtot,\n    a.tvivhab,\n    a.p_tvivhab,\n    a.tvivpar,\n    a.p_tvivpar,\n    a.tvivparhab,\n    a.pvivparhab,\n    a.vivpar_des,\n    a.p_vivpar_d,\n    a.vivpar_ut,\n    a.p_vivpar_u,\n    a.vivnohab,\n    a.p_vivnohab,\n    a.proocup_c,\n    a.pobtot,\n    a.p0a14a,\n    a.pp0a14a,\n    a.p15a29a,\n    a.pp15a29a,\n    a.p30a59a,\n    a.pp30a59a,\n    a.p_60ymas,\n    a.pp_60ymas,\n    a.genz,\n    a.millenial,\n    a.genx,\n    a.baby_boomer,\n    a.a_b,\n    a.c_plus,\n    a.c,\n    a.c_minus,\n    a.d_plus,\n    a.d,\n    a.e,\n    f_pob,\n    m_pob,\n    a.pcon_lim,\n    a.ppcon_lim,\n    a.graproes,\n    a.ent,\n    a.nom_ent,\n    a.mun,\n    a.nom_mun,\n    a.loc,\n    a.nom_loc,\n    a.ageb,\n    a.mza,\n    a.ambito,\n    a.fecha_poli,\n    a.fecha_inf,\n    a.fecha_ceu,\n    a.oid,\n    a.geometry\nfrom __dbt__CTE__inegi2_step4 a\njoin x\non a.cvegeo = x.cvegeo\n)"}], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.inegi_2"}, "model.sdna_project.inegi_2pbi": {"raw_sql": "select distinct\n    cvegeo,\n    vivtot,\n    tvivhab,\n    p_tvivhab,\n    tvivpar,\n    p_tvivpar,\n    tvivparhab,\n    pvivparhab,\n    vivpar_des,\n    p_vivpar_d,\n    vivpar_ut,\n    p_vivpar_u,\n    vivnohab,\n    p_vivnohab,\n    proocup_c,\n    pobtot,\n    p0a14a,\n    pp0a14a,\n    p15a29a,\n    pp15a29a,\n    p30a59a,\n    pp30a59a,\n    p_60ymas,\n    pp_60ymas,\n    genz,\n    millenial,\n    genx,\n    baby_boomer,\n    case\n        when pobtot >= 0\n        then round(pobtot*a_b)\n        else 0\n    end as a_b,\n    case\n        when pobtot >= 0\n        then round(pobtot*c_plus)\n        else 0\n    end as c_plus,\n    case\n        when pobtot >= 0\n        then round(pobtot*c)\n        else 0\n    end as c,\n    case\n        when pobtot >= 0\n        then round(pobtot*c_minus)\n        else 0\n    end as c_minus,\n    case\n        when pobtot >= 0\n        then round(pobtot*d_plus)\n        else 0\n    end as d_plus,\n    case\n        when pobtot >= 0\n        then round(pobtot*d )\n        else 0\n    end as d,\n    case\n        when pobtot >= 0\n        then round(pobtot*c_minus)\n        else 0\n    end as e,\n    pcon_lim,\n     ppcon_lim,\n     graproes,\n     x.ent,\n     x.nom_ent,\n     mun,\n     nom_mun,\n     loc,\n     nom_loc,\n     ageb,\n     mza,\n     ambito,\n     fecha_poli,\n     fecha_inf,\n     fecha_ceu,\n     oid,\n     current_timestamp() as last_updt_dt\nfrom {{ ref('inegi_2pbi_stg') }} x\njoin {{ ref('nse') }} y\n    on x.ent = y.ent", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "inegi_2pbi"], "unique_id": "model.sdna_project.inegi_2pbi", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/inegi_2pbi.sql", "original_file_path": "models/sdna_mx/transformations/inegi_2pbi.sql", "name": "inegi_2pbi", "resource_type": "model", "alias": "inegi_2pbi", "checksum": {"name": "sha256", "checksum": "150e2b8d013abaf8f2826e55b8352e2f5c9497dd1ff0c6ef4c03cc8ef615430d"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["inegi_2pbi_stg"], ["nse"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.inegi_2pbi_stg", "model.sdna_project.nse"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mapping_id_cliente_dataplor_all": {"raw_sql": "select\n    stores.id_cliente,\n    stores.lat,\n    stores.long,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('stg_mx_store_coordinates') }} stores\njoin {{ ref('stg_dataplor_coordinates') }} dc --+ convert store long, lat to a geo point. use st_dwithin to identify all dataplor ids (aka poi's) within a boundary of 1000 m\nwhere st_dwithin(stores.coords, dc.coords, 1000) --+surrounding the point (1000 m ~  .6 mi)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mapping_id_cliente_dataplor_all"], "unique_id": "model.sdna_project.mapping_id_cliente_dataplor_all", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mapping_id_cliente_dataplor_all.sql", "original_file_path": "models/sdna_mx/transformations/mapping_id_cliente_dataplor_all.sql", "name": "mapping_id_cliente_dataplor_all", "resource_type": "model", "alias": "mapping_id_cliente_dataplor_all", "checksum": {"name": "sha256", "checksum": "b891495d426e24fa1386d4e93daa21a00c9b5e23a80b726b34167328b3165cf7"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["stg_mx_store_coordinates"], ["stg_dataplor_coordinates"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.stg_mx_store_coordinates", "model.sdna_project.stg_dataplor_coordinates"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mapping_id_cliente_quadkey_all": {"raw_sql": "with dedupe_geo as (\n    select distinct\n        geography, --+ there is no quadkey mapping file with each unique quadkey, so we must make one\n        trunc(split_part(array_to_string(bounds,','),',',1),7) as long_left_unit,  --+ convert bounds into new columns\n        trunc(split_part(array_to_string(bounds,','),',',2),7) as lat_bottom_unit, --+ left/bottom/right/top coordinate\n        trunc(split_part(array_to_string(bounds,','),',',3),7) as long_right_unit,\n        trunc(split_part(array_to_string(bounds,','),',',4),7) as lat_top_unit\n    from dp_data_share_aws_to_az_replica.mapbox.mapbox_v0_2_daily_quadkey_total\n    where country = 'MX'\n),\nx as ( --+ convert boundary coordinates to polygon, then to geography\n    select\n        geography,\n        to_geography(\n            'polygon(('     ||  --+ polygon format requires identifying perimeter coordinates\n            long_left_unit  || ' ' || lat_bottom_unit || ', ' ||  --+ the order matters and you first/last cooridates must be\n            long_left_unit  || ' ' || lat_top_unit    || ', ' ||  --+ identical to complete the polygon shape\n            long_right_unit || ' ' || lat_top_unit    || ', ' ||  --+ note: it's faster to combine the points as string and then convert to geography type\n            long_right_unit || ' ' || lat_bottom_unit || ', ' ||  --+ than to convert the points to geography type then combine in a collect statement\n            long_left_unit  || ' ' || lat_bottom_unit ||'))'\n        ) as coords\n    from dedupe_geo\n)\nselect\n    id_cliente,\n    lat,\n    long,\n    geography,\n    coords,\n    count(distinct geography) over (partition by id_cliente) as count_quad_keys,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mx_stores') }}\njoin x --+ convert store long, lat to a geo point. use st_dwithin to identify all quadkeys (aka geographies) within a boundary of 160 m\nwhere st_dwithin(to_geography(st_makepoint(long, lat)), coords, 160) --+surrounding the point (160 m ~ .01 mi)\n-- filters out invalid lat / long values\nand lat between -90 and 90\nand long between -180 and 180", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mapping_id_cliente_quadkey_all"], "unique_id": "model.sdna_project.mapping_id_cliente_quadkey_all", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mapping_id_cliente_quadkey_all.sql", "original_file_path": "models/sdna_mx/transformations/mapping_id_cliente_quadkey_all.sql", "name": "mapping_id_cliente_quadkey_all", "resource_type": "model", "alias": "mapping_id_cliente_quadkey_all", "checksum": {"name": "sha256", "checksum": "2b1331bb2e29bc969b286396b6e073daa6ea18b73273d27c2c979b62c5f43f5e"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_stores"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_products": {"raw_sql": "select distinct\n    a13.id_producto,\n    a13.des_producto,\n    a13.id_marca,\n    a13.des_marca,\n    a13.id_submarca,\n    a13.des_submarca,\n    a13.id_segmento,\n    a13.des_segmento,\n    a13.id_unidnegocio,\n    a13.des_unidnegocio,\n    a13.id_tamano,\n    a13.des_tamano,\n    a13.id_categoria id_categoria,\n    a16.des_categoria des_categoria,\n    current_timestamp() last_updt_dt\nfrom {{ ref('dls_latam_ins_vtaclipro_sem_v') }} a11\njoin {{ ref('dls_latam_ins_producto') }} a13\n    on (a11.id_producto = a13.id_producto)\njoin {{ ref('dls_latam_ins_categoria') }} a16\n    on (a13.id_categoria = a16.id_categoria)", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_products"], "unique_id": "model.sdna_project.mx_products", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_products.sql", "original_file_path": "models/sdna_mx/transformations/mx_products.sql", "name": "mx_products", "resource_type": "model", "alias": "mx_products", "checksum": {"name": "sha256", "checksum": "e84895b23acdbd2ee59a93e1c5866e059a82efadf421c269b727bfb80c155697"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dls_latam_ins_vtaclipro_sem_v"], ["dls_latam_ins_producto"], ["dls_latam_ins_categoria"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dls_latam_ins_vtaclipro_sem_v", "model.sdna_project.dls_latam_ins_producto", "model.sdna_project.dls_latam_ins_categoria"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_current_and_last_year": {"raw_sql": "with cr as (\n    select\n        a.id_cliente,\n        a.id_producto,\n        b.des_ano,\n        sum(a.pesos) as pesos_current_year,\n        sum(a.unidad) as unidad_current_year\n    from {{ ref('mx_sales_wk') }} a\n        left join {{ ref('dls_latam_ins_semana') }} b\n            on a.id_semana = b.id_semana\n    where b.des_ano = year(current_timestamp(3))\n    group by\n        a.id_cliente,\n        a.id_producto,\n        b.des_ano\n),\nlt as (\n    select\n        a.id_cliente,\n        a.id_producto,\n        b.des_ano,\n        sum(a.pesos) as pesos_last_year,\n        sum(a.unidad) as unidad_last_year\n    from {{ ref('mx_sales_wk') }} a\n    left join {{ ref('dls_latam_ins_semana') }} b\n        on a.id_semana = b.id_semana\n    where b.des_ano = year(current_timestamp(3)) - 1\n    group by\n        a.id_cliente,\n        a.id_producto,\n        b.des_ano\n)\nselect\n    cr.id_cliente,\n    cr.id_producto,\n    cr.pesos_current_year as pesos_current_year,\n    cr.unidad_current_year as unidad_current_year,\n    lt.pesos_last_year as pesos_last_year,\n    lt.unidad_last_year as unidad_last_year,\n    current_timestamp() as last_updt_dt\nfrom cr\nleft join lt\n    on cr.id_cliente = lt.id_cliente\n    and cr.id_producto = lt.id_producto", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_current_and_last_year"], "unique_id": "model.sdna_project.mx_sales_current_and_last_year", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_current_and_last_year.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_current_and_last_year.sql", "name": "mx_sales_current_and_last_year", "resource_type": "model", "alias": "mx_sales_current_and_last_year", "checksum": {"name": "sha256", "checksum": "066c2a062680a393545366413cb699b4a8fb50f4c61bb060b924437970830324"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_sales_wk"], ["dls_latam_ins_semana"], ["mx_sales_wk"], ["dls_latam_ins_semana"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_sales_wk", "model.sdna_project.dls_latam_ins_semana", "model.sdna_project.mx_sales_wk", "model.sdna_project.dls_latam_ins_semana"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_des_trimestre": {"raw_sql": "select\n    a.id_cliente,\n    a.id_producto,\n    b.des_trimestre,\n    sum(a.pesos) as pesos_ptri,\n    sum(a.unidad) as unidad_ptri,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mx_sales_wk') }} a\nleft join {{ ref('dls_latam_ins_semana') }} b\n    on a.id_semana = b.id_semana\ngroup by\n    a.id_cliente,\n    a.id_producto,\n    b.des_trimestre", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_des_trimestre"], "unique_id": "model.sdna_project.mx_sales_des_trimestre", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_des_trimestre.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_des_trimestre.sql", "name": "mx_sales_des_trimestre", "resource_type": "model", "alias": "mx_sales_des_trimestre", "checksum": {"name": "sha256", "checksum": "b3d738fa6a1368dc52647c37fd8b159fcc25734b417e44a98fcd1debb1c7b209"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_sales_wk"], ["dls_latam_ins_semana"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_sales_wk", "model.sdna_project.dls_latam_ins_semana"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_l26_wk": {"raw_sql": "select\n    id_cliente,\n    id_producto,\n    sum(pesos) as pesos_l26w_cy,\n    sum(unidad) as unidad_l26w_cy,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mx_sales_wk') }}\nwhere id_semana >= to_number(concat_ws('', to_varchar(dateadd(week, - 26, current_timestamp()), 'YYYYMM'), cast(round((day( current_timestamp() ) + 6) / 7, 0) as varchar) ), 38, 0)\ngroup by\n    id_cliente,\n    id_producto\norder by\n    id_cliente", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_l26_wk"], "unique_id": "model.sdna_project.mx_sales_l26_wk", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_l26_wk.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_l26_wk.sql", "name": "mx_sales_l26_wk", "resource_type": "model", "alias": "mx_sales_l26_wk", "checksum": {"name": "sha256", "checksum": "a6c45987e7fe5b7cd41046f3a34dfe620cb8dbf366836cad6d1822aec1e26831"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_sales_wk"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_sales_wk"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_l52_wk": {"raw_sql": "select\n    id_cliente,\n    id_producto,\n    sum(pesos) as pesos_l52w_cy,\n    sum(unidad) as unidad_l52w_cy,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mx_sales_wk') }}\nwhere id_semana >= to_number(concat_ws('', to_varchar(dateadd(week, - 52, current_timestamp()), 'YYYYMM'), cast(round((day( current_timestamp() ) + 6) / 7, 0) as varchar) ), 38, 0)\ngroup by\n    id_cliente,\n    id_producto\norder by\n    id_cliente", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_l52_wk"], "unique_id": "model.sdna_project.mx_sales_l52_wk", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_l52_wk.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_l52_wk.sql", "name": "mx_sales_l52_wk", "resource_type": "model", "alias": "mx_sales_l52_wk", "checksum": {"name": "sha256", "checksum": "27c79e75b300038f4ed45c8ffe9d4341c95eb2ebee6eff52025b10ff291632af"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_sales_wk"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_sales_wk"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_periodo": {"raw_sql": "select\n    a.id_cliente,\n    a.id_producto,\n    b.id_periodo,\n    sum(a.pesos) as pesos_pp,\n    sum(a.unidad) as unidad_pp\nfrom {{ ref('mx_sales_wk') }} a\nleft join {{ ref('dls_latam_ins_semana') }} b\n    on a.id_semana = b.id_semana\ngroup by\n    a.id_cliente,\n    a.id_producto,\n    b.id_periodo", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_periodo"], "unique_id": "model.sdna_project.mx_sales_periodo", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_periodo.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_periodo.sql", "name": "mx_sales_periodo", "resource_type": "model", "alias": "mx_sales_periodo", "checksum": {"name": "sha256", "checksum": "4d36a985b45f757a3ed2c77f8c81ff2d675e6c4b464764d95828e311997d1325"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_sales_wk"], ["dls_latam_ins_semana"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_sales_wk", "model.sdna_project.dls_latam_ins_semana"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_sales_wk": {"raw_sql": "select \n    a11.id_cliente id_cliente,\n    a13.id_producto,\n    a11.id_semana id_semana,\n    a15.des_semana des_semana,\n    sum(a11.venta_capt_uni) unidad,\n    sum(a11.venta_capt_pes) pesos,\n    current_timestamp() last_updt_dt\nfrom {{ ref('dls_latam_ins_vtaclipro_sem_v') }} a11\njoin {{ ref('dls_latam_ins_producto') }} a13\n    on (a11.id_producto = a13.id_producto)\njoin {{ ref('dls_latam_ins_semana') }} a15\n    on (a11.id_semana = a15.id_semana)\ngroup by\n    a11.id_cliente,\n    a13.id_producto,\n    a11.id_semana,\n    a15.des_semana", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_sales_wk"], "unique_id": "model.sdna_project.mx_sales_wk", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_sales_wk.sql", "original_file_path": "models/sdna_mx/transformations/mx_sales_wk.sql", "name": "mx_sales_wk", "resource_type": "model", "alias": "mx_sales_wk", "checksum": {"name": "sha256", "checksum": "81e00a904d76c678e3b3dd161f4e0f83617bed3ff4bbd81b1f6b1979d21406ef"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dls_latam_ins_vtaclipro_sem_v"], ["dls_latam_ins_producto"], ["dls_latam_ins_semana"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dls_latam_ins_vtaclipro_sem_v", "model.sdna_project.dls_latam_ins_producto", "model.sdna_project.dls_latam_ins_semana"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.mx_stores": {"raw_sql": "select distinct\n    id_cliente,\n    des_cliente,\n    direccion,\n    des_municipio,\n    des_edo,\n    des_cp,\n    lat,\n    long,\n    idcia_ruta,\n    des_cia_ruta,\n    id_zona,\n    des_zona,\n    id_division,\n    division,\n    id_sucursal,\n    sucursal,\n    id_tiporuta,\n    des_tiporuta,\n    tru_clave,\n    id_ruta,\n    ruta,\n    id_ruta_corp,\n    id_cli_corp,\n    id_tipocliente,\n    tipocliente,\n    id_nivelcliente,\n    des_nivelcliente,\n    case\n        when trim(des_cliente) like  ('%LA COMER%')\n            or trim(des_cliente) like ('%SORIANA%')\n            or trim(des_cliente) like ('%COMERCIAL MEXICANA%')\n            or trim(des_cliente) like ('%WALMART%')\n            or trim(des_cliente) like ('%SAMS CLUB%')\n            or trim(des_cliente) like ('%COSTCO%')\n            or trim(des_cliente) like ('%EL ZORRO%')\n            or trim(des_cliente) like ('%SUPERAMA%')\n            or trim(des_cliente) like ('%CHEDRAUI%')\n            or trim(des_cliente) like ('%BODEGA AURRERA EXPRESS%')\n        then 'LF'\n        when trim(des_cliente) like ('%BAE%')\n            and trim(des_cliente) not like ('%BAEZ%')\n            and trim(des_cliente) not like ('%BAEZA%')\n        then 'LF'\n        else 'SF'\n    end as format,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mx_stores_stg') }}\n-- these are the bounding coordinates for MX. Anything else is invalid.\nwhere lat between 14.5 and 32.8\nand long between -117.2 and -86.7", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mx_stores"], "unique_id": "model.sdna_project.mx_stores", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mx_stores.sql", "original_file_path": "models/sdna_mx/transformations/mx_stores.sql", "name": "mx_stores", "resource_type": "model", "alias": "mx_stores", "checksum": {"name": "sha256", "checksum": "ccc34322a7fbda4e173ee122602a06cdc9e20119bc25766d2b732595fdd5a845"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mx_stores_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mx_stores_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.nse": {"raw_sql": "with x as (\n    select distinct\n        lpad(ent, 2, 0) as ent,\n        entidad,\n        a_b,\n        c_plus,\n        c,\n        c_minus,\n        d_plus,\n        d,\n        e\n    from {{ ref('nse_stg') }}\n)\nselect distinct\n    *,\n    current_timestamp() as last_updt_dt\nfrom x", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "nse"], "unique_id": "model.sdna_project.nse", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/nse.sql", "original_file_path": "models/sdna_mx/transformations/nse.sql", "name": "nse", "resource_type": "model", "alias": "nse", "checksum": {"name": "sha256", "checksum": "e579291e37c6e5c30b387ca8c34aebc6f4189ede934afa2e46100602f74e4533"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["nse_stg"]], "sources": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": ["model.sdna_project.nse_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/transformations/nse.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}, "compiled_sql": "with x as (\n    select distinct\n        lpad(ent, 2, 0) as ent,\n        entidad,\n        a_b,\n        c_plus,\n        c,\n        c_minus,\n        d_plus,\n        d,\n        e\n    from DP_SDNA_MX.SDNA_MX_DEV.nse_stg\n)\nselect distinct\n    *,\n    current_timestamp() as last_updt_dt\nfrom x", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.nse"}, "model.sdna_project.store_mobility": {"raw_sql": "with id_cliente_daily_ttl as (\n    select\n        x.id_cliente as id_cliente,\n        a.agg_day_period as agg_day_period,\n        sum(nvl(a.activity_index_total, 0)) as sum_daily_activity_ttl,\n        (\n            sum(\n                case\n                    when agg_day_period < '2020-04-01'\n                    then nvl(sum(nvl(a.activity_index_total, 0)), 0)\n                end\n            ) over (partition by x.id_cliente) / 91\n        ) as avg_daily_activity_q1\n    from {{ ref('mapping_id_cliente_quadkey_all') }} x\n    join dp_data_share_aws_to_az_replica.mapbox.mapbox_v0_2_daily_quadkey_total a\n        on x.geography = a.geography\n    where a.country = 'MX'\n    group by\n        x.id_cliente,\n        a.agg_day_period\n),\nsummary as (\n    select\n        id_cliente,\n        trunc(agg_day_period, 'MM') as month_year,\n        avg(nvl(sum_daily_activity_ttl, 0)) as avg_daily_activity_ttl,\n        avg_daily_activity_q1\n    from id_cliente_daily_ttl\n    group by\n        id_cliente,\n        trunc(agg_day_period, 'MM'),\n        avg_daily_activity_q1\n)\nselect\n    id_cliente,\n    month_year,\n    avg_daily_activity_ttl,\n    nvl(avg_daily_activity_q1, 0) as avg_daily_activity_q1,\n    nvl((nvl(avg_daily_activity_ttl, 0) / avg_daily_activity_q1), 0) as ttl_activity_q1_index\nfrom summary", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "store_mobility"], "unique_id": "model.sdna_project.store_mobility", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/store_mobility.sql", "original_file_path": "models/sdna_mx/transformations/store_mobility.sql", "name": "store_mobility", "resource_type": "model", "alias": "store_mobility", "checksum": {"name": "sha256", "checksum": "94865c3bdd94cb98c766feb7c5afb9971c3d62b4ad37bb4f7dc2e587b0dad755"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mapping_id_cliente_quadkey_all"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mapping_id_cliente_quadkey_all"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.store_poi_counts": {"raw_sql": "select \n    a.id_cliente,\n    b.business_category,\n    count(distinct a.dataplor_id) as count_poi,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('mapping_id_cliente_dataplor_all') }} a\njoin {{ ref('dataplor') }} b\n    on a.dataplor_id = b.dataplor_id\ngroup by\n    a.id_cliente,\n    b.business_category\norder by \n    a.id_cliente", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "store_poi_counts"], "unique_id": "model.sdna_project.store_poi_counts", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/store_poi_counts.sql", "original_file_path": "models/sdna_mx/transformations/store_poi_counts.sql", "name": "store_poi_counts", "resource_type": "model", "alias": "store_poi_counts", "checksum": {"name": "sha256", "checksum": "e5752c9bd4d84c0bba39096bf494d1f29ea737e326fdc923daa35dd4e69b670d"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mapping_id_cliente_dataplor_all"], ["dataplor"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mapping_id_cliente_dataplor_all", "model.sdna_project.dataplor"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.tradearea": {"raw_sql": "select\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_df_lf') }}\nunion all\nselect\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_df_sf') }}\nunion all\nselect\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_r_lf') }}\nunion all\nselect\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_r_sf') }}\nunion all\nselect\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_u_lf') }}\nunion all\nselect\n    *,\n    current_timestamp() as last_updt_dt\nfrom {{ ref('tradearea_u_sf') }}", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "tradearea"], "unique_id": "model.sdna_project.tradearea", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/tradearea.sql", "original_file_path": "models/sdna_mx/transformations/tradearea.sql", "name": "tradearea", "resource_type": "model", "alias": "tradearea", "checksum": {"name": "sha256", "checksum": "ea771d338d47a58684da8951eea24c4484caab8b07160c2c65c1bbd890c7e9a3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["tradearea_df_lf"], ["tradearea_df_sf"], ["tradearea_r_lf"], ["tradearea_r_sf"], ["tradearea_u_lf"], ["tradearea_u_sf"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.tradearea_df_lf", "model.sdna_project.tradearea_df_sf", "model.sdna_project.tradearea_r_lf", "model.sdna_project.tradearea_r_sf", "model.sdna_project.tradearea_u_lf", "model.sdna_project.tradearea_u_sf"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.urbanicity": {"raw_sql": "with x as( \n    select distinct\n        lpad(clave_de_entidad, 2, 0) as clave_de_entidad,\n        lpad(clave_de_municipio, 3, 0) as clave_de_municipio,\n        lpad(clave_de_localidad, 4, 0) as clave_de_localidad,\n        nombre_de_localidad,\n        ambito\n    from {{ ref('urbanicity_stg') }}\n)\nselect distinct\n    clave_de_entidad,\n    clave_de_municipio,\n    clave_de_localidad,\n    concat(clave_de_entidad, clave_de_municipio, clave_de_localidad) as localidad_codigo,\n    nombre_de_localidad,\n    ambito,\n    current_timestamp() as last_updt_dt\nfrom x", "compiled": true, "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "urbanicity"], "unique_id": "model.sdna_project.urbanicity", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/urbanicity.sql", "original_file_path": "models/sdna_mx/transformations/urbanicity.sql", "name": "urbanicity", "resource_type": "model", "alias": "urbanicity", "checksum": {"name": "sha256", "checksum": "225ea5a10c4912c664893bacd70325c874043f49de4f2afa8083880b08b3b8ea"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["urbanicity_stg"]], "sources": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": ["model.sdna_project.urbanicity_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "/opt/airflow/dags/dbt/dbt/target/run/sdna_project/models/sdna_mx/transformations/urbanicity.sql", "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}, "compiled_sql": "with x as( \n    select distinct\n        lpad(clave_de_entidad, 2, 0) as clave_de_entidad,\n        lpad(clave_de_municipio, 3, 0) as clave_de_municipio,\n        lpad(clave_de_localidad, 4, 0) as clave_de_localidad,\n        nombre_de_localidad,\n        ambito\n    from DP_SDNA_MX.SDNA_MX_DEV.urbanicity_stg\n)\nselect distinct\n    clave_de_entidad,\n    clave_de_municipio,\n    clave_de_localidad,\n    concat(clave_de_entidad, clave_de_municipio, clave_de_localidad) as localidad_codigo,\n    nombre_de_localidad,\n    ambito,\n    current_timestamp() as last_updt_dt\nfrom x", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "DP_SDNA_MX.SDNA_MX_DEV.urbanicity"}, "model.sdna_project.mobility_adm1_mx": {"raw_sql": "{{ config(materialized='table') }}\n\nwith mobility_data_cte as\n(\n    select * from {{ ref('stg_mobility_data') }}\n),\n\nlookup_cte as\n(\n    select * from {{ ref('stg_lookup') }}\n),\n\nfinal as\n(\n    select\n        mdc.geo_code,\n        lc.state,\n        lc.centroid,\n        mdc.agg_day,\n        mdc.activity_index_total\n    from mobility_data_cte mdc\n\n    left join lookup_cte lc on mdc.geo_code = lc.geo_code\n)\n\nselect * from final", "database": "DP_SDNA_MX", "schema": "SDNA_MX_DEV", "fqn": ["sdna_project", "sdna_mx", "transformations", "mobility", "mobility_adm1_mx"], "unique_id": "model.sdna_project.mobility_adm1_mx", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_mx/transformations/mobility/mobility_adm1_mx.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility_adm1_mx.sql", "name": "mobility_adm1_mx", "resource_type": "model", "alias": "mobility_adm1_mx", "checksum": {"name": "sha256", "checksum": "da61c83b19887c1882e4be4cc445c823cd0da238ac8a1bb3cd454c5f1c514557"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "SDNA_MX_DEV", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["stg_mobility_data"], ["stg_lookup"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.stg_mobility_data", "model.sdna_project.stg_lookup"]}, "description": "", "columns": {"geo_code": {"name": "geo_code", "description": "Foreign key -- lookup table", "meta": {}, "data_type": null, "quote": null, "tags": []}, "activity_index_total": {"name": "activity_index_total", "description": "Total activity index for each geo block", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/sdna_mx/transformations/mobility/mobility.yml", "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_SDNA_MX_L {% elif target.name == 'stage' %} USE WAREHOUSE DP_SDNA_MX_M {% elif target.name == 'prod' %} USE WAREHOUSE DP_SDNA_MX_L {% endif %}", "materialized": "table", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('DBT_CONTEXT')|upper }}", "transient": false}}, "model.sdna_project.dx_fl_sales_cust_wk_prod": {"raw_sql": "--load dx_fl_sales_cust_wk_prod\n\n-- {{ ref('btg_fl_sales_cust_wk_prod_v') }}\n-- {{ ref('dx_msa_xref') }}\n\nSELECT\n\txref.dx_id\n\t,flslscustwkv.prod_upc\n\t,flslscustwkv.prod_slbl\n\t,flslscustwkv.fscl_wk_end_dte\n\t,flslscustwkv.fscl_yr_num\n\t,flslscustwkv.fscl_pd_num\n\t,flslscustwkv.fscl_wk_in_pd_num\n\t,sum(flslscustwkv.tkt_sale_amt) AS tkt_sale_amt\n\t,sum(flslscustwkv.tkt_sale_qty) AS tkt_sale_qty\n\t,sum(flslscustwkv.tkt_sale_wt) AS tkt_sale_wt\n\t,sum(flslscustwkv.gross_tkt_sale_amt) AS gross_tkt_sale_amt\n\t,sum(flslscustwkv.gross_tkt_sale_qty) AS gross_tkt_sale_qty\n\t,sum(flslscustwkv.gross_tkt_sale_wt) AS gross_tkt_sale_wt\n\t,sum(flslscustwkv.net_tkt_sale_amt) AS net_tkt_sale_amt\n\t,sum(flslscustwkv.net_tkt_sale_qty) AS net_tkt_sale_qty\n\t,sum(flslscustwkv.net_tkt_sale_wt) AS net_tkt_sale_wt\nFROM\n\t{{ ref('btg_fl_sales_cust_wk_prod_v') }} flslscustwkv\nINNER JOIN\n    (\n        SELECT DISTINCT dx_id, fl_msa_id\n        FROM {{ ref('dx_msa_xref') }}\n    ) xref -- Include distinct stores that are present in the xref  table only.\nON flslscustwkv.msa_id = xref.fl_msa_id\nGROUP BY\n\txref.dx_id\n\t,flslscustwkv.prod_upc\n\t,flslscustwkv.prod_slbl\n\t,flslscustwkv.fscl_wk_end_dte\n\t,flslscustwkv.fscl_yr_num\n\t,flslscustwkv.fscl_pd_num\n\t,flslscustwkv.fscl_wk_in_pd_num", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "geoscape", "dx_fl_sales_cust_wk_prod"], "unique_id": "model.sdna_project.dx_fl_sales_cust_wk_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/geoscape/dx_fl_sales_cust_wk_prod.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/geoscape/dx_fl_sales_cust_wk_prod.sql", "name": "dx_fl_sales_cust_wk_prod", "resource_type": "model", "alias": "dx_fl_sales_cust_wk_prod", "checksum": {"name": "sha256", "checksum": "e4c5236517e77626c88c0c72d336cf9ed07be62a1358610de34f9474352f7681"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_wk_prod_v"], ["dx_msa_xref"], ["btg_fl_sales_cust_wk_prod_v"], ["dx_msa_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_msa_xref_der": {"raw_sql": "-- load dx_msa_xref_der\n\n-- {{ ref('dx_msa_xref') }}\n\nWITH\nxref_min_index AS\n(\n    SELECT\n        MIN(file_index) AS min_index\n    FROM {{ ref('dx_msa_xref') }}\n    GROUP BY dx_id\n)\nSELECT\n    xref.file_index,\n    xref.dx_id AS dx_id,\n    xref.fl_msa_id AS fl_msa_id,\n    xref.pbc_msa_id AS pbc_msa_id,\n    CASE\n        WHEN fl_msa_id IS NOT NULL OR ltrim(rtrim(fl_msa_id)) != '' THEN 'FL'\n        ELSE 'PBC'\n    END AS dx_id_src\nFROM {{ ref('dx_msa_xref') }} xref\nINNER JOIN xref_min_index ON xref.file_index = xref_min_index.min_index", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "geoscape", "dx_msa_xref_der"], "unique_id": "model.sdna_project.dx_msa_xref_der", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/geoscape/dx_msa_xref_der.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/geoscape/dx_msa_xref_der.sql", "name": "dx_msa_xref_der", "resource_type": "model", "alias": "dx_msa_xref_der", "checksum": {"name": "sha256", "checksum": "76c1cd03a2343f1dfe617fa6d04b92f9448feac0264195c998ec26d691d7a9e0"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_msa_xref"], ["dx_msa_xref"], ["dx_msa_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_pbc_sales_cust_wk_prod": {"raw_sql": "--load dx_pbc_sales_cust_wk_prod\n\n-- {{ ref('btg_pbc_sales_cust_wk_prod_v') }}\n-- {{ ref('dx_msa_xref') }}\n\nSELECT\n    xref.dx_id\n    ,pbslscustwkv.inven_id\n    ,pbslscustwkv.fscl_wk_end_dte\n    ,pbslscustwkv.fscl_yr_num\n    ,pbslscustwkv.fscl_pd_num\n    ,pbslscustwkv.fscl_wk_in_pd_num\n    ,sum(pbslscustwkv.dely_lne_qty) AS dely_lne_qty\n    ,sum(pbslscustwkv.raw_vol) AS raw_vol\n    ,sum(pbslscustwkv.eght_oz_vol) AS eght_oz_vol\n    ,sum(pbslscustwkv.net_rev) AS net_rev\nFROM\n    {{ ref('btg_pbc_sales_cust_wk_prod_v') }} pbslscustwkv\nINNER JOIN\n    (\n        SELECT DISTINCT dx_id, pbc_msa_id\n        FROM {{ ref('dx_msa_xref') }}\n    ) xref\nON pbslscustwkv.msa_id = xref.pbc_msa_id\nGROUP BY\n     xref.dx_id\n    ,pbslscustwkv.inven_id\n    ,pbslscustwkv.fscl_wk_end_dte\n    ,pbslscustwkv.fscl_yr_num\n    ,pbslscustwkv.fscl_pd_num\n    ,pbslscustwkv.fscl_wk_in_pd_num", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "geoscape", "dx_pbc_sales_cust_wk_prod"], "unique_id": "model.sdna_project.dx_pbc_sales_cust_wk_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/geoscape/dx_pbc_sales_cust_wk_prod.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/geoscape/dx_pbc_sales_cust_wk_prod.sql", "name": "dx_pbc_sales_cust_wk_prod", "resource_type": "model", "alias": "dx_pbc_sales_cust_wk_prod", "checksum": {"name": "sha256", "checksum": "7a1ed6868c117d5a05587f075922a07c7f688dd0dc92d80096999338e9f0693c"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_wk_prod_v"], ["dx_msa_xref"], ["btg_pbc_sales_cust_wk_prod_v"], ["dx_msa_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_temp": {"raw_sql": "-- Load exp_geo_temp\n\n-- {{ ref('experian_cv_stg') }}\n-- {{ ref('geo_retailer_zip9_zip5_chain_count') }}\n\nSELECT\n    cv_living_unit_id,\n\tcv_zipcode_5,\n\tcv_zipcode_9,\n\tzip9 AS geo_zipcode,\n\tkroger_banner AS geo_kroger_banner,\n\tall_other_kroger AS geo_all_other_kroger,\n\talbertsons_safeway AS geo_albertsons_safeway,\n\tpublix AS geo_publix,\n\tahold_delhaize AS geo_ahold_delhaize,\n\twakefern AS geo_wakefern,\n\thy_vee AS geo_hy_vee,\n\theb AS geo_heb,\n\twhole_foods AS geo_whole_foods,\n\taldi AS geo_aldi,\n\ttrader_joes AS geo_trader_joes,\n\tbi_lo AS geo_bi_lo,\n\tall_other_grocery AS geo_all_other_grocery,\n\tcvs AS geo_cvs,\n\twalgreens AS geo_walgreens,\n\tall_other_drug AS geo_all_other_drug,\n\ttarget AS geo_target,\n\twm_neighborhood_market AS geo_wm_neighborhood_market,\n\tall_other_walmart AS geo_all_other_walmart,\n\tall_other_mass AS geo_all_other_mass,\n\tcostco AS geo_costco,\n\tbjs AS geo_bjs,\n\tsams_club AS geo_sams_club,\n\tall_other_club AS geo_all_other_club,\n\ttotal_c_and_g AS geo_total_c_and_g,\n\t_7_eleven AS geo_7_eleven,\n\tcircle_k AS geo_circle_k,\n\tspeedway AS geo_speedway,\n\tall_other_c_and_g AS geo_all_other_c_and_g,\n\tdollar_general AS geo_dollar_general,\n\tfamily_dollar AS geo_family_dollar,\n\tall_other_dollar AS geo_all_other_dollar,\n\tamazon_com AS geo_amazon_com,\n\twalmart_com AS geo_walmart_com,\n\tall_other_ao AS geo_all_other_ao,\n\tnot_assigned AS geo_not_assigned\nFROM {{ ref('experian_cv_stg') }} AS exp\nLEFT OUTER JOIN {{ ref('geo_retailer_zip9_zip5_chain_count') }} AS geo ON TRIM(exp.cv_zipcode_9) = TRIM(geo.zip9)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "geoscape", "exp_geo_temp"], "unique_id": "model.sdna_project.exp_geo_temp", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/geoscape/exp_geo_temp.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/geoscape/exp_geo_temp.sql", "name": "exp_geo_temp", "resource_type": "model", "alias": "exp_geo_temp", "checksum": {"name": "sha256", "checksum": "ea212efbee7b8d99558cf9e0fd32e7342dd46b28bdf066ee1dbe1ba9ad73286c"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["experian_cv_stg"], ["geo_retailer_zip9_zip5_chain_count"], ["experian_cv_stg"], ["geo_retailer_zip9_zip5_chain_count"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.experian_cv_stg", "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.experian_cv_stg", "model.sdna_project.geo_retailer_zip9_zip5_chain_count"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_retailer_stg_temp": {"raw_sql": "-- Load geo_retailer_stg_temp\n\n-- {{ ref('dx_store_attr') }}\n-- {{ ref('geo_new_retailer_info') }}\n\nSELECT\n    dx_id AS dx_id,\n\tdx_id_src AS DB,\n\tbtg_store_nm AS store_name,\n\tbtg_trade_channel AS channel,\n\tCASE WHEN dx_id_src = 'FL' THEN fl_chain_lvl1_node_nm WHEN dx_id_src = 'PBC' THEN pbc_grp1_lvl_1_desc ELSE NULL END AS chain_lvl1_node_nm,\n\tCASE WHEN dx_id_src = 'FL' THEN fl_chain_lvl2_node_nm ELSE NULL END AS chain_lvl2_node_nm,\n\tCASE WHEN dx_id_src = 'FL' THEN fl_chain_lvl3_node_nm ELSE NULL END AS chain_lvl3_node_nm,\n\tCASE WHEN dx_id_src = 'FL' THEN fl_chain_lvl4_node_nm ELSE NULL END AS chain_lvl4_node_nm,\n\tCASE WHEN dx_id_src = 'FL' THEN fl_chain_lvl5_node_nm ELSE NULL END AS chain_lvl5_node_nm,\n\tfl_prmy_cust_nbr AS flna_cis_id,\n\tpbc_cust_id AS pbc_cis_id,\n\tbtg_retailer_store_nbr AS store_nbr,\n\tbtg_address AS street_addr1,\n\tNULL AS street_addr2,\n\tbtg_city AS city,\n\tbtg_county AS county,\n\tbtg_state  AS state,\n\tbtg_zip AS store_zip,\n\tNULL AS phone_nbr,\n\tlatitude AS latitude,\n\tlongitude AS longitude,\n\tbtg_retailer AS retailer,\n\tNULL AS msa_id_look_alike,\n\tNULL AS dummy_msa_flag\nFROM {{ ref('dx_store_attr') }}\n\nUNION ALL\n\nSELECT\n    dx_id,\n\tDB,\n\tstore_name,\n\tchannel,\n\tchain_lvl1_node_nm,\n\tchain_lvl2_node_nm,\n\tchain_lvl3_node_nm,\n\tchain_lvl4_node_nm,\n\tchain_lvl5_node_nm,\n\t0,\n\tcis_id,\n\tstore_nbr,\n\tstreet_addr1,\n\tstreet_addr2,\n\tcity,\n\tcounty,\n\tstate,\n\tstore_zip,\n\tphone_nbr,\n\tlatitude,\n\tlongitude,\n\tretailer,\n\tNULL,\n\tNULL\nFROM {{ ref('geo_new_retailer_info') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "geoscape", "geo_retailer_stg_temp"], "unique_id": "model.sdna_project.geo_retailer_stg_temp", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/geoscape/geo_retailer_stg_temp.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/geoscape/geo_retailer_stg_temp.sql", "name": "geo_retailer_stg_temp", "resource_type": "model", "alias": "geo_retailer_stg_temp", "checksum": {"name": "sha256", "checksum": "0784de4eca5213299fa65f4f819d2be23853d8c798e822d2e58d282bcfe51c0a"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_store_attr"], ["geo_new_retailer_info"], ["dx_store_attr"], ["geo_new_retailer_info"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_store_attr", "model.sdna_project.geo_new_retailer_info", "model.sdna_project.dx_store_attr", "model.sdna_project.geo_new_retailer_info"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_dim_temp1": {"raw_sql": "WITH mvh_retailer_dim_temp_1 AS (\n\tSELECT ROW_NUMBER () OVER (ORDER BY retailer_name) as retailer_key,\n\t       retailer_name,\n\t       NULL AS curr_prior_flag\n\tFROM (\n\t\tSELECT DISTINCT UPPER(retailer) as retailer_name\n\t\tFROM {{ ref('geo_retailer_stg') }}\n    ) ret\n)\n\nSELECT retailer_key, retailer_name, curr_prior_flag\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'WALMART.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'AMAZON.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'TARGET.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'KROGER.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'KMART.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'WALGREENS.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'SAMSCLUB.COM', 'both'\nFROM mvh_retailer_dim_temp_1\n\nUNION ALL\n\nSELECT MAX(retailer_key) + 1, 'COSTCO.COM', 'both'\nFROM mvh_retailer_dim_temp_1", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "shopperstore", "mvh_retailer_dim_temp1"], "unique_id": "model.sdna_project.mvh_retailer_dim_temp1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/shopperstore/mvh_retailer_dim_temp1.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/shopperstore/mvh_retailer_dim_temp1.sql", "name": "mvh_retailer_dim_temp1", "resource_type": "model", "alias": "mvh_retailer_dim_temp1", "checksum": {"name": "sha256", "checksum": "d0ca1ec5a9722b07976577fdf7f92024f0bfd215a044ca3b328515c542701bca"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["geo_retailer_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.geo_retailer_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_dim_temp2": {"raw_sql": "SELECT retailer_key,\n       retailer_name,\n       curr_prior_flag,\n       CASE\n            WHEN CONTAINS(lower(retailer_name), '.') THEN TRANSLATE(lower(retailer_name), '.', '_')\n            WHEN CONTAINS(lower(retailer_name), '-') THEN TRANSLATE(lower(retailer_name), '-', '_')\n            WHEN CONTAINS(lower(retailer_name), '/') THEN TRANSLATE(lower(retailer_name), '/', '_')\n            WHEN CONTAINS(lower(retailer_name), '&') THEN TRANSLATE(REGEXP_REPLACE(lower(retailer_name), '&', '_and_'), ' ', '_')\n            WHEN CONTAINS(lower(retailer_name), ' ') THEN TRANSLATE(lower(retailer_name), ' ', '_')\n            ELSE lower(retailer_name)\n       END AS key_kpi_nm\nFROM {{ ref('mvh_retailer_dim_temp1') }}\nWHERE retailer_key NOT IN (24)\n\nUNION ALL\n\nSELECT\n\tretailer_key,\n\tretailer_name,\n\tcurr_prior_flag,\n\t'wm_neighborhood_market' AS key_kpi_nm\nFROM {{ ref('mvh_retailer_dim_temp1') }}\nWHERE retailer_key in (24)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "shopperstore", "mvh_retailer_dim_temp2"], "unique_id": "model.sdna_project.mvh_retailer_dim_temp2", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/shopperstore/mvh_retailer_dim_temp2.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/shopperstore/mvh_retailer_dim_temp2.sql", "name": "mvh_retailer_dim_temp2", "resource_type": "model", "alias": "mvh_retailer_dim_temp2", "checksum": {"name": "sha256", "checksum": "64b9ec820575cc3e64fdae55de608b7a2464387f7a5b05734b0a7c8454c84578"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_retailer_dim_temp1"], ["mvh_retailer_dim_temp1"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_retailer_dim_temp1", "model.sdna_project.mvh_retailer_dim_temp1"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile_1": {"raw_sql": "{{ config(materialized='table', transient=true) }}\n\n{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_avbl_adj_7_eleven', 'is_avbl_adj_ahold_delhaize', 'is_avbl_adj_albertsons', 'is_avbl_adj_aldi', 'is_avbl_adj_amazon_com', 'is_avbl_adj_bi_lo', 'is_avbl_adj_bjs', 'is_avbl_adj_circle_k'] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} {{ column }}_cte AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n   {{ column }}_cte.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n   {{ column }}_cte{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "avbl_is_percentile_1"], "unique_id": "model.sdna_project.avbl_is_percentile_1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_1.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_1.sql", "name": "avbl_is_percentile_1", "resource_type": "model", "alias": "avbl_is_percentile_1", "checksum": {"name": "sha256", "checksum": "f94ac560cf67b76358d253f2b841c2d6ad56d99575877d6406ef0d02acf59a60"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": true, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile_2": {"raw_sql": "{{ config(materialized='table', transient=true) }}\n\n{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_avbl_adj_costco', 'is_avbl_adj_cvs', 'is_avbl_adj_dollar_general', 'is_avbl_adj_family_dollar', 'is_avbl_adj_heb', 'is_avbl_adj_speedway', 'is_avbl_adj_hy_vee', 'is_avbl_adj_kroger_banner', 'is_avbl_adj_all_other_kroger'] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} {{ column }}_cte AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n   {{ column }}_cte.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n   {{ column }}_cte{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "avbl_is_percentile_2"], "unique_id": "model.sdna_project.avbl_is_percentile_2", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_2.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_2.sql", "name": "avbl_is_percentile_2", "resource_type": "model", "alias": "avbl_is_percentile_2", "checksum": {"name": "sha256", "checksum": "36b2389ad8f4db192b43ab9144d2ce7cd1bbcc1b5a5214a9426210dfd32f6b0b"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": true, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile_3": {"raw_sql": "{{ config(materialized='table', transient=true) }}\n\n{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_avbl_adj_all_other_club', 'is_avbl_adj_all_other_dollar', 'is_avbl_adj_all_other_drug', 'is_avbl_adj_all_other_c_and_g', 'is_avbl_adj_all_other_grocery', 'is_avbl_adj_all_other_mass', 'is_avbl_adj_publix', 'is_avbl_adj_safeway', 'is_avbl_adj_sams_club'] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} {{ column }}_cte AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n   {{ column }}_cte.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n   {{ column }}_cte{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "avbl_is_percentile_3"], "unique_id": "model.sdna_project.avbl_is_percentile_3", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_3.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_3.sql", "name": "avbl_is_percentile_3", "resource_type": "model", "alias": "avbl_is_percentile_3", "checksum": {"name": "sha256", "checksum": "e8f8ca1a622b120ddc64549ce9dd254aa9e3c4441e1ed25d09cfab4bba0b5374"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": true, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile_4": {"raw_sql": "{{ config(materialized='table', transient=true) }}\n\n\n{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_avbl_adj_target', 'is_avbl_adj_trader_joes', 'is_avbl_adj_wakefern', 'is_avbl_adj_walgreens', 'is_avbl_adj_walmart_com', 'is_avbl_adj_wm_neighborhood_market', 'is_avbl_adj_all_other_walmart', 'is_avbl_adj_whole_foods'] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} {{ column }}_cte AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n   {{ column }}_cte.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n   {{ column }}_cte{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "avbl_is_percentile_4"], "unique_id": "model.sdna_project.avbl_is_percentile_4", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_4.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_4.sql", "name": "avbl_is_percentile_4", "resource_type": "model", "alias": "avbl_is_percentile_4", "checksum": {"name": "sha256", "checksum": "1aac65029e30e59945ae7c63a6f8e31be160bc5343699fd4e5673dcd24897bac"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": true, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile_5": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_avbl_adj_target_com', 'is_avbl_adj_kroger_com', 'is_avbl_adj_kmart_com', 'is_avbl_adj_walgreens_com', 'is_avbl_adj_samsclub_com', 'is_avbl_adj_costco_com'] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} {{ column }}_cte AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n   {{ column }}_cte.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n   {{ column }}_cte{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "avbl_is_percentile_5"], "unique_id": "model.sdna_project.avbl_is_percentile_5", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_5.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/avbl_is_percentile_5.sql", "name": "avbl_is_percentile_5", "resource_type": "model", "alias": "avbl_is_percentile_5", "checksum": {"name": "sha256", "checksum": "6cb981ea542e3ae04d0617936294531d1ab86f38c66affbd8a7e92991d0f4153"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_1": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_7_eleven', 'is_ahold_delhaize', 'is_albertsons', 'is_aldi', 'is_amazon_com'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_1"], "unique_id": "model.sdna_project.is_percentile_1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_1.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_1.sql", "name": "is_percentile_1", "resource_type": "model", "alias": "is_percentile_1", "checksum": {"name": "sha256", "checksum": "1d28075c38ef23b173bd2f4eb70592f13dd244de9977ab83b0c86e6f9e5d00c7"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_2": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_bi_lo', 'is_bjs', 'is_circle_k', 'is_costco', 'is_cvs'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_2"], "unique_id": "model.sdna_project.is_percentile_2", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_2.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_2.sql", "name": "is_percentile_2", "resource_type": "model", "alias": "is_percentile_2", "checksum": {"name": "sha256", "checksum": "540a0e9d721959b51aabcca3c2593af1efe56e1746b4b65cc9c0c149c1e65ecf"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_3": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_dollar_general', 'is_family_dollar', 'is_heb', 'is_speedway', 'is_hy_vee'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_3"], "unique_id": "model.sdna_project.is_percentile_3", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_3.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_3.sql", "name": "is_percentile_3", "resource_type": "model", "alias": "is_percentile_3", "checksum": {"name": "sha256", "checksum": "f540ab4a8f38fc49c209fc3489ef37b88c5eb6a8c3b10424b8967c95b33e4b95"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_4": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_kroger_banner', 'is_all_other_kroger', 'is_all_other_club', 'is_all_other_dollar', 'is_all_other_drug'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_4"], "unique_id": "model.sdna_project.is_percentile_4", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_4.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_4.sql", "name": "is_percentile_4", "resource_type": "model", "alias": "is_percentile_4", "checksum": {"name": "sha256", "checksum": "3e3fcb447a277602d53d6351bbe01762be9c8daad51d44e6b45cd53b566f5049"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_5": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_all_other_c_and_g', 'is_all_other_grocery', 'is_all_other_mass', 'is_publix', 'is_safeway'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n{%- if column == 'is_safeway' %}\n --- Set safeway percentiles to 0 default\n 0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n {%- else %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endif %}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_5"], "unique_id": "model.sdna_project.is_percentile_5", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_5.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_5.sql", "name": "is_percentile_5", "resource_type": "model", "alias": "is_percentile_5", "checksum": {"name": "sha256", "checksum": "3ccd6f59e263525926bc68c6db255b7cb2e4783ca758499e7fb730e95c959ff1"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_6": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_sams_club', 'is_target', 'is_trader_joes', 'is_wakefern', 'is_walgreens'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_6"], "unique_id": "model.sdna_project.is_percentile_6", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_6.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_6.sql", "name": "is_percentile_6", "resource_type": "model", "alias": "is_percentile_6", "checksum": {"name": "sha256", "checksum": "c197418b31dec7825788aed18eeea3ff726ae989c9d86a9016afb06cbc362cc6"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_7": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_walmart_com', 'is_wm_neighborhood_market', 'is_all_other_walmart', 'is_whole_foods'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_7"], "unique_id": "model.sdna_project.is_percentile_7", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_7.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_7.sql", "name": "is_percentile_7", "resource_type": "model", "alias": "is_percentile_7", "checksum": {"name": "sha256", "checksum": "00d16f1abc619ee5b9019e1cdff58f1ff42f3d8f1526022265f13bef2d19e092"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile_8": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{% set columns = ['is_target_com', 'is_kroger_com', 'is_kmart_com', 'is_walgreens_com', 'is_samsclub_com', 'is_costco_com'] %}\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "is_percentile_8"], "unique_id": "model.sdna_project.is_percentile_8", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/is_percentile_8.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/is_percentile_8.sql", "name": "is_percentile_8", "resource_type": "model", "alias": "is_percentile_8", "checksum": {"name": "sha256", "checksum": "0109b816f21ebdfa74c0c4a0d44af0928143cf445439225ca030784607af7abe"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp": {"raw_sql": "SELECT\n    is_avbl_adj_7_eleven,\n    is_avbl_adj_ahold_delhaize,\n    is_avbl_adj_albertsons,\n    is_avbl_adj_aldi,\n    is_avbl_adj_amazon_com,\n    is_avbl_adj_bi_lo,\n    is_avbl_adj_bjs,\n    is_avbl_adj_circle_k,\n    is_avbl_adj_costco,\n    is_avbl_adj_cvs,\n    is_avbl_adj_dollar_general,\n    is_avbl_adj_family_dollar,\n    is_avbl_adj_heb,\n    is_avbl_adj_speedway,\n    is_avbl_adj_hy_vee,\n    is_avbl_adj_kroger_banner,\n    is_avbl_adj_all_other_kroger,\n    is_avbl_adj_all_other_club,\n    is_avbl_adj_all_other_dollar,\n    is_avbl_adj_all_other_drug,\n    is_avbl_adj_all_other_c_and_g,\n    is_avbl_adj_all_other_grocery,\n    is_avbl_adj_all_other_mass,\n    is_avbl_adj_publix,\n    is_avbl_adj_sams_club,\n    is_avbl_adj_target,\n    is_avbl_adj_trader_joes,\n    is_avbl_adj_wakefern,\n    is_avbl_adj_walgreens,\n    is_avbl_adj_walmart_com,\n    is_avbl_adj_wm_neighborhood_market,\n    is_avbl_adj_all_other_walmart,\n    is_avbl_adj_whole_foods,\n    is_avbl_adj_target_com,\n    is_avbl_adj_kroger_com,\n    is_avbl_adj_kmart_com,\n    is_avbl_adj_walgreens_com,\n    is_avbl_adj_samsclub_com,\n    is_avbl_adj_costco_com\nFROM {{ ref('trifecta_is_cap_iri_adjf_avbl') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "intermediate", "mvh", "trifecta", "trifecta_is_cap_iri_adjf_avbl_tmp"], "unique_id": "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/intermediate/mvh/trifecta/trifecta_is_cap_iri_adjf_avbl_tmp.sql", "original_file_path": "models/sdna_us/household/intermediate/mvh/trifecta/trifecta_is_cap_iri_adjf_avbl_tmp.sql", "name": "trifecta_is_cap_iri_adjf_avbl_tmp", "resource_type": "model", "alias": "trifecta_is_cap_iri_adjf_avbl_tmp", "checksum": {"name": "sha256", "checksum": "7a078da671434ab550f24fe5c98d5c70e5ba65d040ea7d41ac333ea8e22472b5"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_fl_trade_chnl_lkp": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/dxh/dx_mvhs/dx_fl_trade_chnl_lkp/dx_fl_trade_chnl_lkp.txt') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "dx", "dx_fl_trade_chnl_lkp"], "unique_id": "model.sdna_project.dx_fl_trade_chnl_lkp", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/dx/dx_fl_trade_chnl_lkp.sql", "original_file_path": "models/sdna_us/household/loads/mvh/dx/dx_fl_trade_chnl_lkp.sql", "name": "dx_fl_trade_chnl_lkp", "resource_type": "model", "alias": "dx_fl_trade_chnl_lkp", "checksum": {"name": "sha256", "checksum": "4ab7ff41f25a0b0f811bc3a0a428c2bea4664ad98d83c40336f3d0f6ebc1eebd"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.dx_msa_xref": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/dxh/dx_mvhs/dx_msa_xref/dx_xref.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "dx", "dx_msa_xref"], "unique_id": "model.sdna_project.dx_msa_xref", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/dx/dx_msa_xref.sql", "original_file_path": "models/sdna_us/household/loads/mvh/dx/dx_msa_xref.sql", "name": "dx_msa_xref", "resource_type": "model", "alias": "dx_msa_xref", "checksum": {"name": "sha256", "checksum": "78de29289d071ac36a6604f41747f71f80d0d1b0a059321ddee2a94e68614923"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.dx_pbc_trade_chnl_lkp": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/dxh/dx_mvhs/dx_pbc_trade_chnl_lkp/dx_pbc_trade_chnl_lkp.txt') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "dx", "dx_pbc_trade_chnl_lkp"], "unique_id": "model.sdna_project.dx_pbc_trade_chnl_lkp", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/dx/dx_pbc_trade_chnl_lkp.sql", "original_file_path": "models/sdna_us/household/loads/mvh/dx/dx_pbc_trade_chnl_lkp.sql", "name": "dx_pbc_trade_chnl_lkp", "resource_type": "model", "alias": "dx_pbc_trade_chnl_lkp", "checksum": {"name": "sha256", "checksum": "23834205b40ff5814ad485825ade2cba9e16b1f16dc388621166b4cc46a5cf61"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.fsv_gsc_z9_drivetime": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC_PARSER',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('fsv_gsc_z9_drivetime') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/fsv/source/geoscape/dx_mvhs/fsv_gsc_z9_drivetime') }}\n)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fsv", "fsv_gsc_z9_drivetime"], "unique_id": "model.sdna_project.fsv_gsc_z9_drivetime", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fsv/fsv_gsc_z9_drivetime.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fsv/fsv_gsc_z9_drivetime.sql", "name": "fsv_gsc_z9_drivetime", "resource_type": "model", "alias": "fsv_gsc_z9_drivetime", "checksum": {"name": "sha256", "checksum": "3220efb2961191df614e31715c2f9813e9d42b0d30257373ecb207ee311a5dd1"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER", "copy_transform": true}}, "model.sdna_project.fsv_is_coeff_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/fsv/source/is/dx_mvhs/fsv_is_coeff_raw/InfoScout_Final_Model_Coefficients.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fsv", "fsv_is_coeff_raw"], "unique_id": "model.sdna_project.fsv_is_coeff_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fsv/fsv_is_coeff_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fsv/fsv_is_coeff_raw.sql", "name": "fsv_is_coeff_raw", "resource_type": "model", "alias": "fsv_is_coeff_raw", "checksum": {"name": "sha256", "checksum": "8e4efd623f5cf794ce39001d0e7f17bdc6f43f791b16420710d135f8302de0dd"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.fsv_is_means_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/fsv/source/is/dx_mvhs/fsv_is_means_raw/is_means.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fsv", "fsv_is_means_raw"], "unique_id": "model.sdna_project.fsv_is_means_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fsv/fsv_is_means_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fsv/fsv_is_means_raw.sql", "name": "fsv_is_means_raw", "resource_type": "model", "alias": "fsv_is_means_raw", "checksum": {"name": "sha256", "checksum": "b53d1de7988696cbdc8a37b7200e6b275fe90d5190f6f0f125296329838c7a71"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.fsv_stores": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/fsv/source/geoscape/dx_mvhs/fsv_stores/') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fsv", "fsv_stores"], "unique_id": "model.sdna_project.fsv_stores", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fsv/fsv_stores.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fsv/fsv_stores.sql", "name": "fsv_stores", "resource_type": "model", "alias": "fsv_stores", "checksum": {"name": "sha256", "checksum": "931bcbf7f6e36df0938c8f6490331cf84f073b292c35c13feb2cc3fd509a5d41"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}}, "model.sdna_project.fvh_cs_coeff_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/fvh/dx_mvhs/cs_coeff_raw/FVH_Linear_Model_Coefficients.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fvh", "fvh_cs_coeff_raw"], "unique_id": "model.sdna_project.fvh_cs_coeff_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fvh/fvh_cs_coeff_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fvh/fvh_cs_coeff_raw.sql", "name": "fvh_cs_coeff_raw", "resource_type": "model", "alias": "fvh_cs_coeff_raw", "checksum": {"name": "sha256", "checksum": "ab0df336c0ce9ed790be15f527b4cabe733ff70147c569fefab45b97e96cd66f"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.fvh_fs_coeff_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/fvh/dx_mvhs/fvh_fs_coeff_raw/fvh_fs_coefficient.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fvh", "fvh_fs_coeff_raw"], "unique_id": "model.sdna_project.fvh_fs_coeff_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fvh/fvh_fs_coeff_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fvh/fvh_fs_coeff_raw.sql", "name": "fvh_fs_coeff_raw", "resource_type": "model", "alias": "fvh_fs_coeff_raw", "checksum": {"name": "sha256", "checksum": "54e4675ba2b78775f9c17ab3df30658ce15e367c5d32ac399e688e976b955015"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.fvh_life_stage_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/fvh/dx_mvhs/fvh_life_stage_raw/life_stage_table.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fvh", "fvh_life_stage_raw"], "unique_id": "model.sdna_project.fvh_life_stage_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fvh/fvh_life_stage_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fvh/fvh_life_stage_raw.sql", "name": "fvh_life_stage_raw", "resource_type": "model", "alias": "fvh_life_stage_raw", "checksum": {"name": "sha256", "checksum": "2591ed368d5ab1dd6327a549ccf13aab67635a1dec102e683872835a9179da3d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.fvh_t_test_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/fvh/dx_mvhs/fvh_t_test_raw/fvh_fs_prob_lkup.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "fvh", "fvh_t_test_raw"], "unique_id": "model.sdna_project.fvh_t_test_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/fvh/fvh_t_test_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/fvh/fvh_t_test_raw.sql", "name": "fvh_t_test_raw", "resource_type": "model", "alias": "fvh_t_test_raw", "checksum": {"name": "sha256", "checksum": "f8cec337d187b8202b77f7935b1a0d0c5ea42d64338435e2c4f1b49ffea56eb3"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.cbsa_list": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/custom_grouping/dx_mvhs/cbsa_list/cbsa_list_Experian_V7.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "gc", "cbsa_list"], "unique_id": "model.sdna_project.cbsa_list", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/gc/cbsa_list.sql", "original_file_path": "models/sdna_us/household/loads/mvh/gc/cbsa_list.sql", "name": "cbsa_list", "resource_type": "model", "alias": "cbsa_list", "checksum": {"name": "sha256", "checksum": "b204259505a3516a6d6aba4d6797b343f74d9bb2c5ff6263fc1384ec6520dea2"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.gsc_msa_z9_drivetime": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/dxh/dx_mvhs/gsc_msa_z9_drivetime/') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "geoscape", "gsc_msa_z9_drivetime"], "unique_id": "model.sdna_project.gsc_msa_z9_drivetime", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/geoscape/gsc_msa_z9_drivetime.sql", "original_file_path": "models/sdna_us/household/loads/mvh/geoscape/gsc_msa_z9_drivetime.sql", "name": "gsc_msa_z9_drivetime", "resource_type": "model", "alias": "gsc_msa_z9_drivetime", "checksum": {"name": "sha256", "checksum": "ad1cd2e9cdd77a8e3a87acb007ddf805ecc62abab1d3f9cfa78b0b031faaefce"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}}, "model.sdna_project.mvh_retailers_aldi": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/geoscape/dx_mvhs/mvh_retailers_aldi/part-m-00001') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "geoscape", "mvh_retailers_aldi"], "unique_id": "model.sdna_project.mvh_retailers_aldi", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/geoscape/mvh_retailers_aldi.sql", "original_file_path": "models/sdna_us/household/loads/mvh/geoscape/mvh_retailers_aldi.sql", "name": "mvh_retailers_aldi", "resource_type": "model", "alias": "mvh_retailers_aldi", "checksum": {"name": "sha256", "checksum": "7c123fe01fcbdae677c11e40f2e907b680ce64d1d6dd71cec82136646c3f7c97"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}}, "model.sdna_project.mvh_retailers_tj": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/geoscape/dx_mvhs/mvh_retailers_tj/part-m-00001') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "geoscape", "mvh_retailers_tj"], "unique_id": "model.sdna_project.mvh_retailers_tj", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/geoscape/mvh_retailers_tj.sql", "original_file_path": "models/sdna_us/household/loads/mvh/geoscape/mvh_retailers_tj.sql", "name": "mvh_retailers_tj", "resource_type": "model", "alias": "mvh_retailers_tj", "checksum": {"name": "sha256", "checksum": "66492f08d258bee68e215eeb83495ba2fa5f680affb6a110f994caac3287e5a8"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}}, "model.sdna_project.mvh_retailers_wf": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/source/geoscape/dx_mvhs/mvh_retailers_wf/part-m-00001') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "geoscape", "mvh_retailers_wf"], "unique_id": "model.sdna_project.mvh_retailers_wf", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/geoscape/mvh_retailers_wf.sql", "original_file_path": "models/sdna_us/household/loads/mvh/geoscape/mvh_retailers_wf.sql", "name": "mvh_retailers_wf", "resource_type": "model", "alias": "mvh_retailers_wf", "checksum": {"name": "sha256", "checksum": "ea8b49808e1325e59e0b340381e6a045f65a6ee7c092b8bc806b134c2a964f92"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC_PARSER"}}, "model.sdna_project.iri_pepsi_fb_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/iri/dx_mvhs/iri_pepsi_fb_raw/Food_Bev_Spend_05252021.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "iri", "iri_pepsi_fb_raw"], "unique_id": "model.sdna_project.iri_pepsi_fb_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/iri/iri_pepsi_fb_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/iri/iri_pepsi_fb_raw.sql", "name": "iri_pepsi_fb_raw", "resource_type": "model", "alias": "iri_pepsi_fb_raw", "checksum": {"name": "sha256", "checksum": "cc3416131c0bed1eeb762a30ee2d3b3e1ede69787d877bddb004ed573f24fa27"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.is_coeff_raw_stg": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/is/dx_mvhs/coeff_raw/mvh_coefficients_transposed.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "is", "is_coeff_raw_stg"], "unique_id": "model.sdna_project.is_coeff_raw_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/is/is_coeff_raw_stg.sql", "original_file_path": "models/sdna_us/household/loads/mvh/is/is_coeff_raw_stg.sql", "name": "is_coeff_raw_stg", "resource_type": "model", "alias": "is_coeff_raw_stg", "checksum": {"name": "sha256", "checksum": "d69e07d4fb604caf43ee22b551488cde90ec3c743794fccf5f46662c2db6e49d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.is_means_raw": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_PEP_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/data/mvh/source/is/dx_mvhs/is_means_raw/mvh_means_transposed.csv') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "loads", "mvh", "is", "is_means_raw"], "unique_id": "model.sdna_project.is_means_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/loads/mvh/is/is_means_raw.sql", "original_file_path": "models/sdna_us/household/loads/mvh/is/is_means_raw.sql", "name": "is_means_raw", "resource_type": "model", "alias": "is_means_raw", "checksum": {"name": "sha256", "checksum": "007d3ed053d82be0e7a80d0ce596677f4ed3f459ecc07d474b8ce0bac532cef9"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_PEP_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.experian_cv_stg": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT\n{%- for col in get_cols_experian() %}\n{%- if col[0] is not none %} {{ col[0] }} {% else %} NULL {% endif %} AS {{ col[1] }},\n{%- endfor %}\n    GEO_ZIP_CODE || GEO_ZIP_4 AS CV_ZIPCODE_9,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ source('experian', 'MVH_CV_LIVING_UNIT_X261') }}\nWHERE GEO_ADDRESS_QUALITY_INDICATOR IN ('G','E','S')\nAND CV_LIVING_UNIT_ID <> '0000000000'", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "experian", "experian_cv_stg"], "unique_id": "model.sdna_project.experian_cv_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/experian/experian_cv_stg.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/experian/experian_cv_stg.sql", "name": "experian_cv_stg", "resource_type": "model", "alias": "experian_cv_stg", "checksum": {"name": "sha256", "checksum": "07a3dcfdf0afe60614074c39a6e6e04d6a261aa3be12a67a576f14049de97c0c"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [], "sources": [["experian", "MVH_CV_LIVING_UNIT_X261"]], "depends_on": {"macros": ["macro.sdna_project.get_cols_experian"], "nodes": ["source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "view", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_fvh": {"raw_sql": "SELECT\n    cv_living_unit_id AS fv_living_unit_id,\n    -- DERIVING PRESENCE OF CHILDREN\n    -- CHECK IF NO KIDS\n    IFF(cv_no_child_unit > '0', 0, 1)\n    AS fv_no_kids,\n    -- CHECK IF BABIES ONLY\n    IFF(cv_child_age_0_3_mdl    IN ('1Y','5Y')           AND cv_child_age_4_6_mdl   IN ('00','0U','5N','5U') AND cv_child_age_7_9_mdl   IN ('00','0U','5N','5U') AND\n        cv_child_age_10_12_mdl  IN ('00','0U','5N','5U') AND cv_child_age_13_15_mdl IN ('00','0U','5N','5U') AND cv_child_age_16_18_mdl IN ('00','0U','5N','5U'),1,'0')\n    AS fv_babies_only,\n    -- CHECK IF SMALL KIDS ONLY\n    IFF((cv_child_age_4_6_mdl   IN ('1Y','5Y')           OR  cv_child_age_7_9_mdl   IN ('1Y','5Y')           OR cv_child_age_10_12_mdl  IN ('1Y','5Y'))          AND\n        (cv_child_age_0_3_mdl   IN ('00','0U','5N','5U') AND cv_child_age_13_15_mdl IN ('00','0U','5N','5U') AND cv_child_age_16_18_mdl IN ('00','0U','5N','5U')),1,'0')\n    AS fv_small_kids_only,\n    -- CHECK IF TEENS ONLY\n    IFF((cv_child_age_13_15_mdl IN ('1Y','5Y')           OR  cv_child_age_16_18_mdl IN ('1Y','5Y'))          AND\n        (cv_child_age_0_3_mdl   IN ('00','0U','5N','5U') AND cv_child_age_4_6_mdl   IN ('00','0U','5N','5U') AND cv_child_age_7_9_mdl   IN ('00','0U','5N','5U') AND\n         cv_child_age_10_12_mdl IN ('00','0U','5N','5U')),1,'0')\n    AS fv_teens_only,\n    -- CHECK IF BABIES AND SMALL KIDS ONLY\n    IFF((cv_child_age_0_3_mdl   IN ('1Y','5Y')           AND\n        (cv_child_age_4_6_mdl   IN ('1Y','5Y')           OR cv_child_age_7_9_mdl    IN ('1Y','5Y')           OR cv_child_age_10_12_mdl  IN ('1Y','5Y')))         AND\n        (cv_child_age_13_15_mdl IN ('00','0U','5N','5U') AND cv_child_age_16_18_mdl IN ('00','0U','5N','5U')), 1, '0')\n    AS fv_babies_small_kids_only,\n    -- CHECK IF BABIES AND TEENS ONLY\n    IFF((cv_child_age_0_3_mdl   IN ('1Y','5Y')           AND\n        (cv_child_age_13_15_mdl IN ('1Y','5Y')           OR cv_child_age_16_18_mdl  IN ('1Y','5Y')))         AND\n        (cv_child_age_4_6_mdl   IN ('00','0U','5N','5U') AND cv_child_age_7_9_mdl   IN ('00','0U','5N','5U') AND cv_child_age_10_12_mdl IN ('00','0U','5N','5U')),1,'0')\n    AS fv_babies_teens_only,\n    -- CHECK IF SMALL KIDS AND TEENS ONLY\n    IFF((cv_child_age_4_6_mdl   IN ('1Y','5Y')           OR  cv_child_age_7_9_mdl   IN ('1Y','5Y')           OR cv_child_age_10_12_mdl  IN ('1Y','5Y'))          AND\n        (cv_child_age_13_15_mdl IN ('1Y','5Y')           OR  cv_child_age_16_18_mdl IN ('1Y','5Y'))          AND\n        (cv_child_age_0_3_mdl   IN ('00','0U','5N','5U')), 1, '0')\n    AS fv_small_kids_teens_only,\n    -- CHECK IF BABIES AND SMALL KIDS AND TEENS ONLY\n    IFF(cv_child_age_0_3_mdl    IN ('1Y','5Y')           AND\n       (cv_child_age_4_6_mdl    IN ('1Y','5Y')           OR  cv_child_age_7_9_mdl   IN ('1Y','5Y')           OR cv_child_age_10_12_mdl IN ('1Y','5Y'))           AND\n       (cv_child_age_13_15_mdl  IN ('1Y','5Y')           OR  cv_child_age_16_18_mdl IN ('1Y','5Y')), 1, '0')\n    AS fv_have_all_kid,\n\n    -- DERIVE TYPE OF HOUSEHOLD\n    IFF(cv_no_pers_unit = '1', 1, '0')\n    AS fv_hh_type_single,\n    IFF(cv_no_pers_unit = '2', 1, '0')\n    AS fv_hh_type_couple,\n    IFF(CAST(cv_no_pers_unit AS INT) > 2 AND CAST(cv_no_child_unit AS INT) > 0, 1, '0')\n    AS fv_hh_type_wkids,\n    IFF(CAST(cv_no_pers_unit AS INT) > 2 AND CAST(cv_no_child_unit AS INT) = 0, 1, '0')\n    AS fv_hh_type_wokids,\n\n    -- DERIVE HOUSHOLD SIZE\n    IFF(cv_no_pers_unit = '1',1,'0')\n    AS fv_hhdsize_1,\n    IFF(cv_no_pers_unit = '2',1,'0')\n    AS fv_hhdsize_2,\n    IFF(cv_no_pers_unit = '3',1,'0')\n    AS fv_hhdsize_3,\n    IFF(cv_no_pers_unit = '4',1,'0')\n    AS fv_hhdsize_4,\n    IFF(cv_no_pers_unit = '5',1,'0')\n    AS fv_hhdsize_5,\n    IFF(cv_no_pers_unit = '6',1,'0')\n    AS fv_hhdsize_6,\n    IFF(cv_no_pers_unit = '7',1,'0')\n    AS fv_hhdsize_7,\n    IFF(cv_no_pers_unit = '8',1,'0')\n    AS fv_hhdsize_8_plus,\n\n    -- DERIVE HOUSING STATUS\n    IFF(cv_hmeown_comb_hmeown_renter IN ('R','T','U'),1,'0')\n    AS fv_housing_other,\n    IFF(cv_hmeown_comb_hmeown_renter IN ('7','8','9','H'),1,'0')\n    AS fv_housing_own,\n\n    -- DERIVE HOUSEHOLD INCOME\n    IFF(CAST (cv_est_inc_amtv5 AS INT) < 10,1,'0')\n    AS fv_inc_lt_10k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 10 AND CAST (cv_est_inc_amtv5 AS INT) < 12,1,'0')\n    AS fv_inc_1011k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 12 AND CAST (cv_est_inc_amtv5 AS INT) < 15,1,'0')\n    AS fv_inc_1214k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 15 AND CAST (cv_est_inc_amtv5 AS INT) < 20,1,'0')\n    AS fv_inc_1519k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 20 AND CAST (cv_est_inc_amtv5 AS INT) < 25,1,'0')\n    AS fv_inc_2024k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 25 AND CAST (cv_est_inc_amtv5 AS INT) < 35,1,'0')\n    AS fv_inc_2534k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 35 AND CAST (cv_est_inc_amtv5 AS INT) < 45,1,'0')\n    AS fv_inc_3544k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 45 AND CAST (cv_est_inc_amtv5 AS INT) < 50,1,'0')\n    AS fv_inc_4549k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 50 AND CAST (cv_est_inc_amtv5 AS INT) < 60,1,'0')\n    AS fv_inc_5059k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 60 AND CAST (cv_est_inc_amtv5 AS INT) < 70,1,'0')\n    AS fv_inc_6069k,\n    IFF(CAST (cv_est_inc_amtv5 AS INT) >= 70 AND CAST (cv_est_inc_amtv5 AS INT) < 100,1,'0')\n    AS fv_inc_7099k,\n    IFF((CAST (cv_est_inc_amtv5 AS INT) >= 100 ),1,'0')\n    AS fv_inc_100k_plus,\n\n    -- DERIVING MARITAL STATUS\n    -- CHECK IF SINGLE\n    IFF((cv_p2_ptyp = 'P' AND cv_p2_gender = 'F' AND cv_p2_marital_st = '5S') OR cv_p1_marital_st = '5S',1,'0')\n    AS fv_marital_status_single,\n    -- CHECK IF MARRIED\n    IFF((cv_p2_ptyp = 'P' AND cv_p2_gender = 'F' AND SUBSTR(cv_p2_marital_st,2,1) = 'M') OR SUBSTR(cv_p1_marital_st,2,1) = 'M',1,'0')\n    AS fv_marital_status_married,\n    -- CHECK IF OTHER\n    IFF((cv_p2_ptyp = 'P' AND cv_p2_gender = 'F' AND SUBSTR(cv_p2_marital_st,2,1) = 'U') OR SUBSTR(cv_p1_marital_st,2,1) = 'U',1,'0')\n    AS fv_marital_status_other,\n\n    --DERIVE HOUSEHOLD AGE\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 18-24\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 17)       AND\n       (CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) < 25),1,'0')\n    AS fv_age_1824,\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 25-34\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 24)       AND\n       (CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) < 35),1,'0')\n    AS fv_age_2534,\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 35-44\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 34)       AND\n       (CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) < 45),1,'0')\n    AS fv_age_3544,\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 45-54\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 44)       AND\n       (CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) < 55),1,'0')\n    AS fv_age_4554,\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 55-64\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 54)       AND\n       (CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) < 65),1,'0')\n    AS fv_age_5564,\n    -- CHECK IF HH HAS PRIMARY PERSON WITH AGE MORE THAN 65\n    IFF((CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) > 64 ),1,'0')\n    AS fv_age_65_plus,\n\n    -- DERIVE EDUCATION\n    -- CHECK IF EDUCATION COMES UNDER OTHER\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_edu_mdl,cv_p1_edu_mdl)),2,1) IN ('2','5'),1,'0')\n    AS fv_edu_other,\n    -- CHECK IF EDUCATION COMES UNDER GRAD DEGREE\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_edu_mdl,cv_p1_edu_mdl)),2,1) IN ('4'),1,'0')\n    AS fv_edu_grad,\n    -- CHECK IF EDUCATION COMES UNDER DIPLOMA\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_edu_mdl,cv_p1_edu_mdl)),2,1) IN ('1'),1,'0')\n    AS fv_edu_hs,\n    -- CHECK IF EDUCATION COMES UNDER COLLEGE\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_edu_mdl,cv_p1_edu_mdl)),2,1) IN ('3'),1,'0')\n    AS fv_edu_college,\n\n    -- DERIVE OCCUPATION\n    -- CHECK IF OCCUPATION COMES UNDER OTHER\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_occ_grp,cv_p1_occ_grp)),2,1) IN ('7','8','9'),1,'0')\n    AS fv_occup_other,\n    -- CHECK IF OCCUPATION COMES UNDER BLUE COLLAR\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_occ_grp,cv_p1_occ_grp)),2,1) IN ('4','5','6'),1,'0')\n    AS fv_occup_bluecollar,\n    -- CHECK IF OCCUPATION COMES UNDER SKILLED\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_occ_grp,cv_p1_occ_grp)),2,1) IN ('2'),1,'0')\n    AS fv_occup_skilled,\n    -- CHECK IF OCCUPATION COMES UNDER WHITE COLLAR\n    IFF(SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_occ_grp,cv_p1_occ_grp)),2,1) IN ('1','3'),1,'0')\n    AS fv_occup_whitecollar,\n\n\n    -- DERIVE REGION\n    -- CHECK IF REGION IS IN MIDDLE WEST\n    IFF(cv_state_abb IN ('ND','SD','MN','IA','NE','KS','MO','IL','IN','WI','MI','OH'), 1, '0')\n    AS fv_reg_mw,\n    -- CHECK IF REGION IS IN SOUTH\n    IFF(cv_state_abb IN ('TX','OK','AR','LA','MS','AL','TN','KY','VA','WV','MD','DE','NC','SC','GA','FL','DC'), 1, '0')\n    AS fv_reg_s,\n    -- CHECK IF REGION IS IN WEST\n    IFF(cv_state_abb IN ('CA','NV','AZ','NM','CO','WY','ID','OR','MT','WA','AK','HI'), 1, '0')\n    AS fv_reg_w,\n    -- CHECK IF REGION IS IN NORTH EAST\n    IFF(cv_state_abb IN ('PA','NJ','NY','CT','RI','MA','VT','NH','ME'), 1, '0')\n    AS fv_reg_ne,\n\n    -- DERIVE RACE\n    -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS White and non Hispanic\n    IFF(IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp)     IN ('E','G','J','K','L'), 1, '0')\n    AS fv_race_white_nonh,\n    -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS African American and non Hispanic\n    IFF(IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp)     IN ('A'), 1, '0')\n    AS fv_race_aa_nonh,\n    -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS Hispanic\n    IFF(IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp)     IN ('O'), 1, '0')\n    AS fv_race_hisp,\n    -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS South east Asian, South Asian, Central Asian, AND East Asian and non Hispanic\n    IFF(IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp)     IN ('B','C','D','H','I','N'), 1, '0')\n    AS fv_race_asian_nonh,\n    -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS  other non Hispanic\n    IFF(IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp)     IN ('F','M','Z'), 1, '0')\n    AS fv_race_othr_nonh,\n    -- DERIVE HH_SIZE\n    CAST(cv_no_pers_unit AS tinyint) AS fv_hh_size,\n    -- DERIVE HH_INCOME\n    (CAST (cv_est_inc_amtv5 AS INT) * 1000) AS fv_hh_income,\n    -- DERIVE HOH_AGE\n    CAST (SUBSTR((IFF(cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS tinyint) AS fv_hoh_age\nFROM {{ ref('exp_geo_is_cg') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "exp_fvh"], "unique_id": "model.sdna_project.exp_fvh", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/exp_fvh.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/exp_fvh.sql", "name": "exp_fvh", "resource_type": "model", "alias": "exp_fvh", "checksum": {"name": "sha256", "checksum": "8644b96ffc9f078f1a663e629aef3cb41ff04a35ec87a577a3d6cdd13eed5f94"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is_cg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is_cg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_is_cg_fvh": {"raw_sql": "--LOADING FVH values back to the Exp + Geo + IS + CG\n-- Keep below settings - they work well as on Q2-2018\n\nSELECT\n    exp.cv_living_unit_id                                           ,\n    exp.cv_address_id                                               ,\n    exp.cv_short_city_name                                          ,\n    exp.cv_city_name                                                ,\n    exp.cv_county_name                                              ,\n    exp.cv_state_abb                                                ,\n    exp.cv_zipcode_5                                                ,\n    exp.cv_zipcode_4                                                ,\n    exp.cv_zipcode_9                                                ,\n    exp.cv_zip_locality                                             ,\n    exp.cv_delvy_pt_bar_cd                                          ,\n    exp.cv_carr_route                                               ,\n    exp.cv_state_cd                                                 ,\n    exp.cv_county_cd                                                ,\n    exp.cv_cen2010_tract_block_grp                                  ,\n    exp.cv_cen2010_blockid                                          ,\n    exp.cv_latitude                                                 ,\n    exp.cv_longitude                                                ,\n    exp.cv_mat_level_geodata                                        ,\n    exp.cv_addr_qlty_ind                                            ,\n    exp.cv_recp_reliable_cd                                         ,\n    exp.cv_acty_dt                                                  ,\n    exp.cv_tme_zn                                                   ,\n    exp.cv_p1_pid                                                   ,\n    exp.cv_p1_ptyp                                                  ,\n    exp.cv_p1_etnc_etnc                                             ,\n    exp.cv_p1_etnc_exp_grp                                          ,\n    exp.cv_p1_etnc_religion                                         ,\n    exp.cv_p1_etnc_lang_pref                                        ,\n    exp.cv_p1_etnc_grp                                              ,\n    exp.cv_p1_etnc_country_of_origin                                ,\n    exp.cv_p1_gender                                                ,\n    exp.cv_p1_birth_dt                                              ,\n    exp.cv_p1_est_age                                               ,\n    exp.cv_p1_exact_age                                             ,\n    exp.cv_p1_com_age                                               ,\n    exp.cv_p1_edu_mdl                                               ,\n    exp.cv_p1_marital_st                                            ,\n    exp.cv_p1_occ_grp                                               ,\n    exp.cv_p1_occ_cd                                                ,\n    exp.cv_p1_bus_own                                               ,\n    exp.cv_p2_pid                                                   ,\n    exp.cv_p2_ptyp                                                  ,\n    exp.cv_p2_etnc_etnc                                             ,\n    exp.cv_p2_etnc_exp_grp                                          ,\n    exp.cv_p2_etnc_religion                                         ,\n    exp.cv_p2_etnc_lang_pref                                        ,\n    exp.cv_p2_etnc_grp                                              ,\n    exp.cv_p2_etnc_country_of_origin                                ,\n    exp.cv_p2_gender                                                ,\n    exp.cv_p2_birth_dt                                              ,\n    exp.cv_p2_est_age                                               ,\n    exp.cv_p2_exact_age                                             ,\n    exp.cv_p2_com_age                                               ,\n    exp.cv_p2_edu_mdl                                               ,\n    exp.cv_p2_marital_st                                            ,\n    exp.cv_p2_occ_grp                                               ,\n    exp.cv_p2_occ_cd                                                ,\n    exp.cv_p2_bus_own                                               ,\n    exp.cv_p3_pid                                                   ,\n    exp.cv_p3_ptyp                                                  ,\n    exp.cv_p3_etnc_etnc                                             ,\n    exp.cv_p3_etnc_exp_grp                                          ,\n    exp.cv_p3_etnc_religion                                         ,\n    exp.cv_p3_etnc_lang_pref                                        ,\n    exp.cv_p3_etnc_grp                                              ,\n    exp.cv_p3_etnc_country_of_origin                                ,\n    exp.cv_p3_gender                                                ,\n    exp.cv_p3_birth_dt                                              ,\n    exp.cv_p3_est_age                                               ,\n    exp.cv_p3_exact_age                                             ,\n    exp.cv_p3_com_age                                               ,\n    exp.cv_p3_edu_mdl                                               ,\n    exp.cv_p3_marital_st                                            ,\n    exp.cv_p3_occ_grp                                               ,\n    exp.cv_p3_occ_cd                                                ,\n    exp.cv_p3_bus_own                                               ,\n    exp.cv_p4_pid                                                   ,\n    exp.cv_p4_ptyp                                                  ,\n    exp.cv_p4_etnc_etnc                                             ,\n    exp.cv_p4_etnc_exp_grp                                          ,\n    exp.cv_p4_etnc_religion                                         ,\n    exp.cv_p4_etnc_lang_pref                                        ,\n    exp.cv_p4_etnc_grp                                              ,\n    exp.cv_p4_etnc_country_of_origin                                ,\n    exp.cv_p4_gender                                                ,\n    exp.cv_p4_birth_dt                                              ,\n    exp.cv_p4_est_age                                               ,\n    exp.cv_p4_exact_age                                             ,\n    exp.cv_p4_com_age                                               ,\n    exp.cv_p4_edu_mdl                                               ,\n    exp.cv_p4_marital_st                                            ,\n    exp.cv_p4_occ_grp                                               ,\n    exp.cv_p4_occ_cd                                                ,\n    exp.cv_p4_bus_own                                               ,\n    exp.cv_p5_pid                                                   ,\n    exp.cv_p5_ptyp                                                  ,\n    exp.cv_p5_etnc_etnc                                             ,\n    exp.cv_p5_etnc_exp_grp                                          ,\n    exp.cv_p5_etnc_religion                                         ,\n    exp.cv_p5_etnc_lang_pref                                        ,\n    exp.cv_p5_etnc_grp                                              ,\n    exp.cv_p5_etnc_country_of_origin                                ,\n    exp.cv_p5_gender                                                ,\n    exp.cv_p5_birth_dt                                              ,\n    exp.cv_p5_est_age                                               ,\n    exp.cv_p5_exact_age                                             ,\n    exp.cv_p5_com_age                                               ,\n    exp.cv_p5_edu_mdl                                               ,\n    exp.cv_p5_marital_st                                            ,\n    exp.cv_p5_occ_grp                                               ,\n    exp.cv_p5_occ_cd                                                ,\n    exp.cv_p5_bus_own                                               ,\n    exp.cv_p6_pid                                                   ,\n    exp.cv_p6_ptyp                                                  ,\n    exp.cv_p6_etnc_etnc                                             ,\n    exp.cv_p6_etnc_exp_grp                                          ,\n    exp.cv_p6_etnc_religion                                         ,\n    exp.cv_p6_etnc_lang_pref                                        ,\n    exp.cv_p6_etnc_grp                                              ,\n    exp.cv_p6_etnc_country_of_origin                                ,\n    exp.cv_p6_gender                                                ,\n    exp.cv_p6_birth_dt                                              ,\n    exp.cv_p6_est_age                                               ,\n    exp.cv_p6_exact_age                                             ,\n    exp.cv_p6_com_age                                               ,\n    exp.cv_p6_edu_mdl                                               ,\n    exp.cv_p6_marital_st                                            ,\n    exp.cv_p6_occ_grp                                               ,\n    exp.cv_p6_occ_cd                                                ,\n    exp.cv_p6_bus_own                                               ,\n    exp.cv_mor                                                      ,\n    exp.cv_mor_bank_book                                            ,\n    exp.cv_mor_bank_spl_food                                        ,\n    exp.cv_mor_bank_craft_merch                                     ,\n    exp.cv_mor_bank_culinary_int                                    ,\n    exp.cv_mor_bank_dedupe_hit                                      ,\n    exp.cv_mor_bank_doit_yourself                                   ,\n    exp.cv_mor_bank_famgen_mag                                      ,\n    exp.cv_mor_bank_f_merch                                         ,\n    exp.cv_mor_bank_f_orient_mag                                    ,\n    exp.cv_mor_bank_gar_farm_buy                                    ,\n    exp.cv_mor_bank_gar_farm_mag                                    ,\n    exp.cv_mor_bank_gen_contrib                                     ,\n    exp.cv_mor_bank_gen_merch                                       ,\n    exp.cv_mor_bank_gift_gadgs                                      ,\n    exp.cv_mor_bank_health_inst_contib                              ,\n    exp.cv_mor_bank_health_fit_mag                                  ,\n    exp.cv_mor_bank_m_merch                                         ,\n    exp.cv_mor_bank_m_sports_mag                                    ,\n    exp.cv_mor_bank_misc                                            ,\n    exp.cv_mor_bank_nondedupe_hit                                   ,\n    exp.cv_mor_bank_odds_end                                        ,\n    exp.cv_mor_bank_opp_seek_ce                                     ,\n    exp.cv_mor_bank_photograph                                      ,\n    exp.cv_mor_bank_political_cont                                  ,\n    exp.cv_mor_bank_religious_cont                                  ,\n    exp.cv_mor_bank_religious_mag                                   ,\n    exp.cv_mor_bank_upscale_merch                                   ,\n    exp.cv_mor_bank_news_finan                                      ,\n    exp.cv_ncoa_cd                                                  ,\n    exp.cv_ncoa_dt                                                  ,\n    exp.cv_green_aware                                              ,\n    exp.cv_green_aware_deciles                                      ,\n    exp.cv_no_adults_unit                                           ,\n    exp.cv_no_pers_unit                                             ,\n    exp.cv_no_child_unit                                            ,\n    exp.cv_child_age_0_3                                            ,\n    exp.cv_child_age_4_6                                            ,\n    exp.cv_child_age_7_9                                            ,\n    exp.cv_child_age_10_12                                          ,\n    exp.cv_child_age_13_15                                          ,\n    exp.cv_child_age_16_18                                          ,\n    exp.cv_mosaic_household                                         ,\n    exp.cv_mosaic_zip4                                              ,\n    exp.cv_home_bus                                                 ,\n    exp.cv_dwelling_type                                            ,\n    exp.cv_dwelling_unit_size                                       ,\n    exp.cv_length_of_residence                                      ,\n    exp.cv_household_comp                                           ,\n    exp.cv_hmeown_hmeown                                            ,\n    exp.cv_hmeown_prob_hmeown                                       ,\n    exp.cv_hmeown_comb_hmeown_renter                                ,\n    exp.cv_est_curr_hme_val                                         ,\n    exp.cv_est_curr_hme_val_range                                   ,\n    exp.cv_cons_vw_proft                                            ,\n    exp.cv_incom_per_national                                       ,\n    exp.cv_county_ehi_per                                           ,\n    exp.cv_auto_in_market_new                                       ,\n    exp.cv_aut_mark_used                                            ,\n    exp.cv_aut_mark_used_0_5_vehicle                                ,\n    exp.cv_aut_mark_used_11_vehicle                                 ,\n    exp.cv_aut_mark_used_6_10_vehicle                               ,\n    exp.cv_est_inc_amtv5                                            ,\n    exp.cv_est_hh_incv5                                             ,\n    exp.cv_county_echv_index                                        ,\n    exp.cv_county_echv_per                                          ,\n    exp.cv_state_ehi_index                                          ,\n    exp.cv_county_ehi_index                                         ,\n    exp.cv_cen_rur_urban_county_szcd                                ,\n    exp.cv_cbsa                                                     ,\n    exp.cv_cbsa_type                                                ,\n    exp.cv_cape_edu_ispsa                                           ,\n    exp.cv_cape_edu_ispsa_decile                                    ,\n    exp.cv_cape_inc_fam_state_decile                                ,\n    exp.cv_cape_dens_per_per_pop                                    ,\n    exp.cv_cape_age_pop_0_17                                        ,\n    exp.cv_cape_age_pop_0_4                                         ,\n    exp.cv_cape_age_pop_5_9                                         ,\n    exp.cv_cape_age_pop_10_13                                       ,\n    exp.cv_cape_age_pop_14_17                                       ,\n    exp.cv_cape_age_pop_18_99                                       ,\n    exp.cv_cape_age_pop_65_99                                       ,\n    exp.cv_cape_age_pop_median_age                                  ,\n    exp.cv_cape_built_median_hous_age                               ,\n    exp.cv_cape_child_couple_famw_lt18                              ,\n    exp.cv_cape_child_couple_famwo_lt18                             ,\n    exp.cv_cape_child_wper_lt18                                     ,\n    exp.cv_cape_edu_pop25_med_edu_attain                            ,\n    exp.cv_cape_occ_empid_health_tech                               ,\n    exp.cv_cape_ethnic_pop_black_only                               ,\n    exp.cv_cape_ethnic_pop_asian_only                               ,\n    exp.cv_cape_ethnic_pop_hispanic                                 ,\n    exp.cv_cape_ethnic_pop_white_only                               ,\n    exp.cv_cape_avg_hh_size                                         ,\n    exp.cv_cape_oohu_med_hme_val                                    ,\n    exp.cv_cape_hu_mob_hme                                          ,\n    exp.cv_cape_med_fam_hh_inc                                      ,\n    exp.cv_cape_lang_spanish_speak                                  ,\n    exp.cv_cape_occhu_own_occu                                      ,\n    exp.cv_cape_oochu_rent_occu                                     ,\n    exp.cv_cape_marr_couple_fam                                     ,\n    exp.cv_hh_int_read_bible_devo                                   ,\n    exp.cv_hh_pc_use_net_service                                    ,\n    exp.cv_hh_crafts                                                ,\n    exp.cv_hh_finan_stks_bond                                       ,\n    exp.cv_hh_finan_cds_money_mkt                                   ,\n    exp.cv_hh_finan_iras_currently                                  ,\n    exp.cv_hh_finan_mutual_funds                                    ,\n    exp.cv_hh_finan_real_estate                                     ,\n    exp.cv_act_amusement_park_visit                                 ,\n    exp.cv_act_zoo_visit                                            ,\n    exp.cv_act_coffee_connoisseurs                                  ,\n    exp.cv_act_wine_lover                                           ,\n    exp.cv_act_doit_yourself                                        ,\n    exp.cv_act_hme_imp_spenders                                     ,\n    exp.cv_act_hunt_enthus                                          ,\n    exp.cv_act_digi_mag_buyer                                       ,\n    exp.cv_act_attend_edu_pgm                                       ,\n    exp.cv_act_video_gamer                                          ,\n    exp.cv_act_mlb_enthus                                           ,\n    exp.cv_act_nascar_enthus                                        ,\n    exp.cv_act_nba_enthus                                           ,\n    exp.cv_act_nfl_enthus                                           ,\n    exp.cv_act_nhl_enthus                                           ,\n    exp.cv_act_pga_tour_enthus                                      ,\n    exp.cv_act_politics_viewing_tv_lib                              ,\n    exp.cv_act_politics_viewing_tv_libcom                           ,\n    exp.cv_act_politics_viewing_tv_conserv                          ,\n    exp.cv_act_eats_fam_restaurant                                  ,\n    exp.cv_act_eats_ff_restaurant                                   ,\n    exp.cv_act_canoeing_kayaking                                    ,\n    exp.cv_act_play_golf                                            ,\n    exp.cv_act_gourment_cooking                                     ,\n    exp.cv_act_cat_owners                                           ,\n    exp.cv_act_dog_owners                                           ,\n    exp.cv_act_pet_enthus                                           ,\n    exp.cv_act_arts_crafts                                          ,\n    exp.cv_act_scrapbooking                                         ,\n    exp.cv_act_cultural_arts                                        ,\n    exp.cv_hobbies_gardening                                        ,\n    exp.cv_act_photography                                          ,\n    exp.cv_act_book_reader                                          ,\n    exp.cv_act_ebook_reader                                         ,\n    exp.cv_act_audiobook_reader                                     ,\n    exp.cv_act_avid_runners                                         ,\n    exp.cv_act_outdoor_enthus                                       ,\n    exp.cv_act_fishing                                              ,\n    exp.cv_act_snow_sport                                           ,\n    exp.cv_act_boating                                              ,\n    exp.cv_act_plays_hockey                                         ,\n    exp.cv_act_plays_soccer                                         ,\n    exp.cv_act_plays_tennis                                         ,\n    exp.cv_act_sport_enthusiast                                     ,\n    exp.cv_act_healthy_living                                       ,\n    exp.cv_act_fitness_enthus                                       ,\n    exp.cv_act_on_diet                                              ,\n    exp.cv_act_weight_conscious                                     ,\n    exp.cv_act_casino_gambling                                      ,\n    exp.cv_act_sweepstakes_lottery                                  ,\n    exp.cv_act_music_download                                       ,\n    exp.cv_act_music_stream                                         ,\n    exp.cv_act_listen_christian_music                               ,\n    exp.cv_act_listen_classical_music                               ,\n    exp.cv_act_listen_country_music                                 ,\n    exp.cv_act_listen_music                                         ,\n    exp.cv_act_listen_oldies_music                                  ,\n    exp.cv_act_listen_rock_music                                    ,\n    exp.cv_act_listen_80s_music                                     ,\n    exp.cv_act_listen_hiphop_music                                  ,\n    exp.cv_act_listen_alter_music                                   ,\n    exp.cv_act_listen_jazz_music                                    ,\n    exp.cv_act_listen_pop_music                                     ,\n    exp.cv_buyer_lap_own                                            ,\n    exp.cv_buyer_security_sys_own                                   ,\n    exp.cv_buyer_tab_own                                            ,\n    exp.cv_buyer_coupon_users                                       ,\n    exp.cv_buyer_lux_store_shopp                                    ,\n    exp.cv_buyer_lux_hme_goods_shopp                                ,\n    exp.cv_buyer_yng_adult_cloth_shopp                              ,\n    exp.cv_buyer_supercenter_shopp                                  ,\n    exp.cv_buyer_warehouse_club_mem                                 ,\n    exp.cv_buyer_loyalty_card_usr                                   ,\n    exp.cv_buyer_presence_auto                                      ,\n    exp.cv_buyer_nonpres_makeup_usr                                 ,\n    exp.cv_buyer_pres_makeup_usr                                    ,\n    exp.cv_buyer_highend_spirit_drinker                             ,\n    exp.cv_lfstyl_lf_insure_plcy_hldr                               ,\n    exp.cv_lfstyl_med_insure_plcy_hldrs                             ,\n    exp.cv_lfstyl_medicare_plcy_hldrs                               ,\n    exp.cv_lfstyl_have_grand_child                                  ,\n    exp.cv_lfstyl_high_freq_business_trav                           ,\n    exp.cv_lfstyl_high_freq_cruise_enthus                           ,\n    exp.cv_lfstyl_high_freq_domes_vacationer                        ,\n    exp.cv_lfstyl_high_freq_forgn_vacationer                        ,\n    exp.cv_lfstyl_freq_fly_pgm_mem                                  ,\n    exp.cv_lfstyl_hostel_guest_loyal_pgm                            ,\n    exp.cv_lfstyl_interest_religion                                 ,\n    exp.cv_lfstyl_military_act                                      ,\n    exp.cv_lfstyl_military_inact                                    ,\n    exp.cv_donor_contrib_charities                                  ,\n    exp.cv_donor_contrib_arts_charities                             ,\n    exp.cv_donor_contrib_edu_charities                              ,\n    exp.cv_donor_contrib_health_charities                           ,\n    exp.cv_donor_contrib_political_charities                        ,\n    exp.cv_donor_contrib_pvt_found                                  ,\n    exp.cv_donor_contrib_volunteer                                  ,\n    exp.cv_finan_debit_card_usr                                     ,\n    exp.cv_finan_corp_credit_card_usr                               ,\n    exp.cv_finan_major_credit_card_usr                              ,\n    exp.cv_finan_premium_credit_card_usr                            ,\n    exp.cv_finan_credit_card_usr                                    ,\n    exp.cv_finan_store_credit_card_usr                              ,\n    exp.cv_invest_retire_finan_plan                                 ,\n    exp.cv_invest_part_online_trade                                 ,\n    exp.cv_invest_brokerage_acct_own                                ,\n    exp.cv_invest_actv_investor                                     ,\n    exp.cv_invest_mutual_fund_invest                                ,\n    exp.cv_memship_aarp_mem                                         ,\n    exp.cv_memship_union_mem                                        ,\n    exp.cv_tt_email,\n    -- Removed old cv_tt_* columns\n    exp.cv_p1_retail_shopp                                          ,\n    exp.cv_p2_retail_shopp                                          ,\n    exp.cv_p3_retail_shopp                                          ,\n    exp.cv_p4_retail_shopp                                          ,\n    exp.cv_p5_retail_shopp                                          ,\n    exp.cv_p6_retail_shopp                                          ,\n    exp.cv_p1_health_well_being                                     ,\n    exp.cv_p2_health_well_being                                     ,\n    exp.cv_p3_health_well_being                                     ,\n    exp.cv_p4_health_well_being                                     ,\n    exp.cv_p5_health_well_being                                     ,\n    exp.cv_p6_health_well_being                                     ,\n    exp.cv_p1_mobile_usrs                                           ,\n    exp.cv_p2_mobile_usrs                                           ,\n    exp.cv_p3_mobile_usrs                                           ,\n    exp.cv_p4_mobile_usrs                                           ,\n    exp.cv_p5_mobile_usrs                                           ,\n    exp.cv_p6_mobile_usrs                                           ,\n    exp.cv_p1_tech_adoption                                         ,\n    exp.cv_p2_tech_adoption                                         ,\n    exp.cv_p3_tech_adoption                                         ,\n    exp.cv_p4_tech_adoption                                         ,\n    exp.cv_p5_tech_adoption                                         ,\n    exp.cv_p6_tech_adoption                                         ,\n    exp.cv_p1_mor                                                   ,\n    exp.cv_p2_mor                                                   ,\n    exp.cv_p3_mor                                                   ,\n    exp.cv_p4_mor                                                   ,\n    exp.cv_p5_mor                                                   ,\n    exp.cv_p6_mor                                                   ,\n    exp.cv_mosaic_glob_hh                                           ,\n    exp.cv_mosaic_glob_zip4                                         ,\n    exp.cv_child_pres_0_18                                          ,\n    exp.cv_child_age_0_3_mdl                                        ,\n    exp.cv_child_age_scor_0_3                                       ,\n    exp.cv_child_age_4_6_mdl                                        ,\n    exp.cv_child_age_scor_4_6                                       ,\n    exp.cv_child_age_7_9_mdl                                        ,\n    exp.cv_child_age_scor_7_9_                                      ,\n    exp.cv_child_age_10_12_mdl                                      ,\n    exp.cv_child_age_scor_10_12_                                    ,\n    exp.cv_child_age_13_15_mdl                                      ,\n    exp.cv_child_age_scor_13_15                                     ,\n    exp.cv_child_age_16_18_mdl                                      ,\n    exp.cv_child_age_scor_16_18_                                    ,\n    exp.cv_hh_ail_meds_vis_ctnt_lenses                              ,--populated with null value from Experian from Q4 2020\n    exp.cv_bhvr_bank_cntct_lens_wearer                              ,--populated with null value from Experian from Q4 2020\n    exp.cv_bhvr_bnk_reg_pres_drug_users                             ,--populated with null value from Experian from Q4 2020\n    exp.cv_bhvr_bnk_intrst_vid_dvd                                  ,\n    exp.cv_bhvr_bnk_intrst_golf                                     ,\n    exp.cv_bhvr_bnk_contri_charities                                ,\n    exp.cv_bhvr_bnk_pet_enthusiast                                  ,\n    exp.cv_bhvr_bnk_intrst_cultural_arts                            ,\n    exp.cv_bhvr_bnk_purchased_thu_mail                              ,\n    exp.cv_bhvr_bnk_intrst_fitness                                  ,\n    exp.cv_bhvr_bnk_intrst_outdoors                                 ,\n    exp.cv_bhvr_bnk_intrst_travel                                   ,\n    exp.cv_bhvr_bnk_investors                                       ,\n    exp.cv_bhvr_bnk_pres_of_automobile                              ,\n    exp.cv_bhvr_bnk_pres_of_credit_card                             ,\n    exp.cv_bhvr_bnk_intrst_gardening                                ,\n    exp.cv_bhvr_bnk_intrst_crafts                                   ,\n    exp.cv_bhvr_bnk_collectors                                      ,\n    exp.cv_bhvr_bnk_cruise_enthusiasts                              ,\n    exp.cv_bhvr_bnk_intrst_sports                                   ,\n    exp.cv_bhvr_bnk_intrst_grmt_cooking                             ,\n    exp.cv_bhvr_bnk_sweepstakes_gambling                            ,\n    exp.cv_bhvr_bnk_intrst_politics                                 ,\n    exp.cv_bhvr_bnk_intrst_music                                    ,\n    exp.cv_bhvr_bnk_intrst_reading                                  ,\n    exp.cv_bhvr_bnk_child_parenting_prod                            ,\n    exp.cv_bhvr_bnk_do_it_yourselfer                                ,\n    exp.cv_bhvr_bnk_self_improvement                                ,\n    exp.cv_bhvr_bnk_intrst_in_religion                              ,\n    exp.cv_bhvr_bnk_grandparent                                     ,\n    exp.cv_bhvr_bnk_intrst_clothing                                 ,\n    exp.cv_bhvr_bnk_donates_envrn_causes                            ,\n    exp.cv_bhvr_bnk_invests_mutual_funds                            ,\n    exp.cv_bhvr_bnk_wght_conscious                                  ,\n    exp.cv_bhvr_bnk_mail_order_multibuyer                           ,\n    exp.cv_bhvr_bnk_dog_enthusiasts                                 ,\n    exp.cv_bhvr_bnk_cat_enthusiasts                                 ,\n    exp.cv_bhvr_bnk_hlthy_living                                    ,\n    exp.cv_bhvr_bnk_intrst_automotive                               ,\n    exp.cv_bhvr_bnk_intrst_skiing                                   ,\n    exp.cv_bhvr_bnk_intrst_boating                                  ,\n    exp.cv_bhvr_bnk_pres_of_cell_phone                              ,\n    exp.cv_bhvr_bnk_commn_connectivity                              ,\n    exp.cv_bhvr_bnk_computers                                       ,\n    exp.cv_bhvr_bnk_hi_tech_owner                                   ,\n    exp.cv_bhvr_bnk_home_decor_furnish                              ,\n    exp.cv_bhvr_bnk_homeentmnt_video                                ,\n    exp.cv_bhvr_bnk_kitchen_aids_applns                             ,\n    exp.cv_bhvr_bnk_mo_buyer_music_video                            ,\n    exp.cv_bhvr_bnk_mob_books                                       ,\n    exp.cv_bhvr_bnk_mo_buyer_cloth_shoe                             ,\n    exp.cv_bhvr_bnk_mob_ins_fin                                     ,\n    exp.cv_bhvr_bnk_mail_order_buyer_gift                           ,\n    exp.cv_bhvr_bnk_mob_grdng                                       ,\n    exp.cv_bhvr_bnk_mob_jewelry                                     ,\n    exp.cv_bhvr_bnk_clas_opra_big_bnd_mus                           ,\n    exp.cv_bhvr_bnk_country_music                                   ,\n    exp.cv_bhvr_bnk_christian_music                                 ,\n    exp.cv_bhvr_bnk_rock_music                                      ,\n    exp.cv_bhvr_bnk_internet_online_subs                            ,\n    exp.cv_bhvr_bnk_intrst_photo                                    ,\n    exp.cv_bhvr_bnk_purchase_via_online                             ,\n    exp.cv_bhvr_bnk_intrst_affluence_ls                             ,\n    exp.cv_bhvr_bnk_domestic_traveler                               ,\n    exp.cv_bhvr_bnk_foreign_traveler                                ,\n    exp.cv_bhvr_bnk_pres_of_prem_cc                                 ,\n    exp.cv_bhvr_bnk_active_military                                 ,\n    exp.cv_bhvr_bnk_inactive_military                               ,\n    exp.cv_hh_acty_int_hob_photography                              ,\n    exp.cv_hh_acty_int_hobbies_gardening                            ,\n    exp.cv_hh_acty_int_hob_home_ws_diy                              ,\n    exp.cv_hh_acty_int_hob_cars_auto_rep                            ,\n    exp.cv_hh_acty_int_hob_bird_watching                            ,\n    exp.cv_hh_acty_int_hob_self_imprvmnt                            ,\n    exp.cv_hh_acty_int_music_chrstn_gosp                            ,\n    exp.cv_hh_acty_int_music_r_and_b                                ,\n    exp.cv_hh_acty_int_music_jazz_new_age                           ,\n    exp.cv_hh_acty_int_music_classical                              ,\n    exp.cv_hh_acty_int_music_rock_n_roll                            ,\n    exp.cv_hh_acty_int_music_country                                ,\n    exp.cv_hh_acty_int_music_in_gen                                 ,\n    exp.cv_hh_acty_int_music_other_music                            ,\n    exp.cv_hh_acty_int_read_bs_fiction                              ,\n    exp.cv_hh_acty_int_childrens_reading                            ,\n    exp.cv_hh_acty_int_reading_computer                             ,\n    exp.cv_hh_acty_int_read_cook_culinary                           ,\n    exp.cv_hh_acty_int_reading_country_ls                           ,\n    exp.cv_hh_acty_int_read_entmnt_ppl                              ,\n    exp.cv_hh_acty_int_reading_fashion                              ,\n    exp.cv_hh_acty_int_reading_history                              ,\n    exp.cv_hh_acty_int_read_intr_decor                              ,\n    exp.cv_hh_acty_int_read_med_hlth                                ,\n    exp.cv_hh_acty_int_reading_military                             ,\n    exp.cv_hh_acty_int_reading_mystery                              ,\n    exp.cv_hh_acty_int_read_ntrl_hlth_rmd                           ,\n    exp.cv_hh_acty_int_reading_romance                              ,\n    exp.cv_hh_acty_int_read_sc_fiction                              ,\n    exp.cv_hh_acty_int_read_sc_tech                                 ,\n    exp.cv_hh_acty_int_sports_read                                  ,\n    exp.cv_hh_acty_int_read_wrld_news_pol                           ,\n    exp.cv_hh_acty_int_book_reader                                  ,\n    exp.cv_hh_acty_int_soc_ani_wf_soc                               ,\n    exp.cv_hh_acty_int_soc_env_wildlife                             ,\n    exp.cv_hh_acty_int_soc_pol_cons                                 ,\n    exp.cv_hh_acty_int_soc_pol_liberal                              ,\n    exp.cv_hh_acty_int_soc_religion                                 ,\n    exp.cv_hh_acty_int_soc_child                                    ,\n    exp.cv_hh_acty_int_soc_veterans                                 ,\n    exp.cv_hh_acty_int_soc_hlth                                     ,\n    exp.cv_hh_acty_int_soc_othr                                     ,\n    exp.cv_hh_acty_int_sportsbaseball                               ,\n    exp.cv_hh_acty_int_sportsbasketball                             ,\n    exp.cv_hh_acty_int_sports_rec_hockey                            ,\n    exp.cv_hh_acty_int_sportscampng_hikng                           ,\n    exp.cv_hh_acty_int_sports_rec_hunting                           ,\n    exp.cv_hh_acty_int_sports_rec_fishing                           ,\n    exp.cv_hh_acty_int_sports_rec_nascar                            ,\n    exp.cv_hh_acty_int_sprt_fitness_exer                            ,\n    exp.cv_hh_acty_int_sportsscuba_diving                           ,\n    exp.cv_hh_acty_int_sportsfootball                               ,\n    exp.cv_hh_acty_int_sports_rec_golf                              ,\n    exp.cv_hh_acty_int_sportssnow_skng                              ,\n    exp.cv_hh_acty_int_boating_sailing                              ,\n    exp.cv_hh_acty_int_sports_rec_walking                           ,\n    exp.cv_hh_acty_int_sports_rec_cycling                           ,\n    exp.cv_hh_acty_int_sportsmotorcycles                            ,\n    exp.cv_hh_acty_int_running_jogging                              ,\n    exp.cv_hh_acty_int_sports_rec_soccer                            ,\n    exp.cv_hh_acty_int_sportsswimming                               ,\n    exp.cv_hh_acty_int_play_sprt_in_gen                             ,\n    exp.cv_hh_acty_int_sweepstakes                                  ,\n    exp.cv_hh_acty_int_swpstakes_loteries                           ,\n    exp.cv_hh_acty_int_casino_gambling                              ,\n    exp.cv_hh_acty_int_travel_cruise                                ,\n    exp.cv_hh_acty_int_trvl_inter                                   ,\n    exp.cv_hh_acty_int_travel_domestic                              ,\n    exp.cv_hh_acty_int_travel_time_share                            ,\n    exp.cv_hh_acty_int_trvl_rec_vehicle                             ,\n    exp.cv_hh_acty_int_rv_travel                                    ,\n    exp.cv_hh_acty_int_trvl_bus_trvl                                ,\n    exp.cv_hh_acty_int_trvl_per_trvl                                ,\n    exp.cv_hh_acty_int_pc_i_own_computer                            ,\n    exp.cv_hh_acty_int_pc__i_usedsl_hispd                           ,\n    exp.cv_hh_acty_int_pc_i_plan_buy_comp                           ,\n    exp.cv_hh_acty_int_eg_cell_phone                                ,\n    exp.cv_hh_acty_int_eg_com_disc_player                           ,\n    exp.cv_hh_acty_int_eg_dvd_player                                ,\n    exp.cv_hh_acty_int_eg_satellite_dish                            ,\n    exp.cv_hh_acty_int_eg_dig_cam                                   ,\n    exp.cv_hh_acty_int_eg_hdtv                                      ,\n    exp.cv_hh_acty_int_eg__electronics                              ,\n    exp.cv_hh_acty_int_eg_pda_blackberry                            ,\n    exp.cv_hh_acty_int_eg_video_camera                              ,\n    exp.cv_hh_acty_int_eg_video_game_sys                            ,\n    exp.cv_hh_acty_int_eg_hom_theater_sys                           ,\n    exp.cv_hh_acty_int_eg_cellph_priphln                            ,\n    exp.cv_hh_acty_int_cltrl_arts                                   ,\n    exp.cv_hh_acty_int_magzn_bus_fin                                ,\n    exp.cv_hh_acty_int_childrens_magzn                              ,\n    exp.cv_hh_acty_int_magzn_comp_elctrns                           ,\n    exp.cv_hh_acty_int_magzn_crft_gms_hob                           ,\n    exp.cv_hh_acty_int_magazines_fitness                            ,\n    exp.cv_hh_acty_int_mgzn_fd_wine_ckng                            ,\n    exp.cv_hh_acty_int_magzn_grdng_magzn                            ,\n    exp.cv_hh_acty_int_magzn_hntg_fshng                             ,\n    exp.cv_hh_acty_int_magazines_mens                               ,\n    exp.cv_hh_acty_int_magazines_music                              ,\n    exp.cv_hh_acty_int_mgzn_prtntg_babies                           ,\n    exp.cv_hh_acty_int_mgzn_sports_mgzn                             ,\n    exp.cv_hh_acty_int_magzn_subs                                   ,\n    exp.cv_hh_acty_int_magazines_travel                             ,\n    exp.cv_hh_acty_int_magazines_womens                             ,\n    exp.cv_hh_acty_int_magzn_cur_evnt_nws                           ,\n    exp.cv_hh_ls_veh_hav_leased_a_veh                               ,\n    exp.cv_hh_ls_veh_hav_purchased_a_veh                            ,\n    exp.cv_hh_ls_afltn_mem_book_club                                ,\n    exp.cv_hh_ls_afltn_mem_music_club                               ,\n    exp.cv_hh_ls_cc_amer_exp_prem                                   ,\n    exp.cv_hh_ls_cc_amer_exp_regular                                ,\n    exp.cv_hh_ls_cc_discover_premium                                ,\n    exp.cv_hh_ls_cc_discover_regular                                ,\n    exp.cv_hh_ls_cc_other_card_premium                              ,\n    exp.cv_hh_ls_cc_other_card_regular                              ,\n    exp.cv_hh_ls_cc_store_ret_reg                                   ,\n    exp.cv_hh_ls_cc_visa_regular                                    ,\n    exp.cv_hh_ls_cc_mastercard_regular                              ,\n    exp.cv_hh_ls_contri_hmntrn                                      ,\n    exp.cv_hh_ls_entmnt_buy_prercrdvideo                            ,\n    exp.cv_hh_ls_entmnt_wtch_cabletv                                ,\n    exp.cv_hh_ls_entmnt_watch_videos                                ,\n    exp.cv_hh_ls_outdoor_lvng_entmnt                                ,\n    exp.cv_hh_ls_entmnt_season_hldy_prod                            ,\n    exp.cv_hh_ls_fin_iras_future_intrst                             ,\n    exp.cv_hh_ls_fin_life_insur_cur                                 ,\n    exp.cv_hh_ls_fin_mutl_funds                                     ,\n    exp.cv_hh_ls_fin_othr_invest_cur                                ,\n    exp.cv_hh_ls_fin_othr_invest_future                             ,\n    exp.cv_hh_ls_fin_real_estate_fut                                ,\n    exp.cv_hh_ls_fin_stks_bond_fut                                  ,\n    exp.cv_hh_ls_grndkids_proud_grndprnt                            ,\n    exp.cv_hh_ls_info_byng_purc_by_intrnt                           ,\n    exp.cv_hh_ls_mil_gov_active_mil_mem                             ,\n    exp.cv_hh_ls_military_gov_vetern                                ,\n    exp.cv_hh_lifestyl_pets_own_a_cat                               ,\n    exp.cv_hh_lifestyl_pets_own_a_dog                               ,\n    exp.cv_hh_lifestyl_pets_own_a_pet                               ,\n    exp.cv_hh_ls_biy_internet                                       ,\n    exp.cv_hh_ls_bib_mail                                           ,\n    exp.cv_hh_ls_bib_catalog                                        ,\n    exp.cv_hh_ls_buying_interest_apparel                            ,\n    exp.cv_hh_ls_buying_intrst_comp_elec                            ,\n    exp.cv_hh_ls_buying_intrst_book_music                           ,\n    exp.cv_hh_ls_bi_home_garden                                     ,\n    exp.cv_hh_ls_bi_sports_related                                  ,\n    exp.cv_hh_ls_buying_interest_big_tall                           ,\n    exp.cv_hh_ls_byng_intrst_moc                                    ,\n    exp.cv_hh_ls_byng_intrst_mog                                    ,\n    exp.cv_hh_ls_bi_mail_order_gift                                 ,\n    exp.cv_hh_ls_byng_intrst_mjc                                    ,\n    exp.cv_hh_ls_bi_mail_music_videos                               ,\n    exp.cv_hh_ls_byng_intrst_mcp                                    ,\n    exp.cv_hh_ls_bi_mail_books_magzn                                ,\n    exp.cv_hh_ls_bi_food_and_beverage                               ,\n    exp.cv_hh_ls_bi_home_decorating                                 ,\n    exp.cv_hh_ls_bi_furniture                                       ,\n    exp.cv_hh_ls_bi_domestics                                       ,\n    exp.cv_hh_ls_buying_interest_footwear                           ,\n    exp.cv_hh_ml_ordr_apprl_acsries                                 ,\n    exp.cv_cape_age_pop_0_9                                         ,\n    exp.cv_cape_age_pop_0_24                                        ,\n    exp.cv_cape_age_pop_25_34                                       ,\n    exp.cv_cape_age_pop_35_44                                       ,\n    exp.cv_cape_age_pop_45_54                                       ,\n    exp.cv_cape_age_pop_55_64                                       ,\n    exp.cv_cape_age_pop_18_65                                       ,\n    exp.cv_cape_age_pop_75_99                                       ,\n    exp.cv_cape_pop_med_age_of_adults_18                            ,\n    exp.cv_cape_child_hh_fem_hh_fam_plt18                           ,\n    exp.cv_cape_child_hh_without_per_lt18                           ,\n    exp.cv_cape_cmte_com_travtowrk_60_89                            ,\n    exp.cv_cape_cmter_travtowork_90                                 ,\n    exp.cv_cape_cmter_avg_trav_timetowork                           ,\n    exp.cv_cape_cmter_med_trav_timetowork                           ,\n    exp.cv_cape_cmte_wrkrs_carpld_to_work                           ,\n    exp.cv_cape_emply_fem16_lbr_frce                                ,\n    exp.cv_cape_etnc_hh_nonhisp_whte_only                           ,\n    exp.cv_cape_etnc_pop_black_only_hisp                            ,\n    exp.cv_cape_etnc_pop_non_hispanic                               ,\n    exp.cv_cape_etnc_pop_white_only_hisp                            ,\n    exp.cv_cape_inc_hh_inc_under_10k                                ,\n    exp.cv_cape_inc_hh_inc_10_14k                                   ,\n    exp.cv_cape_inc_hh_inc_15_19k                                   ,\n    exp.cv_cape_inc_hh_inc_20_24k                                   ,\n    exp.cv_cape_inc_hh_inc_25_29k                                   ,\n    exp.cv_cape_inc_hh_inc_30_34k                                   ,\n    exp.cv_cape_inc_hh_inc_35_39k                                   ,\n    exp.cv_cape_inc_hh_inc_40_44k                                   ,\n    exp.cv_cape_inc_hh_inc_45_49k                                   ,\n    exp.cv_cape_inc_hh_inc_50_59k                                   ,\n    exp.cv_cape_inc_hh_inc_60_74k                                   ,\n    exp.cv_cape_inc_hh_inc_75_99k                                   ,\n    exp.cv_cape_inc_hh_inc_100_124k                                 ,\n    exp.cv_cape_inc_hh_inc_125_149k                                 ,\n    exp.cv_cape_inc_hh_inc_150_199k                                 ,\n    exp.cv_cape_inc_hh_inc_200_249k                                 ,\n    exp.cv_cape_inc_hh_inc_250_499k                                 ,\n    exp.cv_cape_inc_hh_incm_500k_more                               ,\n    exp.cv_cape_inc_hh_med_hh_inc                                   ,\n    exp.cv_cape_inc_hh_med_non_fam_hh_inc                           ,\n    exp.cv_cape_inc_pop_per_capita_income                           ,\n    exp.cv_cape_ind_empld_acmdn_food_svcs                           ,\n    exp.cv_cape_ind_empld_adm_supwstemgmt                           ,\n    exp.cv_cape_ind_empld_agr_fst_fsh_hnt                           ,\n    exp.cv_cape_ind_empld_arts_entmnt                               ,\n    exp.cv_cape_indus_empld_construction                            ,\n    exp.cv_cape_ind_empld_edu_srvs                                  ,\n    exp.cv_cape_ind_empld_fin_and_ins                               ,\n    exp.cv_cape_indus_empld_hc_soc_ass                              ,\n    exp.cv_cape_indus_empld_information                             ,\n    exp.cv_cape_indus_empld_manufacturing                           ,\n    exp.cv_cape_ind_empld_mgmt_com_entrps                           ,\n    exp.cv_cape_indus_empld_mining                                  ,\n    exp.cv_cape_ind_empld_oth_svcs                                  ,\n    exp.cv_cape_ind_empld_public_admin                              ,\n    exp.cv_cape_ind_empld_rer_lsng                                  ,\n    exp.cv_cape_indus_empld_retail_trade                            ,\n    exp.cv_cape_ind_empld_prof_sc_tch_scs                           ,\n    exp.cv_cape_ind_empld_trans_wh                                  ,\n    exp.cv_cape_indus_empld_utilities                               ,\n    exp.cv_cape_ind_empld_wholesale_trade                           ,\n    exp.cv_cape_mrtg_oohu_first_mrtg_only                           ,\n    exp.cv_cape_move_occhu_med_len_res                              ,\n    exp.cv_cape_rent_rntl_median_rent                               ,\n    exp.cv_cape_tenancy_hu_occupied                                 ,\n    exp.cv_cape_typ_pop_child_in_fam_hh                             ,\n    exp.cv_cape_typ_pop_in_family_hh                                ,\n    exp.cv_cape_typ_pop_in_non_family_hh                            ,\n    exp.cv_cape_pop_nat_adpt_child_fam_hh                           ,\n    exp.cv_cape_typ_pop_spouse_in_fam_hh                            ,\n    exp.cv_cape_urban_pop_rural_on_farms                            ,\n    exp.cv_cape_urban_pop_rur_not_on_frms                           ,\n    exp.cv_cape_urban_pop_in_urban_area                             ,\n    exp.cv_cape_urban_pop_in_urban_clstrs                           ,\n    exp.cv_cape_inc_fam_inc_state_indx                              ,\n    exp.cv_prop_rlty_home_year_built                                ,\n    exp.cv_mrtg_home_pur_mrtg_term                                  ,\n    exp.cv_mrtg_home_pur_home_pur_date                              ,\n    exp.cv_mrtg_home_pur_mrtg_rate_type                             ,\n    exp.cv_mrtg_home_pur_mrtg_loan_type                             ,\n    exp.cv_mrtg_home_purc_type_of_purc                              ,\n    exp.cv_mrtg_home_pur_pur_amt_rng                                ,\n    exp.cv_mrtg_home_pur_mrtg_amt_rng                               ,\n    exp.cv_rlty_mdl_confdnce_cdv2                                   ,\n    exp.cv_rlty_mdl_est_avl_equity_cd_v2                            ,\n    exp.cv_rlty_mdl_est_avl_equity_amt_v2                           ,\n    exp.cv_rlty_mdl_est_cur_lntoval_ratv2                           ,\n    exp.cv_rlty_mdl_est_cur_mrtg_pmtv21                             ,\n    exp.cv_rlty_mdl_est_cur_mrtg_pmtv22                             ,\n    exp.cv_rlty_mdl_est_cur_mrtg_amtcdv2                            ,\n    exp.cv_rlty_mdl_est_cur_mrtg_am_v2                              ,\n\n    exp.geo_zipcode                                                 ,\n    exp.geo_kroger_banner                                           ,\n    exp.geo_all_other_kroger                                        ,\n    exp.geo_albertsons_safeway                                      ,\n    exp.geo_publix                                                  ,\n    exp.geo_ahold_delhaize                                          ,\n    exp.geo_wakefern                                                ,\n    exp.geo_hy_vee                                                  ,\n    exp.geo_heb                                                     ,\n    exp.geo_whole_foods                                             ,\n    exp.geo_aldi                                                    ,\n    exp.geo_trader_joes                                             ,\n    exp.geo_bi_lo                                                   ,\n    exp.geo_all_other_grocery                                       ,\n    exp.geo_cvs                                                     ,\n    exp.geo_walgreens                                               ,\n    exp.geo_all_other_drug                                          ,\n    exp.geo_target                                                  ,\n    exp.geo_wm_neighborhood_market                                  ,\n    exp.geo_all_other_walmart                                       ,\n    exp.geo_all_other_mass                                          ,\n    exp.geo_costco                                                  ,\n    exp.geo_bjs                                                     ,\n    exp.geo_sams_club                                               ,\n    exp.geo_all_other_club                                          ,\n    exp.geo_total_c_and_g                                           ,\n    exp.geo_7_eleven                                                ,\n    exp.geo_circle_k                                                ,\n    exp.geo_speedway                                                ,\n    exp.geo_all_other_c_and_g                                       ,\n    exp.geo_dollar_general                                          ,\n    exp.geo_family_dollar                                           ,\n    exp.geo_all_other_dollar                                        ,\n    exp.geo_amazon_com                                              ,\n    exp.geo_walmart_com                                             ,\n    exp.geo_all_other_ao,\n    exp.geo_not_assigned,\n\n    exp.is_7_eleven,\n    exp.is_ahold_delhaize,\n    exp.is_albertsons,\n    exp.is_aldi,\n    exp.is_amazon_com,\n    exp.is_bi_lo,\n    exp.is_bjs,\n    exp.is_circle_k,\n    exp.is_costco,\n    exp.is_cvs,\n    exp.is_dollar_general,\n    exp.is_family_dollar,\n    exp.is_heb,\n    exp.is_speedway,\n    exp.is_hy_vee,\n    exp.is_kroger_banner,\n    exp.is_all_other_kroger,\n    exp.is_all_other_club,\n    exp.is_all_other_dollar,\n    exp.is_all_other_drug,\n    exp.is_all_other_c_and_g,\n    exp.is_all_other_grocery,\n    exp.is_all_other_mass,\n    exp.is_publix,\n    exp.is_sams_club,\n    exp.is_target,\n    exp.is_trader_joes,\n    exp.is_wakefern,\n    exp.is_walgreens,\n    exp.is_walmart_com,\n    exp.is_wm_neighborhood_market,\n    exp.is_all_other_walmart,\n    exp.is_whole_foods,\n\n    exp.is_all_other_ao,\n    exp.is_not_assigned,\n\n    exp.is_target_com,\n    exp.is_kroger_com,\n    exp.is_kmart_com,\n    exp.is_walgreens_com,\n    exp.is_samsclub_com,\n    exp.is_costco_com,\n\n    exp.hh_size                                                     ,\n    exp.hoh_age                                                     ,\n    exp.hoh_lifestage                                               ,\n    exp.hoh_ethnicity                                               ,\n    exp.hoh_hispanic                                                ,\n    exp.hh_income                                                   ,\n    exp.hh_per_cap_income                                           ,\n    exp.hh_presence_of_child                                        ,\n    exp.hh_presence_of_child_age_0_6                                ,\n    exp.hh_presence_of_child_age_7_12                               ,\n    exp.hh_presence_of_child_age_13_18                              ,\n    exp.hh_age_of_old_child                                         ,\n    exp.hh_presence_of_gender                                       ,\n    exp.hh_millennial_male                                          ,\n    exp.hh_millennial_female                                        ,\n    exp.hh_gen_x_male                                               ,\n    exp.hh_gen_x_female                                             ,\n    exp.hh_young_boomer_male                                        ,\n    exp.hh_young_boomer_female                                      ,\n    exp.hh_post_boomer_male                                         ,\n    exp.hh_post_boomer_female                                       ,\n    exp.hh_county_size                                              ,\n    exp.hh_urban_suburban_rural                                     ,\n    exp.hh_county                                                   ,\n    exp.hh_state                                                    ,\n    exp.hh_cbsa                                                     ,\n    fvh.fv_ls_num AS fvh_cur_lifestage                              ,\n    fvh.fv_current_spend AS fvh_cur_pred_spend                      ,\n    fvh.fv_future_spend AS fvh_fut_pred_spend                       ,\n    fvh.fv_growth_rate\nFROM {{ ref('exp_geo_is_cg') }} exp,\n     {{ ref('fvh_cs_fs') }} fvh\nWHERE exp.cv_living_unit_id = fvh.fv_living_unit_id", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "exp_geo_is_cg_fvh"], "unique_id": "model.sdna_project.exp_geo_is_cg_fvh", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/exp_geo_is_cg_fvh.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/exp_geo_is_cg_fvh.sql", "name": "exp_geo_is_cg_fvh", "resource_type": "model", "alias": "exp_geo_is_cg_fvh", "checksum": {"name": "sha256", "checksum": "49a4ea763a74dd180e926aa80fb110c1f29e0aae1f6b22187913e80b6f8b2bf6"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is_cg"], ["fvh_cs_fs"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is_cg", "model.sdna_project.fvh_cs_fs"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_cluster": {"raw_sql": "-- TO LOAD THE CLUSTER SEGMENTATION FOR EACH HOUSEHOLD\n\nSELECT\n    fv_living_unit_id          ,\n    fv_no_kids                 ,\n    fv_babies_only             ,\n    fv_small_kids_only         ,\n    fv_teens_only              ,\n    fv_babies_small_kids_only  ,\n    fv_babies_teens_only       ,\n    fv_small_kids_teens_only   ,\n    fv_have_all_kid            ,\n    fv_hh_type_single          ,\n    fv_hh_type_couple          ,\n    fv_hh_type_wkids           ,\n    fv_hh_type_wokids          ,\n    fv_hhdsize_1               ,\n    fv_hhdsize_2               ,\n    fv_hhdsize_3               ,\n    fv_hhdsize_4               ,\n    fv_hhdsize_5               ,\n    fv_hhdsize_6               ,\n    fv_hhdsize_7               ,\n    fv_hhdsize_8_plus          ,\n    fv_housing_other           ,\n    fv_housing_own             ,\n    fv_inc_lt_10k              ,\n    fv_inc_1011k               ,\n    fv_inc_1214k               ,\n    fv_inc_1519k               ,\n    fv_inc_2024k               ,\n    fv_inc_2534k               ,\n    fv_inc_3544k               ,\n    fv_inc_4549k               ,\n    fv_inc_5059k               ,\n    fv_inc_6069k               ,\n    fv_inc_7099k               ,\n    fv_inc_100k_plus           ,\n    fv_marital_status_single   ,\n    fv_marital_status_married  ,\n    fv_marital_status_other    ,\n    fv_age_1824                ,\n    fv_age_2534                ,\n    fv_age_3544                ,\n    fv_age_4554                ,\n    fv_age_5564                ,\n    fv_age_65_plus             ,\n    fv_edu_other               ,\n    fv_edu_grad                ,\n    fv_edu_hs                  ,\n    fv_edu_college             ,\n    fv_occup_other             ,\n    fv_occup_bluecollar        ,\n    fv_occup_skilled           ,\n    fv_occup_whitecollar       ,\n    fv_reg_mw                  ,\n    fv_reg_s                   ,\n    fv_reg_w                   ,\n    fv_reg_ne                  ,\n    fv_race_white_nonh         ,\n    fv_race_aa_nonh            ,\n    fv_race_hisp               ,\n    fv_race_asian_nonh         ,\n    fv_race_othr_nonh          ,\n    fv_hh_size                 ,\n    fv_hh_income               ,\n    fv_hoh_age                 ,\n    -- fv_cluster                 ,\n    cluster_grp_1 + cluster_grp_2 + cluster_grp_3 AS fv_cluster\nFROM (\n    SELECT\n        fv_living_unit_id          ,\n        fv_no_kids                 ,\n        fv_babies_only             ,\n        fv_small_kids_only         ,\n        fv_teens_only              ,\n        fv_babies_small_kids_only  ,\n        fv_babies_teens_only       ,\n        fv_small_kids_teens_only   ,\n        fv_have_all_kid            ,\n        fv_hh_type_single          ,\n        fv_hh_type_couple          ,\n        fv_hh_type_wkids           ,\n        fv_hh_type_wokids          ,\n        fv_hhdsize_1               ,\n        fv_hhdsize_2               ,\n        fv_hhdsize_3               ,\n        fv_hhdsize_4               ,\n        fv_hhdsize_5               ,\n        fv_hhdsize_6               ,\n        fv_hhdsize_7               ,\n        fv_hhdsize_8_plus          ,\n        fv_housing_other           ,\n        fv_housing_own             ,\n        fv_inc_lt_10k              ,\n        fv_inc_1011k               ,\n        fv_inc_1214k               ,\n        fv_inc_1519k               ,\n        fv_inc_2024k               ,\n        fv_inc_2534k               ,\n        fv_inc_3544k               ,\n        fv_inc_4549k               ,\n        fv_inc_5059k               ,\n        fv_inc_6069k               ,\n        fv_inc_7099k               ,\n        fv_inc_100k_plus           ,\n        fv_marital_status_single   ,\n        fv_marital_status_married  ,\n        fv_marital_status_other    ,\n        fv_age_1824                ,\n        fv_age_2534                ,\n        fv_age_3544                ,\n        fv_age_4554                ,\n        fv_age_5564                ,\n        fv_age_65_plus             ,\n        fv_edu_other               ,\n        fv_edu_grad                ,\n        fv_edu_hs                  ,\n        fv_edu_college             ,\n        fv_occup_other             ,\n        fv_occup_bluecollar        ,\n        fv_occup_skilled           ,\n        fv_occup_whitecollar       ,\n        fv_reg_mw                  ,\n        fv_reg_s                   ,\n        fv_reg_w                   ,\n        fv_reg_ne                  ,\n        fv_race_white_nonh         ,\n        fv_race_aa_nonh            ,\n        fv_race_hisp               ,\n        fv_race_asian_nonh         ,\n        fv_race_othr_nonh          ,\n        fv_hh_size                 ,\n        fv_hh_income               ,\n        fv_hoh_age                 ,\n        -- fv_cluster                 ,\n        IFF (fv_marital_status_married = 1 AND fv_hh_type_couple = 0\n            --THEN\n            ,IFF (fv_babies_only = 0\n              --THEN\n              ,IFF (fv_race_hisp = 0\n                --THEN\n                ,IFF (fv_race_asian_nonh = 0\n                  --THEN\n                  ,IFF (fv_race_aa_nonh = 0\n                    --THEN\n                   ,IFF (fv_hhdsize_3 = 0\n                     --THEN\n                     ,IFF (fv_age_4554 = 0\n                       --THEN\n                       ,IFF (fv_age_5564 = 0\n                         --THEN\n                         ,22\n                         --ELSE\n                         ,16\n                        )\n                       --ELSE\n                       ,15\n                      )\n                     --ELSE\n                     ,14\n                    )\n                    --ELSE\n                    ,20\n                 )\n                 --ELSE\n                 ,21\n                 )\n                --ELSE\n                ,18\n               )\n              --ELSE\n              ,17\n             )\n            --ELSE\n            ,0\n           ) AS cluster_grp_1,\n\n        IFF (fv_marital_status_married = 1 AND fv_hh_type_couple = 1\n            --THEN\n            ,IFF (fv_race_asian_nonh = 0\n              --THEN\n              ,IFF (fv_race_aa_nonh = 0\n                --THEN\n                ,IFF (fv_race_hisp = 0\n                  --THEN\n                  ,IFF (fv_age_5564 = 0\n                    --THEN\n                    ,IFF (fv_age_4554 = 0\n                      --THEN\n                      ,IFF (fv_age_65_plus = 0\n                        --THEN\n                        ,8\n                        --ELSE\n                        ,9\n                       )\n                      --ELSE\n                      ,7\n                     )\n                     --ELSE\n                     ,IFF (fv_inc_100k_plus = 0\n                       --THEN\n                       ,6\n                       --ELSE\n                       ,5\n                      )\n                   )\n                  --ELSE\n                  ,10\n                 )\n                --ELSE\n                ,11\n               )\n              --ELSE\n              ,12\n             )\n            --ELSE\n            ,0\n           ) AS cluster_grp_2,\n\n        IFF (fv_marital_status_married = 0\n            --THEN\n            ,IFF (fv_hh_type_wkids = 0\n             --THEN\n             ,IFF (fv_hh_type_wokids = 0\n               --THEN\n               ,IFF (fv_hh_type_couple = 0\n                 --THEN\n                 ,IFF (fv_age_65_plus = 0\n                   --THEN\n                   ,IFF (fv_race_asian_nonh = 0\n                     --THEN\n                     ,IFF (fv_race_aa_nonh = 0\n                       --THEN\n                       ,4\n                       --ELSE\n                       ,3\n                      )\n                     --ELSE\n                     ,2\n                    )\n                   --ELSE\n                   ,1\n                  )\n                 --ELSE\n                 ,13\n                )\n               --ELSE\n               ,23\n              )\n             --ELSE\n             ,19\n             )\n            --ELSE\n            ,0\n           ) AS cluster_grp_3\n        FROM {{ ref('exp_fvh') }}\n) clusters", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_cluster"], "unique_id": "model.sdna_project.fvh_cluster", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_cluster.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_cluster.sql", "name": "fvh_cluster", "resource_type": "model", "alias": "fvh_cluster", "checksum": {"name": "sha256", "checksum": "ed34b5bd72d30bd3a173e28c8db6bd21be6ed88a16d1144e80f546d8a70351a3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_fvh"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_fvh"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_cs_fs": {"raw_sql": "--LOADING FINAL FVH TABLE WITH CURRENT LIFE STAGE, CURRENT SPEND, FUTURE SPEND\n\nSELECT\n    prob.fv_living_unit_id,\n    lst.ls_num             as fv_ls_num,\n    lst.ls_description     as fv_ls_description,\n    prob.current_spend     as fv_current_spend,\n    (prob.current_spend / lst.avg_current_spend)   *\n    (prob.pb_solo_retiree                          *  lst.fs_solo_retiree                          +\n     prob.pb_thriving_asian_singles                *  lst.fs_thriving_asian_singles                +\n     prob.pb_struggling_african_american_singles   *  lst.fs_struggling_african_american_singles   +\n     prob.pb_affluent_couples                      *  lst.fs_affluent_couples                      +\n     prob.pb_mixed_ethnic_solos                    *  lst.fs_mixed_ethnic_solos                    +\n     prob.pb_thriving_established_couples          *  lst.fs_thriving_established_couples          +\n     prob.pb_middle_aged_couples                   *  lst.fs_middle_aged_couples                   +\n     prob.pb_younger_working_couples               *  lst.fs_younger_working_couples               +\n     prob.pb_retired_couples                       *  lst.fs_retired_couples                       +\n     prob.pb_established_hispanics_couples         *  lst.fs_established_hispanics_couples         +\n     prob.pb_thriving_african_american_couples     *  lst.fs_thriving_african_american_couples     +\n     prob.pb_affluent_asian_couples                *  lst.fs_affluent_asian_couples                +\n     prob.pb_mixed_struggling_couples              *  lst.fs_mixed_struggling_couples              +\n     prob.pb_midage_3_person_families              *  lst.fs_midage_3_person_families              +\n     prob.pb_midage_two_income_families            *  lst.fs_midage_two_income_families            +\n     prob.pb_older_established_families            *  lst.fs_older_established_families            +\n     prob.pb_thriving_young_large_families         *  lst.fs_thriving_young_large_families         +\n     prob.pb_thriving_hispanic_families            *  lst.fs_thriving_hispanic_families            +\n     prob.pb_struggling_african_american_families  *  lst.fs_struggling_african_american_families  +\n     prob.pb_thriving_african_american_families    *  lst.fs_thriving_african_american_families    +\n     prob.pb_affluent_asian_families               *  lst.fs_affluent_asian_families               +\n     prob.pb_new_families                          *  lst.fs_new_families                          +\n     prob.pb_midsized_families_wo_kids             *  lst.fs_midsized_families_wo_kids             ) AS fv_future_spend,\n    (((prob.current_spend / lst.avg_current_spend) *\n    (prob.pb_solo_retiree                          *  lst.fs_solo_retiree                          +\n     prob.pb_thriving_asian_singles                *  lst.fs_thriving_asian_singles                +\n     prob.pb_struggling_african_american_singles   *  lst.fs_struggling_african_american_singles   +\n     prob.pb_affluent_couples                      *  lst.fs_affluent_couples                      +\n     prob.pb_mixed_ethnic_solos                    *  lst.fs_mixed_ethnic_solos                    +\n     prob.pb_thriving_established_couples          *  lst.fs_thriving_established_couples          +\n     prob.pb_middle_aged_couples                   *  lst.fs_middle_aged_couples                   +\n     prob.pb_younger_working_couples               *  lst.fs_younger_working_couples               +\n     prob.pb_retired_couples                       *  lst.fs_retired_couples                       +\n     prob.pb_established_hispanics_couples         *  lst.fs_established_hispanics_couples         +\n     prob.pb_thriving_african_american_couples     *  lst.fs_thriving_african_american_couples     +\n     prob.pb_affluent_asian_couples                *  lst.fs_affluent_asian_couples                +\n     prob.pb_mixed_struggling_couples              *  lst.fs_mixed_struggling_couples              +\n     prob.pb_midage_3_person_families              *  lst.fs_midage_3_person_families              +\n     prob.pb_midage_two_income_families            *  lst.fs_midage_two_income_families            +\n     prob.pb_older_established_families            *  lst.fs_older_established_families            +\n     prob.pb_thriving_young_large_families         *  lst.fs_thriving_young_large_families         +\n     prob.pb_thriving_hispanic_families            *  lst.fs_thriving_hispanic_families            +\n     prob.pb_struggling_african_american_families  *  lst.fs_struggling_african_american_families  +\n     prob.pb_thriving_african_american_families    *  lst.fs_thriving_african_american_families    +\n     prob.pb_affluent_asian_families               *  lst.fs_affluent_asian_families               +\n     prob.pb_new_families                          *  lst.fs_new_families                          +\n     prob.pb_midsized_families_wo_kids             *  lst.fs_midsized_families_wo_kids             )) - prob.current_spend) / prob.current_spend AS fv_growth_rate\nFROM {{ ref('fvh_probability') }} prob,\n     {{ ref('fvh_life_stage_stg') }} lst\nWHERE prob.ls_num = lst.ls_num", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_cs_fs"], "unique_id": "model.sdna_project.fvh_cs_fs", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_cs_fs.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_cs_fs.sql", "name": "fvh_cs_fs", "resource_type": "model", "alias": "fvh_cs_fs", "checksum": {"name": "sha256", "checksum": "d92f58779d84ed9b52336d6cb1439cf0adbeeb87ec138691bbd77cb5acbf1bc3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_probability"], ["fvh_life_stage_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_probability", "model.sdna_project.fvh_life_stage_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_currentspend": {"raw_sql": "-- TO LOAD THE CURRENT SPEND TRIP COUNT FOR EACH HOUSEHOLD\n\nSELECT\n    hh.fv_living_unit_id          ,\n    hh.fv_no_kids                 ,\n    hh.fv_babies_only             ,\n    hh.fv_small_kids_only         ,\n    hh.fv_teens_only              ,\n    hh.fv_babies_small_kids_only  ,\n    hh.fv_babies_teens_only       ,\n    hh.fv_small_kids_teens_only   ,\n    hh.fv_have_all_kid            ,\n    hh.fv_hh_type_single          ,\n    hh.fv_hh_type_couple          ,\n    hh.fv_hh_type_wkids           ,\n    hh.fv_hh_type_wokids          ,\n    hh.fv_hhdsize_1               ,\n    hh.fv_hhdsize_2               ,\n    hh.fv_hhdsize_3               ,\n    hh.fv_hhdsize_4               ,\n    hh.fv_hhdsize_5               ,\n    hh.fv_hhdsize_6               ,\n    hh.fv_hhdsize_7               ,\n    hh.fv_hhdsize_8_plus          ,\n    hh.fv_housing_other           ,\n    hh.fv_housing_own             ,\n    hh.fv_inc_lt_10k              ,\n    hh.fv_inc_1011k               ,\n    hh.fv_inc_1214k               ,\n    hh.fv_inc_1519k               ,\n    hh.fv_inc_2024k               ,\n    hh.fv_inc_2534k               ,\n    hh.fv_inc_3544k               ,\n    hh.fv_inc_4549k               ,\n    hh.fv_inc_5059k               ,\n    hh.fv_inc_6069k               ,\n    hh.fv_inc_7099k               ,\n    hh.fv_inc_100k_plus           ,\n    hh.fv_marital_status_single   ,\n    hh.fv_marital_status_married  ,\n    hh.fv_marital_status_other    ,\n    hh.fv_age_1824                ,\n    hh.fv_age_2534                ,\n    hh.fv_age_3544                ,\n    hh.fv_age_4554                ,\n    hh.fv_age_5564                ,\n    hh.fv_age_65_plus             ,\n    hh.fv_edu_other               ,\n    hh.fv_edu_grad                ,\n    hh.fv_edu_hs                  ,\n    hh.fv_edu_college             ,\n    hh.fv_occup_other             ,\n    hh.fv_occup_bluecollar        ,\n    hh.fv_occup_skilled           ,\n    hh.fv_occup_whitecollar       ,\n    hh.fv_reg_mw                  ,\n    hh.fv_reg_s                   ,\n    hh.fv_reg_w                   ,\n    hh.fv_reg_ne                  ,\n    hh.fv_race_white_nonh         ,\n    hh.fv_race_aa_nonh            ,\n    hh.fv_race_hisp               ,\n    hh.fv_race_asian_nonh         ,\n    hh.fv_race_othr_nonh          ,\n    hh.fv_hh_size                 ,\n    hh.fv_hh_income               ,\n    hh.fv_hoh_age                 ,\n    hh.fv_cluster                 ,\n    -- hh.fv_current_spend\n    EXP(\n      ce.fv_intercept\n    + ce.fv_age_1824 * hh.fv_age_1824\n    + ce.fv_age_3544 * hh.fv_age_3544\n    + ce.fv_age_4554 * hh.fv_age_4554\n    + ce.fv_age_5564 * hh.fv_age_5564\n    + ce.fv_age_65_plus * hh.fv_age_65_plus\n    + ce.fv_edu_college * hh.fv_edu_college\n    + ce.fv_small_kids_only * hh.fv_small_kids_only\n    + ce.fv_teens_only * hh.fv_teens_only\n    + ce.fv_babies_small_kids_only * hh.fv_babies_small_kids_only\n    + ce.fv_babies_teens_only * hh.fv_babies_teens_only\n    + ce.fv_small_kids_teens_only * hh.fv_small_kids_teens_only\n    + ce.fv_have_all_kid * hh.fv_have_all_kid\n    + ce.fv_hhdsize_3 * hh.fv_hhdsize_3\n    + ce.fv_hhdsize_4 * hh.fv_hhdsize_4\n    + ce.fv_hhdsize_5 * hh.fv_hhdsize_5\n    + ce.fv_hhdsize_6 * hh.fv_hhdsize_6\n    + ce.fv_hhdsize_7 * hh.fv_hhdsize_7\n    + ce.fv_hhdsize_8_plus * hh.fv_hhdsize_8_plus\n    + ce.fv_housing_own * hh.fv_housing_own\n    + ce.fv_inc_lt_10k * hh.fv_inc_lt_10k\n    + ce.fv_inc_1011k * hh.fv_inc_1011k\n    + ce.fv_inc_1214k * hh.fv_inc_1214k\n    + ce.fv_inc_1519k * hh.fv_inc_1519k\n    + ce.fv_inc_2024k * hh.fv_inc_2024k\n    + ce.fv_inc_3544k * hh.fv_inc_3544k\n    + ce.fv_inc_4549k * hh.fv_inc_4549k\n    + ce.fv_inc_5059k * hh.fv_inc_5059k\n    + ce.fv_inc_6069k * hh.fv_inc_6069k\n    + ce.fv_inc_7099k * hh.fv_inc_7099k\n    + ce.fv_inc_100k_plus * hh.fv_inc_100k_plus\n    + ce.fv_occup_bluecollar * hh.fv_occup_bluecollar\n    + ce.fv_occup_skilled * hh.fv_occup_skilled\n    + ce.fv_occup_whitecollar * hh.fv_occup_whitecollar\n    + ce.fv_race_aa_nonh * hh.fv_race_aa_nonh\n    + ce.fv_race_asian_nonh * hh.fv_race_asian_nonh\n    + ce.fv_race_hisp * hh.fv_race_hisp\n    + ce.fv_race_othr_nonh * hh.fv_race_othr_nonh\n    + ce.fv_reg_mw * hh.fv_reg_mw\n    + ce.fv_reg_s * hh.fv_reg_s\n    + ce.fv_reg_w * hh.fv_reg_w\n    + ce.fv_edu_grad * hh.fv_edu_grad\n    + ce.fv_edu_hs * hh.fv_edu_hs\n    + ce.fv_hh_type_couple * hh.fv_hh_type_couple\n    + ce.fv_hh_type_wkids * hh.fv_hh_type_wkids\n    + ce.fv_hh_type_wokids * hh.fv_hh_type_wokids\n    + ce.fv_babies_only * hh.fv_babies_only\n    + ce.fv_marital_status_married * hh.fv_marital_status_married\n    + ce.fv_marital_status_other * hh.fv_marital_status_other\n    ) as fv_current_spend\nFROM {{ ref('fvh_cluster') }} hh,\n     {{ ref('fvh_cs_coeff_raw') }} ce\nWHERE  ce.fv_cluster = hh.fv_cluster", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_currentspend"], "unique_id": "model.sdna_project.fvh_currentspend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_currentspend.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_currentspend.sql", "name": "fvh_currentspend", "resource_type": "model", "alias": "fvh_currentspend", "checksum": {"name": "sha256", "checksum": "297e296411beb8836e09bc1789a423664f2dcdb1a382ffe40edeb088bad458fd"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_cluster"], ["fvh_cs_coeff_raw"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_cluster", "model.sdna_project.fvh_cs_coeff_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_life_stage_stg": {"raw_sql": "-- SELECTING THE FINAL VALUES THAT WILL BE POPULATED TO THE TABLE\nSELECT\n    ls_raw.ls_num,\n    ls_raw.ls_description,\n    ls_raw.growth_rate,\n    ls_raw.avg_current_spend,\n    ls_raw_transpose.solo_retiree                         as fs_solo_retiree,\n    ls_raw_transpose.thriving_asian_singles               as fs_thriving_asian_singles,\n    ls_raw_transpose.struggling_african_american_singles  as fs_struggling_african_american_singles,\n    ls_raw_transpose.affluent_couples                     as fs_affluent_couples,\n    ls_raw_transpose.mixed_ethnic_solos                   as fs_mixed_ethnic_solos,\n    ls_raw_transpose.thriving_established_couples         as fs_thriving_established_couples,\n    ls_raw_transpose.middle_aged_couples                  as fs_middle_aged_couples,\n    ls_raw_transpose.younger_working_couples              as fs_younger_working_couples,\n    ls_raw_transpose.retired_couples                      as fs_retired_couples,\n    ls_raw_transpose.established_hispanics_couples        as fs_established_hispanics_couples,\n    ls_raw_transpose.thriving_african_american_couples    as fs_thriving_african_american_couples,\n    ls_raw_transpose.affluent_asian_couples               as fs_affluent_asian_couples,\n    ls_raw_transpose.mixed_struggling_couples             as fs_mixed_struggling_couples,\n    ls_raw_transpose.midage_3_person_families             as fs_midage_3_person_families,\n    ls_raw_transpose.midage_two_income_families           as fs_midage_two_income_families,\n    ls_raw_transpose.older_established_families           as fs_older_established_families,\n    ls_raw_transpose.thriving_young_large_families        as fs_thriving_young_large_families,\n    ls_raw_transpose.thriving_hispanic_families           as fs_thriving_hispanic_families,\n    ls_raw_transpose.struggling_african_american_families as fs_struggling_african_american_families,\n    ls_raw_transpose.thriving_african_american_families   as fs_thriving_african_american_families,\n    ls_raw_transpose.affluent_asian_families              as fs_affluent_asian_families,\n    ls_raw_transpose.new_families                         as fs_new_families,\n    ls_raw_transpose.midsized_families_wo_kids            as fs_midsized_families_wo_kids,\n    current_timestamp()                                   as last_updt_dt\nFROM {{ ref('fvh_life_stage_raw') }} ls_raw,\n         -- SUB QUERY - TO GET ONLY THE CALCULATED FUTURE SPEND FOR ALL 23 LIFE STAGES\n     (SELECT\n         MAX(CASE   ls_raw_fs.ls_num WHEN 1  THEN fs_future_spend ELSE 0 END) AS solo_retiree                        ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 2  THEN fs_future_spend ELSE 0 END) AS thriving_asian_singles              ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 3  THEN fs_future_spend ELSE 0 END) AS struggling_african_american_singles ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 4  THEN fs_future_spend ELSE 0 END) AS mixed_ethnic_solos                  ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 5  THEN fs_future_spend ELSE 0 END) AS affluent_couples                    ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 6  THEN fs_future_spend ELSE 0 END) AS thriving_established_couples        ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 7  THEN fs_future_spend ELSE 0 END) AS middle_aged_couples                 ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 8  THEN fs_future_spend ELSE 0 END) AS younger_working_couples             ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 9  THEN fs_future_spend ELSE 0 END) AS retired_couples                     ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 10 THEN fs_future_spend ELSE 0 END) AS established_hispanics_couples       ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 11 THEN fs_future_spend ELSE 0 END) AS thriving_african_american_couples   ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 12 THEN fs_future_spend ELSE 0 END) AS affluent_asian_couples              ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 13 THEN fs_future_spend ELSE 0 END) AS mixed_struggling_couples            ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 14 THEN fs_future_spend ELSE 0 END) AS midage_3_person_families            ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 15 THEN fs_future_spend ELSE 0 END) AS midage_two_income_families          ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 16 THEN fs_future_spend ELSE 0 END) AS older_established_families          ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 17 THEN fs_future_spend ELSE 0 END) AS thriving_young_large_families       ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 18 THEN fs_future_spend ELSE 0 END) AS thriving_hispanic_families          ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 19 THEN fs_future_spend ELSE 0 END) AS struggling_african_american_families,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 20 THEN fs_future_spend ELSE 0 END) AS thriving_african_american_families  ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 21 THEN fs_future_spend ELSE 0 END) AS affluent_asian_families             ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 22 THEN fs_future_spend ELSE 0 END) AS new_families                        ,\n         MAX(CASE   ls_raw_fs.ls_num WHEN 23 THEN fs_future_spend ELSE 0 END) AS midsized_families_wo_kids\n         FROM (\n             SELECT\n                ls_num                  ,\n                ls_description          ,\n                growth_rate             ,\n                avg_current_spend       ,\n                (POW(growth_rate, 5) * avg_current_spend) AS fs_future_spend\n             FROM {{ ref('fvh_life_stage_raw') }}\n         ) AS ls_raw_fs\n     ) AS ls_raw_transpose", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_life_stage_stg"], "unique_id": "model.sdna_project.fvh_life_stage_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_life_stage_stg.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_life_stage_stg.sql", "name": "fvh_life_stage_stg", "resource_type": "model", "alias": "fvh_life_stage_stg", "checksum": {"name": "sha256", "checksum": "d9d6570456970b838b961b4cc62e253f4f1bb3528734702dab8c2f2e85a69747"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_life_stage_raw"], ["fvh_life_stage_raw"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_life_stage_raw", "model.sdna_project.fvh_life_stage_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_probability": {"raw_sql": "SELECT\n    tv.fv_living_unit_id as fv_living_unit_id,\n    tv.fv_cluster        as ls_num,\n    fv_current_spend     as current_spend,\n    --DIV0 USED TO OVERCOME DIVIDE BY ZERO\n    DIV0(p_ls1,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_solo_retiree,\n    DIV0(p_ls2,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_asian_singles,\n    DIV0(p_ls3,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_struggling_african_american_singles,\n    DIV0(p_ls4,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_affluent_couples,\n    DIV0(p_ls5,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_mixed_ethnic_solos,\n    DIV0(p_ls6,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_established_couples,\n    DIV0(p_ls7,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_middle_aged_couples,\n    DIV0(p_ls8,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_younger_working_couples,\n    DIV0(p_ls9,  (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_retired_couples,\n    DIV0(p_ls10, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_established_hispanics_couples,\n    DIV0(p_ls11, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_african_american_couples,\n    DIV0(p_ls12, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_affluent_asian_couples,\n    DIV0(p_ls13, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_mixed_struggling_couples,\n    DIV0(p_ls14, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_midage_3_person_families,\n    DIV0(p_ls15, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_midage_two_income_families,\n    DIV0(p_ls16, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_older_established_families,\n    DIV0(p_ls17, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_young_large_families,\n    DIV0(p_ls18, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_hispanic_families,\n    DIV0(p_ls19, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_struggling_african_american_families,\n    DIV0(p_ls20, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_thriving_african_american_families,\n    DIV0(p_ls21, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_affluent_asian_families,\n    DIV0(p_ls22, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_new_families,\n    DIV0(p_ls23, (p_ls1 + p_ls2 + p_ls3 + p_ls4 + p_ls5 + p_ls6 + p_ls7 + p_ls8 + p_ls9 + p_ls10 + p_ls11 + p_ls12 + p_ls13 + p_ls14 + p_ls15 + p_ls16 + p_ls17 + p_ls18 + p_ls19 + p_ls20 + p_ls21 + p_ls22 + p_ls23)) AS pb_midsized_families_wo_kids\nFROM {{ ref('fvh_t_value') }} tv,\n-- TEMPORARY TABLES FOR EACH LIFE STAGE WITH THE LOOKUP VALUE\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_solo_retiree > 7,1,0))                         AS p_ls1  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_solo_retiree = fv_t_value)                         AS pb1,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_asian_singles > 7,1,0))               AS p_ls2  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_asian_singles = fv_t_value)               AS pb2,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_struggling_african_american_singles > 7,1,0))  AS p_ls3  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_struggling_african_american_singles = fv_t_value)  AS pb3,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_affluent_couples > 7,1,0))                     AS p_ls4  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_affluent_couples = fv_t_value)                     AS pb4,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_mixed_ethnic_solos > 7,1,0))                   AS p_ls5  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_mixed_ethnic_solos = fv_t_value)                   AS pb5,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_established_couples > 7,1,0))         AS p_ls6  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_established_couples = fv_t_value)         AS pb6,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_middle_aged_couples > 7,1,0))                  AS p_ls7  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_middle_aged_couples = fv_t_value)                  AS pb7,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_younger_working_couples > 7,1,0))              AS p_ls8  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_younger_working_couples = fv_t_value)              AS pb8,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_retired_couples > 7,1,0))                      AS p_ls9  FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_retired_couples = fv_t_value)                      AS pb9,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_established_hispanics_couples > 7,1,0))        AS p_ls10 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_established_hispanics_couples = fv_t_value)        AS pb10,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_african_american_couples > 7,1,0))    AS p_ls11 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_african_american_couples = fv_t_value)    AS pb11,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_affluent_asian_couples > 7,1,0))               AS p_ls12 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_affluent_asian_couples = fv_t_value)               AS pb12,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_mixed_struggling_couples > 7,1,0))             AS p_ls13 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_mixed_struggling_couples = fv_t_value)             AS pb13,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_midage_3_person_families > 7,1,0))             AS p_ls14 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_midage_3_person_families = fv_t_value)             AS pb14,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_midage_two_income_families > 7,1,0))           AS p_ls15 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_midage_two_income_families = fv_t_value)           AS pb15,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_older_established_families > 7,1,0))           AS p_ls16 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_older_established_families = fv_t_value)           AS pb16,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_young_large_families > 7,1,0))        AS p_ls17 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_young_large_families = fv_t_value)        AS pb17,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_hispanic_families > 7,1,0))           AS p_ls18 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_hispanic_families = fv_t_value)           AS pb18,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_struggling_african_american_families > 7,1,0)) AS p_ls19 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_struggling_african_american_families = fv_t_value) AS pb19,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_thriving_african_american_families > 7,1,0))   AS p_ls20 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_thriving_african_american_families = fv_t_value)   AS pb20,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_affluent_asian_families > 7,1,0))              AS p_ls21 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_affluent_asian_families = fv_t_value)              AS pb21,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_new_families > 7,1,0))                         AS p_ls22 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_new_families = fv_t_value)                         AS pb22,\n(SELECT fv_living_unit_id,NVL(fv_probability,iff(fv_modeled_tv_midsized_families_wo_kids > 7,1,0))            AS p_ls23 FROM {{ ref('fvh_t_value') }} LEFT OUTER JOIN {{ ref('fvh_t_test_raw') }} ON fv_modeled_tv_midsized_families_wo_kids = fv_t_value)            AS pb23\nWHERE tv.fv_living_unit_id = pb1.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb2.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb3.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb4.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb5.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb6.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb7.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb8.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb9.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb10.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb11.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb12.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb13.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb14.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb15.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb16.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb17.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb18.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb19.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb20.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb21.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb22.fv_living_unit_id\nAND   tv.fv_living_unit_id = pb23.fv_living_unit_id", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_probability"], "unique_id": "model.sdna_project.fvh_probability", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_probability.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_probability.sql", "name": "fvh_probability", "resource_type": "model", "alias": "fvh_probability", "checksum": {"name": "sha256", "checksum": "2bf0db0139119ca671c2cafb7bd88876b9e9d7bbe167a6e550319e053f767ce2"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_t_value"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"], ["fvh_t_value"], ["fvh_t_test_raw"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_test_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_t_value": {"raw_sql": "SELECT\n    fv_living_unit_id,\n    fv_cluster,\n    fv_current_spend,\n    ( fv_hh_size         * fs_c1_hhd\n    + fv_hh_income       * fs_c1_inc\n    + fv_hoh_age         * fs_c1_age\n    + fv_race_white_nonh * fs_c1_race_white_nonh\n    + fv_race_aa_nonh    * fs_c1_race_aa_nonh\n    + fv_race_hisp       * fs_c1_race_hisp\n    + fv_race_asian_nonh * fs_c1_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c1_race_other_nonh\n    ) AS fv_modeled_tv_solo_retiree,\n    ( fv_hh_size         * fs_c2_hhd\n    + fv_hh_income       * fs_c2_inc\n    + fv_hoh_age         * fs_c2_age\n    + fv_race_white_nonh * fs_c2_race_white_nonh\n    + fv_race_aa_nonh    * fs_c2_race_aa_nonh\n    + fv_race_hisp       * fs_c2_race_hisp\n    + fv_race_asian_nonh * fs_c2_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c2_race_other_nonh\n    ) AS fv_modeled_tv_thriving_asian_singles,\n    ( fv_hh_size         * fs_c3_hhd\n    + fv_hh_income       * fs_c3_inc\n    + fv_hoh_age         * fs_c3_age\n    + fv_race_white_nonh * fs_c3_race_white_nonh\n    + fv_race_aa_nonh    * fs_c3_race_aa_nonh\n    + fv_race_hisp       * fs_c3_race_hisp\n    + fv_race_asian_nonh * fs_c3_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c3_race_other_nonh\n    ) AS fv_modeled_tv_struggling_african_american_singles,\n    ( fv_hh_size         * fs_c4_hhd\n    + fv_hh_income       * fs_c4_inc\n    + fv_hoh_age         * fs_c4_age\n    + fv_race_white_nonh * fs_c4_race_white_nonh\n    + fv_race_aa_nonh    * fs_c4_race_aa_nonh\n    + fv_race_hisp       * fs_c4_race_hisp\n    + fv_race_asian_nonh * fs_c4_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c4_race_other_nonh\n    ) AS fv_modeled_tv_affluent_couples,\n    ( fv_hh_size         * fs_c5_hhd\n    + fv_hh_income       * fs_c5_inc\n    + fv_hoh_age         * fs_c5_age\n    + fv_race_white_nonh * fs_c5_race_white_nonh\n    + fv_race_aa_nonh    * fs_c5_race_aa_nonh\n    + fv_race_hisp       * fs_c5_race_hisp\n    + fv_race_asian_nonh * fs_c5_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c5_race_other_nonh\n    ) AS fv_modeled_tv_mixed_ethnic_solos,\n    ( fv_hh_size         * fs_c6_hhd\n    + fv_hh_income       * fs_c6_inc\n    + fv_hoh_age         * fs_c6_age\n    + fv_race_white_nonh * fs_c6_race_white_nonh\n    + fv_race_aa_nonh    * fs_c6_race_aa_nonh\n    + fv_race_hisp       * fs_c6_race_hisp\n    + fv_race_asian_nonh * fs_c6_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c6_race_other_nonh\n    ) AS fv_modeled_tv_thriving_established_couples,\n    ( fv_hh_size         * fs_c7_hhd\n    + fv_hh_income       * fs_c7_inc\n    + fv_hoh_age         * fs_c7_age\n    + fv_race_white_nonh * fs_c7_race_white_nonh\n    + fv_race_aa_nonh    * fs_c7_race_aa_nonh\n    + fv_race_hisp       * fs_c7_race_hisp\n    + fv_race_asian_nonh * fs_c7_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c7_race_other_nonh\n    ) AS fv_modeled_tv_middle_aged_couples,\n    ( fv_hh_size         * fs_c8_hhd\n    + fv_hh_income       * fs_c8_inc\n    + fv_hoh_age         * fs_c8_age\n    + fv_race_white_nonh * fs_c8_race_white_nonh\n    + fv_race_aa_nonh    * fs_c8_race_aa_nonh\n    + fv_race_hisp       * fs_c8_race_hisp\n    + fv_race_asian_nonh * fs_c8_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c8_race_other_nonh\n    ) AS fv_modeled_tv_younger_working_couples,\n    ( fv_hh_size         * fs_c9_hhd\n    + fv_hh_income       * fs_c9_inc\n    + fv_hoh_age         * fs_c9_age\n    + fv_race_white_nonh * fs_c9_race_white_nonh\n    + fv_race_aa_nonh    * fs_c9_race_aa_nonh\n    + fv_race_hisp       * fs_c9_race_hisp\n    + fv_race_asian_nonh * fs_c9_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c9_race_other_nonh\n    ) AS fv_modeled_tv_retired_couples,\n    ( fv_hh_size         * fs_c10_hhd\n    + fv_hh_income       * fs_c10_inc\n    + fv_hoh_age         * fs_c10_age\n    + fv_race_white_nonh * fs_c10_race_white_nonh\n    + fv_race_aa_nonh    * fs_c10_race_aa_nonh\n    + fv_race_hisp       * fs_c10_race_hisp\n    + fv_race_asian_nonh * fs_c10_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c10_race_other_nonh\n    ) AS fv_modeled_tv_established_hispanics_couples,\n    ( fv_hh_size         * fs_c11_hhd\n    + fv_hh_income       * fs_c11_inc\n    + fv_hoh_age         * fs_c11_age\n    + fv_race_white_nonh * fs_c11_race_white_nonh\n    + fv_race_aa_nonh    * fs_c11_race_aa_nonh\n    + fv_race_hisp       * fs_c11_race_hisp\n    + fv_race_asian_nonh * fs_c11_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c11_race_other_nonh\n    ) AS fv_modeled_tv_thriving_african_american_couples,\n    ( fv_hh_size         * fs_c12_hhd\n    + fv_hh_income       * fs_c12_inc\n    + fv_hoh_age         * fs_c12_age\n    + fv_race_white_nonh * fs_c12_race_white_nonh\n    + fv_race_aa_nonh    * fs_c12_race_aa_nonh\n    + fv_race_hisp       * fs_c12_race_hisp\n    + fv_race_asian_nonh * fs_c12_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c12_race_other_nonh\n    ) AS fv_modeled_tv_affluent_asian_couples,\n    ( fv_hh_size         * fs_c13_hhd\n    + fv_hh_income       * fs_c13_inc\n    + fv_hoh_age         * fs_c13_age\n    + fv_race_white_nonh * fs_c13_race_white_nonh\n    + fv_race_aa_nonh    * fs_c13_race_aa_nonh\n    + fv_race_hisp       * fs_c13_race_hisp\n    + fv_race_asian_nonh * fs_c13_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c13_race_other_nonh\n    ) AS fv_modeled_tv_mixed_struggling_couples,\n    ( fv_hh_size         * fs_c14_hhd\n    + fv_hh_income       * fs_c14_inc\n    + fv_hoh_age         * fs_c14_age\n    + fv_race_white_nonh * fs_c14_race_white_nonh\n    + fv_race_aa_nonh    * fs_c14_race_aa_nonh\n    + fv_race_hisp       * fs_c14_race_hisp\n    + fv_race_asian_nonh * fs_c14_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c14_race_other_nonh\n    ) AS fv_modeled_tv_midage_3_person_families,\n    ( fv_hh_size         * fs_c15_hhd\n    + fv_hh_income       * fs_c15_inc\n    + fv_hoh_age         * fs_c15_age\n    + fv_race_white_nonh * fs_c15_race_white_nonh\n    + fv_race_aa_nonh    * fs_c15_race_aa_nonh\n    + fv_race_hisp       * fs_c15_race_hisp\n    + fv_race_asian_nonh * fs_c15_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c15_race_other_nonh\n    ) AS fv_modeled_tv_midage_two_income_families,\n    ( fv_hh_size         * fs_c16_hhd\n    + fv_hh_income       * fs_c16_inc\n    + fv_hoh_age         * fs_c16_age\n    + fv_race_white_nonh * fs_c16_race_white_nonh\n    + fv_race_aa_nonh    * fs_c16_race_aa_nonh\n    + fv_race_hisp       * fs_c16_race_hisp\n    + fv_race_asian_nonh * fs_c16_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c16_race_other_nonh\n    ) AS fv_modeled_tv_older_established_families,\n    ( fv_hh_size         * fs_c17_hhd\n    + fv_hh_income       * fs_c17_inc\n    + fv_hoh_age         * fs_c17_age\n    + fv_race_white_nonh * fs_c17_race_white_nonh\n    + fv_race_aa_nonh    * fs_c17_race_aa_nonh\n    + fv_race_hisp       * fs_c17_race_hisp\n    + fv_race_asian_nonh * fs_c17_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c17_race_other_nonh\n    ) AS fv_modeled_tv_thriving_young_large_families,\n    ( fv_hh_size         * fs_c18_hhd\n    + fv_hh_income       * fs_c18_inc\n    + fv_hoh_age         * fs_c18_age\n    + fv_race_white_nonh * fs_c18_race_white_nonh\n    + fv_race_aa_nonh    * fs_c18_race_aa_nonh\n    + fv_race_hisp       * fs_c18_race_hisp\n    + fv_race_asian_nonh * fs_c18_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c18_race_other_nonh\n    ) AS fv_modeled_tv_thriving_hispanic_families,\n    ( fv_hh_size         * fs_c19_hhd\n    + fv_hh_income       * fs_c19_inc\n    + fv_hoh_age         * fs_c19_age\n    + fv_race_white_nonh * fs_c19_race_white_nonh\n    + fv_race_aa_nonh    * fs_c19_race_aa_nonh\n    + fv_race_hisp       * fs_c19_race_hisp\n    + fv_race_asian_nonh * fs_c19_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c19_race_other_nonh\n    ) AS fv_modeled_tv_struggling_african_american_families,\n    ( fv_hh_size         * fs_c20_hhd\n    + fv_hh_income       * fs_c20_inc\n    + fv_hoh_age         * fs_c20_age\n    + fv_race_white_nonh * fs_c20_race_white_nonh\n    + fv_race_aa_nonh    * fs_c20_race_aa_nonh\n    + fv_race_hisp       * fs_c20_race_hisp\n    + fv_race_asian_nonh * fs_c20_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c20_race_other_nonh\n    ) AS fv_modeled_tv_thriving_african_american_families,\n    ( fv_hh_size         * fs_c21_hhd\n    + fv_hh_income       * fs_c21_inc\n    + fv_hoh_age         * fs_c21_age\n    + fv_race_white_nonh * fs_c21_race_white_nonh\n    + fv_race_aa_nonh    * fs_c21_race_aa_nonh\n    + fv_race_hisp       * fs_c21_race_hisp\n    + fv_race_asian_nonh * fs_c21_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c21_race_other_nonh\n    ) AS fv_modeled_tv_affluent_asian_families,\n    ( fv_hh_size         * fs_c22_hhd\n    + fv_hh_income       * fs_c22_inc\n    + fv_hoh_age         * fs_c22_age\n    + fv_race_white_nonh * fs_c22_race_white_nonh\n    + fv_race_aa_nonh    * fs_c22_race_aa_nonh\n    + fv_race_hisp       * fs_c22_race_hisp\n    + fv_race_asian_nonh * fs_c22_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c22_race_other_nonh\n    ) AS fv_modeled_tv_new_families,\n    ( fv_hh_size         * fs_c23_hhd\n    + fv_hh_income       * fs_c23_inc\n    + fv_hoh_age         * fs_c23_age\n    + fv_race_white_nonh * fs_c23_race_white_nonh\n    + fv_race_aa_nonh    * fs_c23_race_aa_nonh\n    + fv_race_hisp       * fs_c23_race_hisp\n    + fv_race_asian_nonh * fs_c23_race_asian_nonh\n    + fv_race_othr_nonh  * fs_c23_race_other_nonh\n    ) AS fv_modeled_tv_midsized_families_wo_kids\nFROM {{ ref('fvh_currentspend') }},\n     {{ ref('fvh_fs_coeff_raw') }}\nWHERE fv_cluster = fs_life_stage", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "fvh", "fvh_t_value"], "unique_id": "model.sdna_project.fvh_t_value", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/fvh/fvh_t_value.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/fvh/fvh_t_value.sql", "name": "fvh_t_value", "resource_type": "model", "alias": "fvh_t_value", "checksum": {"name": "sha256", "checksum": "c1fb69b2c753a6919e3f3f436aedffa54c1da677e7cdee41bd6735f5c8346fd0"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_currentspend"], ["fvh_fs_coeff_raw"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_currentspend", "model.sdna_project.fvh_fs_coeff_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_is_cg": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load exp_geo_is_cg\n\n-- {{ ref('exp_geo_is') }}\n\nSELECT\n    cv_living_unit_id,\n    cv_address_id,\n    cv_short_city_name,\n    cv_city_name,\n    cv_county_name,\n    cv_state_abb,\n    cv_zipcode_5,\n    cv_zipcode_4,\n    cv_zipcode_9,\n    cv_zip_locality,\n    cv_delvy_pt_bar_cd,\n    cv_carr_route,\n    cv_state_cd,\n    cv_county_cd,\n    cv_cen2010_tract_block_grp,\n    cv_cen2010_blockid,\n    COALESCE(cv_latitude/1000000,0) AS cv_latitude,\n    COALESCE(cv_longitude/1000000,0) AS cv_longitude,\n    cv_mat_level_geodata,\n    cv_addr_qlty_ind,\n    cv_recp_reliable_cd,\n    cv_acty_dt,\n    cv_tme_zn,\n    cv_p1_pid,\n    cv_p1_ptyp,\n    cv_p1_etnc_etnc,\n    cv_p1_etnc_exp_grp,\n    cv_p1_etnc_religion,\n    cv_p1_etnc_lang_pref,\n    cv_p1_etnc_grp,\n    cv_p1_etnc_country_of_origin,\n    cv_p1_gender,\n    cv_p1_birth_dt,\n    cv_p1_est_age,\n    cv_p1_exact_age,\n    cv_p1_com_age,\n    cv_p1_edu_mdl,\n    cv_p1_marital_st,\n    cv_p1_occ_grp,\n    cv_p1_occ_cd,\n    cv_p1_bus_own,\n    cv_p2_pid,\n    cv_p2_ptyp,\n    cv_p2_etnc_etnc,\n    cv_p2_etnc_exp_grp,\n    cv_p2_etnc_religion,\n    cv_p2_etnc_lang_pref,\n    cv_p2_etnc_grp,\n    cv_p2_etnc_country_of_origin,\n    cv_p2_gender,\n    cv_p2_birth_dt,\n    cv_p2_est_age,\n    cv_p2_exact_age,\n    cv_p2_com_age,\n    cv_p2_edu_mdl,\n    cv_p2_marital_st,\n    cv_p2_occ_grp,\n    cv_p2_occ_cd,\n    cv_p2_bus_own,\n    cv_p3_pid,\n    cv_p3_ptyp,\n    cv_p3_etnc_etnc,\n    cv_p3_etnc_exp_grp,\n    cv_p3_etnc_religion,\n    cv_p3_etnc_lang_pref,\n    cv_p3_etnc_grp,\n    cv_p3_etnc_country_of_origin,\n    cv_p3_gender,\n    cv_p3_birth_dt,\n    cv_p3_est_age,\n    cv_p3_exact_age,\n    cv_p3_com_age,\n    cv_p3_edu_mdl,\n    cv_p3_marital_st,\n    cv_p3_occ_grp,\n    cv_p3_occ_cd,\n    cv_p3_bus_own,\n    cv_p4_pid,\n    cv_p4_ptyp,\n    cv_p4_etnc_etnc,\n    cv_p4_etnc_exp_grp,\n    cv_p4_etnc_religion,\n    cv_p4_etnc_lang_pref,\n    cv_p4_etnc_grp,\n    cv_p4_etnc_country_of_origin,\n    cv_p4_gender,\n    cv_p4_birth_dt,\n    cv_p4_est_age,\n    cv_p4_exact_age,\n    cv_p4_com_age,\n    cv_p4_edu_mdl,\n    cv_p4_marital_st,\n    cv_p4_occ_grp,\n    cv_p4_occ_cd,\n    cv_p4_bus_own,\n    cv_p5_pid,\n    cv_p5_ptyp,\n    cv_p5_etnc_etnc,\n    cv_p5_etnc_exp_grp,\n    cv_p5_etnc_religion,\n    cv_p5_etnc_lang_pref,\n    cv_p5_etnc_grp,\n    cv_p5_etnc_country_of_origin,\n    cv_p5_gender,\n    cv_p5_birth_dt,\n    cv_p5_est_age,\n    cv_p5_exact_age,\n    cv_p5_com_age,\n    cv_p5_edu_mdl,\n    cv_p5_marital_st,\n    cv_p5_occ_grp,\n    cv_p5_occ_cd,\n    cv_p5_bus_own,\n    cv_p6_pid,\n    cv_p6_ptyp,\n    cv_p6_etnc_etnc,\n    cv_p6_etnc_exp_grp,\n    cv_p6_etnc_religion,\n    cv_p6_etnc_lang_pref,\n    cv_p6_etnc_grp,\n    cv_p6_etnc_country_of_origin,\n    cv_p6_gender,\n    cv_p6_birth_dt,\n    cv_p6_est_age,\n    cv_p6_exact_age,\n    cv_p6_com_age,\n    cv_p6_edu_mdl,\n    cv_p6_marital_st,\n    cv_p6_occ_grp,\n    cv_p6_occ_cd,\n    cv_p6_bus_own,\n    cv_mor,\n    cv_mor_bank_book,\n    cv_mor_bank_spl_food,\n    cv_mor_bank_craft_merch,\n    cv_mor_bank_culinary_int,\n    cv_mor_bank_dedupe_hit,\n    cv_mor_bank_doit_yourself,\n    cv_mor_bank_famgen_mag,\n    cv_mor_bank_f_merch,\n    cv_mor_bank_f_orient_mag,\n    cv_mor_bank_gar_farm_buy,\n    cv_mor_bank_gar_farm_mag,\n    cv_mor_bank_gen_contrib,\n    cv_mor_bank_gen_merch,\n    cv_mor_bank_gift_gadgs,\n    cv_mor_bank_health_inst_contib,\n    cv_mor_bank_health_fit_mag,\n    cv_mor_bank_m_merch,\n    cv_mor_bank_m_sports_mag,\n    cv_mor_bank_misc,\n    cv_mor_bank_nondedupe_hit,\n    cv_mor_bank_odds_end,\n    cv_mor_bank_opp_seek_ce,\n    cv_mor_bank_photograph,\n    cv_mor_bank_political_cont,\n    cv_mor_bank_religious_cont,\n    cv_mor_bank_religious_mag,\n    cv_mor_bank_upscale_merch,\n    cv_mor_bank_news_finan,\n    cv_ncoa_cd,\n    cv_ncoa_dt,\n    cv_green_aware,\n    cv_green_aware_deciles,\n    cv_no_adults_unit,\n    cv_no_pers_unit,\n    cv_no_child_unit,\n    cv_child_age_0_3,\n    cv_child_age_4_6,\n    cv_child_age_7_9,\n    cv_child_age_10_12,\n    cv_child_age_13_15,\n    cv_child_age_16_18,\n    cv_mosaic_household,\n    cv_mosaic_zip4,\n    cv_home_bus,\n    cv_dwelling_type,\n    cv_dwelling_unit_size,\n    cv_length_of_residence,\n    cv_household_comp,\n    cv_hmeown_hmeown,\n    cv_hmeown_prob_hmeown,\n    cv_hmeown_comb_hmeown_renter,\n    cv_est_curr_hme_val,\n    cv_est_curr_hme_val_range,\n    cv_cons_vw_proft,\n    cv_incom_per_national,\n    cv_county_ehi_per,\n    cv_auto_in_market_new,\n    cv_aut_mark_used,\n    cv_aut_mark_used_0_5_vehicle,\n    cv_aut_mark_used_11_vehicle,\n    cv_aut_mark_used_6_10_vehicle,\n    cv_est_inc_amtv5,\n    cv_est_hh_incv5,\n    cv_county_echv_index,\n    cv_county_echv_per,\n    cv_state_ehi_index,\n    cv_county_ehi_index,\n    cv_cen_rur_urban_county_szcd,\n    cv_cbsa,\n    cv_cbsa_type,\n    cv_cape_edu_ispsa,\n    cv_cape_edu_ispsa_decile,\n    cv_cape_inc_fam_state_decile,\n    COALESCE(cv_cape_dens_per_per_pop/100,0) AS cv_cape_dens_per_per_pop,\n    COALESCE(cv_cape_age_pop_0_17/10,0) AS cv_cape_age_pop_0_17,\n    COALESCE(cv_cape_age_pop_0_4/10,0) AS cv_cape_age_pop_0_4,\n    COALESCE(cv_cape_age_pop_5_9/10,0) AS cv_cape_age_pop_5_9,\n    COALESCE(cv_cape_age_pop_10_13/10,0) AS cv_cape_age_pop_10_13,\n    COALESCE(cv_cape_age_pop_14_17/10,0) AS cv_cape_age_pop_14_17,\n    COALESCE(cv_cape_age_pop_18_99/10,0) AS cv_cape_age_pop_18_99,\n    COALESCE(cv_cape_age_pop_65_99/10,0) AS cv_cape_age_pop_65_99,\n    COALESCE(cv_cape_age_pop_median_age/100,0) AS cv_cape_age_pop_median_age,\n    cv_cape_built_median_hous_age,\n    COALESCE(cv_cape_child_couple_famw_lt18/10,0) AS cv_cape_child_couple_famw_lt18,\n    COALESCE(cv_cape_child_couple_famwo_lt18/10,0) AS cv_cape_child_couple_famwo_lt18,\n    COALESCE(cv_cape_child_wper_lt18/10,0) AS cv_cape_child_wper_lt18,\n    COALESCE(cv_cape_edu_pop25_med_edu_attain/10,0) AS cv_cape_edu_pop25_med_edu_attain,\n    COALESCE(cv_cape_occ_empid_health_tech/10,0) AS cv_cape_occ_empid_health_tech,\n    COALESCE(cv_cape_ethnic_pop_black_only/10,0) AS cv_cape_ethnic_pop_black_only,\n    COALESCE(cv_cape_ethnic_pop_asian_only/10,0) AS cv_cape_ethnic_pop_asian_only,\n    COALESCE(cv_cape_ethnic_pop_hispanic/10,0) AS cv_cape_ethnic_pop_hispanic,\n    COALESCE(cv_cape_ethnic_pop_white_only/10,0) AS cv_cape_ethnic_pop_white_only,\n    COALESCE(cv_cape_avg_hh_size/100,0) AS cv_cape_avg_hh_size,\n    cv_cape_oohu_med_hme_val,\n    COALESCE(cv_cape_hu_mob_hme/10,0) AS cv_cape_hu_mob_hme,\n    cv_cape_med_fam_hh_inc,\n    COALESCE(cv_cape_lang_spanish_speak/10,0) AS cv_cape_lang_spanish_speak,\n    COALESCE(cv_cape_occhu_own_occu/10,0) AS cv_cape_occhu_own_occu,\n    COALESCE(cv_cape_oochu_rent_occu/10,0) AS cv_cape_oochu_rent_occu,\n    COALESCE(cv_cape_marr_couple_fam/10,0) AS cv_cape_marr_couple_fam,\n    cv_hh_int_read_bible_devo,\n    cv_hh_pc_use_net_service,\n    cv_hh_crafts,\n    cv_hh_finan_stks_bond,\n    cv_hh_finan_cds_money_mkt,\n    cv_hh_finan_iras_currently,\n    cv_hh_finan_mutual_funds,\n    cv_hh_finan_real_estate,\n    cv_act_amusement_park_visit,\n    cv_act_zoo_visit,\n    cv_act_coffee_connoisseurs,\n    cv_act_wine_lover,\n    cv_act_doit_yourself,\n    cv_act_hme_imp_spenders,\n    cv_act_hunt_enthus,\n    cv_act_digi_mag_buyer,\n    cv_act_attend_edu_pgm,\n    cv_act_video_gamer,\n    cv_act_mlb_enthus,\n    cv_act_nascar_enthus,\n    cv_act_nba_enthus,\n    cv_act_nfl_enthus,\n    cv_act_nhl_enthus,\n    cv_act_pga_tour_enthus,\n    cv_act_politics_viewing_tv_lib,\n    cv_act_politics_viewing_tv_libcom,\n    cv_act_politics_viewing_tv_conserv,\n    cv_act_eats_fam_restaurant,\n    cv_act_eats_ff_restaurant,\n    cv_act_canoeing_kayaking,\n    cv_act_play_golf,\n    cv_act_gourment_cooking,\n    cv_act_cat_owners,\n    cv_act_dog_owners,\n    cv_act_pet_enthus,\n    cv_act_arts_crafts,\n    cv_act_scrapbooking,\n    cv_act_cultural_arts,\n    cv_hobbies_gardening,\n    cv_act_photography,\n    cv_act_book_reader,\n    cv_act_ebook_reader,\n    cv_act_audiobook_reader,\n    cv_act_avid_runners,\n    cv_act_outdoor_enthus,\n    cv_act_fishing,\n    cv_act_snow_sport,\n    cv_act_boating,\n    cv_act_plays_hockey,\n    cv_act_plays_soccer,\n    cv_act_plays_tennis,\n    cv_act_sport_enthusiast,\n    cv_act_healthy_living,\n    cv_act_fitness_enthus,\n    cv_act_on_diet,\n    cv_act_weight_conscious,\n    cv_act_casino_gambling,\n    cv_act_sweepstakes_lottery,\n    cv_act_music_download,\n    cv_act_music_stream,\n    cv_act_listen_christian_music,\n    cv_act_listen_classical_music,\n    cv_act_listen_country_music,\n    cv_act_listen_music,\n    cv_act_listen_oldies_music,\n    cv_act_listen_rock_music,\n    cv_act_listen_80s_music,\n    cv_act_listen_hiphop_music,\n    cv_act_listen_alter_music,\n    cv_act_listen_jazz_music,\n    cv_act_listen_pop_music,\n    cv_buyer_lap_own,\n    cv_buyer_security_sys_own,\n    cv_buyer_tab_own,\n    cv_buyer_coupon_users,\n    cv_buyer_lux_store_shopp,\n    cv_buyer_lux_hme_goods_shopp,\n    cv_buyer_yng_adult_cloth_shopp,\n    cv_buyer_supercenter_shopp,\n    cv_buyer_warehouse_club_mem,\n    cv_buyer_loyalty_card_usr,\n    cv_buyer_presence_auto,\n    cv_buyer_nonpres_makeup_usr,\n    cv_buyer_pres_makeup_usr,\n    cv_buyer_highend_spirit_drinker,\n    cv_lfstyl_lf_insure_plcy_hldr,\n    cv_lfstyl_med_insure_plcy_hldrs,\n    cv_lfstyl_medicare_plcy_hldrs,\n    cv_lfstyl_have_grand_child,\n    cv_lfstyl_high_freq_business_trav,\n    cv_lfstyl_high_freq_cruise_enthus,\n    cv_lfstyl_high_freq_domes_vacationer,\n    cv_lfstyl_high_freq_forgn_vacationer,\n    cv_lfstyl_freq_fly_pgm_mem,\n    cv_lfstyl_hostel_guest_loyal_pgm,\n    cv_lfstyl_interest_religion,\n    cv_lfstyl_military_act,\n    cv_lfstyl_military_inact,\n    cv_donor_contrib_charities,\n    cv_donor_contrib_arts_charities,\n    cv_donor_contrib_edu_charities,\n    cv_donor_contrib_health_charities,\n    cv_donor_contrib_political_charities,\n    cv_donor_contrib_pvt_found,\n    cv_donor_contrib_volunteer,\n    cv_finan_debit_card_usr,\n    cv_finan_corp_credit_card_usr,\n    cv_finan_major_credit_card_usr,\n    cv_finan_premium_credit_card_usr,\n    cv_finan_credit_card_usr,\n    cv_finan_store_credit_card_usr,\n    cv_invest_retire_finan_plan,\n    cv_invest_part_online_trade,\n    cv_invest_brokerage_acct_own,\n    cv_invest_actv_investor,\n    cv_invest_mutual_fund_invest,\n    cv_memship_aarp_mem,\n    cv_memship_union_mem,\n    cv_tt_email,\n    -- Removed old cv_tt_* columns\n    cv_p1_retail_shopp,\n    cv_p2_retail_shopp,\n    cv_p3_retail_shopp,\n    cv_p4_retail_shopp,\n    cv_p5_retail_shopp,\n    cv_p6_retail_shopp,\n    cv_p1_health_well_being,\n    cv_p2_health_well_being,\n    cv_p3_health_well_being,\n    cv_p4_health_well_being,\n    cv_p5_health_well_being,\n    cv_p6_health_well_being,\n    cv_p1_mobile_usrs,\n    cv_p2_mobile_usrs,\n    cv_p3_mobile_usrs,\n    cv_p4_mobile_usrs,\n    cv_p5_mobile_usrs,\n    cv_p6_mobile_usrs,\n    cv_p1_tech_adoption,\n    cv_p2_tech_adoption,\n    cv_p3_tech_adoption,\n    cv_p4_tech_adoption,\n    cv_p5_tech_adoption,\n    cv_p6_tech_adoption,\n    cv_p1_mor,\n    cv_p2_mor,\n    cv_p3_mor,\n    cv_p4_mor,\n    cv_p5_mor,\n    cv_p6_mor,\n    cv_mosaic_glob_hh,\n    cv_mosaic_glob_zip4,\n    cv_child_pres_0_18,\n    cv_child_age_0_3_mdl,\n    cv_child_age_scor_0_3,\n    cv_child_age_4_6_mdl,\n    cv_child_age_scor_4_6,\n    cv_child_age_7_9_mdl,\n    cv_child_age_scor_7_9_,\n    cv_child_age_10_12_mdl,\n    cv_child_age_scor_10_12_,\n    cv_child_age_13_15_mdl,\n    cv_child_age_scor_13_15,\n    cv_child_age_16_18_mdl,\n    cv_child_age_scor_16_18_,\n    cv_hh_ail_meds_vis_ctnt_lenses,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bank_cntct_lens_wearer,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bnk_reg_pres_drug_users,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bnk_intrst_vid_dvd,\n    cv_bhvr_bnk_intrst_golf,\n    cv_bhvr_bnk_contri_charities,\n    cv_bhvr_bnk_pet_enthusiast,\n    cv_bhvr_bnk_intrst_cultural_arts,\n    cv_bhvr_bnk_purchased_thu_mail,\n    cv_bhvr_bnk_intrst_fitness,\n    cv_bhvr_bnk_intrst_outdoors,\n    cv_bhvr_bnk_intrst_travel,\n    cv_bhvr_bnk_investors,\n    cv_bhvr_bnk_pres_of_automobile,\n    cv_bhvr_bnk_pres_of_credit_card,\n    cv_bhvr_bnk_intrst_gardening,\n    cv_bhvr_bnk_intrst_crafts,\n    cv_bhvr_bnk_collectors,\n    cv_bhvr_bnk_cruise_enthusiasts,\n    cv_bhvr_bnk_intrst_sports,\n    cv_bhvr_bnk_intrst_grmt_cooking,\n    cv_bhvr_bnk_sweepstakes_gambling,\n    cv_bhvr_bnk_intrst_politics,\n    cv_bhvr_bnk_intrst_music,\n    cv_bhvr_bnk_intrst_reading,\n    cv_bhvr_bnk_child_parenting_prod,\n    cv_bhvr_bnk_do_it_yourselfer,\n    cv_bhvr_bnk_self_improvement,\n    cv_bhvr_bnk_intrst_in_religion,\n    cv_bhvr_bnk_grandparent,\n    cv_bhvr_bnk_intrst_clothing,\n    cv_bhvr_bnk_donates_envrn_causes,\n    cv_bhvr_bnk_invests_mutual_funds,\n    cv_bhvr_bnk_wght_conscious,\n    cv_bhvr_bnk_mail_order_multibuyer,\n    cv_bhvr_bnk_dog_enthusiasts,\n    cv_bhvr_bnk_cat_enthusiasts,\n    cv_bhvr_bnk_hlthy_living,\n    cv_bhvr_bnk_intrst_automotive,\n    cv_bhvr_bnk_intrst_skiing,\n    cv_bhvr_bnk_intrst_boating,\n    cv_bhvr_bnk_pres_of_cell_phone,\n    cv_bhvr_bnk_commn_connectivity,\n    cv_bhvr_bnk_computers,\n    cv_bhvr_bnk_hi_tech_owner,\n    cv_bhvr_bnk_home_decor_furnish,\n    cv_bhvr_bnk_homeentmnt_video,\n    cv_bhvr_bnk_kitchen_aids_applns,\n    cv_bhvr_bnk_mo_buyer_music_video,\n    cv_bhvr_bnk_mob_books,\n    cv_bhvr_bnk_mo_buyer_cloth_shoe,\n    cv_bhvr_bnk_mob_ins_fin,\n    cv_bhvr_bnk_mail_order_buyer_gift,\n    cv_bhvr_bnk_mob_grdng,\n    cv_bhvr_bnk_mob_jewelry,\n    cv_bhvr_bnk_clas_opra_big_bnd_mus,\n    cv_bhvr_bnk_country_music,\n    cv_bhvr_bnk_christian_music,\n    cv_bhvr_bnk_rock_music,\n    cv_bhvr_bnk_internet_online_subs,\n    cv_bhvr_bnk_intrst_photo,\n    cv_bhvr_bnk_purchase_via_online,\n    cv_bhvr_bnk_intrst_affluence_ls,\n    cv_bhvr_bnk_domestic_traveler,\n    cv_bhvr_bnk_foreign_traveler,\n    cv_bhvr_bnk_pres_of_prem_cc,\n    cv_bhvr_bnk_active_military,\n    cv_bhvr_bnk_inactive_military,\n    cv_hh_acty_int_hob_photography,\n    cv_hh_acty_int_hobbies_gardening,\n    cv_hh_acty_int_hob_home_ws_diy,\n    cv_hh_acty_int_hob_cars_auto_rep,\n    cv_hh_acty_int_hob_bird_watching,\n    cv_hh_acty_int_hob_self_imprvmnt,\n    cv_hh_acty_int_music_chrstn_gosp,\n    cv_hh_acty_int_music_r_and_b,\n    cv_hh_acty_int_music_jazz_new_age,\n    cv_hh_acty_int_music_classical,\n    cv_hh_acty_int_music_rock_n_roll,\n    cv_hh_acty_int_music_country,\n    cv_hh_acty_int_music_in_gen,\n    cv_hh_acty_int_music_other_music,\n    cv_hh_acty_int_read_bs_fiction,\n    cv_hh_acty_int_childrens_reading,\n    cv_hh_acty_int_reading_computer,\n    cv_hh_acty_int_read_cook_culinary,\n    cv_hh_acty_int_reading_country_ls,\n    cv_hh_acty_int_read_entmnt_ppl,\n    cv_hh_acty_int_reading_fashion,\n    cv_hh_acty_int_reading_history,\n    cv_hh_acty_int_read_intr_decor,\n    cv_hh_acty_int_read_med_hlth,\n    cv_hh_acty_int_reading_military,\n    cv_hh_acty_int_reading_mystery,\n    cv_hh_acty_int_read_ntrl_hlth_rmd,\n    cv_hh_acty_int_reading_romance,\n    cv_hh_acty_int_read_sc_fiction,\n    cv_hh_acty_int_read_sc_tech,\n    cv_hh_acty_int_sports_read,\n    cv_hh_acty_int_read_wrld_news_pol,\n    cv_hh_acty_int_book_reader,\n    cv_hh_acty_int_soc_ani_wf_soc,\n    cv_hh_acty_int_soc_env_wildlife,\n    cv_hh_acty_int_soc_pol_cons,\n    cv_hh_acty_int_soc_pol_liberal,\n    cv_hh_acty_int_soc_religion,\n    cv_hh_acty_int_soc_child,\n    cv_hh_acty_int_soc_veterans,\n    cv_hh_acty_int_soc_hlth,\n    cv_hh_acty_int_soc_othr,\n    cv_hh_acty_int_sportsbaseball,\n    cv_hh_acty_int_sportsbasketball,\n    cv_hh_acty_int_sports_rec_hockey,\n    cv_hh_acty_int_sportscampng_hikng,\n    cv_hh_acty_int_sports_rec_hunting,\n    cv_hh_acty_int_sports_rec_fishing,\n    cv_hh_acty_int_sports_rec_nascar,\n    cv_hh_acty_int_sprt_fitness_exer,\n    cv_hh_acty_int_sportsscuba_diving,\n    cv_hh_acty_int_sportsfootball,\n    cv_hh_acty_int_sports_rec_golf,\n    cv_hh_acty_int_sportssnow_skng,\n    cv_hh_acty_int_boating_sailing,\n    cv_hh_acty_int_sports_rec_walking,\n    cv_hh_acty_int_sports_rec_cycling,\n    cv_hh_acty_int_sportsmotorcycles,\n    cv_hh_acty_int_running_jogging,\n    cv_hh_acty_int_sports_rec_soccer,\n    cv_hh_acty_int_sportsswimming,\n    cv_hh_acty_int_play_sprt_in_gen,\n    cv_hh_acty_int_sweepstakes,\n    cv_hh_acty_int_swpstakes_loteries,\n    cv_hh_acty_int_casino_gambling,\n    cv_hh_acty_int_travel_cruise,\n    cv_hh_acty_int_trvl_inter,\n    cv_hh_acty_int_travel_domestic,\n    cv_hh_acty_int_travel_time_share,\n    cv_hh_acty_int_trvl_rec_vehicle,\n    cv_hh_acty_int_rv_travel,\n    cv_hh_acty_int_trvl_bus_trvl,\n    cv_hh_acty_int_trvl_per_trvl,\n    cv_hh_acty_int_pc_i_own_computer,\n    cv_hh_acty_int_pc__i_usedsl_hispd,\n    cv_hh_acty_int_pc_i_plan_buy_comp,\n    cv_hh_acty_int_eg_cell_phone,\n    cv_hh_acty_int_eg_com_disc_player,\n    cv_hh_acty_int_eg_dvd_player,\n    cv_hh_acty_int_eg_satellite_dish,\n    cv_hh_acty_int_eg_dig_cam,\n    cv_hh_acty_int_eg_hdtv,\n    cv_hh_acty_int_eg__electronics,\n    cv_hh_acty_int_eg_pda_blackberry,\n    cv_hh_acty_int_eg_video_camera,\n    cv_hh_acty_int_eg_video_game_sys,\n    cv_hh_acty_int_eg_hom_theater_sys,\n    cv_hh_acty_int_eg_cellph_priphln,\n    cv_hh_acty_int_cltrl_arts,\n    cv_hh_acty_int_magzn_bus_fin,\n    cv_hh_acty_int_childrens_magzn,\n    cv_hh_acty_int_magzn_comp_elctrns,\n    cv_hh_acty_int_magzn_crft_gms_hob,\n    cv_hh_acty_int_magazines_fitness,\n    cv_hh_acty_int_mgzn_fd_wine_ckng,\n    cv_hh_acty_int_magzn_grdng_magzn,\n    cv_hh_acty_int_magzn_hntg_fshng,\n    cv_hh_acty_int_magazines_mens,\n    cv_hh_acty_int_magazines_music,\n    cv_hh_acty_int_mgzn_prtntg_babies,\n    cv_hh_acty_int_mgzn_sports_mgzn,\n    cv_hh_acty_int_magzn_subs,\n    cv_hh_acty_int_magazines_travel,\n    cv_hh_acty_int_magazines_womens,\n    cv_hh_acty_int_magzn_cur_evnt_nws,\n    cv_hh_ls_veh_hav_leased_a_veh,\n    cv_hh_ls_veh_hav_purchased_a_veh,\n    cv_hh_ls_afltn_mem_book_club,\n    cv_hh_ls_afltn_mem_music_club,\n    cv_hh_ls_cc_amer_exp_prem,\n    cv_hh_ls_cc_amer_exp_regular,\n    cv_hh_ls_cc_discover_premium,\n    cv_hh_ls_cc_discover_regular,\n    cv_hh_ls_cc_other_card_premium,\n    cv_hh_ls_cc_other_card_regular,\n    cv_hh_ls_cc_store_ret_reg,\n    cv_hh_ls_cc_visa_regular,\n    cv_hh_ls_cc_mastercard_regular,\n    cv_hh_ls_contri_hmntrn,\n    cv_hh_ls_entmnt_buy_prercrdvideo,\n    cv_hh_ls_entmnt_wtch_cabletv,\n    cv_hh_ls_entmnt_watch_videos,\n    cv_hh_ls_outdoor_lvng_entmnt,\n    cv_hh_ls_entmnt_season_hldy_prod,\n    cv_hh_ls_fin_iras_future_intrst,\n    cv_hh_ls_fin_life_insur_cur,\n    cv_hh_ls_fin_mutl_funds,\n    cv_hh_ls_fin_othr_invest_cur,\n    cv_hh_ls_fin_othr_invest_future,\n    cv_hh_ls_fin_real_estate_fut,\n    cv_hh_ls_fin_stks_bond_fut,\n    cv_hh_ls_grndkids_proud_grndprnt,\n    cv_hh_ls_info_byng_purc_by_intrnt,\n    cv_hh_ls_mil_gov_active_mil_mem,\n    cv_hh_ls_military_gov_vetern,\n    cv_hh_lifestyl_pets_own_a_cat,\n    cv_hh_lifestyl_pets_own_a_dog,\n    cv_hh_lifestyl_pets_own_a_pet,\n    cv_hh_ls_biy_internet,\n    cv_hh_ls_bib_mail,\n    cv_hh_ls_bib_catalog,\n    cv_hh_ls_buying_interest_apparel,\n    cv_hh_ls_buying_intrst_comp_elec,\n    cv_hh_ls_buying_intrst_book_music,\n    cv_hh_ls_bi_home_garden,\n    cv_hh_ls_bi_sports_related,\n    cv_hh_ls_buying_interest_big_tall,\n    cv_hh_ls_byng_intrst_moc,\n    cv_hh_ls_byng_intrst_mog,\n    cv_hh_ls_bi_mail_order_gift,\n    cv_hh_ls_byng_intrst_mjc,\n    cv_hh_ls_bi_mail_music_videos,\n    cv_hh_ls_byng_intrst_mcp,\n    cv_hh_ls_bi_mail_books_magzn,\n    cv_hh_ls_bi_food_and_beverage,\n    cv_hh_ls_bi_home_decorating,\n    cv_hh_ls_bi_furniture,\n    cv_hh_ls_bi_domestics,\n    cv_hh_ls_buying_interest_footwear,\n    cv_hh_ml_ordr_apprl_acsries,\n    COALESCE(cv_cape_age_pop_0_9/10,0) AS cv_cape_age_pop_0_9,\n    COALESCE(cv_cape_age_pop_0_24/10,0) AS cv_cape_age_pop_0_24,\n    COALESCE(cv_cape_age_pop_25_34/10,0) AS cv_cape_age_pop_25_34,\n    COALESCE(cv_cape_age_pop_35_44/10,0) AS cv_cape_age_pop_35_44,\n    COALESCE(cv_cape_age_pop_45_54/10,0) AS cv_cape_age_pop_45_54,\n    COALESCE(cv_cape_age_pop_55_64/10,0) AS cv_cape_age_pop_55_64,\n    COALESCE(cv_cape_age_pop_18_65/10,0) AS cv_cape_age_pop_18_65,\n    COALESCE(cv_cape_age_pop_75_99/10,0) AS cv_cape_age_pop_75_99,\n    COALESCE(cv_cape_pop_med_age_of_adults_18/100,0) AS cv_cape_pop_med_age_of_adults_18,\n    COALESCE(cv_cape_child_hh_fem_hh_fam_plt18/10,0) AS cv_cape_child_hh_fem_hh_fam_plt18,\n    COALESCE(cv_cape_child_hh_without_per_lt18/10,0) AS cv_cape_child_hh_without_per_lt18,\n    COALESCE(cv_cape_cmte_com_travtowrk_60_89/10,0) AS cv_cape_cmte_com_travtowrk_60_89,\n    COALESCE(cv_cape_cmter_travtowork_90/10,0) AS cv_cape_cmter_travtowork_90,\n    COALESCE(cv_cape_cmter_avg_trav_timetowork/10,0) AS cv_cape_cmter_avg_trav_timetowork,\n    COALESCE(cv_cape_cmter_med_trav_timetowork/10,0) AS cv_cape_cmter_med_trav_timetowork,\n    COALESCE(cv_cape_cmte_wrkrs_carpld_to_work/10,0) AS cv_cape_cmte_wrkrs_carpld_to_work,\n    COALESCE(cv_cape_emply_fem16_lbr_frce/10,0) AS cv_cape_emply_fem16_lbr_frce,\n    COALESCE(cv_cape_etnc_hh_nonhisp_whte_only/10,0) AS cv_cape_etnc_hh_nonhisp_whte_only,\n    COALESCE(cv_cape_etnc_pop_black_only_hisp/10,0) AS cv_cape_etnc_pop_black_only_hisp,\n    COALESCE(cv_cape_etnc_pop_non_hispanic/10,0) AS cv_cape_etnc_pop_non_hispanic,\n    COALESCE(cv_cape_etnc_pop_white_only_hisp/10,0) AS cv_cape_etnc_pop_white_only_hisp,\n    COALESCE(cv_cape_inc_hh_inc_under_10k/10,0) AS cv_cape_inc_hh_inc_under_10k,\n    COALESCE(cv_cape_inc_hh_inc_10_14k/10,0) AS cv_cape_inc_hh_inc_10_14k,\n    COALESCE(cv_cape_inc_hh_inc_15_19k/10,0) AS cv_cape_inc_hh_inc_15_19k,\n    COALESCE(cv_cape_inc_hh_inc_20_24k/10,0) AS cv_cape_inc_hh_inc_20_24k,\n    COALESCE(cv_cape_inc_hh_inc_25_29k/10,0) AS cv_cape_inc_hh_inc_25_29k,\n    COALESCE(cv_cape_inc_hh_inc_30_34k/10,0) AS cv_cape_inc_hh_inc_30_34k,\n    COALESCE(cv_cape_inc_hh_inc_35_39k/10,0) AS cv_cape_inc_hh_inc_35_39k,\n    COALESCE(cv_cape_inc_hh_inc_40_44k/10,0) AS cv_cape_inc_hh_inc_40_44k,\n    COALESCE(cv_cape_inc_hh_inc_45_49k/10,0) AS cv_cape_inc_hh_inc_45_49k,\n    COALESCE(cv_cape_inc_hh_inc_50_59k/10,0) AS cv_cape_inc_hh_inc_50_59k,\n    COALESCE(cv_cape_inc_hh_inc_60_74k/10,0) AS cv_cape_inc_hh_inc_60_74k,\n    COALESCE(cv_cape_inc_hh_inc_75_99k/10,0) AS cv_cape_inc_hh_inc_75_99k,\n    COALESCE(cv_cape_inc_hh_inc_100_124k/10,0) AS cv_cape_inc_hh_inc_100_124k,\n    COALESCE(cv_cape_inc_hh_inc_125_149k/10,0) AS cv_cape_inc_hh_inc_125_149k,\n    COALESCE(cv_cape_inc_hh_inc_150_199k/10,0) AS cv_cape_inc_hh_inc_150_199k,\n    COALESCE(cv_cape_inc_hh_inc_200_249k/10,0) AS cv_cape_inc_hh_inc_200_249k,\n    COALESCE(cv_cape_inc_hh_inc_250_499k/10,0) AS cv_cape_inc_hh_inc_250_499k,\n    COALESCE(cv_cape_inc_hh_incm_500k_more/10,0) AS cv_cape_inc_hh_incm_500k_more,\n    cv_cape_inc_hh_med_hh_inc,\n    cv_cape_inc_hh_med_non_fam_hh_inc,\n    cv_cape_inc_pop_per_capita_income,\n    COALESCE(cv_cape_ind_empld_acmdn_food_svcs/10,0) AS cv_cape_ind_empld_acmdn_food_svcs,\n    COALESCE(cv_cape_ind_empld_adm_supwstemgmt/10,0) AS cv_cape_ind_empld_adm_supwstemgmt,\n    COALESCE(cv_cape_ind_empld_agr_fst_fsh_hnt/10,0) AS cv_cape_ind_empld_agr_fst_fsh_hnt,\n    COALESCE(cv_cape_ind_empld_arts_entmnt/10,0) AS cv_cape_ind_empld_arts_entmnt,\n    COALESCE(cv_cape_indus_empld_construction/10,0) AS cv_cape_indus_empld_construction,\n    COALESCE(cv_cape_ind_empld_edu_srvs/10,0) AS cv_cape_ind_empld_edu_srvs,\n    COALESCE(cv_cape_ind_empld_fin_and_ins/10,0) AS cv_cape_ind_empld_fin_and_ins,\n    COALESCE(cv_cape_indus_empld_hc_soc_ass/10,0) AS cv_cape_indus_empld_hc_soc_ass,\n    COALESCE(cv_cape_indus_empld_information/10,0) AS cv_cape_indus_empld_information,\n    COALESCE(cv_cape_indus_empld_manufacturing/10,0) AS cv_cape_indus_empld_manufacturing,\n    COALESCE(cv_cape_ind_empld_mgmt_com_entrps/10,0) AS cv_cape_ind_empld_mgmt_com_entrps,\n    COALESCE(cv_cape_indus_empld_mining/10,0) AS cv_cape_indus_empld_mining,\n    COALESCE(cv_cape_ind_empld_oth_svcs/10,0) AS cv_cape_ind_empld_oth_svcs,\n    COALESCE(cv_cape_ind_empld_public_admin/10,0) AS cv_cape_ind_empld_public_admin,\n    COALESCE(cv_cape_ind_empld_rer_lsng/10,0) AS cv_cape_ind_empld_rer_lsng,\n    COALESCE(cv_cape_indus_empld_retail_trade/10,0) AS cv_cape_indus_empld_retail_trade,\n    COALESCE(cv_cape_ind_empld_prof_sc_tch_scs/10,0) AS cv_cape_ind_empld_prof_sc_tch_scs,\n    COALESCE(cv_cape_ind_empld_trans_wh/10,0) AS cv_cape_ind_empld_trans_wh,\n    COALESCE(cv_cape_indus_empld_utilities/10,0) AS cv_cape_indus_empld_utilities,\n    COALESCE(cv_cape_ind_empld_wholesale_trade/10,0) AS cv_cape_ind_empld_wholesale_trade,\n    COALESCE(cv_cape_mrtg_oohu_first_mrtg_only/10,0) AS cv_cape_mrtg_oohu_first_mrtg_only,\n    COALESCE(cv_cape_move_occhu_med_len_res/100,0) AS cv_cape_move_occhu_med_len_res,\n    cv_cape_rent_rntl_median_rent,\n    COALESCE(cv_cape_tenancy_hu_occupied/10,0) AS cv_cape_tenancy_hu_occupied,\n    COALESCE(cv_cape_typ_pop_child_in_fam_hh/10,0) AS cv_cape_typ_pop_child_in_fam_hh,\n    COALESCE(cv_cape_typ_pop_in_family_hh/10,0) AS cv_cape_typ_pop_in_family_hh,\n    COALESCE(cv_cape_typ_pop_in_non_family_hh/10,0) AS cv_cape_typ_pop_in_non_family_hh,\n    COALESCE(cv_cape_pop_nat_adpt_child_fam_hh/10,0) AS cv_cape_pop_nat_adpt_child_fam_hh,\n    COALESCE(cv_cape_typ_pop_spouse_in_fam_hh/10,0) AS cv_cape_typ_pop_spouse_in_fam_hh,\n    COALESCE(cv_cape_urban_pop_rural_on_farms/10,0) AS cv_cape_urban_pop_rural_on_farms,\n    COALESCE(cv_cape_urban_pop_rur_not_on_frms/10,0) AS cv_cape_urban_pop_rur_not_on_frms,\n    COALESCE(cv_cape_urban_pop_in_urban_area/10,0) AS cv_cape_urban_pop_in_urban_area,\n    COALESCE(cv_cape_urban_pop_in_urban_clstrs/10,0) AS cv_cape_urban_pop_in_urban_clstrs,\n    cv_cape_inc_fam_inc_state_indx,\n    cv_prop_rlty_home_year_built,\n    cv_mrtg_home_pur_mrtg_term,\n    cv_mrtg_home_pur_home_pur_date,\n    cv_mrtg_home_pur_mrtg_rate_type,\n    cv_mrtg_home_pur_mrtg_loan_type,\n    cv_mrtg_home_purc_type_of_purc,\n    cv_mrtg_home_pur_pur_amt_rng,\n    cv_mrtg_home_pur_mrtg_amt_rng,\n    cv_rlty_mdl_confdnce_cdv2,\n    cv_rlty_mdl_est_avl_equity_cd_v2,\n    cv_rlty_mdl_est_avl_equity_amt_v2,\n    cv_rlty_mdl_est_cur_lntoval_ratv2,\n    cv_rlty_mdl_est_cur_mrtg_pmtv21,\n    cv_rlty_mdl_est_cur_mrtg_pmtv22,\n    cv_rlty_mdl_est_cur_mrtg_amtcdv2,\n    cv_rlty_mdl_est_cur_mrtg_am_v2,\n\n    geo_zipcode,\n    geo_kroger_banner,\n    geo_all_other_kroger,\n    geo_albertsons_safeway,\n    geo_publix,\n    geo_ahold_delhaize,\n    geo_wakefern,\n    geo_hy_vee,\n    geo_heb,\n    geo_whole_foods,\n    geo_aldi,\n    geo_trader_joes,\n    geo_bi_lo,\n    geo_all_other_grocery,\n    geo_cvs,\n    geo_walgreens,\n    geo_all_other_drug,\n    geo_target,\n    geo_wm_neighborhood_market,\n    geo_all_other_walmart,\n    geo_all_other_mass,\n    geo_costco,\n    geo_bjs,\n    geo_sams_club,\n    geo_all_other_club,\n    geo_total_c_and_g,\n    geo_7_eleven,\n    geo_circle_k,\n    geo_speedway,\n    geo_all_other_c_and_g,\n    geo_dollar_general,\n    geo_family_dollar,\n    geo_all_other_dollar,\n    geo_amazon_com,\n    geo_walmart_com,\n    geo_all_other_ao,\n    geo_not_assigned,\n    is_7_eleven,\n    is_ahold_delhaize,\n    is_albertsons,\n    is_aldi,\n    is_amazon_com,\n    is_bi_lo,\n    is_bjs,\n    is_circle_k,\n    is_costco,\n    is_cvs,\n    is_dollar_general,\n    is_family_dollar,\n    is_heb,\n    is_speedway,\n    is_hy_vee,\n    is_kroger_banner,\n    is_all_other_kroger,\n    is_all_other_club,\n    is_all_other_dollar,\n    is_all_other_drug,\n    is_all_other_c_and_g,\n    is_all_other_grocery,\n    is_all_other_mass,\n    is_publix,\n    is_sams_club,\n    is_target,\n    is_trader_joes,\n    is_wakefern,\n    is_walgreens,\n    is_walmart_com,\n    is_wm_neighborhood_market,\n    is_all_other_walmart,\n    is_whole_foods,\n    is_all_other_ao,\n    is_not_assigned,\n\n    is_target_com,\n    is_kroger_com,\n    is_kmart_com,\n    is_walgreens_com,\n    is_samsclub_com,\n    is_costco_com,\n\n    -- DERIVE HOUSEHOLD SIZE\n    CASE cv_no_pers_unit\n        WHEN '1' THEN '1 Person'\n        WHEN '2' THEN '2 Persons'\n        WHEN '3' THEN '3 Persons'\n        WHEN '4' THEN '4 Persons'\n        WHEN '5' THEN '5 Persons'\n        WHEN '6' THEN '6 Persons'\n        WHEN '7' THEN '7 Persons'\n        WHEN '8' THEN '8+ Persons'\n        ELSE 'Unknown'\n    END AS hh_size,\n\n    -- DERIVING HEAD OF HOUSEHOLD AGE\n    CASE\n        -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 19-39\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 19)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 39)   THEN '01 Millennial (Age 19-39)'\n        -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 40-50\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 40)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 50)   THEN '02 Gen X (Age 40-50)'\n        -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 51-60\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 51)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 60)   THEN '03 Young Boomer (Age 51-60)'\n        -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 61-70\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 61)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 70)   THEN '04 Older Boomer (61-70)'\n        -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 71-80\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 71)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 80)   THEN '05 Retirees (Age 71-80)'\n        -- CHECK IF HH HAS PRIMARY PERSON WITH AGE MORE THAN 81\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 81)   THEN '06 Seniors (Age 81+)'\n        ELSE 'Unknown'\n    END AS hoh_age,\n\n    -- DERIVING HEAD OF HOUSEHOLD LIFESTAGE\n    CASE\n        -- CHECK IF HH HAS NO CHILD AND HOH COMBINED AGE <= 45\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 45)   AND\n              cv_child_pres_0_18 IN ('00','0U','5N','5U')                                                                   THEN '01 Getting Started'\n        -- CHECK IF HH HAS NO CHILD AND HOH COMBINED AGE IS BETWEEN 46 AND 70\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 46)   AND\n             (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 70)   AND\n              cv_child_pres_0_18 IN ('00','0U','5N','5U')                                                                   THEN '04 Established Workers'\n        -- CHECK IF NO CHILD AND HOH COMBINED AGE IS >= 71\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 71)   AND\n              cv_child_pres_0_18 IN ('00','0U','5N','5U')                                                                   THEN '05 Retired'\n        -- CHECK IF HH HAS A CHILD WITH AGE < 13\n        WHEN ((cv_child_age_0_3_mdl  IN ('1Y','5Y')) OR (cv_child_age_4_6_mdl   IN ('1Y','5Y'))                             OR\n              (cv_child_age_7_9_mdl  IN ('1Y','5Y')) OR (cv_child_age_10_12_mdl IN ('1Y','5Y')))                            THEN '02 Younger Families'\n        -- CHECK IF HH HAS A CHILD WITH AGE BETWEEN 13 AND 17\n        WHEN cv_child_age_13_15_mdl IN ('1Y','5Y')   OR cv_child_age_16_18_mdl  IN ('1Y','5Y')                              THEN '03 Raising Teens'\n        -- DEFAULT VALUE RETURNED\n        ELSE 'Unknown'\n    END AS hoh_lifestage,\n\n    -- DERIVING HEAD OF HOUSEHOLD ETHNICITY\n    CASE\n        -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS Scandinavian, Western European AND Eastern European\n        WHEN (IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp) IN ('E','G','J','K','L'))             THEN 'Caucasian'\n        -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS African American\n        WHEN (IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp) IN ('A'))                             THEN 'African American'\n        -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS South east Asian, South Asian, Central Asian, AND East Asian\n        WHEN (IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp) IN ('B','C','D','H','N'))             THEN 'Asian'\n        -- CHECK IF HH PRIMARY PERSON HAS ETHNICITY AS Hispanic\n        WHEN (IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp) IN ('O'))                             THEN 'Hispanic'\n        ELSE 'Unknown'\n    END AS hoh_ethnicity,\n\n    -- DERIVE HOUSEHOLD HISPANIC ETHNICITY\n    CASE\n        WHEN (IFF(cv_p2_ptyp='P' AND cv_p2_gender='F', cv_p2_etnc_grp, cv_p1_etnc_grp) IN ('O'))                             THEN '1'\n        ELSE '0'\n    END AS hoh_hispanic,\n\n    -- DERIVING HOUSEHOLD INCOME\n    CASE\n        -- CHECK IF EST. HH INCOME LESS THEN $15K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 1)  AND (CAST (cv_est_inc_amtv5 AS INT) < 15)                               THEN '1. lt $15K'\n        -- CHECK IF EST. HH INCOME BETWEEN $15K AND $24.9999K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 15) AND (CAST (cv_est_inc_amtv5 AS FLOAT) <= 24.9999)                       THEN '2. $15K-$25K'\n        -- CHECK IF EST. HH INCOME BETWEEN $25K AND $34.9999K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 25) AND (CAST (cv_est_inc_amtv5 AS FLOAT) <= 34.9999)                       THEN '3. $25K-$35K'\n        -- CHECK IF EST. HH INCOME BETWEEN $35K AND $49.9999K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 35) AND (CAST (cv_est_inc_amtv5 AS FLOAT) <= 49.9999)                       THEN '4. $35K-$50K'\n        -- CHECK IF EST. HH INCOME BETWEEN $50K AND $69.9999K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 50) AND (CAST (cv_est_inc_amtv5 AS FLOAT) <= 69.9999)                       THEN '5. $50K-$70K'\n        -- CHECK IF EST. HH INCOME BETWEEN $70K AND $99.9999K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 70) AND (CAST (cv_est_inc_amtv5 AS FLOAT) <= 99.9999)                       THEN '6. $70K-$100K'\n        -- CHECK IF EST. HH INCOME GREATER THAN $100K\n        WHEN (CAST (cv_est_inc_amtv5 AS INT) >= 100)                                                                        THEN '7. gt $100K'\n        -- DEFAULT VALUE RETURNED\n        ELSE '8. Unknown'\n    END AS hh_income,\n\n    -- DERIVE HH INCOME PER CAPITA\n    CASE\n         WHEN (cv_no_pers_unit = '1') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 25,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 50, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '2') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 35,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 60, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '3') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 45,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 70, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '4') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 55,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 80, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '5') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 65,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 90, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '6') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 75,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 100, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '7') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 85,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 110, 'High','Medium')))\n         WHEN (cv_no_pers_unit = '8') THEN (IFF (CAST (cv_est_inc_amtv5 AS INT) < 95,'Low',IFF (CAST (cv_est_inc_amtv5 AS INT) > 120, 'High','Medium')))\n         ELSE 'Unknown'\n    END AS hh_per_cap_income,\n\n    --CHECK IF HOUSEHOLD IS KNOWN/MODELED TO HAVE CHILDEREN AND NO. OF CHILDREN IS NOT 0\n    CASE\n        WHEN (cv_child_pres_0_18 IN ('1Y','5Y') AND CAST(cv_no_child_unit AS INT) >=1)                                      THEN 'Yes'\n        ELSE 'No'\n    END AS hh_presence_of_child,\n\n    --CHECK IF HOUSEHOLD CHILD AGE IN 0 TO 6 IS KNOWN/MODELED TO HAVE CHILDEREN\n    CASE\n        WHEN ((cv_child_age_0_3_mdl IN ('1Y','5Y') OR cv_child_age_4_6_mdl IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                                   THEN 'Yes'\n        ELSE 'No'\n    END AS hh_presence_of_child_age_0_6,\n\n    --CHECK IF HOUSEHOLD CHILD AGE IN 7 TO 12 IS KNOWN/MODELED TO HAVE CHILDEREN\n    CASE\n        WHEN ((cv_child_age_7_9_mdl IN ('1Y','5Y') OR cv_child_age_10_12_mdl IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                                 THEN 'Yes'\n        ELSE 'No'\n    END AS hh_presence_of_child_age_7_12,\n\n    --CHECK IF HOUSEHOLD CHILD AGE IN 13 TO 18 IS KNOWN/MODELED TO HAVE CHILDEREN\n    CASE\n        WHEN ((cv_child_age_13_15_mdl IN ('1Y','5Y') OR cv_child_age_16_18_mdl IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_presence_of_child_age_13_18,\n\n    -- DERIVEING AGE OF OLDEST CHILD IN HOUSEHOLD\n    CASE\n        -- CHECK IF OLDEST CHILD PRESENT BETWEEN 13 TO 18\n        WHEN ((cv_child_age_13_15_mdl     IN ('1Y','5Y')  OR cv_child_age_16_18_mdl     IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                      THEN 'Oldest Child 13-18'\n        -- CHECK IF OLDEST CHILD PRESENT BETWEEN 7 TO 12\n        WHEN ((cv_child_age_7_9_mdl       IN ('1Y','5Y')  OR cv_child_age_10_12_mdl     IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                      THEN 'Oldest Child 7-12'\n           -- CHECK IF OLDEST CHILD PRESENT BETWEEN 0 TO 6\n        WHEN ((cv_child_age_0_3_mdl       IN ('1Y','5Y')  OR cv_child_age_4_6_mdl       IN ('1Y','5Y')) AND CAST(cv_no_child_unit AS INT) >=1)                      THEN 'Oldest Child 0-6'\n        ELSE 'No Children'\n    END AS hh_age_of_old_child,\n\n    -- DERIVING GENDER OF PERSON\n    CASE\n        WHEN ('M'     IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                AND\n             ('F' NOT IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                THEN 'Male'\n        WHEN ('F'     IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                AND\n             ('M' NOT IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                THEN 'Female'\n        WHEN ('F'     IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                AND\n             ('M'     IN (cv_p1_gender, cv_p2_gender, cv_p3_gender, cv_p4_gender,cv_p5_gender, cv_p6_gender))                THEN 'Both'\n        WHEN (cv_p1_gender = 'B' OR cv_p2_gender = 'B' OR cv_p3_gender = 'B' OR cv_p4_gender = 'B'                           OR\n              cv_p5_gender = 'B' OR cv_p6_gender = 'B')                                                                      THEN 'Both'\n        ELSE 'Unknown'\n    END AS hh_presence_of_gender,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 19-39 AND MALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 19)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 39)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'M')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_millennial_male,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 19-39 AND FEMALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 19)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 39)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'F')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_millennial_female,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 40-50 AND MALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 40)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 50)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'M')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_gen_x_male,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 40-50 AND FEMALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 40)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 50)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'F')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_gen_x_female,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 51-60 AND MALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 51)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 60)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'M')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_young_boomer_male,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 51-60 AND FEMALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 51)   AND\n              (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) <= 60)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'F')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_young_boomer_female,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 61-70 AND MALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 61)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'M')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_post_boomer_male,\n\n    -- CHECK IF HH HAS PRIMARY PERSON WITHIN AGE LIMIT 61-70 AND FEMALE\n    CASE\n        WHEN (CAST (SUBSTR((IFF (cv_p2_ptyp = 'P'  AND cv_p2_gender = 'F',cv_p2_com_age,cv_p1_com_age)),2,2) AS INT) >= 61)   AND\n              ((IFF (cv_p2_ptyp = 'P' AND cv_p2_gender = 'F',cv_p2_gender,cv_p1_gender)) = 'F')                               THEN 'Yes'\n        ELSE 'No'\n    END AS hh_post_boomer_female,\n\n    --DERIVING RURAL-URBAN COUNTY SIZE CODE\n    CASE cv_cen_rur_urban_county_szcd\n        WHEN '1' THEN '1 Metro Pop 1M+'\n        WHEN '2' THEN '2 Metro Pop 250K - 1M'\n        WHEN '3' THEN '3 Metro Pop 250K'\n        WHEN '4' THEN '4 Urban 20K Metro adjacent'\n        WHEN '5' THEN '5 Urban 20K not adjacent'\n        WHEN '6' THEN '6 Urban 2500 - 19999 adjacent'\n        WHEN '7' THEN '7 Urban 2500 - 19999 not adjacent'\n        WHEN '8' THEN '8 Rural < 2500 urban adjacent'\n        WHEN '9' THEN '9 Rural < 2500 urban not adjacent'\n        ELSE '0 Unknown'\n    END AS  hh_county_size,\n\n    --DERIVING CORE BASED STATISTICAL AREA TYPE\n    CASE cv_cbsa_type\n        WHEN 'A' THEN 'Urban'\n        WHEN 'B' THEN 'Suburban'\n        WHEN 'C' THEN 'Rural'\n        ELSE 'Unknown'\n    END AS  hh_urban_suburban_rural,\n\n    --DERIVING THE COMBINED VALUE OF COUNTY CODE AND COUNTY NAME\n    CONCAT(cv_county_cd,'-',cv_county_name) AS HH_County,\n\n    --DERIVING STATE NAME FROM ABBREVATION\n    CASE cv_state_abb\n        WHEN 'AK' THEN 'Alaska'        WHEN 'AL' THEN 'Alabama'      WHEN 'AR' THEN 'Arkansas'             WHEN 'AZ' THEN 'Arizona'       WHEN 'CA' THEN 'California'\n        WHEN 'CO' THEN 'Colorado'      WHEN 'CT' THEN 'Connecticut'  WHEN 'DC' THEN 'District of Columbia' WHEN 'DE' THEN 'Delaware'\n        WHEN 'FL' THEN 'Florida'       WHEN 'GA' THEN 'Georgia'      WHEN 'HI' THEN 'Hawaii'               WHEN 'IA' THEN 'Iowa'          WHEN 'ID' THEN 'Idaho'\n        WHEN 'IL' THEN 'Illinois'      WHEN 'IN' THEN 'Indiana'      WHEN 'KS' THEN 'Kansas'               WHEN 'KY' THEN 'Kentucky'      WHEN 'LA' THEN 'Louisiana'\n        WHEN 'MA' THEN 'Massachusetts' WHEN 'MD' THEN 'Maryland'     WHEN 'ME' THEN 'Maine'                WHEN 'MI' THEN 'Michigan'      WHEN 'MN' THEN 'Minnesota'\n        WHEN 'MO' THEN 'Missouri'      WHEN 'MS' THEN 'Mississippi'  WHEN 'MT' THEN 'Montana'              WHEN 'NC' THEN 'North Carolina'\n        WHEN 'ND' THEN 'North Dakota'  WHEN 'NE' THEN 'Nebraska'     WHEN 'NH' THEN 'New Hampshire'        WHEN 'NJ' THEN 'New Jersey'\n        WHEN 'NM' THEN 'New Mexico'    WHEN 'NV' THEN 'Nevada'       WHEN 'NY' THEN 'New York'             WHEN 'OH' THEN 'Ohio'          WHEN 'OK' THEN 'Oklahoma'\n        WHEN 'OR' THEN 'Oregon'        WHEN 'PA' THEN 'Pennsylvania' WHEN 'RI' THEN 'Rhode Island'         WHEN 'SC' THEN 'South Carolina'\n        WHEN 'SD' THEN 'South Dakota'  WHEN 'TN' THEN 'Tennessee'    WHEN 'TX' THEN 'Texas'                WHEN 'UT' THEN 'Utah'          WHEN 'VA' THEN 'Virginia'\n        WHEN 'VT' THEN 'Vermont'       WHEN 'WA' THEN 'Washington'   WHEN 'WI' THEN 'Wisconsin'            WHEN 'WV' THEN 'West Virginia' WHEN 'WY' THEN 'Wyoming'\n        ELSE 'Unknown'\n    END AS hh_state,\n    --DERIVING CORE BASED STATISTICAL AREA\n    COALESCE(cbsa_list.cbsa_desc, 'Unknown') AS hh_cbsa\n\nFROM {{ ref('exp_geo_is') }} AS exp_geo_is\nLEFT OUTER JOIN {{ ref('cbsa_list') }} AS cbsa_list ON exp_geo_is.cv_cbsa = cbsa_list.cbsa_code", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "gc", "exp_geo_is_cg"], "unique_id": "model.sdna_project.exp_geo_is_cg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/gc/exp_geo_is_cg.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/gc/exp_geo_is_cg.sql", "name": "exp_geo_is_cg", "resource_type": "model", "alias": "exp_geo_is_cg", "checksum": {"name": "sha256", "checksum": "fbdfce4f2cdf4c6a4eabfbef0b94ced4fe3cfb79088e3030975b23b903b57507"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"], ["exp_geo_is"], ["cbsa_list"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is", "model.sdna_project.exp_geo_is", "model.sdna_project.cbsa_list"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_store_attr": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load table dx_store_attr\n\n-- {{ ref('btg_load_stat') }}\n-- {{ ref('btg_fl_sales_cust_v') }}\n-- {{ ref('btg_pbc_sales_cust_v') }}\n-- {{ ref('btg_msa_lat_lon_v') }}\n-- {{ ref('btg_fl_retailer_xref_v') }}\n-- {{ ref('btg_pbc_retailer_xref_v') }}\n-- {{ ref('dx_pbc_sales_cust_wk_prod') }}\n-- {{ ref('dx_msa_xref_der') }} xrefder\n-- {{ ref('dx_fl_sales_cust_wk_prod') }}\n-- {{ ref('dx_fl_trade_chnl_lkp') }}\n-- {{ ref('dx_pbc_trade_chnl_lkp') }}\n\nWITH fl_last_period AS (\n    SELECT\n\t\tdx_id AS msa_id,\n\t\tSUM(net_tkt_sale_amt) AS lpfl_sales\n\tFROM\n\t\t{{ ref('dx_fl_sales_cust_wk_prod') }} a\n\t\tJOIN {{ ref('btg_load_stat') }} b ON a.fscl_yr_num = b.curr_btg_load_year\n\tWHERE\n\t\ta.fscl_pd_num >= (b.curr_btg_load_pd_num - 2)\n\tGROUP BY\n\t\tdx_id\n),\n\npbc_last_period AS (\n\tSELECT\n\t\tdx_id AS msa_id,\n\t\tSUM(net_rev) AS lppbc_sales\n\tFROM\n\t\t{{ ref('dx_pbc_sales_cust_wk_prod') }} a\n\t\tJOIN {{ ref('btg_load_stat') }} b on a.fscl_yr_num = b.curr_btg_load_year\n\tWHERE\n\t\ta.fscl_pd_num >= (b.curr_btg_load_pd_num - 2)\n\tGROUP BY\n\t\tdx_id\n)\n\n,fl_attr AS ( \n    SELECT\n        xrefder.dx_id AS dx_id,\n        xrefder.fl_msa_id AS fl_msa_id,\n        xrefder.pbc_msa_id AS pbc_msa_id,\n        xrefder.dx_id_src AS dx_id_src,\n        CASE\n            WHEN ltrim(rtrim(flcustv.tdlinx_id))='' THEN NULL ELSE  upper(ltrim(rtrim(flcustv.tdlinx_id)))\n        END AS tdlinx_id,\n        flcustv.prmy_cust_nbr AS fl_prmy_cust_nbr,\n        pbcustv.pbc_cust_id AS pbc_cust_id,\n        CASE\n            WHEN ltrim(rtrim(flcustv.store_nbr)) IN ('0','00','000','0000','00000' ,'000000' )\n            OR ltrim(rtrim(flcustv.store_nbr))=''\n            THEN NULL ELSE  upper(ltrim(rtrim(flcustv.store_nbr)))\n        END AS fl_store_nbr,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.udf_num)) IN ('0','00','000','0000','00000' ,'000000' )\n            OR ltrim(rtrim(pbcustv.udf_num))='' THEN NULL ELSE  upper(ltrim(rtrim(pbcustv.udf_num)))\n        END AS pbc_store_nbr,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.cust_nm)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.cust_nm)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.nme)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.nme)))\n        END\n        END AS btg_store_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.cust_nm)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.cust_nm)))\n        END AS fl_cust_nm,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.nme)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.nme)))\n        END AS pbc_nm,\n        flcustv.rt_nbr AS fl_rt_nbr,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_str_addr1)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_str_addr1)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_strt1)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_strt1)))\n        END\n        END AS btg_address,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_city)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_city)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_city)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_city)))\n        END\n        END AS btg_city,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_st_prov)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_st_prov)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_state)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_state)))\n        END\n        END AS btg_state,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_cnty_sburb)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_cnty_sburb)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_cnty)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_cnty)))\n        END\n        END AS btg_county,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_ctry)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_ctry)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_cntry_cde)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_cntry_cde)))\n        END\n        END AS btg_country,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_post_code)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_post_code)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_zip)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_zip)))\n        END\n        END AS btg_zip,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.phy_loc_post_code_zip5)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.phy_loc_post_code_zip5)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.dely_adr_zip5)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.dely_adr_zip5)))\n        END\n        END AS btg_zip5,\n        CASE\n            WHEN xrefder.fl_msa_id=''\n         THEN NULL\n         ELSE\n        CASE\n            WHEN  flcustv.cust_end_date < current_date  or (lpfl_sales<= 0 or lpfl_sales is null)\n         THEN 'N' ELSE 'Y'\n        END\n        END AS fl_open_flg,\n        CASE\n            WHEN xrefder.pbc_msa_id=''\n        THEN NULL\n        ELSE\n           CASE\n            WHEN lppbc_sales<=0  or lppbc_sales is null then 'N'\n             ELSE 'Y'\n           END\n        END\n        AS pbc_open_flg,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN flcustv.first_sale_dt\n            WHEN xrefder.dx_id_src='PBC' THEN pbcustv.cust_added_dte\n        END AS btg_first_sale_date,\n         flcustv.first_sale_dt AS fl_first_sale_dte,\n        pbcustv.cust_added_dte AS pbc_cust_added_dte,\n        CASE\n            WHEN xrefder.dx_id_src='FL' THEN\n        CASE\n            WHEN ltrim(rtrim(flcustv.trade_seg_descp)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(flcustv.trade_seg_descp)))\n        END\n            WHEN xrefder.dx_id_src='PBC' THEN\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_aggr_desc)) ='' THEN NULL\n            ELSE\n            upper(ltrim(rtrim(pbcustv.bus_type_aggr_desc)))\n        END\n        END AS btg_trade_segment,\n        CASE\n            WHEN ltrim(rtrim(flcustv.bus_type_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.bus_type_code)))\n        END AS fl_bus_type_code,\n        CASE\n            WHEN ltrim(rtrim(flcustv.bus_type_descp))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.bus_type_descp)))\n        END AS fl_bus_type_descp,\n        CASE\n            WHEN ltrim(rtrim(flcustv.trade_seg_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.trade_seg_code)))\n        END AS fl_trade_seg_code,\n        CASE\n            WHEN ltrim(rtrim(flcustv.trade_seg_descp))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.trade_seg_descp)))\n        END AS fl_trade_seg_descp,\n        CASE\n            WHEN ltrim(rtrim(flcustv.trade_chanl_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.trade_chanl_code)))\n        END AS fl_trade_chanl_code,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_ctgy_desc))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_ctgy_desc)))\n        END AS pbc_format,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_cde))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_cde)))\n        END AS pbc_bus_type_cde,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_aggr_cde))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_aggr_cde)))\n        END AS pbc_bus_type_aggr_cde,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_aggr_desc))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_aggr_desc)))\n        END AS pbc_bus_type_aggr_desc,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_ctgy_cde))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_ctgy_cde)))\n        END AS pbc_bus_type_ctgy_cde,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.bus_type_ctgy_desc))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.bus_type_ctgy_desc)))\n        END AS pbc_bus_type_ctgy_desc,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl1_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl1_node_nbr)))\n        END AS fl_chain_lvl1_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl1_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl1_node_nm)))\n        END AS fl_chain_lvl1_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl2_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl2_node_nbr)))\n        END AS fl_chain_lvl2_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl2_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl2_node_nm)))\n        END AS fl_chain_lvl2_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl3_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl3_node_nbr)))\n        END AS fl_chain_lvl3_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl3_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl3_node_nm)))\n        END AS fl_chain_lvl3_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl4_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl4_node_nbr)))\n        END AS fl_chain_lvl4_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl4_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl4_node_nm)))\n        END AS fl_chain_lvl4_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl5_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl5_node_nbr)))\n        END AS fl_chain_lvl5_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl5_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl5_node_nm)))\n        END AS fl_chain_lvl5_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl6_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl6_node_nbr)))\n        END AS fl_chain_lvl6_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.chain_lvl6_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.chain_lvl6_node_nm)))\n        END AS fl_chain_lvl6_node_nm,\n        pbcustv.grp1_lvl_1_id  AS  pbc_grp1_lvl_1_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.grp1_lvl_1_desc))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.grp1_lvl_1_desc)))\n        END AS pbc_grp1_lvl_1_desc,\n        pbcustv.grp1_lvl_2_id AS  pbc_grp1_lvl_2_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.grp1_lvl_2_desc))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.grp1_lvl_2_desc)))\n        END AS pbc_grp1_lvl_2_desc,\n        latlnv.lat_qty AS latitude,\n        CASE\n            WHEN latlnv.lngtd_qty>0 THEN -1*(latlnv.lngtd_qty)\n            ELSE  latlnv.lngtd_qty\n        END AS longitude,\n        --latlnv.lngtd_qty AS longitude,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.cust_fobo_btlr_flg))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.cust_fobo_btlr_flg)))\n        END AS pbc_cust_fobo_btlr_flg,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.cust_fobo_cust_flg))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.cust_fobo_cust_flg)))\n        END AS pbc_cust_fobo_cust_flg,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.cust_fsv_flg))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.cust_fsv_flg)))\n        END AS pbc_cust_fsv_flg,\n        CASE\n            WHEN ltrim(rtrim(flcustv.serv_freq_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.serv_freq_code)))\n        END AS fl_serv_freq_code,\n        CASE\n            WHEN ltrim(rtrim(flcustv.serv_freq_descp))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.serv_freq_descp)))\n        END AS fl_serv_freq_descp,\n        flcustv.serv_wk_nbr AS fl_serv_wk_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.serv_day_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.serv_day_nbr)))\n        END AS fl_serv_day_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.deliv_freq_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.deliv_freq_code)))\n        END AS fl_deliv_freq_code,\n        flcustv.deliv_wk_nbr AS fl_deliv_wk_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.deliv_day_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.deliv_day_nbr)))\n        END AS fl_deliv_day_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.prod_deliv_freq_code))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.prod_deliv_freq_code)))\n        END AS fl_prod_deliv_freq_code,\n        CASE\n            WHEN ltrim(rtrim(flcustv.prod_deliv_freq_descp))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.prod_deliv_freq_descp)))\n        END AS fl_prod_deliv_freq_descp,\n\n        flcustv.prod_deliv_wk_nbr AS fl_prod_deliv_wk_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.prod_deliv_day_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.prod_deliv_day_nbr)))\n        END AS fl_prod_deliv_day_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl1_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl1_node_nbr)))\n        END AS fl_geo_lvl1_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl1_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl1_node_nm)))\n        END AS fl_geo_lvl1_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl2_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl2_node_nbr)))\n        END AS fl_geo_lvl2_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl2_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl2_node_nm)))\n        END AS fl_geo_lvl2_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl3_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl3_node_nbr)))\n        END AS fl_geo_lvl3_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl3_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl3_node_nm)))\n        END AS fl_geo_lvl3_node_nm,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl4_node_nbr))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl4_node_nbr)))\n        END AS fl_geo_lvl4_node_nbr,\n        CASE\n            WHEN ltrim(rtrim(flcustv.geo_lvl4_node_nm))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(flcustv.geo_lvl4_node_nm)))\n        END AS fl_geo_lvl4_node_nm,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_prod_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_prod_nme)))\n        END AS pbc_loc_prod_nme,\n        pbcustv.loc_prod_mu_id AS pbc_loc_prod_mu_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_prod_mu_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_prod_mu_nme)))\n        END AS pbc_loc_prod_mu_nme,\n        pbcustv.loc_prod_bu_id AS pbc_loc_prod_bu_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_prod_bu_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_prod_bu_nme)))\n        END AS pbc_loc_prod_bu_nme,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_serv_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_serv_nme)))\n        END AS pbc_loc_serv_nme,\n        pbcustv.loc_serv_mu_id AS pbc_loc_serv_mu_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_serv_mu_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_serv_mu_nme)))\n        END AS pbc_loc_serv_mu_nme,\n        pbcustv.loc_serv_bu_id AS pbc_loc_serv_bu_id,\n        CASE\n            WHEN ltrim(rtrim(pbcustv.loc_serv_bu_nme))='' THEN NULL\n            ELSE  upper(ltrim(rtrim(pbcustv.loc_serv_bu_nme)))\n        END AS pbc_loc_serv_bu_nme\n        FROM {{ ref('dx_msa_xref_der') }} xrefder\n       LEFT JOIN {{ ref('btg_fl_sales_cust_v') }} flcustv\n    ON xrefder.fl_msa_id=flcustv.msa_id\n    LEFT JOIN {{ ref('btg_pbc_sales_cust_v') }} pbcustv  ON xrefder.pbc_msa_id=pbcustv.msa_id\n    LEFT JOIN pbc_last_period lppbc on xrefder.pbc_msa_id=lppbc.msa_id\n    LEFT JOIN fl_last_period lpfl on xrefder.fl_msa_id=lpfl.msa_id\n    LEFT JOIN {{ ref('btg_msa_lat_lon_v') }} latlnv ON xrefder.dx_id=latlnv.msa_id\n)\n\n--Get Consistent spelling and store format for for FL stores\n,fl_chnl_attr AS (\n    SELECT\n        flcustv.msa_id as msa_id ,\n\t\tltrim(rtrim(upper(flchnlkp.dx_trade_chanl_descp))) as dx_trade_chanl_descp,\n\t\tltrim(rtrim(upper(flchnlkp.dx_store_format))) AS fl_format,\n\t\tltrim(rtrim(upper(flchnlkp.dx_include_flg))) as fl_include_flg\n    FROM  {{ ref('btg_fl_sales_cust_v') }} flcustv \n    INNER JOIN {{ ref('dx_fl_trade_chnl_lkp') }} flchnlkp ON rtrim(ltrim(upper(flcustv.trade_chanl_descp)))=rtrim(ltrim(UPPER(flchnlkp.trade_chanl_descp)))\n)\n\n--Get FL Consistent spelling for PBC stores\n, pbc_chnl_attr AS (\n    SELECT\n        pbcustv.msa_id as msa_id ,\n        ltrim(rtrim(upper(pbchnlkp.bus_type_desc))) as bus_type_desc,\n        ltrim(rtrim(upper(pbchnlkp.dx_trade_chanl_descp))) as dx_trade_chanl_descp,\n        ltrim(rtrim(upper(pbchnlkp.dx_include_flg))) as pbc_include_flg\n    FROM {{ ref('btg_pbc_sales_cust_v') }} pbcustv\n    INNER JOIN {{ ref('dx_pbc_trade_chnl_lkp') }} pbchnlkp ON rtrim(ltrim(upper(pbcustv.bus_type_desc)))=rtrim(ltrim(UPPER(pbchnlkp.bus_type_desc)))\n)\n\n--Get inputs from FL Retailer tables\n, fl_retlr_attr AS (\n    SELECT\n        fl_retlr.msa_id as msa_id,\n        ltrim(rtrim(upper(fl_retlr.fl_retailer))) as fl_retailer\n    FROM {{ ref('btg_fl_retailer_xref_v') }} fl_retlr\n)\n\n--Get inputs from PBC Retailer table\n, pbc_retlr_attr AS (\n    SELECT\n        pbc_retlr.msa_id as msa_id,\n        ltrim(rtrim(upper(pbc_retlr.pbc_retailer))) as pbc_retailer\n    FROM {{ ref('btg_pbc_retailer_xref_v') }} pbc_retlr\n)\n\n--Get the final list of both FL and PBC attributes along with consistent spelling and FL store format\n, fl_pbc_dx_attr AS (\n    SELECT \n \t    fl_attr.dx_id,\n\t    fl_attr.fl_msa_id,\n\t    fl_attr.pbc_msa_id,\n\t    fl_attr.dx_id_src,\n\t    fl_attr.tdlinx_id,\n\t    fl_attr.fl_prmy_cust_nbr,\n\t\tfl_attr.pbc_cust_id,\n\t    fl_attr.fl_store_nbr,\n\t    fl_attr.pbc_store_nbr,\n\t    CASE\n        WHEN fl_attr.dx_id_src='FL' \n        then\n        case when fl_attr.fl_store_nbr IS NOT NULL \n        THEN fl_attr.fl_store_nbr\n        ELSE\n        fl_attr.pbc_store_nbr\n        end\n        else \n        CASE WHEN \n            fl_attr.dx_id_src='PBC' \n        then\n        case when\n        fl_attr.pbc_store_nbr IS NOT NULL \n        THEN\n        fl_attr.pbc_store_nbr\n        else \n        fl_attr.fl_store_nbr\n        end\n        end\n    \tEND AS btg_retailer_store_nbr,\n \t    fl_attr.btg_store_nm,\n\t    fl_attr.fl_cust_nm,\n\t\tfl_attr.pbc_nm,\n\t    fl_attr.fl_rt_nbr,\n\t    fl_attr.btg_address,\n\t    fl_attr.btg_city,\n\t    fl_attr.btg_state,\n\t    fl_attr.btg_county,\n\t    fl_attr.btg_country,\n\t    fl_attr.btg_zip,\n\t    fl_attr.btg_zip5,\n\t    CASE when fl_attr.dx_id_src='FL' and fl_attr.pbc_open_flg='Y' then 'Y'\n\t         when fl_attr.dx_id_src='FL' and (fl_attr.pbc_open_flg<>'Y' or fl_attr.pbc_open_flg is null) then  fl_attr.fl_open_flg \n\t         when fl_attr.dx_id_src='PBC' then fl_attr.pbc_open_flg end as  btg_open_flg,\n\t    fl_attr.fl_open_flg,\n\t    fl_attr.pbc_open_flg,\n\t    fl_attr.btg_first_sale_date,\t \n\t    fl_attr.fl_first_sale_dte,\n\t    fl_attr.pbc_cust_added_dte,\n\t    fl_attr.btg_trade_segment,\n    CASE\n        WHEN \n        fl_attr.dx_id_src='FL' \n        THEN\n    CASE\n        WHEN \n        fl_chnl_attr.fl_include_flg='Y'  \n        THEN fl_chnl_attr.dx_trade_chanl_descp \n        ELSE pbc_chnl_attr.dx_trade_chanl_descp\n    END\n        ELSE\n    CASE\n        WHEN   \n        fl_attr.dx_id_src='PBC'  THEN\n    CASE\n        WHEN   pbc_chnl_attr.pbc_include_flg='Y' \n        THEN pbc_chnl_attr.dx_trade_chanl_descp\n        ELSE fl_chnl_attr.dx_trade_chanl_descp\n    END\n    END \n    --If only one of the msa id's is included, populate btg_trade_channel accordingly.\n    END AS btg_trade_channel,\n    \tfl_attr.fl_bus_type_code,\n\t    fl_attr.fl_bus_type_descp,\n\t    fl_attr.fl_trade_seg_code,\n\t    fl_attr.fl_trade_seg_descp,\n\t    fl_attr.fl_trade_chanl_code,\n\t    fl_chnl_attr.dx_trade_chanl_descp as fl_trade_chanl_descp,\n    CASE\n     WHEN fl_attr.dx_id_src='FL' \n        THEN\n    CASE\n        WHEN \n        fl_chnl_attr.fl_include_flg='Y'  \n        THEN fl_chnl_attr.fl_format \n        ELSE fl_attr.pbc_format\n    END\n        ELSE\n    CASE\n        WHEN   \n        fl_attr.dx_id_src='PBC'  THEN\n    CASE\n        WHEN   \n        pbc_chnl_attr.pbc_include_flg='Y' \n        THEN fl_attr.pbc_format\n        ELSE fl_chnl_attr.fl_format \n    END\n    END\n    END AS btg_format,\n\t   fl_chnl_attr.fl_format,\n\t    fl_attr.pbc_format,\n\t    fl_attr.pbc_bus_type_cde,\n\t    pbc_chnl_attr.dx_trade_chanl_descp AS pbc_bus_type_desc,\n\t    fl_attr.pbc_bus_type_aggr_cde,\n\t    fl_attr.pbc_bus_type_aggr_desc,\n\t    fl_attr.pbc_bus_type_ctgy_cde,\n\t    fl_attr.pbc_bus_type_ctgy_desc,\n\t    fl_attr.fl_chain_lvl1_node_nbr,\n\t    fl_attr.fl_chain_lvl1_node_nm,\n\t    fl_attr.fl_chain_lvl2_node_nbr,\n\t    fl_attr.fl_chain_lvl2_node_nm,\n\t    fl_attr.fl_chain_lvl3_node_nbr,\n\t    fl_attr.fl_chain_lvl3_node_nm,\n\t    fl_attr.fl_chain_lvl4_node_nbr,\n\t    fl_attr.fl_chain_lvl4_node_nm,\n\t    fl_attr.fl_chain_lvl5_node_nbr,\n\t    fl_attr.fl_chain_lvl5_node_nm,\n\t    fl_attr.fl_chain_lvl6_node_nbr,\n\t    fl_attr.fl_chain_lvl6_node_nm,\n\t    fl_attr.pbc_grp1_lvl_1_id,\n\t    fl_attr.pbc_grp1_lvl_1_desc,\n\t    fl_attr.pbc_grp1_lvl_2_id,\n\t    fl_attr.pbc_grp1_lvl_2_desc,\n\t    fl_attr.latitude,\n\t    fl_attr.longitude,\n\t    fl_attr.pbc_cust_fobo_btlr_flg,\n\t    fl_attr.pbc_cust_fobo_cust_flg,\n\t    fl_attr.pbc_cust_fsv_flg,\n\t    fl_attr.fl_serv_freq_code,\n\t    fl_attr.fl_serv_freq_descp,\n\t    fl_attr.fl_serv_wk_nbr,\n\t    fl_attr.fl_serv_day_nbr,\n\t    fl_attr.fl_deliv_freq_code,\n\t    fl_attr.fl_deliv_wk_nbr,\n\t    fl_attr.fl_deliv_day_nbr,\n\t    fl_attr.fl_prod_deliv_freq_code,\n\t    fl_attr.fl_prod_deliv_freq_descp,\n\t    fl_attr.fl_prod_deliv_wk_nbr,\n\t    fl_attr.fl_prod_deliv_day_nbr,\n\t    fl_attr.fl_geo_lvl1_node_nbr,\n\t    fl_attr.fl_geo_lvl1_node_nm,\n\t    fl_attr.fl_geo_lvl2_node_nbr,\n\t    fl_attr.fl_geo_lvl2_node_nm,\n\t    fl_attr.fl_geo_lvl3_node_nbr,\n\t    fl_attr.fl_geo_lvl3_node_nm,\n\t    fl_attr.fl_geo_lvl4_node_nbr,\n\t    fl_attr.fl_geo_lvl4_node_nm,\n\t    fl_attr.pbc_loc_prod_nme,\n\t    fl_attr.pbc_loc_prod_mu_id,\n\t    fl_attr.pbc_loc_prod_mu_nme,\n\t    fl_attr.pbc_loc_prod_bu_id,\n\t    fl_attr.pbc_loc_prod_bu_nme,\n\t    fl_attr.pbc_loc_serv_nme,\n\t    fl_attr.pbc_loc_serv_mu_id,\n\t    fl_attr.pbc_loc_serv_mu_nme,\n\t    fl_attr.pbc_loc_serv_bu_id,\n\t    fl_attr.pbc_loc_serv_bu_nme,\n    --populate retailer data\n    --fl_retailer     \n    CASE\n        WHEN ltrim(rtrim(fl_retlr_attr.fl_retailer)) ='' THEN NULL\n        ELSE\n        upper(ltrim(rtrim(fl_retlr_attr.fl_retailer)))\n    END AS fl_retailer,\n    --pbc_retailer\n    CASE\n        WHEN ltrim(rtrim(pbc_retlr_attr.pbc_retailer)) ='' THEN NULL\n        ELSE\n        upper(ltrim(rtrim(pbc_retlr_attr.pbc_retailer)))\n    END AS pbc_retailer,\n    --btg_retailer\n    CASE\n        WHEN fl_attr.dx_id_src='FL' THEN\n    CASE\n        WHEN ltrim(rtrim(fl_retlr_attr.fl_retailer)) ='' THEN NULL\n        ELSE\n        upper(ltrim(rtrim(fl_retlr_attr.fl_retailer)))\n    END\n        WHEN fl_attr.dx_id_src='PBC' THEN\n    CASE\n        WHEN ltrim(rtrim(pbc_retlr_attr.pbc_retailer)) ='' THEN NULL\n        ELSE\n        upper(ltrim(rtrim(pbc_retlr_attr.pbc_retailer)))\n    END\n    END AS btg_retailer\n    FROM fl_attr\n    LEFT JOIN fl_chnl_attr ON fl_attr.fl_msa_id=fl_chnl_attr.msa_id\n    LEFT JOIN pbc_chnl_attr ON fl_attr.pbc_msa_id=pbc_chnl_attr.msa_id\n    LEFT JOIN fl_retlr_attr ON fl_attr.fl_msa_id=fl_retlr_attr.msa_id\n    LEFT JOIN pbc_retlr_attr ON fl_attr.pbc_msa_id=pbc_retlr_attr.msa_id\n)\nSELECT\n    *,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM fl_pbc_dx_attr", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "dx_store_attr"], "unique_id": "model.sdna_project.dx_store_attr", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/dx_store_attr.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/dx_store_attr.sql", "name": "dx_store_attr", "resource_type": "model", "alias": "dx_store_attr", "checksum": {"name": "sha256", "checksum": "e653afe485a7c51d7be22c951838398ce43d1f89bd8f6b810ab1c3f1894e657f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_load_stat"], ["btg_fl_sales_cust_v"], ["btg_pbc_sales_cust_v"], ["btg_msa_lat_lon_v"], ["btg_fl_retailer_xref_v"], ["btg_pbc_retailer_xref_v"], ["dx_pbc_sales_cust_wk_prod"], ["dx_msa_xref_der"], ["dx_fl_sales_cust_wk_prod"], ["dx_fl_trade_chnl_lkp"], ["dx_pbc_trade_chnl_lkp"], ["dx_fl_sales_cust_wk_prod"], ["btg_load_stat"], ["dx_pbc_sales_cust_wk_prod"], ["btg_load_stat"], ["dx_msa_xref_der"], ["btg_fl_sales_cust_v"], ["btg_pbc_sales_cust_v"], ["btg_msa_lat_lon_v"], ["btg_fl_sales_cust_v"], ["dx_fl_trade_chnl_lkp"], ["btg_pbc_sales_cust_v"], ["dx_pbc_trade_chnl_lkp"], ["btg_fl_retailer_xref_v"], ["btg_pbc_retailer_xref_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_load_stat", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_trade_chnl_lkp", "model.sdna_project.dx_pbc_trade_chnl_lkp", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.btg_load_stat", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.btg_load_stat", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.dx_fl_trade_chnl_lkp", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.dx_pbc_trade_chnl_lkp", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load exp_geo\n\n-- {{ ref('exp_geo_lmtd_cv') }}\n-- {{ ref('experian_cv_stg') }}\n\nSELECT\n    exp.cv_living_unit_id,\n\texp.cv_address_id,\n\texp.cv_short_city_name,\n\texp.cv_city_name,\n\texp.cv_county_name,\n\texp.cv_state_abb,\n\texp.cv_zipcode_5,\n\texp.cv_zipcode_4,\n\texp.cv_zipcode_9,\n\texp.cv_zip_locality,\n\texp.cv_delvy_pt_bar_cd,\n\texp.cv_carr_route,\n\texp.cv_state_cd,\n\texp.cv_county_cd,\n\texp.cv_cen2010_tract_block_grp,\n\texp.cv_cen2010_blockid,\n\texp.cv_latitude,\n\texp.cv_longitude,\n\texp.cv_mat_level_geodata,\n\texp.cv_addr_qlty_ind,\n\texp.cv_recp_reliable_cd,\n\texp.cv_acty_dt,\n\texp.cv_tme_zn,\n\texp.cv_p1_pid,\n\texp.cv_p1_ptyp,\n\texp.cv_p1_etnc_etnc,\n\texp.cv_p1_etnc_exp_grp,\n\texp.cv_p1_etnc_religion,\n\texp.cv_p1_etnc_lang_pref,\n\texp.cv_p1_etnc_grp,\n\texp.cv_p1_etnc_country_of_origin,\n\texp.cv_p1_gender,\n\texp.cv_p1_birth_dt,\n\texp.cv_p1_est_age,\n\texp.cv_p1_exact_age,\n\texp.cv_p1_com_age,\n\texp.cv_p1_edu_mdl,\n\texp.cv_p1_marital_st,\n\texp.cv_p1_occ_grp,\n\texp.cv_p1_occ_cd,\n\texp.cv_p1_bus_own,\n\texp.cv_p2_pid,\n\texp.cv_p2_ptyp,\n\texp.cv_p2_etnc_etnc,\n\texp.cv_p2_etnc_exp_grp,\n\texp.cv_p2_etnc_religion,\n\texp.cv_p2_etnc_lang_pref,\n\texp.cv_p2_etnc_grp,\n\texp.cv_p2_etnc_country_of_origin,\n\texp.cv_p2_gender,\n\texp.cv_p2_birth_dt,\n\texp.cv_p2_est_age,\n\texp.cv_p2_exact_age,\n\texp.cv_p2_com_age,\n\texp.cv_p2_edu_mdl,\n\texp.cv_p2_marital_st,\n\texp.cv_p2_occ_grp,\n\texp.cv_p2_occ_cd,\n\texp.cv_p2_bus_own,\n\texp.cv_p3_pid,\n\texp.cv_p3_ptyp,\n\texp.cv_p3_etnc_etnc,\n\texp.cv_p3_etnc_exp_grp,\n\texp.cv_p3_etnc_religion,\n\texp.cv_p3_etnc_lang_pref,\n\texp.cv_p3_etnc_grp,\n\texp.cv_p3_etnc_country_of_origin,\n\texp.cv_p3_gender,\n\texp.cv_p3_birth_dt,\n\texp.cv_p3_est_age,\n\texp.cv_p3_exact_age,\n\texp.cv_p3_com_age,\n\texp.cv_p3_edu_mdl,\n\texp.cv_p3_marital_st,\n\texp.cv_p3_occ_grp,\n\texp.cv_p3_occ_cd,\n\texp.cv_p3_bus_own,\n\texp.cv_p4_pid,\n\texp.cv_p4_ptyp,\n\texp.cv_p4_etnc_etnc,\n\texp.cv_p4_etnc_exp_grp,\n\texp.cv_p4_etnc_religion,\n\texp.cv_p4_etnc_lang_pref,\n\texp.cv_p4_etnc_grp,\n\texp.cv_p4_etnc_country_of_origin,\n\texp.cv_p4_gender,\n\texp.cv_p4_birth_dt,\n\texp.cv_p4_est_age,\n\texp.cv_p4_exact_age,\n\texp.cv_p4_com_age,\n\texp.cv_p4_edu_mdl,\n\texp.cv_p4_marital_st,\n\texp.cv_p4_occ_grp,\n\texp.cv_p4_occ_cd,\n\texp.cv_p4_bus_own,\n\texp.cv_p5_pid,\n\texp.cv_p5_ptyp,\n\texp.cv_p5_etnc_etnc,\n\texp.cv_p5_etnc_exp_grp,\n\texp.cv_p5_etnc_religion,\n\texp.cv_p5_etnc_lang_pref,\n\texp.cv_p5_etnc_grp,\n\texp.cv_p5_etnc_country_of_origin,\n\texp.cv_p5_gender,\n\texp.cv_p5_birth_dt,\n\texp.cv_p5_est_age,\n\texp.cv_p5_exact_age,\n\texp.cv_p5_com_age,\n\texp.cv_p5_edu_mdl,\n\texp.cv_p5_marital_st,\n\texp.cv_p5_occ_grp,\n\texp.cv_p5_occ_cd,\n\texp.cv_p5_bus_own,\n\texp.cv_p6_pid,\n\texp.cv_p6_ptyp,\n\texp.cv_p6_etnc_etnc,\n\texp.cv_p6_etnc_exp_grp,\n\texp.cv_p6_etnc_religion,\n\texp.cv_p6_etnc_lang_pref,\n\texp.cv_p6_etnc_grp,\n\texp.cv_p6_etnc_country_of_origin,\n\texp.cv_p6_gender,\n\texp.cv_p6_birth_dt,\n\texp.cv_p6_est_age,\n\texp.cv_p6_exact_age,\n\texp.cv_p6_com_age,\n\texp.cv_p6_edu_mdl,\n\texp.cv_p6_marital_st,\n\texp.cv_p6_occ_grp,\n\texp.cv_p6_occ_cd,\n\texp.cv_p6_bus_own,\n\texp.cv_mor,\n\texp.cv_mor_bank_book,\n\texp.cv_mor_bank_spl_food,\n\texp.cv_mor_bank_craft_merch,\n\texp.cv_mor_bank_culinary_int,\n\texp.cv_mor_bank_dedupe_hit,\n\texp.cv_mor_bank_doit_yourself,\n\texp.cv_mor_bank_famgen_mag,\n\texp.cv_mor_bank_f_merch,\n\texp.cv_mor_bank_f_orient_mag,\n\texp.cv_mor_bank_gar_farm_buy,\n\texp.cv_mor_bank_gar_farm_mag,\n\texp.cv_mor_bank_gen_contrib,\n\texp.cv_mor_bank_gen_merch,\n\texp.cv_mor_bank_gift_gadgs,\n\texp.cv_mor_bank_health_inst_contib,\n\texp.cv_mor_bank_health_fit_mag,\n\texp.cv_mor_bank_m_merch,\n\texp.cv_mor_bank_m_sports_mag,\n\texp.cv_mor_bank_misc,\n\texp.cv_mor_bank_nondedupe_hit,\n\texp.cv_mor_bank_odds_end,\n\texp.cv_mor_bank_opp_seek_ce,\n\texp.cv_mor_bank_photograph,\n\texp.cv_mor_bank_political_cont,\n\texp.cv_mor_bank_religious_cont,\n\texp.cv_mor_bank_religious_mag,\n\texp.cv_mor_bank_upscale_merch,\n\texp.cv_mor_bank_news_finan,\n\texp.cv_ncoa_cd,\n\texp.cv_ncoa_dt,\n\texp.cv_green_aware,\n\texp.cv_green_aware_deciles,\n\texp.cv_no_adults_unit,\n\texp.cv_no_pers_unit,\n\texp.cv_no_child_unit,\n\texp.cv_child_age_0_3,\n\texp.cv_child_age_4_6,\n\texp.cv_child_age_7_9,\n\texp.cv_child_age_10_12,\n\texp.cv_child_age_13_15,\n\texp.cv_child_age_16_18,\n\texp.cv_mosaic_household,\n\texp.cv_mosaic_zip4,\n\texp.cv_home_bus,\n\texp.cv_dwelling_type,\n\texp.cv_dwelling_unit_size,\n\texp.cv_length_of_residence,\n\texp.cv_household_comp,\n\texp.cv_hmeown_hmeown,\n\texp.cv_hmeown_prob_hmeown,\n\texp.cv_hmeown_comb_hmeown_renter,\n\texp.cv_est_curr_hme_val,\n\texp.cv_est_curr_hme_val_range,\n\texp.cv_cons_vw_proft,\n\texp.cv_incom_per_national,\n\texp.cv_county_ehi_per,\n\texp.cv_auto_in_market_new,\n\texp.cv_aut_mark_used,\n\texp.cv_aut_mark_used_0_5_vehicle,\n\texp.cv_aut_mark_used_11_vehicle,\n\texp.cv_aut_mark_used_6_10_vehicle,\n\texp.cv_est_inc_amtv5,\n\texp.cv_est_hh_incv5,\n\texp.cv_county_echv_index,\n\texp.cv_county_echv_per,\n\texp.cv_state_ehi_index,\n\texp.cv_county_ehi_index,\n\texp.cv_cen_rur_urban_county_szcd,\n\texp.cv_cbsa,\n\texp.cv_cbsa_type,\n\texp.cv_cape_edu_ispsa,\n\texp.cv_cape_edu_ispsa_decile,\n\texp.cv_cape_inc_fam_state_decile,\n\texp.cv_cape_dens_per_per_pop,\n\texp.cv_cape_age_pop_0_17,\n\texp.cv_cape_age_pop_0_4,\n\texp.cv_cape_age_pop_5_9,\n\texp.cv_cape_age_pop_10_13,\n\texp.cv_cape_age_pop_14_17,\n\texp.cv_cape_age_pop_18_99,\n\texp.cv_cape_age_pop_65_99,\n\texp.cv_cape_age_pop_median_age,\n\texp.cv_cape_built_median_hous_age,\n\texp.cv_cape_child_couple_famw_lt18,\n\texp.cv_cape_child_couple_famwo_lt18,\n\texp.cv_cape_child_wper_lt18,\n\texp.cv_cape_edu_pop25_med_edu_attain,\n\texp.cv_cape_occ_empid_health_tech,\n\texp.cv_cape_ethnic_pop_black_only,\n\texp.cv_cape_ethnic_pop_asian_only,\n\texp.cv_cape_ethnic_pop_hispanic,\n\texp.cv_cape_ethnic_pop_white_only,\n\texp.cv_cape_avg_hh_size,\n\texp.cv_cape_oohu_med_hme_val,\n\texp.cv_cape_hu_mob_hme,\n\texp.cv_cape_med_fam_hh_inc,\n\texp.cv_cape_lang_spanish_speak,\n\texp.cv_cape_occhu_own_occu,\n\texp.cv_cape_oochu_rent_occu,\n\texp.cv_cape_marr_couple_fam,\n\texp.cv_hh_int_read_bible_devo,\n\texp.cv_hh_pc_use_net_service,\n\texp.cv_hh_crafts,\n\texp.cv_hh_finan_stks_bond,\n\texp.cv_hh_finan_cds_money_mkt,\n\texp.cv_hh_finan_iras_currently,\n\texp.cv_hh_finan_mutual_funds,\n\texp.cv_hh_finan_real_estate,\n\texp.cv_act_amusement_park_visit,\n\texp.cv_act_zoo_visit,\n\texp.cv_act_coffee_connoisseurs,\n\texp.cv_act_wine_lover,\n\texp.cv_act_doit_yourself,\n\texp.cv_act_hme_imp_spenders,\n\texp.cv_act_hunt_enthus,\n\texp.cv_act_digi_mag_buyer,\n\texp.cv_act_attend_edu_pgm,\n\texp.cv_act_video_gamer,\n\texp.cv_act_mlb_enthus,\n\texp.cv_act_nascar_enthus,\n\texp.cv_act_nba_enthus,\n\texp.cv_act_nfl_enthus,\n\texp.cv_act_nhl_enthus,\n\texp.cv_act_pga_tour_enthus,\n\texp.cv_act_politics_viewing_tv_lib,\n\texp.cv_act_politics_viewing_tv_libcom,\n\texp.cv_act_politics_viewing_tv_conserv,\n\texp.cv_act_eats_fam_restaurant,\n\texp.cv_act_eats_ff_restaurant,\n\texp.cv_act_canoeing_kayaking,\n\texp.cv_act_play_golf,\n\texp.cv_act_gourment_cooking,\n\texp.cv_act_cat_owners,\n\texp.cv_act_dog_owners,\n\texp.cv_act_pet_enthus,\n\texp.cv_act_arts_crafts,\n\texp.cv_act_scrapbooking,\n\texp.cv_act_cultural_arts,\n\texp.cv_hobbies_gardening,\n\texp.cv_act_photography,\n\texp.cv_act_book_reader,\n\texp.cv_act_ebook_reader,\n\texp.cv_act_audiobook_reader,\n\texp.cv_act_avid_runners,\n\texp.cv_act_outdoor_enthus,\n\texp.cv_act_fishing,\n\texp.cv_act_snow_sport,\n\texp.cv_act_boating,\n\texp.cv_act_plays_hockey,\n\texp.cv_act_plays_soccer,\n\texp.cv_act_plays_tennis,\n\texp.cv_act_sport_enthusiast,\n\texp.cv_act_healthy_living,\n\texp.cv_act_fitness_enthus,\n\texp.cv_act_on_diet,\n\texp.cv_act_weight_conscious,\n\texp.cv_act_casino_gambling,\n\texp.cv_act_sweepstakes_lottery,\n\texp.cv_act_music_download,\n\texp.cv_act_music_stream,\n\texp.cv_act_listen_christian_music,\n\texp.cv_act_listen_classical_music,\n\texp.cv_act_listen_country_music,\n\texp.cv_act_listen_music,\n\texp.cv_act_listen_oldies_music,\n\texp.cv_act_listen_rock_music,\n\texp.cv_act_listen_80s_music,\n\texp.cv_act_listen_hiphop_music,\n\texp.cv_act_listen_alter_music,\n\texp.cv_act_listen_jazz_music,\n\texp.cv_act_listen_pop_music,\n\texp.cv_buyer_lap_own,\n\texp.cv_buyer_security_sys_own,\n\texp.cv_buyer_tab_own,\n\texp.cv_buyer_coupon_users,\n\texp.cv_buyer_lux_store_shopp,\n\texp.cv_buyer_lux_hme_goods_shopp,\n\texp.cv_buyer_yng_adult_cloth_shopp,\n\texp.cv_buyer_supercenter_shopp,\n\texp.cv_buyer_warehouse_club_mem,\n\texp.cv_buyer_loyalty_card_usr,\n\texp.cv_buyer_presence_auto,\n\texp.cv_buyer_nonpres_makeup_usr,\n\texp.cv_buyer_pres_makeup_usr,\n\texp.cv_buyer_highend_spirit_drinker,\n\texp.cv_lfstyl_lf_insure_plcy_hldr,\n\texp.cv_lfstyl_med_insure_plcy_hldrs,\n\texp.cv_lfstyl_medicare_plcy_hldrs,\n\texp.cv_lfstyl_have_grand_child,\n\texp.cv_lfstyl_high_freq_business_trav,\n\texp.cv_lfstyl_high_freq_cruise_enthus,\n\texp.cv_lfstyl_high_freq_domes_vacationer,\n\texp.cv_lfstyl_high_freq_forgn_vacationer,\n\texp.cv_lfstyl_freq_fly_pgm_mem,\n\texp.cv_lfstyl_hostel_guest_loyal_pgm,\n\texp.cv_lfstyl_interest_religion,\n\texp.cv_lfstyl_military_act,\n\texp.cv_lfstyl_military_inact,\n\texp.cv_donor_contrib_charities,\n\texp.cv_donor_contrib_arts_charities,\n\texp.cv_donor_contrib_edu_charities,\n\texp.cv_donor_contrib_health_charities,\n\texp.cv_donor_contrib_political_charities,\n\texp.cv_donor_contrib_pvt_found,\n\texp.cv_donor_contrib_volunteer,\n\texp.cv_finan_debit_card_usr,\n\texp.cv_finan_corp_credit_card_usr,\n\texp.cv_finan_major_credit_card_usr,\n\texp.cv_finan_premium_credit_card_usr,\n\texp.cv_finan_credit_card_usr,\n\texp.cv_finan_store_credit_card_usr,\n\texp.cv_invest_retire_finan_plan,\n\texp.cv_invest_part_online_trade,\n\texp.cv_invest_brokerage_acct_own,\n\texp.cv_invest_actv_investor,\n\texp.cv_invest_mutual_fund_invest,\n\texp.cv_memship_aarp_mem,\n\texp.cv_memship_union_mem,\n\texp.cv_tt_brick_mortar,\n\texp.cv_tt_onlie_mid_high,\n\texp.cv_tt_etailer,\n\texp.cv_tt_online_discount,\n\texp.cv_tt_online_bid_mrktplc,\n\texp.cv_tt_broadcast_cable_tv,\n\texp.cv_tt_direct_mail,\n\texp.cv_tt_email,\n\texp.cv_tt_internet_radio,\n\texp.cv_tt_mobile_display,\n\texp.cv_tt_mobile_video,\n\texp.cv_tt_online_video,\n\texp.cv_tt_online_display,\n\texp.cv_tt_online_stream_tv,\n\texp.cv_tt_satellite_radio,\n\texp.cv_tt_buy_american,\n\texp.cv_tt_showme_money,\n\texp.cv_tt_go_with_flow,\n\texp.cv_tt_no_time_like_present,\n\texp.cv_tt_never_empty_handed,\n\texp.cv_tt_on_road_again,\n\texp.cv_tt_look_at_me_now,\n\texp.cv_tt_stop_smell_roses,\n\texp.cv_tt_wrk_hard_play_hard,\n\texp.cv_tt_penny_saved_penny_earned,\n\texp.cv_tt_its_all_in_name,\n\texp.cv_p1_retail_shopp,\n\texp.cv_p2_retail_shopp,\n\texp.cv_p3_retail_shopp,\n\texp.cv_p4_retail_shopp,\n\texp.cv_p5_retail_shopp,\n\texp.cv_p6_retail_shopp,\n\texp.cv_p1_health_well_being,\n\texp.cv_p2_health_well_being,\n\texp.cv_p3_health_well_being,\n\texp.cv_p4_health_well_being,\n\texp.cv_p5_health_well_being,\n\texp.cv_p6_health_well_being,\n\texp.cv_p1_mobile_usrs,\n\texp.cv_p2_mobile_usrs,\n\texp.cv_p3_mobile_usrs,\n\texp.cv_p4_mobile_usrs,\n\texp.cv_p5_mobile_usrs,\n\texp.cv_p6_mobile_usrs,\n\texp.cv_p1_tech_adoption,\n\texp.cv_p2_tech_adoption,\n\texp.cv_p3_tech_adoption,\n\texp.cv_p4_tech_adoption,\n\texp.cv_p5_tech_adoption,\n\texp.cv_p6_tech_adoption,\n\texp.cv_p1_mor,\n\texp.cv_p2_mor,\n\texp.cv_p3_mor,\n\texp.cv_p4_mor,\n\texp.cv_p5_mor,\n\texp.cv_p6_mor,\n\texp.cv_mosaic_glob_hh,\n\texp.cv_mosaic_glob_zip4,\n\texp.cv_child_pres_0_18,\n\texp.cv_child_age_0_3_mdl,\n\texp.cv_child_age_scor_0_3,\n\texp.cv_child_age_4_6_mdl,\n\texp.cv_child_age_scor_4_6,\n\texp.cv_child_age_7_9_mdl,\n\texp.cv_child_age_scor_7_9_,\n\texp.cv_child_age_10_12_mdl,\n\texp.cv_child_age_scor_10_12_,\n\texp.cv_child_age_13_15_mdl,\n\texp.cv_child_age_scor_13_15,\n\texp.cv_child_age_16_18_mdl,\n\texp.cv_child_age_scor_16_18_,\n\texp.cv_hh_ail_meds_vis_ctnt_lenses,\n\t--populated with null value from Experian from Q4 2020\n\texp.cv_bhvr_bank_cntct_lens_wearer,\n\t--populated with null value from Experian from Q4 2020\n\texp.cv_bhvr_bnk_reg_pres_drug_users,\n\t--populated with null value from Experian from Q4 2020\n\texp.cv_bhvr_bnk_intrst_vid_dvd,\n\texp.cv_bhvr_bnk_intrst_golf,\n\texp.cv_bhvr_bnk_contri_charities,\n\texp.cv_bhvr_bnk_pet_enthusiast,\n\texp.cv_bhvr_bnk_intrst_cultural_arts,\n\texp.cv_bhvr_bnk_purchased_thu_mail,\n\texp.cv_bhvr_bnk_intrst_fitness,\n\texp.cv_bhvr_bnk_intrst_outdoors,\n\texp.cv_bhvr_bnk_intrst_travel,\n\texp.cv_bhvr_bnk_investors,\n\texp.cv_bhvr_bnk_pres_of_automobile,\n\texp.cv_bhvr_bnk_pres_of_credit_card,\n\texp.cv_bhvr_bnk_intrst_gardening,\n\texp.cv_bhvr_bnk_intrst_crafts,\n\texp.cv_bhvr_bnk_collectors,\n\texp.cv_bhvr_bnk_cruise_enthusiasts,\n\texp.cv_bhvr_bnk_intrst_sports,\n\texp.cv_bhvr_bnk_intrst_grmt_cooking,\n\texp.cv_bhvr_bnk_sweepstakes_gambling,\n\texp.cv_bhvr_bnk_intrst_politics,\n\texp.cv_bhvr_bnk_intrst_music,\n\texp.cv_bhvr_bnk_intrst_reading,\n\texp.cv_bhvr_bnk_child_parenting_prod,\n\texp.cv_bhvr_bnk_do_it_yourselfer,\n\texp.cv_bhvr_bnk_self_improvement,\n\texp.cv_bhvr_bnk_intrst_in_religion,\n\texp.cv_bhvr_bnk_grandparent,\n\texp.cv_bhvr_bnk_intrst_clothing,\n\texp.cv_bhvr_bnk_donates_envrn_causes,\n\texp.cv_bhvr_bnk_invests_mutual_funds,\n\texp.cv_bhvr_bnk_wght_conscious,\n\texp.cv_bhvr_bnk_mail_order_multibuyer,\n\texp.cv_bhvr_bnk_dog_enthusiasts,\n\texp.cv_bhvr_bnk_cat_enthusiasts,\n\texp.cv_bhvr_bnk_hlthy_living,\n\texp.cv_bhvr_bnk_intrst_automotive,\n\texp.cv_bhvr_bnk_intrst_skiing,\n\texp.cv_bhvr_bnk_intrst_boating,\n\texp.cv_bhvr_bnk_pres_of_cell_phone,\n\texp.cv_bhvr_bnk_commn_connectivity,\n\texp.cv_bhvr_bnk_computers,\n\texp.cv_bhvr_bnk_hi_tech_owner,\n\texp.cv_bhvr_bnk_home_decor_furnish,\n\texp.cv_bhvr_bnk_homeentmnt_video,\n\texp.cv_bhvr_bnk_kitchen_aids_applns,\n\texp.cv_bhvr_bnk_mo_buyer_music_video,\n\texp.cv_bhvr_bnk_mob_books,\n\texp.cv_bhvr_bnk_mo_buyer_cloth_shoe,\n\texp.cv_bhvr_bnk_mob_ins_fin,\n\texp.cv_bhvr_bnk_mail_order_buyer_gift,\n\texp.cv_bhvr_bnk_mob_grdng,\n\texp.cv_bhvr_bnk_mob_jewelry,\n\texp.cv_bhvr_bnk_clas_opra_big_bnd_mus,\n\texp.cv_bhvr_bnk_country_music,\n\texp.cv_bhvr_bnk_christian_music,\n\texp.cv_bhvr_bnk_rock_music,\n\texp.cv_bhvr_bnk_internet_online_subs,\n\texp.cv_bhvr_bnk_intrst_photo,\n\texp.cv_bhvr_bnk_purchase_via_online,\n\texp.cv_bhvr_bnk_intrst_affluence_ls,\n\texp.cv_bhvr_bnk_domestic_traveler,\n\texp.cv_bhvr_bnk_foreign_traveler,\n\texp.cv_bhvr_bnk_pres_of_prem_cc,\n\texp.cv_bhvr_bnk_active_military,\n\texp.cv_bhvr_bnk_inactive_military,\n\texp.cv_hh_acty_int_hob_photography,\n\texp.cv_hh_acty_int_hobbies_gardening,\n\texp.cv_hh_acty_int_hob_home_ws_diy,\n\texp.cv_hh_acty_int_hob_cars_auto_rep,\n\texp.cv_hh_acty_int_hob_bird_watching,\n\texp.cv_hh_acty_int_hob_self_imprvmnt,\n\texp.cv_hh_acty_int_music_chrstn_gosp,\n\texp.cv_hh_acty_int_music_r_and_b,\n\texp.cv_hh_acty_int_music_jazz_new_age,\n\texp.cv_hh_acty_int_music_classical,\n\texp.cv_hh_acty_int_music_rock_n_roll,\n\texp.cv_hh_acty_int_music_country,\n\texp.cv_hh_acty_int_music_in_gen,\n\texp.cv_hh_acty_int_music_other_music,\n\texp.cv_hh_acty_int_read_bs_fiction,\n\texp.cv_hh_acty_int_childrens_reading,\n\texp.cv_hh_acty_int_reading_computer,\n\texp.cv_hh_acty_int_read_cook_culinary,\n\texp.cv_hh_acty_int_reading_country_ls,\n\texp.cv_hh_acty_int_read_entmnt_ppl,\n\texp.cv_hh_acty_int_reading_fashion,\n\texp.cv_hh_acty_int_reading_history,\n\texp.cv_hh_acty_int_read_intr_decor,\n\texp.cv_hh_acty_int_read_med_hlth,\n\texp.cv_hh_acty_int_reading_military,\n\texp.cv_hh_acty_int_reading_mystery,\n\texp.cv_hh_acty_int_read_ntrl_hlth_rmd,\n\texp.cv_hh_acty_int_reading_romance,\n\texp.cv_hh_acty_int_read_sc_fiction,\n\texp.cv_hh_acty_int_read_sc_tech,\n\texp.cv_hh_acty_int_sports_read,\n\texp.cv_hh_acty_int_read_wrld_news_pol,\n\texp.cv_hh_acty_int_book_reader,\n\texp.cv_hh_acty_int_soc_ani_wf_soc,\n\texp.cv_hh_acty_int_soc_env_wildlife,\n\texp.cv_hh_acty_int_soc_pol_cons,\n\texp.cv_hh_acty_int_soc_pol_liberal,\n\texp.cv_hh_acty_int_soc_religion,\n\texp.cv_hh_acty_int_soc_child,\n\texp.cv_hh_acty_int_soc_veterans,\n\texp.cv_hh_acty_int_soc_hlth,\n\texp.cv_hh_acty_int_soc_othr,\n\texp.cv_hh_acty_int_sportsbaseball,\n\texp.cv_hh_acty_int_sportsbasketball,\n\texp.cv_hh_acty_int_sports_rec_hockey,\n\texp.cv_hh_acty_int_sportscampng_hikng,\n\texp.cv_hh_acty_int_sports_rec_hunting,\n\texp.cv_hh_acty_int_sports_rec_fishing,\n\texp.cv_hh_acty_int_sports_rec_nascar,\n\texp.cv_hh_acty_int_sprt_fitness_exer,\n\texp.cv_hh_acty_int_sportsscuba_diving,\n\texp.cv_hh_acty_int_sportsfootball,\n\texp.cv_hh_acty_int_sports_rec_golf,\n\texp.cv_hh_acty_int_sportssnow_skng,\n\texp.cv_hh_acty_int_boating_sailing,\n\texp.cv_hh_acty_int_sports_rec_walking,\n\texp.cv_hh_acty_int_sports_rec_cycling,\n\texp.cv_hh_acty_int_sportsmotorcycles,\n\texp.cv_hh_acty_int_running_jogging,\n\texp.cv_hh_acty_int_sports_rec_soccer,\n\texp.cv_hh_acty_int_sportsswimming,\n\texp.cv_hh_acty_int_play_sprt_in_gen,\n\texp.cv_hh_acty_int_sweepstakes,\n\texp.cv_hh_acty_int_swpstakes_loteries,\n\texp.cv_hh_acty_int_casino_gambling,\n\texp.cv_hh_acty_int_travel_cruise,\n\texp.cv_hh_acty_int_trvl_inter,\n\texp.cv_hh_acty_int_travel_domestic,\n\texp.cv_hh_acty_int_travel_time_share,\n\texp.cv_hh_acty_int_trvl_rec_vehicle,\n\texp.cv_hh_acty_int_rv_travel,\n\texp.cv_hh_acty_int_trvl_bus_trvl,\n\texp.cv_hh_acty_int_trvl_per_trvl,\n\texp.cv_hh_acty_int_pc_i_own_computer,\n\texp.cv_hh_acty_int_pc__i_usedsl_hispd,\n\texp.cv_hh_acty_int_pc_i_plan_buy_comp,\n\texp.cv_hh_acty_int_eg_cell_phone,\n\texp.cv_hh_acty_int_eg_com_disc_player,\n\texp.cv_hh_acty_int_eg_dvd_player,\n\texp.cv_hh_acty_int_eg_satellite_dish,\n\texp.cv_hh_acty_int_eg_dig_cam,\n\texp.cv_hh_acty_int_eg_hdtv,\n\texp.cv_hh_acty_int_eg__electronics,\n\texp.cv_hh_acty_int_eg_pda_blackberry,\n\texp.cv_hh_acty_int_eg_video_camera,\n\texp.cv_hh_acty_int_eg_video_game_sys,\n\texp.cv_hh_acty_int_eg_hom_theater_sys,\n\texp.cv_hh_acty_int_eg_cellph_priphln,\n\texp.cv_hh_acty_int_cltrl_arts,\n\texp.cv_hh_acty_int_magzn_bus_fin,\n\texp.cv_hh_acty_int_childrens_magzn,\n\texp.cv_hh_acty_int_magzn_comp_elctrns,\n\texp.cv_hh_acty_int_magzn_crft_gms_hob,\n\texp.cv_hh_acty_int_magazines_fitness,\n\texp.cv_hh_acty_int_mgzn_fd_wine_ckng,\n\texp.cv_hh_acty_int_magzn_grdng_magzn,\n\texp.cv_hh_acty_int_magzn_hntg_fshng,\n\texp.cv_hh_acty_int_magazines_mens,\n\texp.cv_hh_acty_int_magazines_music,\n\texp.cv_hh_acty_int_mgzn_prtntg_babies,\n\texp.cv_hh_acty_int_mgzn_sports_mgzn,\n\texp.cv_hh_acty_int_magzn_subs,\n\texp.cv_hh_acty_int_magazines_travel,\n\texp.cv_hh_acty_int_magazines_womens,\n\texp.cv_hh_acty_int_magzn_cur_evnt_nws,\n\texp.cv_hh_ls_veh_hav_leased_a_veh,\n\texp.cv_hh_ls_veh_hav_purchased_a_veh,\n\texp.cv_hh_ls_afltn_mem_book_club,\n\texp.cv_hh_ls_afltn_mem_music_club,\n\texp.cv_hh_ls_cc_amer_exp_prem,\n\texp.cv_hh_ls_cc_amer_exp_regular,\n\texp.cv_hh_ls_cc_discover_premium,\n\texp.cv_hh_ls_cc_discover_regular,\n\texp.cv_hh_ls_cc_other_card_premium,\n\texp.cv_hh_ls_cc_other_card_regular,\n\texp.cv_hh_ls_cc_store_ret_reg,\n\texp.cv_hh_ls_cc_visa_regular,\n\texp.cv_hh_ls_cc_mastercard_regular,\n\texp.cv_hh_ls_contri_hmntrn,\n\texp.cv_hh_ls_entmnt_buy_prercrdvideo,\n\texp.cv_hh_ls_entmnt_wtch_cabletv,\n\texp.cv_hh_ls_entmnt_watch_videos,\n\texp.cv_hh_ls_outdoor_lvng_entmnt,\n\texp.cv_hh_ls_entmnt_season_hldy_prod,\n\texp.cv_hh_ls_fin_iras_future_intrst,\n\texp.cv_hh_ls_fin_life_insur_cur,\n\texp.cv_hh_ls_fin_mutl_funds,\n\texp.cv_hh_ls_fin_othr_invest_cur,\n\texp.cv_hh_ls_fin_othr_invest_future,\n\texp.cv_hh_ls_fin_real_estate_fut,\n\texp.cv_hh_ls_fin_stks_bond_fut,\n\texp.cv_hh_ls_grndkids_proud_grndprnt,\n\texp.cv_hh_ls_info_byng_purc_by_intrnt,\n\texp.cv_hh_ls_mil_gov_active_mil_mem,\n\texp.cv_hh_ls_military_gov_vetern,\n\texp.cv_hh_lifestyl_pets_own_a_cat,\n\texp.cv_hh_lifestyl_pets_own_a_dog,\n\texp.cv_hh_lifestyl_pets_own_a_pet,\n\texp.cv_hh_ls_biy_internet,\n\texp.cv_hh_ls_bib_mail,\n\texp.cv_hh_ls_bib_catalog,\n\texp.cv_hh_ls_buying_interest_apparel,\n\texp.cv_hh_ls_buying_intrst_comp_elec,\n\texp.cv_hh_ls_buying_intrst_book_music,\n\texp.cv_hh_ls_bi_home_garden,\n\texp.cv_hh_ls_bi_sports_related,\n\texp.cv_hh_ls_buying_interest_big_tall,\n\texp.cv_hh_ls_byng_intrst_moc,\n\texp.cv_hh_ls_byng_intrst_mog,\n\texp.cv_hh_ls_bi_mail_order_gift,\n\texp.cv_hh_ls_byng_intrst_mjc,\n\texp.cv_hh_ls_bi_mail_music_videos,\n\texp.cv_hh_ls_byng_intrst_mcp,\n\texp.cv_hh_ls_bi_mail_books_magzn,\n\texp.cv_hh_ls_bi_food_and_beverage,\n\texp.cv_hh_ls_bi_home_decorating,\n\texp.cv_hh_ls_bi_furniture,\n\texp.cv_hh_ls_bi_domestics,\n\texp.cv_hh_ls_buying_interest_footwear,\n\texp.cv_hh_ml_ordr_apprl_acsries,\n\texp.cv_cape_age_pop_0_9,\n\texp.cv_cape_age_pop_0_24,\n\texp.cv_cape_age_pop_25_34,\n\texp.cv_cape_age_pop_35_44,\n\texp.cv_cape_age_pop_45_54,\n\texp.cv_cape_age_pop_55_64,\n\texp.cv_cape_age_pop_18_65,\n\texp.cv_cape_age_pop_75_99,\n\texp.cv_cape_pop_med_age_of_adults_18,\n\texp.cv_cape_child_hh_fem_hh_fam_plt18,\n\texp.cv_cape_child_hh_without_per_lt18,\n\texp.cv_cape_cmte_com_travtowrk_60_89,\n\texp.cv_cape_cmter_travtowork_90,\n\texp.cv_cape_cmter_avg_trav_timetowork,\n\texp.cv_cape_cmter_med_trav_timetowork,\n\texp.cv_cape_cmte_wrkrs_carpld_to_work,\n\texp.cv_cape_emply_fem16_lbr_frce,\n\texp.cv_cape_etnc_hh_nonhisp_whte_only,\n\texp.cv_cape_etnc_pop_black_only_hisp,\n\texp.cv_cape_etnc_pop_non_hispanic,\n\texp.cv_cape_etnc_pop_white_only_hisp,\n\texp.cv_cape_inc_hh_inc_under_10k,\n\texp.cv_cape_inc_hh_inc_10_14k,\n\texp.cv_cape_inc_hh_inc_15_19k,\n\texp.cv_cape_inc_hh_inc_20_24k,\n\texp.cv_cape_inc_hh_inc_25_29k,\n\texp.cv_cape_inc_hh_inc_30_34k,\n\texp.cv_cape_inc_hh_inc_35_39k,\n\texp.cv_cape_inc_hh_inc_40_44k,\n\texp.cv_cape_inc_hh_inc_45_49k,\n\texp.cv_cape_inc_hh_inc_50_59k,\n\texp.cv_cape_inc_hh_inc_60_74k,\n\texp.cv_cape_inc_hh_inc_75_99k,\n\texp.cv_cape_inc_hh_inc_100_124k,\n\texp.cv_cape_inc_hh_inc_125_149k,\n\texp.cv_cape_inc_hh_inc_150_199k,\n\texp.cv_cape_inc_hh_inc_200_249k,\n\texp.cv_cape_inc_hh_inc_250_499k,\n\texp.cv_cape_inc_hh_incm_500k_more,\n\texp.cv_cape_inc_hh_med_hh_inc,\n\texp.cv_cape_inc_hh_med_non_fam_hh_inc,\n\texp.cv_cape_inc_pop_per_capita_income,\n\texp.cv_cape_ind_empld_acmdn_food_svcs,\n\texp.cv_cape_ind_empld_adm_supwstemgmt,\n\texp.cv_cape_ind_empld_agr_fst_fsh_hnt,\n\texp.cv_cape_ind_empld_arts_entmnt,\n\texp.cv_cape_indus_empld_construction,\n\texp.cv_cape_ind_empld_edu_srvs,\n\texp.cv_cape_ind_empld_fin_and_ins,\n\texp.cv_cape_indus_empld_hc_soc_ass,\n\texp.cv_cape_indus_empld_information,\n\texp.cv_cape_indus_empld_manufacturing,\n\texp.cv_cape_ind_empld_mgmt_com_entrps,\n\texp.cv_cape_indus_empld_mining,\n\texp.cv_cape_ind_empld_oth_svcs,\n\texp.cv_cape_ind_empld_public_admin,\n\texp.cv_cape_ind_empld_rer_lsng,\n\texp.cv_cape_indus_empld_retail_trade,\n\texp.cv_cape_ind_empld_prof_sc_tch_scs,\n\texp.cv_cape_ind_empld_trans_wh,\n\texp.cv_cape_indus_empld_utilities,\n\texp.cv_cape_ind_empld_wholesale_trade,\n\texp.cv_cape_mrtg_oohu_first_mrtg_only,\n\texp.cv_cape_move_occhu_med_len_res,\n\texp.cv_cape_rent_rntl_median_rent,\n\texp.cv_cape_tenancy_hu_occupied,\n\texp.cv_cape_typ_pop_child_in_fam_hh,\n\texp.cv_cape_typ_pop_in_family_hh,\n\texp.cv_cape_typ_pop_in_non_family_hh,\n\texp.cv_cape_pop_nat_adpt_child_fam_hh,\n\texp.cv_cape_typ_pop_spouse_in_fam_hh,\n\texp.cv_cape_urban_pop_rural_on_farms,\n\texp.cv_cape_urban_pop_rur_not_on_frms,\n\texp.cv_cape_urban_pop_in_urban_area,\n\texp.cv_cape_urban_pop_in_urban_clstrs,\n\texp.cv_cape_inc_fam_inc_state_indx,\n\texp.cv_prop_rlty_home_year_built,\n\texp.cv_mrtg_home_pur_mrtg_term,\n\texp.cv_mrtg_home_pur_home_pur_date,\n\texp.cv_mrtg_home_pur_mrtg_rate_type,\n\texp.cv_mrtg_home_pur_mrtg_loan_type,\n\texp.cv_mrtg_home_purc_type_of_purc,\n\texp.cv_mrtg_home_pur_pur_amt_rng,\n\texp.cv_mrtg_home_pur_mrtg_amt_rng,\n\texp.cv_rlty_mdl_confdnce_cdv2,\n\texp.cv_rlty_mdl_est_avl_equity_cd_v2,\n\texp.cv_rlty_mdl_est_avl_equity_amt_v2,\n\texp.cv_rlty_mdl_est_cur_lntoval_ratv2,\n\texp.cv_rlty_mdl_est_cur_mrtg_pmtv21,\n\texp.cv_rlty_mdl_est_cur_mrtg_pmtv22,\n\texp.cv_rlty_mdl_est_cur_mrtg_amtcdv2,\n\texp.cv_rlty_mdl_est_cur_mrtg_am_v2,\n\tlmtd.geo_zipcode,\n\tlmtd.geo_kroger_banner,\n\tlmtd.geo_all_other_kroger,\n\tlmtd.geo_albertsons_safeway,\n\tlmtd.geo_publix,\n\tlmtd.geo_ahold_delhaize,\n\tlmtd.geo_wakefern,\n\tlmtd.geo_hy_vee,\n\tlmtd.geo_heb,\n\tlmtd.geo_whole_foods,\n\tlmtd.geo_aldi,\n\tlmtd.geo_trader_joes,\n\tlmtd.geo_bi_lo,\n\tlmtd.geo_all_other_grocery,\n\tlmtd.geo_cvs,\n\tlmtd.geo_walgreens,\n\tlmtd.geo_all_other_drug,\n\tlmtd.geo_target,\n\tlmtd.geo_wm_neighborhood_market,\n\tlmtd.geo_all_other_walmart,\n\tlmtd.geo_all_other_mass,\n\tlmtd.geo_costco,\n\tlmtd.geo_bjs,\n\tlmtd.geo_sams_club,\n\tlmtd.geo_all_other_club,\n\tlmtd.geo_total_c_and_g,\n\tlmtd.geo_7_eleven,\n\tlmtd.geo_circle_k,\n\tlmtd.geo_speedway,\n\tlmtd.geo_all_other_c_and_g,\n\tlmtd.geo_dollar_general,\n\tlmtd.geo_family_dollar,\n\tlmtd.geo_all_other_dollar,\n\tlmtd.geo_amazon_com,\n\tlmtd.geo_walmart_com,\n\tlmtd.geo_all_other_ao,\n\tlmtd.geo_not_assigned\nFROM {{ ref('exp_geo_lmtd_cv') }} AS lmtd\nLEFT OUTER JOIN {{ ref('experian_cv_stg') }} exp ON lmtd.cv_living_unit_id = exp.cv_living_unit_id", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "exp_geo"], "unique_id": "model.sdna_project.exp_geo", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/exp_geo.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/exp_geo.sql", "name": "exp_geo", "resource_type": "model", "alias": "exp_geo", "checksum": {"name": "sha256", "checksum": "bf2eed0eee491e3a5b8053fac971a8fa571b001a51074b3c6e28699a903f1006"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_lmtd_cv"], ["experian_cv_stg"], ["exp_geo_lmtd_cv"], ["experian_cv_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.experian_cv_stg", "model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.experian_cv_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_lmtd_cv": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load exp_geo_lmtd_cv\n\n-- {{ ref('exp_geo_temp') }}\n-- {{ ref('exp_geo_null') }}\n-- {{ ref('geo_retailer_zip9_zip5_chain_count') }}\n\nSELECT\n    cv_living_unit_id,\n\tcv_zipcode_5,\n\tcv_zipcode_9,\n\tgeo_zipcode,\n\tgeo_kroger_banner,\n\tgeo_all_other_kroger,\n\tgeo_albertsons_safeway,\n\tgeo_publix,\n\tgeo_ahold_delhaize,\n\tgeo_wakefern,\n\tgeo_hy_vee,\n\tgeo_heb,\n\tgeo_whole_foods,\n\tgeo_aldi,\n\tgeo_trader_joes,\n\tgeo_bi_lo,\n\tgeo_all_other_grocery,\n\tgeo_cvs,\n\tgeo_walgreens,\n\tgeo_all_other_drug,\n\tgeo_target,\n\tgeo_wm_neighborhood_market,\n\tgeo_all_other_walmart,\n\tgeo_all_other_mass,\n\tgeo_costco,\n\tgeo_bjs,\n\tgeo_sams_club,\n\tgeo_all_other_club,\n\tgeo_total_c_and_g,\n\tgeo_7_eleven,\n\tgeo_circle_k,\n\tgeo_speedway,\n\tgeo_all_other_c_and_g,\n\tgeo_dollar_general,\n\tgeo_family_dollar,\n\tgeo_all_other_dollar,\n\tgeo_amazon_com,\n\tgeo_walmart_com,\n\tgeo_all_other_ao,\n\tgeo_not_assigned\nFROM {{ ref('exp_geo_temp') }}\nWHERE geo_zipcode IS NOT NULL\n\nUNION ALL\n\nSELECT\n    cv_living_unit_id,\n\tcv_zipcode_5,\n\tcv_zipcode_9,\n\tzip9,\n\tkroger_banner,\n\tall_other_kroger,\n\talbertsons_safeway,\n\tpublix,\n\tahold_delhaize,\n\twakefern,\n\thy_vee,\n\theb,\n\twhole_foods,\n\taldi,\n\ttrader_joes,\n\tbi_lo,\n\tall_other_grocery,\n\tcvs,\n\twalgreens,\n\tall_other_drug,\n\ttarget,\n\twm_neighborhood_market,\n\tall_other_walmart,\n\tall_other_mass,\n\tcostco,\n\tbjs,\n\tsams_club,\n\tall_other_club,\n\ttotal_c_and_g,\n\t_7_eleven,\n\tcircle_k,\n\tspeedway,\n\tall_other_c_and_g,\n\tdollar_general,\n\tfamily_dollar,\n\tall_other_dollar,\n\tamazon_com,\n\twalmart_com,\n\tall_other_ao,\n\tnot_assigned\nFROM {{ ref('exp_geo_null') }} AS exp\nLEFT OUTER JOIN {{ ref('geo_retailer_zip9_zip5_chain_count') }} AS geo ON TRIM(exp.cv_zipcode_9) = TRIM(geo.zip9)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "exp_geo_lmtd_cv"], "unique_id": "model.sdna_project.exp_geo_lmtd_cv", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/exp_geo_lmtd_cv.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/exp_geo_lmtd_cv.sql", "name": "exp_geo_lmtd_cv", "resource_type": "model", "alias": "exp_geo_lmtd_cv", "checksum": {"name": "sha256", "checksum": "6097095ac4c44b97d219d15f6dac3145e3a157572f87407cae9fedad4255249c"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_temp"], ["exp_geo_null"], ["geo_retailer_zip9_zip5_chain_count"], ["exp_geo_temp"], ["exp_geo_null"], ["geo_retailer_zip9_zip5_chain_count"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_null", "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_null", "model.sdna_project.geo_retailer_zip9_zip5_chain_count"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_null": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load exp_geo_null\n\n-- {{ ref('exp_geo_temp') }}\n\nSELECT\n    cv_living_unit_id,\n    cv_zipcode_5,\n    cv_zipcode_9\nFROM {{ ref('exp_geo_temp') }}\nWHERE geo_zipcode IS NULL", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "exp_geo_null"], "unique_id": "model.sdna_project.exp_geo_null", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/exp_geo_null.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/exp_geo_null.sql", "name": "exp_geo_null", "resource_type": "model", "alias": "exp_geo_null", "checksum": {"name": "sha256", "checksum": "24729f3dbaee036e6401200abf7cd5ab6f220f9ca973670054f606a40ab3dce1"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_temp"], ["exp_geo_temp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_temp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_new_retailer_info": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load geo_new_retailer_info\n\n-- {{ ref('mvh_retailers_tj') }}\n-- {{ ref('btg_msa_lat_lon_v') }}\n-- {{ ref('mvh_retailers_aldi') }}\n-- {{ ref('mvh_retailers_wf') }}\n\nSELECT\n    dx_id,\n\tdb,\n\tstore_name,\n\tchannel,\n\tchain_lvl1_node_nm,\n\tchain_lvl2_node_nm,\n\tchain_lvl3_node_nm,\n\tchain_lvl4_node_nm,\n\tchain_lvl5_node_nm,\n\tretailer,\n\tcis_id,\n\tstore_nbr,\n\tstreet_addr1,\n\tstreet_addr2,\n\tcity,\n\tcounty,\n\tstate,\n\tstore_zip,\n\tphone_nbr,\n\tlatitude,\n\tlongitude,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t(\n\t\tSELECT\n\t\t\tCONCAT(\n\t\t\t\tmsa_id_dummy,\n\t\t\t\t'-',\n\t\t\t\tROW_NUMBER() OVER(\n\t\t\t\t\tPARTITION BY msa_id_dummy\n\t\t\t\t\tORDER BY\n\t\t\t\t\t\tmsa_id_dummy DESC\n\t\t\t\t),\n\t\t\t\t'-X'\n\t\t\t) AS dx_id,\n\t\t\t'N/A' AS DB,\n\t\t\tstore_nm AS store_name,\n\t\t\t'NULL' AS channel,\n\t\t\tlist_name AS chain_lvl1_node_nm,\n\t\t\tmsa_id_dummy AS chain_lvl2_node_nm,\n\t\t\t'NULL' AS chain_lvl3_node_nm,\n\t\t\t'NULL' AS chain_lvl4_node_nm,\n\t\t\t'NULL' AS chain_lvl5_node_nm,\n\t\t\t'TRADER JOES' AS retailer,\n\t\t\t0 AS cis_id,\n\t\t\tstore_nbr,\n\t\t\taddress AS street_addr1,\n\t\t\taddress_line2 AS street_addr2,\n\t\t\tcity,\n\t\t\tcounty,\n\t\t\tstate,\n\t\t\tzip_code AS store_zip,\n\t\t\tphone_nbr,\n\t\t\tllv.lat_qty AS latitude,\n\t\t\tllv.lngtd_qty AS longitude\n\t\tFROM {{ ref('mvh_retailers_tj') }} AS tj\n\t\tLEFT OUTER JOIN {{ ref('btg_msa_lat_lon_v') }} AS llv ON tj.msa_id_look_alike = llv.msa_id\n\t\tWHERE msa_id_look_alike <> ''\n\n\t\tUNION\n\n\t\tSELECT\n\t\t\tCONCAT(\n\t\t\t\tmsa_id_dummy,\n\t\t\t\t'-',\n\t\t\t\tROW_NUMBER() OVER(\n\t\t\t\t\tPARTITION BY msa_id_dummy\n\t\t\t\t\tORDER BY\n\t\t\t\t\t\tmsa_id_dummy DESC\n\t\t\t\t),\n\t\t\t\t'-X'\n\t\t\t) AS dx_id,\n\t\t\t'N/A' AS DB,\n\t\t\tstore_nm AS store_name,\n\t\t\t'NULL' AS channel,\n\t\t\tlist_name AS chain_lvl1_node_nm,\n\t\t\tmsa_id_dummy AS chain_lvl2_node_nm,\n\t\t\t'NULL' AS chain_lvl3_node_nm,\n\t\t\t'NULL' AS chain_lvl4_node_nm,\n\t\t\t'NULL' AS chain_lvl5_node_nm,\n\t\t\t'ALDI' AS retailer,\n\t\t\t0 AS cis_id,\n\t\t\tstore_nbr,\n\t\t\taddress AS street_addr1,\n\t\t\taddress_line2 AS street_addr2,\n\t\t\tcity,\n\t\t\tcounty,\n\t\t\tstate,\n\t\t\tzip_code AS store_zip,\n\t\t\tphone_nbr,\n\t\t\tllv.lat_qty AS latitude,\n\t\t\tllv.lngtd_qty AS longitude\n\t\tFROM {{ ref('mvh_retailers_aldi') }} AS aldi\n\t\tLEFT OUTER JOIN {{ ref ('btg_msa_lat_lon_v') }} AS llv ON aldi.msa_id_look_alike = llv.msa_id\n\t\tWHERE msa_id_look_alike <> ''\n\n\t\tUNION\n\n\t\tSELECT\n\t\t\tCONCAT(\n\t\t\t\tmsa_id_dummy,\n\t\t\t\t'-',\n\t\t\t\tROW_NUMBER() OVER(\n\t\t\t\t\tPARTITION BY msa_id_dummy\n\t\t\t\t\tORDER BY\n\t\t\t\t\t\tmsa_id_dummy DESC\n\t\t\t\t),\n\t\t\t\t'-X'\n\t\t\t) AS dx_id,\n\t\t\t'N/A' AS DB,\n\t\t\tstore_nm AS store_name,\n\t\t\tNULL AS channel,\n\t\t\tlist_name AS chain_lvl1_node_nm,\n\t\t\tmsa_id_dummy AS chain_lvl2_node_nm,\n\t\t\tNULL AS chain_lvl3_node_nm,\n\t\t\tNULL AS chain_lvl4_node_nm,\n\t\t\tNULL AS chain_lvl5_node_nm,\n\t\t\t'WHOLE FOODS' AS retailer,\n\t\t\t0 AS cis_id,\n\t\t\tstore_nbr,\n\t\t\taddress AS street_addr1,\n\t\t\taddress_line2 AS street_addr2,\n\t\t\tcity,\n\t\t\tcounty,\n\t\t\tstate,\n\t\t\tzip_code AS store_zip,\n\t\t\tphone_nbr,\n\t\t\tllv.lat_qty AS latitude,\n\t\t\tllv.lngtd_qty AS longitude\n\t\tFROM {{ ref('mvh_retailers_wf') }} AS wf\n\t\tLEFT OUTER JOIN {{ ref('btg_msa_lat_lon_v') }} AS llv ON wf.msa_id_look_alike = llv.msa_id\n\t\tWHERE msa_id_look_alike <> ''\n\t) AS temp", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "geo_new_retailer_info"], "unique_id": "model.sdna_project.geo_new_retailer_info", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/geo_new_retailer_info.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/geo_new_retailer_info.sql", "name": "geo_new_retailer_info", "resource_type": "model", "alias": "geo_new_retailer_info", "checksum": {"name": "sha256", "checksum": "8935f19589c7334bb05eecea9fe67f557d7aa2a792f536ca219a159d325dfa50"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_retailers_tj"], ["btg_msa_lat_lon_v"], ["mvh_retailers_aldi"], ["mvh_retailers_wf"], ["mvh_retailers_tj"], ["btg_msa_lat_lon_v"], ["mvh_retailers_aldi"], ["btg_msa_lat_lon_v"], ["mvh_retailers_wf"], ["btg_msa_lat_lon_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_retailers_tj", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.mvh_retailers_aldi", "model.sdna_project.mvh_retailers_wf", "model.sdna_project.mvh_retailers_tj", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.mvh_retailers_aldi", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.mvh_retailers_wf", "model.sdna_project.btg_msa_lat_lon_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_retailer_stg": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load geo_retailer_stg\n\n-- {{ ref('geo_retailer_stg_temp') }}\n\nSELECT\n    dx_id,\n\tDB,\n\tstore_name,\n\tchannel,\n\tchain_lvl1_node_nm,\n\tchain_lvl2_node_nm,\n\tchain_lvl3_node_nm,\n\tchain_lvl4_node_nm,\n\tchain_lvl5_node_nm,\n\tflna_cis_id,\n\tpbc_cis_id,\n\tstore_nbr,\n\tstreet_addr1,\n\tstreet_addr2,\n\tcity,\n\tcounty,\n\tstate,\n\tstore_zip,\n\tphone_nbr,\n\tlatitude,\n\tlongitude,\n\tretailer,\n\tCASE WHEN CONTAINS(dx_id, '-') THEN SPLIT_PART(dx_id, '-', 0) ELSE dx_id END AS msa_id_look_alike,\n\tCASE WHEN CONTAINS(dx_id, '-') THEN 'Y' ELSE 'N' END AS dummy_msa_flag,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM {{ ref('geo_retailer_stg_temp') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "geo_retailer_stg"], "unique_id": "model.sdna_project.geo_retailer_stg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/geo_retailer_stg.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/geo_retailer_stg.sql", "name": "geo_retailer_stg", "resource_type": "model", "alias": "geo_retailer_stg", "checksum": {"name": "sha256", "checksum": "c4ab9077ff0159695b7f09859e3d4db983f7f1660d87df02fb8e841cde780875"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["geo_retailer_stg_temp"], ["geo_retailer_stg_temp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.geo_retailer_stg_temp", "model.sdna_project.geo_retailer_stg_temp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_retailer_zip9_chain_count": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load geo_retailer_zip9_chain_count\n\n-- {{ ref('geo_retailer_zip9_info') }}\n\nSELECT\n    temp.zip9,\n    MAX(CASE temp.retailer WHEN 'KROGER BANNER' THEN cnt ELSE 0 END) AS kroger_banner,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER KROGER' THEN cnt ELSE 0 END) AS all_other_kroger,\n    MAX(CASE temp.retailer WHEN 'ALBERTSONS/SAFEWAY' THEN cnt ELSE 0 END) AS albertsons_safeway,\n    MAX(CASE temp.retailer WHEN 'PUBLIX' THEN cnt ELSE 0 END) AS publix,\n    MAX(CASE temp.retailer WHEN 'AHOLD/DELHAIZE' THEN cnt ELSE 0 END) AS ahold_delhaize,\n    MAX(CASE temp.retailer WHEN 'WAKEFERN' THEN cnt ELSE 0 END) AS wakefern,\n    MAX(CASE temp.retailer WHEN 'HY-VEE' THEN cnt ELSE 0 END) AS hy_vee,\n    MAX(CASE temp.retailer WHEN 'HEB' THEN cnt ELSE 0 END) AS heb,\n    MAX(CASE temp.retailer WHEN 'WHOLE FOODS' THEN cnt ELSE 0 END) AS whole_foods,\n    MAX(CASE temp.retailer WHEN 'ALDI' THEN cnt ELSE 0 END) AS aldi,\n    MAX(CASE temp.retailer WHEN 'TRADER JOES' THEN cnt ELSE 0 END) AS trader_joes,\n    MAX(CASE temp.retailer WHEN 'BI-LO' THEN cnt ELSE 0 END) AS bi_lo,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER GROCERY' THEN cnt ELSE 0 END) AS all_other_grocery,\n    MAX(CASE temp.retailer WHEN 'CVS' THEN cnt ELSE 0 END) AS cvs,\n    MAX(CASE temp.retailer WHEN 'WALGREENS' THEN cnt ELSE 0 END) AS walgreens,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER DRUG' THEN cnt ELSE 0 END) AS all_other_drug,\n    MAX(CASE temp.retailer WHEN 'TARGET' THEN cnt ELSE 0 END) AS target,\n    MAX(CASE temp.retailer WHEN 'NEIGHBORHOOD MARKET' THEN cnt ELSE 0 END) AS wm_neighborhood_market,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER WALMART' THEN cnt ELSE 0 END) AS all_other_walmart,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER MASS' THEN cnt ELSE 0 END) AS all_other_mass,\n    MAX(CASE temp.retailer WHEN 'COSTCO' THEN cnt ELSE 0 END) AS costco,\n    MAX(CASE temp.retailer WHEN 'BJS' THEN cnt ELSE 0 END) AS bjs,\n    MAX(CASE temp.retailer WHEN 'SAMS CLUB' THEN cnt ELSE 0 END) AS sams_club,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER CLUB' THEN cnt ELSE 0 END) AS all_other_club,\n    MAX(CASE temp.retailer WHEN 'TOTAL C&G' THEN cnt ELSE 0 END) AS total_c_and_g,\n    MAX(CASE temp.retailer WHEN '7-ELEVEN' THEN cnt ELSE 0 END) AS _7_eleven,\n    MAX(CASE temp.retailer WHEN 'CIRCLE K' THEN cnt ELSE 0 END) AS circle_k,\n    MAX(CASE temp.retailer WHEN 'SPEEDWAY' THEN cnt ELSE 0 END) AS speedway,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER C&G' THEN cnt ELSE 0 END) AS all_other_c_and_g,\n    MAX(CASE temp.retailer WHEN 'DOLLAR GENERAL' THEN cnt ELSE 0 END) AS dollar_general,\n    MAX(CASE temp.retailer WHEN 'FAMILY DOLLAR' THEN cnt ELSE 0 END) AS family_dollar,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER DOLLAR' THEN cnt ELSE 0 END) AS all_other_dollar,\n    MAX(CASE temp.retailer WHEN 'AMAZON.COM' THEN cnt ELSE 0 END) AS amazon_com,\n    MAX(CASE temp.retailer WHEN 'WALMART.COM' THEN cnt ELSE 0 END) AS walmart_com,\n    MAX(CASE temp.retailer WHEN 'ALL OTHER AO' THEN cnt ELSE 0 END) AS all_other_ao,\n    MAX(CASE temp.retailer WHEN 'NOT ASSIGNED' THEN cnt ELSE 0 END) AS not_assigned\nFROM\n\t(\n\t\tSELECT\n\t\t\tzip9,\n\t\t\tretailer,\n\t\t\tCOUNT(1) as cnt\n\t\tFROM {{ ref('geo_retailer_zip9_info') }}\n\t\tGROUP BY zip9, retailer\n\t) AS temp\nGROUP BY temp.zip9", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "geo_retailer_zip9_chain_count"], "unique_id": "model.sdna_project.geo_retailer_zip9_chain_count", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_chain_count.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_chain_count.sql", "name": "geo_retailer_zip9_chain_count", "resource_type": "model", "alias": "geo_retailer_zip9_chain_count", "checksum": {"name": "sha256", "checksum": "96fd3332488d09f76de18625721814613fac8e1feb630e9e699d8fb94989a8d4"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["geo_retailer_zip9_info"], ["geo_retailer_zip9_info"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.geo_retailer_zip9_info"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_retailer_zip9_info": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load geo_retailer_zip9_info\n\n-- {{ ref('geo_retailer_stg') }}\n-- {{ ref('gsc_msa_z9_drivetime') }}\n\nSELECT\n    a.dx_id,\n\ta.DB,\n\ta.store_name,\n\ta.channel,\n\ta.chain_lvl1_node_nm,\n\ta.chain_lvl2_node_nm,\n\ta.chain_lvl3_node_nm,\n\ta.chain_lvl4_node_nm,\n\ta.chain_lvl5_node_nm,\n\ta.flna_cis_id,\n\ta.pbc_cis_id,\n\ta.store_nbr,\n\ta.street_addr1,\n\ta.street_addr2,\n\ta.city,\n\ta.county,\n\ta.state,\n\ta.store_zip,\n\ta.phone_nbr,\n\ta.latitude,\n\ta.longitude,\n\ta.retailer,\n\ta.msa_id_look_alike,\n\ta.dummy_msa_flag,\n\tTRIM(b.usps_zip9) AS zip9,\n\tb.drive_minutes,\n\tb.drive_miles\nFROM {{ ref('geo_retailer_stg') }} AS a,\n\t {{ ref('gsc_msa_z9_drivetime') }} AS b\nWHERE SPLIT(a.dx_id, '\\-')[0] = TRIM(b.msa_id)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "geo_retailer_zip9_info"], "unique_id": "model.sdna_project.geo_retailer_zip9_info", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_info.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_info.sql", "name": "geo_retailer_zip9_info", "resource_type": "model", "alias": "geo_retailer_zip9_info", "checksum": {"name": "sha256", "checksum": "6d16a9261393b9c48bf6802f65befad333ae4282b46535c6dc9fd3afb7c337cc"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["geo_retailer_stg"], ["gsc_msa_z9_drivetime"], ["geo_retailer_stg"], ["gsc_msa_z9_drivetime"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.geo_retailer_stg", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.geo_retailer_stg", "model.sdna_project.gsc_msa_z9_drivetime"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.geo_retailer_zip9_zip5_chain_count": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load geo_retailer_zip9_zip5_chain_count\n\n-- {{ ref('geo_retailer_zip9_chain_count') }}\n\nSELECT\n    zip9,\n\tkroger_banner,\n\tall_other_kroger,\n\talbertsons_safeway,\n\tpublix,\n\tahold_delhaize,\n\twakefern,\n\thy_vee,\n\theb,\n\twhole_foods,\n\taldi,\n\ttrader_joes,\n\tbi_lo,\n\tall_other_grocery,\n\tcvs,\n\twalgreens,\n\tall_other_drug,\n\ttarget,\n\twm_neighborhood_market,\n\tall_other_walmart,\n\tall_other_mass,\n\tcostco,\n\tbjs,\n\tsams_club,\n\tall_other_club,\n\ttotal_c_and_g,\n\t_7_eleven,\n\tcircle_k,\n\tspeedway,\n\tall_other_c_and_g,\n\tdollar_general,\n\tfamily_dollar,\n\tall_other_dollar,\n\tamazon_com,\n\twalmart_com,\n\tall_other_ao,\n\tnot_assigned\nFROM {{ ref('geo_retailer_zip9_chain_count') }}\n\nUNION ALL\n\nSELECT\n    SUBSTR(zip9, 1, 5) AS zip9,\n    ROUND(AVG(kroger_banner)) AS kroger_banner ,\n    ROUND(AVG(all_other_kroger)) AS all_other_kroger,\n    ROUND(AVG(albertsons_safeway)) AS albertsons_safeway,\n    ROUND(AVG(publix)) AS publix,\n    ROUND(AVG(ahold_delhaize)) AS ahold_delhaize,\n    ROUND(AVG(wakefern)) AS wakefern,\n    ROUND(AVG(hy_vee)) AS hy_vee,\n    ROUND(AVG(heb)) AS heb,\n    ROUND(AVG(whole_foods)) AS whole_foods,\n    ROUND(AVG(aldi)) AS aldi,\n    ROUND(AVG(trader_joes)) AS trader_joes,\n    ROUND(AVG(bi_lo)) AS bi_lo,\n    ROUND(AVG(all_other_grocery)) AS all_other_grocery,\n    ROUND(AVG(cvs)) AS cvs,\n    ROUND(AVG(walgreens)) AS walgreens,\n    ROUND(AVG(all_other_drug)) AS all_other_drug,\n    ROUND(AVG(target)) AS target,\n    ROUND(AVG(wm_neighborhood_market)) AS wm_neighborhood_market,\n    ROUND(AVG(all_other_walmart)) AS all_other_walmart,\n    ROUND(AVG(all_other_mass)) AS all_other_mass,\n    ROUND(AVG(costco)) AS costco,\n    ROUND(AVG(bjs)) AS bjs,\n    ROUND(AVG(sams_club)) AS sams_club,\n    ROUND(AVG(all_other_club)) AS all_other_club,\n    ROUND(AVG(total_c_and_g)) AS total_c_and_g,\n    ROUND(AVG(_7_eleven)) AS _7_eleven,\n    ROUND(AVG(circle_k)) AS circle_k,\n    ROUND(AVG(speedway)) AS speedway,\n    ROUND(AVG(all_other_c_and_g)) AS all_other_c_and_g,\n    ROUND(AVG(dollar_general)) AS dollar_general,\n    ROUND(AVG(family_dollar)) AS family_dollar,\n    ROUND(AVG(all_other_dollar)) AS all_other_dollar,\n    ROUND(AVG(amazon_com)) AS amazon_com,\n    ROUND(AVG(walmart_com)) AS walmart_com,\n    ROUND(AVG(all_other_ao)) AS all_other_ao,\n    ROUND(AVG(not_assigned)) AS not_assigned\nFROM {{ ref('geo_retailer_zip9_chain_count') }}\nGROUP BY SUBSTR(zip9, 1, 5)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "geoscape", "geo_retailer_zip9_zip5_chain_count"], "unique_id": "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_zip5_chain_count.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/geoscape/geo_retailer_zip9_zip5_chain_count.sql", "name": "geo_retailer_zip9_zip5_chain_count", "resource_type": "model", "alias": "geo_retailer_zip9_zip5_chain_count", "checksum": {"name": "sha256", "checksum": "6603bb9c9b792dbe44c4e5d22623c366dbb102af6f173cec93248bd6b70fd995"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["geo_retailer_zip9_chain_count"], ["geo_retailer_zip9_chain_count"], ["geo_retailer_zip9_chain_count"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.geo_retailer_zip9_chain_count", "model.sdna_project.geo_retailer_zip9_chain_count", "model.sdna_project.geo_retailer_zip9_chain_count"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_is_cg_fvh_iri": {"raw_sql": "SELECT\n    cv_living_unit_id                                          ,\n    cv_address_id                                              ,\n    cv_short_city_name                                         ,\n    cv_city_name                                               ,\n    cv_county_name                                             ,\n    cv_state_abb                                               ,\n    cv_zipcode_5                                               ,\n    cv_zipcode_4                                               ,\n    cv_zipcode_9                                               ,\n    cv_zip_locality                                            ,\n    cv_delvy_pt_bar_cd                                         ,\n    cv_carr_route                                              ,\n    cv_state_cd                                                ,\n    cv_county_cd                                               ,\n    cv_cen2010_tract_block_grp                                 ,\n    cv_cen2010_blockid                                         ,\n    cv_latitude                                                ,\n    cv_longitude                                               ,\n    cv_mat_level_geodata                                       ,\n    cv_addr_qlty_ind                                           ,\n    cv_recp_reliable_cd                                        ,\n    cv_acty_dt                                                 ,\n    cv_tme_zn                                                  ,\n    cv_p1_pid                                                  ,\n    cv_p1_ptyp                                                 ,\n    cv_p1_etnc_etnc                                            ,\n    cv_p1_etnc_exp_grp                                         ,\n    cv_p1_etnc_religion                                        ,\n    cv_p1_etnc_lang_pref                                       ,\n    cv_p1_etnc_grp                                             ,\n    cv_p1_etnc_country_of_origin                               ,\n    cv_p1_gender                                               ,\n    cv_p1_birth_dt                                             ,\n    cv_p1_est_age                                              ,\n    cv_p1_exact_age                                            ,\n    cv_p1_com_age                                              ,\n    cv_p1_edu_mdl                                              ,\n    cv_p1_marital_st                                           ,\n    cv_p1_occ_grp                                              ,\n    cv_p1_occ_cd                                               ,\n    cv_p1_bus_own                                              ,\n    cv_p2_pid                                                  ,\n    cv_p2_ptyp                                                 ,\n    cv_p2_etnc_etnc                                            ,\n    cv_p2_etnc_exp_grp                                         ,\n    cv_p2_etnc_religion                                        ,\n    cv_p2_etnc_lang_pref                                       ,\n    cv_p2_etnc_grp                                             ,\n    cv_p2_etnc_country_of_origin                               ,\n    cv_p2_gender                                               ,\n    cv_p2_birth_dt                                             ,\n    cv_p2_est_age                                              ,\n    cv_p2_exact_age                                            ,\n    cv_p2_com_age                                              ,\n    cv_p2_edu_mdl                                              ,\n    cv_p2_marital_st                                           ,\n    cv_p2_occ_grp                                              ,\n    cv_p2_occ_cd                                               ,\n    cv_p2_bus_own                                              ,\n    cv_p3_pid                                                  ,\n    cv_p3_ptyp                                                 ,\n    cv_p3_etnc_etnc                                            ,\n    cv_p3_etnc_exp_grp                                         ,\n    cv_p3_etnc_religion                                        ,\n    cv_p3_etnc_lang_pref                                       ,\n    cv_p3_etnc_grp                                             ,\n    cv_p3_etnc_country_of_origin                               ,\n    cv_p3_gender                                               ,\n    cv_p3_birth_dt                                             ,\n    cv_p3_est_age                                              ,\n    cv_p3_exact_age                                            ,\n    cv_p3_com_age                                              ,\n    cv_p3_edu_mdl                                              ,\n    cv_p3_marital_st                                           ,\n    cv_p3_occ_grp                                              ,\n    cv_p3_occ_cd                                               ,\n    cv_p3_bus_own                                              ,\n    cv_p4_pid                                                  ,\n    cv_p4_ptyp                                                 ,\n    cv_p4_etnc_etnc                                            ,\n    cv_p4_etnc_exp_grp                                         ,\n    cv_p4_etnc_religion                                        ,\n    cv_p4_etnc_lang_pref                                       ,\n    cv_p4_etnc_grp                                             ,\n    cv_p4_etnc_country_of_origin                               ,\n    cv_p4_gender                                               ,\n    cv_p4_birth_dt                                             ,\n    cv_p4_est_age                                              ,\n    cv_p4_exact_age                                            ,\n    cv_p4_com_age                                              ,\n    cv_p4_edu_mdl                                              ,\n    cv_p4_marital_st                                           ,\n    cv_p4_occ_grp                                              ,\n    cv_p4_occ_cd                                               ,\n    cv_p4_bus_own                                              ,\n    cv_p5_pid                                                  ,\n    cv_p5_ptyp                                                 ,\n    cv_p5_etnc_etnc                                            ,\n    cv_p5_etnc_exp_grp                                         ,\n    cv_p5_etnc_religion                                        ,\n    cv_p5_etnc_lang_pref                                       ,\n    cv_p5_etnc_grp                                             ,\n    cv_p5_etnc_country_of_origin                               ,\n    cv_p5_gender                                               ,\n    cv_p5_birth_dt                                             ,\n    cv_p5_est_age                                              ,\n    cv_p5_exact_age                                            ,\n    cv_p5_com_age                                              ,\n    cv_p5_edu_mdl                                              ,\n    cv_p5_marital_st                                           ,\n    cv_p5_occ_grp                                              ,\n    cv_p5_occ_cd                                               ,\n    cv_p5_bus_own                                              ,\n    cv_p6_pid                                                  ,\n    cv_p6_ptyp                                                 ,\n    cv_p6_etnc_etnc                                            ,\n    cv_p6_etnc_exp_grp                                         ,\n    cv_p6_etnc_religion                                        ,\n    cv_p6_etnc_lang_pref                                       ,\n    cv_p6_etnc_grp                                             ,\n    cv_p6_etnc_country_of_origin                               ,\n    cv_p6_gender                                               ,\n    cv_p6_birth_dt                                             ,\n    cv_p6_est_age                                              ,\n    cv_p6_exact_age                                            ,\n    cv_p6_com_age                                              ,\n    cv_p6_edu_mdl                                              ,\n    cv_p6_marital_st                                           ,\n    cv_p6_occ_grp                                              ,\n    cv_p6_occ_cd                                               ,\n    cv_p6_bus_own                                              ,\n    cv_mor                                                     ,\n    cv_mor_bank_book                                           ,\n    cv_mor_bank_spl_food                                       ,\n    cv_mor_bank_craft_merch                                    ,\n    cv_mor_bank_culinary_int                                   ,\n    cv_mor_bank_dedupe_hit                                     ,\n    cv_mor_bank_doit_yourself                                  ,\n    cv_mor_bank_famgen_mag                                     ,\n    cv_mor_bank_f_merch                                        ,\n    cv_mor_bank_f_orient_mag                                   ,\n    cv_mor_bank_gar_farm_buy                                   ,\n    cv_mor_bank_gar_farm_mag                                   ,\n    cv_mor_bank_gen_contrib                                    ,\n    cv_mor_bank_gen_merch                                      ,\n    cv_mor_bank_gift_gadgs                                     ,\n    cv_mor_bank_health_inst_contib                             ,\n    cv_mor_bank_health_fit_mag                                 ,\n    cv_mor_bank_m_merch                                        ,\n    cv_mor_bank_m_sports_mag                                   ,\n    cv_mor_bank_misc                                           ,\n    cv_mor_bank_nondedupe_hit                                  ,\n    cv_mor_bank_odds_end                                       ,\n    cv_mor_bank_opp_seek_ce                                    ,\n    cv_mor_bank_photograph                                     ,\n    cv_mor_bank_political_cont                                 ,\n    cv_mor_bank_religious_cont                                 ,\n    cv_mor_bank_religious_mag                                  ,\n    cv_mor_bank_upscale_merch                                  ,\n    cv_mor_bank_news_finan                                     ,\n    cv_ncoa_cd                                                 ,\n    cv_ncoa_dt                                                 ,\n    cv_green_aware                                             ,\n    cv_green_aware_deciles                                     ,\n    cv_no_adults_unit                                          ,\n    cv_no_pers_unit                                            ,\n    cv_no_child_unit                                           ,\n    cv_child_age_0_3                                           ,\n    cv_child_age_4_6                                           ,\n    cv_child_age_7_9                                           ,\n    cv_child_age_10_12                                         ,\n    cv_child_age_13_15                                         ,\n    cv_child_age_16_18                                         ,\n    cv_mosaic_household                                        ,\n    cv_mosaic_zip4                                             ,\n    cv_home_bus                                                ,\n    cv_dwelling_type                                           ,\n    cv_dwelling_unit_size                                      ,\n    cv_length_of_residence                                     ,\n    cv_household_comp                                          ,\n    cv_hmeown_hmeown                                           ,\n    cv_hmeown_prob_hmeown                                      ,\n    cv_hmeown_comb_hmeown_renter                               ,\n    cv_est_curr_hme_val                                        ,\n    cv_est_curr_hme_val_range                                  ,\n    cv_cons_vw_proft                                           ,\n    cv_incom_per_national                                      ,\n    cv_county_ehi_per                                          ,\n    cv_auto_in_market_new                                      ,\n    cv_aut_mark_used                                           ,\n    cv_aut_mark_used_0_5_vehicle                               ,\n    cv_aut_mark_used_11_vehicle                                ,\n    cv_aut_mark_used_6_10_vehicle                              ,\n    cv_est_inc_amtv5                                           ,\n    cv_est_hh_incv5                                            ,\n    cv_county_echv_index                                       ,\n    cv_county_echv_per                                         ,\n    cv_state_ehi_index                                         ,\n    cv_county_ehi_index                                        ,\n    cv_cen_rur_urban_county_szcd                               ,\n    cv_cbsa                                                    ,\n    cv_cbsa_type                                               ,\n    cv_cape_edu_ispsa                                          ,\n    cv_cape_edu_ispsa_decile                                   ,\n    cv_cape_inc_fam_state_decile                               ,\n    cv_cape_dens_per_per_pop                                   ,\n    cv_cape_age_pop_0_17                                       ,\n    cv_cape_age_pop_0_4                                        ,\n    cv_cape_age_pop_5_9                                        ,\n    cv_cape_age_pop_10_13                                      ,\n    cv_cape_age_pop_14_17                                      ,\n    cv_cape_age_pop_18_99                                      ,\n    cv_cape_age_pop_65_99                                      ,\n    cv_cape_age_pop_median_age                                 ,\n    cv_cape_built_median_hous_age                              ,\n    cv_cape_child_couple_famw_lt18                             ,\n    cv_cape_child_couple_famwo_lt18                            ,\n    cv_cape_child_wper_lt18                                    ,\n    cv_cape_edu_pop25_med_edu_attain                           ,\n    cv_cape_occ_empid_health_tech                              ,\n    cv_cape_ethnic_pop_black_only                              ,\n    cv_cape_ethnic_pop_asian_only                              ,\n    cv_cape_ethnic_pop_hispanic                                ,\n    cv_cape_ethnic_pop_white_only                              ,\n    cv_cape_avg_hh_size                                        ,\n    cv_cape_oohu_med_hme_val                                   ,\n    cv_cape_hu_mob_hme                                         ,\n    cv_cape_med_fam_hh_inc                                     ,\n    cv_cape_lang_spanish_speak                                 ,\n    cv_cape_occhu_own_occu                                     ,\n    cv_cape_oochu_rent_occu                                    ,\n    cv_cape_marr_couple_fam                                    ,\n    cv_hh_int_read_bible_devo                                  ,\n    cv_hh_pc_use_net_service                                   ,\n    cv_hh_crafts                                               ,\n    cv_hh_finan_stks_bond                                      ,\n    cv_hh_finan_cds_money_mkt                                  ,\n    cv_hh_finan_iras_currently                                 ,\n    cv_hh_finan_mutual_funds                                   ,\n    cv_hh_finan_real_estate                                    ,\n    cv_act_amusement_park_visit                                ,\n    cv_act_zoo_visit                                           ,\n    cv_act_coffee_connoisseurs                                 ,\n    cv_act_wine_lover                                          ,\n    cv_act_doit_yourself                                       ,\n    cv_act_hme_imp_spenders                                    ,\n    cv_act_hunt_enthus                                         ,\n    cv_act_digi_mag_buyer                                      ,\n    cv_act_attend_edu_pgm                                      ,\n    cv_act_video_gamer                                         ,\n    cv_act_mlb_enthus                                          ,\n    cv_act_nascar_enthus                                       ,\n    cv_act_nba_enthus                                          ,\n    cv_act_nfl_enthus                                          ,\n    cv_act_nhl_enthus                                          ,\n    cv_act_pga_tour_enthus                                     ,\n    cv_act_politics_viewing_tv_lib                             ,\n    cv_act_politics_viewing_tv_libcom                          ,\n    cv_act_politics_viewing_tv_conserv                         ,\n    cv_act_eats_fam_restaurant                                 ,\n    cv_act_eats_ff_restaurant                                  ,\n    cv_act_canoeing_kayaking                                   ,\n    cv_act_play_golf                                           ,\n    cv_act_gourment_cooking                                    ,\n    cv_act_cat_owners                                          ,\n    cv_act_dog_owners                                          ,\n    cv_act_pet_enthus                                          ,\n    cv_act_arts_crafts                                         ,\n    cv_act_scrapbooking                                        ,\n    cv_act_cultural_arts                                       ,\n    cv_hobbies_gardening                                       ,\n    cv_act_photography                                         ,\n    cv_act_book_reader                                         ,\n    cv_act_ebook_reader                                        ,\n    cv_act_audiobook_reader                                    ,\n    cv_act_avid_runners                                        ,\n    cv_act_outdoor_enthus                                      ,\n    cv_act_fishing                                             ,\n    cv_act_snow_sport                                          ,\n    cv_act_boating                                             ,\n    cv_act_plays_hockey                                        ,\n    cv_act_plays_soccer                                        ,\n    cv_act_plays_tennis                                        ,\n    cv_act_sport_enthusiast                                    ,\n    cv_act_healthy_living                                      ,\n    cv_act_fitness_enthus                                      ,\n    cv_act_on_diet                                             ,\n    cv_act_weight_conscious                                    ,\n    cv_act_casino_gambling                                     ,\n    cv_act_sweepstakes_lottery                                 ,\n    cv_act_music_download                                      ,\n    cv_act_music_stream                                        ,\n    cv_act_listen_christian_music                              ,\n    cv_act_listen_classical_music                              ,\n    cv_act_listen_country_music                                ,\n    cv_act_listen_music                                        ,\n    cv_act_listen_oldies_music                                 ,\n    cv_act_listen_rock_music                                   ,\n    cv_act_listen_80s_music                                    ,\n    cv_act_listen_hiphop_music                                 ,\n    cv_act_listen_alter_music                                  ,\n    cv_act_listen_jazz_music                                   ,\n    cv_act_listen_pop_music                                    ,\n    cv_buyer_lap_own                                           ,\n    cv_buyer_security_sys_own                                  ,\n    cv_buyer_tab_own                                           ,\n    cv_buyer_coupon_users                                      ,\n    cv_buyer_lux_store_shopp                                   ,\n    cv_buyer_lux_hme_goods_shopp                               ,\n    cv_buyer_yng_adult_cloth_shopp                             ,\n    cv_buyer_supercenter_shopp                                 ,\n    cv_buyer_warehouse_club_mem                                ,\n    cv_buyer_loyalty_card_usr                                  ,\n    cv_buyer_presence_auto                                     ,\n    cv_buyer_nonpres_makeup_usr                                ,\n    cv_buyer_pres_makeup_usr                                   ,\n    cv_buyer_highend_spirit_drinker                            ,\n    cv_lfstyl_lf_insure_plcy_hldr                              ,\n    cv_lfstyl_med_insure_plcy_hldrs                            ,\n    cv_lfstyl_medicare_plcy_hldrs                              ,\n    cv_lfstyl_have_grand_child                                 ,\n    cv_lfstyl_high_freq_business_trav                          ,\n    cv_lfstyl_high_freq_cruise_enthus                          ,\n    cv_lfstyl_high_freq_domes_vacationer                       ,\n    cv_lfstyl_high_freq_forgn_vacationer                       ,\n    cv_lfstyl_freq_fly_pgm_mem                                 ,\n    cv_lfstyl_hostel_guest_loyal_pgm                           ,\n    cv_lfstyl_interest_religion                                ,\n    cv_lfstyl_military_act                                     ,\n    cv_lfstyl_military_inact                                   ,\n    cv_donor_contrib_charities                                 ,\n    cv_donor_contrib_arts_charities                            ,\n    cv_donor_contrib_edu_charities                             ,\n    cv_donor_contrib_health_charities                          ,\n    cv_donor_contrib_political_charities                       ,\n    cv_donor_contrib_pvt_found                                 ,\n    cv_donor_contrib_volunteer                                 ,\n    cv_finan_debit_card_usr                                    ,\n    cv_finan_corp_credit_card_usr                              ,\n    cv_finan_major_credit_card_usr                             ,\n    cv_finan_premium_credit_card_usr                           ,\n    cv_finan_credit_card_usr                                   ,\n    cv_finan_store_credit_card_usr                             ,\n    cv_invest_retire_finan_plan                                ,\n    cv_invest_part_online_trade                                ,\n    cv_invest_brokerage_acct_own                               ,\n    cv_invest_actv_investor                                    ,\n    cv_invest_mutual_fund_invest                               ,\n    cv_memship_aarp_mem                                        ,\n    cv_memship_union_mem                                       ,\n    cv_tt_email                                                ,\n    -- Removed old cv_tt_* columns,\n    cv_p1_retail_shopp                                         ,\n    cv_p2_retail_shopp                                         ,\n    cv_p3_retail_shopp                                         ,\n    cv_p4_retail_shopp                                         ,\n    cv_p5_retail_shopp                                         ,\n    cv_p6_retail_shopp                                         ,\n    cv_p1_health_well_being                                    ,\n    cv_p2_health_well_being                                    ,\n    cv_p3_health_well_being                                    ,\n    cv_p4_health_well_being                                    ,\n    cv_p5_health_well_being                                    ,\n    cv_p6_health_well_being                                    ,\n    cv_p1_mobile_usrs                                          ,\n    cv_p2_mobile_usrs                                          ,\n    cv_p3_mobile_usrs                                          ,\n    cv_p4_mobile_usrs                                          ,\n    cv_p5_mobile_usrs                                          ,\n    cv_p6_mobile_usrs                                          ,\n    cv_p1_tech_adoption                                        ,\n    cv_p2_tech_adoption                                        ,\n    cv_p3_tech_adoption                                        ,\n    cv_p4_tech_adoption                                        ,\n    cv_p5_tech_adoption                                        ,\n    cv_p6_tech_adoption                                        ,\n    cv_p1_mor                                                  ,\n    cv_p2_mor                                                  ,\n    cv_p3_mor                                                  ,\n    cv_p4_mor                                                  ,\n    cv_p5_mor                                                  ,\n    cv_p6_mor                                                  ,\n    cv_mosaic_glob_hh                                          ,\n    cv_mosaic_glob_zip4                                        ,\n    cv_child_pres_0_18                                         ,\n    cv_child_age_0_3_mdl                                       ,\n    cv_child_age_scor_0_3                                      ,\n    cv_child_age_4_6_mdl                                       ,\n    cv_child_age_scor_4_6                                      ,\n    cv_child_age_7_9_mdl                                       ,\n    cv_child_age_scor_7_9_                                     ,\n    cv_child_age_10_12_mdl                                     ,\n    cv_child_age_scor_10_12_                                   ,\n    cv_child_age_13_15_mdl                                     ,\n    cv_child_age_scor_13_15                                    ,\n    cv_child_age_16_18_mdl                                     ,\n    cv_child_age_scor_16_18_                                   ,\n    cv_hh_ail_meds_vis_ctnt_lenses                             ,\n    cv_bhvr_bank_cntct_lens_wearer                             ,\n    cv_bhvr_bnk_reg_pres_drug_users                            ,\n    cv_bhvr_bnk_intrst_vid_dvd                                 ,\n    cv_bhvr_bnk_intrst_golf                                    ,\n    cv_bhvr_bnk_contri_charities                               ,\n    cv_bhvr_bnk_pet_enthusiast                                 ,\n    cv_bhvr_bnk_intrst_cultural_arts                           ,\n    cv_bhvr_bnk_purchased_thu_mail                             ,\n    cv_bhvr_bnk_intrst_fitness                                 ,\n    cv_bhvr_bnk_intrst_outdoors                                ,\n    cv_bhvr_bnk_intrst_travel                                  ,\n    cv_bhvr_bnk_investors                                      ,\n    cv_bhvr_bnk_pres_of_automobile                             ,\n    cv_bhvr_bnk_pres_of_credit_card                            ,\n    cv_bhvr_bnk_intrst_gardening                               ,\n    cv_bhvr_bnk_intrst_crafts                                  ,\n    cv_bhvr_bnk_collectors                                     ,\n    cv_bhvr_bnk_cruise_enthusiasts                             ,\n    cv_bhvr_bnk_intrst_sports                                  ,\n    cv_bhvr_bnk_intrst_grmt_cooking                            ,\n    cv_bhvr_bnk_sweepstakes_gambling                           ,\n    cv_bhvr_bnk_intrst_politics                                ,\n    cv_bhvr_bnk_intrst_music                                   ,\n    cv_bhvr_bnk_intrst_reading                                 ,\n    cv_bhvr_bnk_child_parenting_prod                           ,\n    cv_bhvr_bnk_do_it_yourselfer                               ,\n    cv_bhvr_bnk_self_improvement                               ,\n    cv_bhvr_bnk_intrst_in_religion                             ,\n    cv_bhvr_bnk_grandparent                                    ,\n    cv_bhvr_bnk_intrst_clothing                                ,\n    cv_bhvr_bnk_donates_envrn_causes                           ,\n    cv_bhvr_bnk_invests_mutual_funds                           ,\n    cv_bhvr_bnk_wght_conscious                                 ,\n    cv_bhvr_bnk_mail_order_multibuyer                          ,\n    cv_bhvr_bnk_dog_enthusiasts                                ,\n    cv_bhvr_bnk_cat_enthusiasts                                ,\n    cv_bhvr_bnk_hlthy_living                                   ,\n    cv_bhvr_bnk_intrst_automotive                              ,\n    cv_bhvr_bnk_intrst_skiing                                  ,\n    cv_bhvr_bnk_intrst_boating                                 ,\n    cv_bhvr_bnk_pres_of_cell_phone                             ,\n    cv_bhvr_bnk_commn_connectivity                             ,\n    cv_bhvr_bnk_computers                                      ,\n    cv_bhvr_bnk_hi_tech_owner                                  ,\n    cv_bhvr_bnk_home_decor_furnish                             ,\n    cv_bhvr_bnk_homeentmnt_video                               ,\n    cv_bhvr_bnk_kitchen_aids_applns                            ,\n    cv_bhvr_bnk_mo_buyer_music_video                           ,\n    cv_bhvr_bnk_mob_books                                      ,\n    cv_bhvr_bnk_mo_buyer_cloth_shoe                            ,\n    cv_bhvr_bnk_mob_ins_fin                                    ,\n    cv_bhvr_bnk_mail_order_buyer_gift                          ,\n    cv_bhvr_bnk_mob_grdng                                      ,\n    cv_bhvr_bnk_mob_jewelry                                    ,\n    cv_bhvr_bnk_clas_opra_big_bnd_mus                          ,\n    cv_bhvr_bnk_country_music                                  ,\n    cv_bhvr_bnk_christian_music                                ,\n    cv_bhvr_bnk_rock_music                                     ,\n    cv_bhvr_bnk_internet_online_subs                           ,\n    cv_bhvr_bnk_intrst_photo                                   ,\n    cv_bhvr_bnk_purchase_via_online                            ,\n    cv_bhvr_bnk_intrst_affluence_ls                            ,\n    cv_bhvr_bnk_domestic_traveler                              ,\n    cv_bhvr_bnk_foreign_traveler                               ,\n    cv_bhvr_bnk_pres_of_prem_cc                                ,\n    cv_bhvr_bnk_active_military                                ,\n    cv_bhvr_bnk_inactive_military                              ,\n    cv_hh_acty_int_hob_photography                             ,\n    cv_hh_acty_int_hobbies_gardening                           ,\n    cv_hh_acty_int_hob_home_ws_diy                             ,\n    cv_hh_acty_int_hob_cars_auto_rep                           ,\n    cv_hh_acty_int_hob_bird_watching                           ,\n    cv_hh_acty_int_hob_self_imprvmnt                           ,\n    cv_hh_acty_int_music_chrstn_gosp                           ,\n    cv_hh_acty_int_music_r_and_b                               ,\n    cv_hh_acty_int_music_jazz_new_age                          ,\n    cv_hh_acty_int_music_classical                             ,\n    cv_hh_acty_int_music_rock_n_roll                           ,\n    cv_hh_acty_int_music_country                               ,\n    cv_hh_acty_int_music_in_gen                                ,\n    cv_hh_acty_int_music_other_music                           ,\n    cv_hh_acty_int_read_bs_fiction                             ,\n    cv_hh_acty_int_childrens_reading                           ,\n    cv_hh_acty_int_reading_computer                            ,\n    cv_hh_acty_int_read_cook_culinary                          ,\n    cv_hh_acty_int_reading_country_ls                          ,\n    cv_hh_acty_int_read_entmnt_ppl                             ,\n    cv_hh_acty_int_reading_fashion                             ,\n    cv_hh_acty_int_reading_history                             ,\n    cv_hh_acty_int_read_intr_decor                             ,\n    cv_hh_acty_int_read_med_hlth                               ,\n    cv_hh_acty_int_reading_military                            ,\n    cv_hh_acty_int_reading_mystery                             ,\n    cv_hh_acty_int_read_ntrl_hlth_rmd                          ,\n    cv_hh_acty_int_reading_romance                             ,\n    cv_hh_acty_int_read_sc_fiction                             ,\n    cv_hh_acty_int_read_sc_tech                                ,\n    cv_hh_acty_int_sports_read                                 ,\n    cv_hh_acty_int_read_wrld_news_pol                          ,\n    cv_hh_acty_int_book_reader                                 ,\n    cv_hh_acty_int_soc_ani_wf_soc                              ,\n    cv_hh_acty_int_soc_env_wildlife                            ,\n    cv_hh_acty_int_soc_pol_cons                                ,\n    cv_hh_acty_int_soc_pol_liberal                             ,\n    cv_hh_acty_int_soc_religion                                ,\n    cv_hh_acty_int_soc_child                                   ,\n    cv_hh_acty_int_soc_veterans                                ,\n    cv_hh_acty_int_soc_hlth                                    ,\n    cv_hh_acty_int_soc_othr                                    ,\n    cv_hh_acty_int_sportsbaseball                              ,\n    cv_hh_acty_int_sportsbasketball                            ,\n    cv_hh_acty_int_sports_rec_hockey                           ,\n    cv_hh_acty_int_sportscampng_hikng                          ,\n    cv_hh_acty_int_sports_rec_hunting                          ,\n    cv_hh_acty_int_sports_rec_fishing                          ,\n    cv_hh_acty_int_sports_rec_nascar                           ,\n    cv_hh_acty_int_sprt_fitness_exer                           ,\n    cv_hh_acty_int_sportsscuba_diving                          ,\n    cv_hh_acty_int_sportsfootball                              ,\n    cv_hh_acty_int_sports_rec_golf                             ,\n    cv_hh_acty_int_sportssnow_skng                             ,\n    cv_hh_acty_int_boating_sailing                             ,\n    cv_hh_acty_int_sports_rec_walking                          ,\n    cv_hh_acty_int_sports_rec_cycling                          ,\n    cv_hh_acty_int_sportsmotorcycles                           ,\n    cv_hh_acty_int_running_jogging                             ,\n    cv_hh_acty_int_sports_rec_soccer                           ,\n    cv_hh_acty_int_sportsswimming                              ,\n    cv_hh_acty_int_play_sprt_in_gen                            ,\n    cv_hh_acty_int_sweepstakes                                 ,\n    cv_hh_acty_int_swpstakes_loteries                          ,\n    cv_hh_acty_int_casino_gambling                             ,\n    cv_hh_acty_int_travel_cruise                               ,\n    cv_hh_acty_int_trvl_inter                                  ,\n    cv_hh_acty_int_travel_domestic                             ,\n    cv_hh_acty_int_travel_time_share                           ,\n    cv_hh_acty_int_trvl_rec_vehicle                            ,\n    cv_hh_acty_int_rv_travel                                   ,\n    cv_hh_acty_int_trvl_bus_trvl                               ,\n    cv_hh_acty_int_trvl_per_trvl                               ,\n    cv_hh_acty_int_pc_i_own_computer                           ,\n    cv_hh_acty_int_pc__i_usedsl_hispd                          ,\n    cv_hh_acty_int_pc_i_plan_buy_comp                          ,\n    cv_hh_acty_int_eg_cell_phone                               ,\n    cv_hh_acty_int_eg_com_disc_player                          ,\n    cv_hh_acty_int_eg_dvd_player                               ,\n    cv_hh_acty_int_eg_satellite_dish                           ,\n    cv_hh_acty_int_eg_dig_cam                                  ,\n    cv_hh_acty_int_eg_hdtv                                     ,\n    cv_hh_acty_int_eg__electronics                             ,\n    cv_hh_acty_int_eg_pda_blackberry                           ,\n    cv_hh_acty_int_eg_video_camera                             ,\n    cv_hh_acty_int_eg_video_game_sys                           ,\n    cv_hh_acty_int_eg_hom_theater_sys                          ,\n    cv_hh_acty_int_eg_cellph_priphln                           ,\n    cv_hh_acty_int_cltrl_arts                                  ,\n    cv_hh_acty_int_magzn_bus_fin                               ,\n    cv_hh_acty_int_childrens_magzn                             ,\n    cv_hh_acty_int_magzn_comp_elctrns                          ,\n    cv_hh_acty_int_magzn_crft_gms_hob                          ,\n    cv_hh_acty_int_magazines_fitness                           ,\n    cv_hh_acty_int_mgzn_fd_wine_ckng                           ,\n    cv_hh_acty_int_magzn_grdng_magzn                           ,\n    cv_hh_acty_int_magzn_hntg_fshng                            ,\n    cv_hh_acty_int_magazines_mens                              ,\n    cv_hh_acty_int_magazines_music                             ,\n    cv_hh_acty_int_mgzn_prtntg_babies                          ,\n    cv_hh_acty_int_mgzn_sports_mgzn                            ,\n    cv_hh_acty_int_magzn_subs                                  ,\n    cv_hh_acty_int_magazines_travel                            ,\n    cv_hh_acty_int_magazines_womens                            ,\n    cv_hh_acty_int_magzn_cur_evnt_nws                          ,\n    cv_hh_ls_veh_hav_leased_a_veh                              ,\n    cv_hh_ls_veh_hav_purchased_a_veh                           ,\n    cv_hh_ls_afltn_mem_book_club                               ,\n    cv_hh_ls_afltn_mem_music_club                              ,\n    cv_hh_ls_cc_amer_exp_prem                                  ,\n    cv_hh_ls_cc_amer_exp_regular                               ,\n    cv_hh_ls_cc_discover_premium                               ,\n    cv_hh_ls_cc_discover_regular                               ,\n    cv_hh_ls_cc_other_card_premium                             ,\n    cv_hh_ls_cc_other_card_regular                             ,\n    cv_hh_ls_cc_store_ret_reg                                  ,\n    cv_hh_ls_cc_visa_regular                                   ,\n    cv_hh_ls_cc_mastercard_regular                             ,\n    cv_hh_ls_contri_hmntrn                                     ,\n    cv_hh_ls_entmnt_buy_prercrdvideo                           ,\n    cv_hh_ls_entmnt_wtch_cabletv                               ,\n    cv_hh_ls_entmnt_watch_videos                               ,\n    cv_hh_ls_outdoor_lvng_entmnt                               ,\n    cv_hh_ls_entmnt_season_hldy_prod                           ,\n    cv_hh_ls_fin_iras_future_intrst                            ,\n    cv_hh_ls_fin_life_insur_cur                                ,\n    cv_hh_ls_fin_mutl_funds                                    ,\n    cv_hh_ls_fin_othr_invest_cur                               ,\n    cv_hh_ls_fin_othr_invest_future                            ,\n    cv_hh_ls_fin_real_estate_fut                               ,\n    cv_hh_ls_fin_stks_bond_fut                                 ,\n    cv_hh_ls_grndkids_proud_grndprnt                           ,\n    cv_hh_ls_info_byng_purc_by_intrnt                          ,\n    cv_hh_ls_mil_gov_active_mil_mem                            ,\n    cv_hh_ls_military_gov_vetern                               ,\n    cv_hh_lifestyl_pets_own_a_cat                              ,\n    cv_hh_lifestyl_pets_own_a_dog                              ,\n    cv_hh_lifestyl_pets_own_a_pet                              ,\n    cv_hh_ls_biy_internet                                      ,\n    cv_hh_ls_bib_mail                                          ,\n    cv_hh_ls_bib_catalog                                       ,\n    cv_hh_ls_buying_interest_apparel                           ,\n    cv_hh_ls_buying_intrst_comp_elec                           ,\n    cv_hh_ls_buying_intrst_book_music                          ,\n    cv_hh_ls_bi_home_garden                                    ,\n    cv_hh_ls_bi_sports_related                                 ,\n    cv_hh_ls_buying_interest_big_tall                          ,\n    cv_hh_ls_byng_intrst_moc                                   ,\n    cv_hh_ls_byng_intrst_mog                                   ,\n    cv_hh_ls_bi_mail_order_gift                                ,\n    cv_hh_ls_byng_intrst_mjc                                   ,\n    cv_hh_ls_bi_mail_music_videos                              ,\n    cv_hh_ls_byng_intrst_mcp                                   ,\n    cv_hh_ls_bi_mail_books_magzn                               ,\n    cv_hh_ls_bi_food_and_beverage                              ,\n    cv_hh_ls_bi_home_decorating                                ,\n    cv_hh_ls_bi_furniture                                      ,\n    cv_hh_ls_bi_domestics                                      ,\n    cv_hh_ls_buying_interest_footwear                          ,\n    cv_hh_ml_ordr_apprl_acsries                                ,\n    cv_cape_age_pop_0_9                                        ,\n    cv_cape_age_pop_0_24                                       ,\n    cv_cape_age_pop_25_34                                      ,\n    cv_cape_age_pop_35_44                                      ,\n    cv_cape_age_pop_45_54                                      ,\n    cv_cape_age_pop_55_64                                      ,\n    cv_cape_age_pop_18_65                                      ,\n    cv_cape_age_pop_75_99                                      ,\n    cv_cape_pop_med_age_of_adults_18                           ,\n    cv_cape_child_hh_fem_hh_fam_plt18                          ,\n    cv_cape_child_hh_without_per_lt18                          ,\n    cv_cape_cmte_com_travtowrk_60_89                           ,\n    cv_cape_cmter_travtowork_90                                ,\n    cv_cape_cmter_avg_trav_timetowork                          ,\n    cv_cape_cmter_med_trav_timetowork                          ,\n    cv_cape_cmte_wrkrs_carpld_to_work                          ,\n    cv_cape_emply_fem16_lbr_frce                               ,\n    cv_cape_etnc_hh_nonhisp_whte_only                          ,\n    cv_cape_etnc_pop_black_only_hisp                           ,\n    cv_cape_etnc_pop_non_hispanic                              ,\n    cv_cape_etnc_pop_white_only_hisp                           ,\n    cv_cape_inc_hh_inc_under_10k                               ,\n    cv_cape_inc_hh_inc_10_14k                                  ,\n    cv_cape_inc_hh_inc_15_19k                                  ,\n    cv_cape_inc_hh_inc_20_24k                                  ,\n    cv_cape_inc_hh_inc_25_29k                                  ,\n    cv_cape_inc_hh_inc_30_34k                                  ,\n    cv_cape_inc_hh_inc_35_39k                                  ,\n    cv_cape_inc_hh_inc_40_44k                                  ,\n    cv_cape_inc_hh_inc_45_49k                                  ,\n    cv_cape_inc_hh_inc_50_59k                                  ,\n    cv_cape_inc_hh_inc_60_74k                                  ,\n    cv_cape_inc_hh_inc_75_99k                                  ,\n    cv_cape_inc_hh_inc_100_124k                                ,\n    cv_cape_inc_hh_inc_125_149k                                ,\n    cv_cape_inc_hh_inc_150_199k                                ,\n    cv_cape_inc_hh_inc_200_249k                                ,\n    cv_cape_inc_hh_inc_250_499k                                ,\n    cv_cape_inc_hh_incm_500k_more                              ,\n    cv_cape_inc_hh_med_hh_inc                                  ,\n    cv_cape_inc_hh_med_non_fam_hh_inc                          ,\n    cv_cape_inc_pop_per_capita_income                          ,\n    cv_cape_ind_empld_acmdn_food_svcs                          ,\n    cv_cape_ind_empld_adm_supwstemgmt                          ,\n    cv_cape_ind_empld_agr_fst_fsh_hnt                          ,\n    cv_cape_ind_empld_arts_entmnt                              ,\n    cv_cape_indus_empld_construction                           ,\n    cv_cape_ind_empld_edu_srvs                                 ,\n    cv_cape_ind_empld_fin_and_ins                              ,\n    cv_cape_indus_empld_hc_soc_ass                             ,\n    cv_cape_indus_empld_information                            ,\n    cv_cape_indus_empld_manufacturing                          ,\n    cv_cape_ind_empld_mgmt_com_entrps                          ,\n    cv_cape_indus_empld_mining                                 ,\n    cv_cape_ind_empld_oth_svcs                                 ,\n    cv_cape_ind_empld_public_admin                             ,\n    cv_cape_ind_empld_rer_lsng                                 ,\n    cv_cape_indus_empld_retail_trade                           ,\n    cv_cape_ind_empld_prof_sc_tch_scs                          ,\n    cv_cape_ind_empld_trans_wh                                 ,\n    cv_cape_indus_empld_utilities                              ,\n    cv_cape_ind_empld_wholesale_trade                          ,\n    cv_cape_mrtg_oohu_first_mrtg_only                          ,\n    cv_cape_move_occhu_med_len_res                             ,\n    cv_cape_rent_rntl_median_rent                              ,\n    cv_cape_tenancy_hu_occupied                                ,\n    cv_cape_typ_pop_child_in_fam_hh                            ,\n    cv_cape_typ_pop_in_family_hh                               ,\n    cv_cape_typ_pop_in_non_family_hh                           ,\n    cv_cape_pop_nat_adpt_child_fam_hh                          ,\n    cv_cape_typ_pop_spouse_in_fam_hh                           ,\n    cv_cape_urban_pop_rural_on_farms                           ,\n    cv_cape_urban_pop_rur_not_on_frms                          ,\n    cv_cape_urban_pop_in_urban_area                            ,\n    cv_cape_urban_pop_in_urban_clstrs                          ,\n    cv_cape_inc_fam_inc_state_indx                             ,\n    cv_prop_rlty_home_year_built                               ,\n    cv_mrtg_home_pur_mrtg_term                                 ,\n    cv_mrtg_home_pur_home_pur_date                             ,\n    cv_mrtg_home_pur_mrtg_rate_type                            ,\n    cv_mrtg_home_pur_mrtg_loan_type                            ,\n    cv_mrtg_home_purc_type_of_purc                             ,\n    cv_mrtg_home_pur_pur_amt_rng                               ,\n    cv_mrtg_home_pur_mrtg_amt_rng                              ,\n    cv_rlty_mdl_confdnce_cdv2                                  ,\n    cv_rlty_mdl_est_avl_equity_cd_v2                           ,\n    cv_rlty_mdl_est_avl_equity_amt_v2                          ,\n    cv_rlty_mdl_est_cur_lntoval_ratv2                          ,\n    cv_rlty_mdl_est_cur_mrtg_pmtv21                            ,\n    cv_rlty_mdl_est_cur_mrtg_pmtv22                            ,\n    cv_rlty_mdl_est_cur_mrtg_amtcdv2                           ,\n    cv_rlty_mdl_est_cur_mrtg_am_v2                             ,\n    geo_zipcode                                                ,\n    geo_kroger_banner                                          ,\n    geo_all_other_kroger                                       ,\n    geo_albertsons_safeway                                     ,\n    geo_publix                                                 ,\n    geo_ahold_delhaize                                         ,\n    geo_wakefern                                               ,\n    geo_hy_vee                                                 ,\n    geo_heb                                                    ,\n    geo_whole_foods                                            ,\n    geo_aldi                                                   ,\n    geo_trader_joes                                            ,\n    geo_bi_lo                                                  ,\n    geo_all_other_grocery                                      ,\n    geo_cvs                                                    ,\n    geo_walgreens                                              ,\n    geo_all_other_drug                                         ,\n    geo_target                                                 ,\n    geo_wm_neighborhood_market                                 ,\n    geo_all_other_walmart                                      ,\n    geo_all_other_mass                                         ,\n    geo_costco                                                 ,\n    geo_bjs                                                    ,\n    geo_sams_club                                              ,\n    geo_all_other_club                                         ,\n    geo_total_c_and_g                                          ,\n    geo_7_eleven                                               ,\n    geo_circle_k                                               ,\n    geo_speedway                                               ,\n    geo_all_other_c_and_g                                      ,\n    geo_dollar_general                                         ,\n    geo_family_dollar                                          ,\n    geo_all_other_dollar                                       ,\n    geo_amazon_com                                             ,\n    geo_walmart_com                                            ,\n    geo_all_other_ao           ,\n    geo_not_assigned           ,\n    is_7_eleven ,\n    is_ahold_delhaize ,\n    is_albertsons ,\n    is_aldi ,\n    is_amazon_com ,\n    is_bi_lo ,\n    is_bjs ,\n    is_circle_k ,\n    is_costco ,\n    is_cvs ,\n    is_dollar_general ,\n    is_family_dollar ,\n    is_heb ,\n    is_speedway ,\n    is_hy_vee ,\n    is_kroger_banner ,\n    is_all_other_kroger ,\n    is_all_other_club ,\n    is_all_other_dollar ,\n    is_all_other_drug ,\n    is_all_other_c_and_g ,\n    is_all_other_grocery ,\n    is_all_other_mass ,\n    is_publix ,\n    is_sams_club ,\n    is_target ,\n    is_trader_joes ,\n    is_wakefern ,\n    is_walgreens ,\n    is_walmart_com ,\n    is_wm_neighborhood_market ,\n    is_all_other_walmart ,\n    is_whole_foods ,\n    is_all_other_ao            ,\n    is_not_assigned            ,\n    is_target_com         ,\n    is_kroger_com         ,\n    is_kmart_com          ,\n    is_walgreens_com      ,\n    is_samsclub_com       ,\n    is_costco_com         ,\n    hh_size                                                    ,\n    hoh_age                                                    ,\n    hoh_lifestage                                              ,\n    hoh_ethnicity                                              ,\n    hoh_hispanic                                               ,\n    hh_income                                                  ,\n    hh_per_cap_income                                          ,\n    hh_presence_of_child                                       ,\n    hh_presence_of_child_age_0_6                               ,\n    hh_presence_of_child_age_7_12                              ,\n    hh_presence_of_child_age_13_18                             ,\n    hh_age_of_old_child                                        ,\n    hh_presence_of_gender                                      ,\n    hh_millennial_male                                         ,\n    hh_millennial_female                                       ,\n    hh_gen_x_male                                              ,\n    hh_gen_x_female                                            ,\n    hh_young_boomer_male                                       ,\n    hh_young_boomer_female                                     ,\n    hh_post_boomer_male                                        ,\n    hh_post_boomer_female                                      ,\n    hh_county_size                                             ,\n    hh_urban_suburban_rural                                    ,\n    hh_county                                                  ,\n    hh_state                                                   ,\n    hh_cbsa                                                    ,\n    fvh_cur_lifestage                                          ,\n    fvh_cur_pred_spend                                         ,\n    fvh_fut_pred_spend                                         ,\n    fvh_growth_rate                                            ,\n    iri.smart_water,\n    iri.smart_water_decile,\n    iri.energy_csd_zero_calorie,\n    iri.energy_csd_zero_calorie_decile,\n    iri.csd_total,\n    iri.csd_total_decile,\n    iri.doritos,\n    iri.doritos_decile,\n    iri.energy_drinks,\n    iri.energy_drinks_decile,\n    iri.gatorade,\n    iri.gatorade_decile,\n    iri.lays,\n    iri.lays_decile,\n    iri.lipton_base,\n    iri.lipton_base_decile,\n    iri.lipton_brisk,\n    iri.lipton_brisk_decile,\n    iri.mt_dew,\n    iri.mt_dew_decile,\n    iri.mtn_dew_kickstart,\n    iri.mtn_dew_kickstart_decile,\n    iri.nuts,\n    iri.nuts_decile,\n    iri.pepsi_diet,\n    iri.pepsi_diet_decile,\n    iri.pepsi_regular,\n    iri.pepsi_regular_decile,\n    iri.performance_bars,\n    iri.performance_bars_decile,\n    iri.pepsico_protein_powder,\n    iri.pepsico_protein_powder_decile,\n    iri.propel,\n    iri.propel_decile,\n    iri.quaker_oatmeal,\n    iri.quaker_oatmeal_decile,\n    iri.rte_cereal,\n    iri.rte_cereal_decile,\n    iri.ruffles,\n    iri.ruffles_decile,\n    iri.bottled_water,\n    iri.bottled_water_decile,\n    iri.starbucks_tripleshot,\n    iri.starbucks_tripleshot_decile,\n    iri.funyuns,\n    iri.funyuns_decile,\n    iri.chilled_tea,\n    iri.chilled_tea_decile,\n    iri.coffee_rtd,\n    iri.coffee_rtd_decile,\n    iri.online_delivery,\n    iri.online_delivery_decile,\n    iri.csd_singles,\n    iri.csd_singles_decile,\n    iri.flv_csd_ex_dew_pepper,\n    iri.flv_csd_ex_dew_pepper_decile,\n    iri.rtd_protein,\n    iri.rtd_protein_decile,\n    iri.sodastream,\n    iri.sodastream_decile,\n    iri.gamefuel,\n    iri.gamefuel_decile,\n    iri.mainstream_kettle_chips,\n    iri.mainstream_kettle_chips_decile,\n    iri.lipton_pure_leaf,\n    iri.lipton_pure_leaf_decile,\n    iri.mainstream_juices,\n    iri.mainstream_juices_decile,\n    iri.mt_dew_flv_seek,\n    iri.mt_dew_flv_seek_decile,\n    iri.instant_quaker_oats,\n    iri.instant_quaker_oats_decile,\n    iri.naked_protein,\n    iri.naked_protein_decile,\n    iri.pepsi_zero_coke_zero,\n    iri.pepsi_zero_coke_zero_decile,\n    iri.prem_juice_drinks,\n    iri.prem_juice_drinks_decile,\n    iri.lightly_flavored_tortilla_chips,\n    iri.lightly_flavored_tortilla_chips_decile,\n    iri.doubleshot_javam,\n    iri.doubleshot_javam_decile,\n    iri.food_bev,\n    iri.food_bev_decile,\n    iri.ncb_innovation,\n    iri.ncb_innovation_decile,\n    iri.premium_csd,\n    iri.premium_csd_decile,\n    iri.premium_tea,\n    iri.premium_tea_decile,\n    iri.premium_water,\n    iri.premium_water_decile,\n    iri.probiotic_juices,\n    iri.probiotic_juices_decile,\n    iri.lays_poppables,\n    iri.lays_poppables_decile,\n    iri.alternative_tortilla_chips,\n    iri.alternative_tortilla_chips_decile,\n    iri.snack_bars,\n    iri.snack_bars_decile,\n    iri.sparkling_water,\n    iri.sparkling_water_decile,\n    iri.dips_as_meal_enhancers,\n    iri.dips_as_meal_enhancers_decile,\n    iri.stacys,\n    iri.stacys_decile,\n    iri.sunchips,\n    iri.sunchips_decile,\n    iri.super_premium_juices,\n    iri.super_premium_juices_decile,\n    iri.tostitos,\n    iri.tostitos_decile,\n    iri.flavor_camp_bbq,\n    iri.flavor_camp_bbq_decile,\n    iri.plant_based_rtd_protein,\n    iri.plant_based_rtd_protein_decile,\n    iri.veggie_chips,\n    iri.veggie_chips_decile,\n    iri.g_organic,\n    iri.g_organic_decile,\n    iri.mountain_dew_baja_blast,\n    iri.mountain_dew_baja_blast_decile,\n    iri.cold_brew,\n    iri.cold_brew_decile,\n    iri.bubly,\n    iri.bubly_decile,\n    iri.ultra_premium_juice,\n    iri.ultra_premium_juice_decile,\n    iri.lightly_salted_chips,\n    iri.lightly_salted_chips_decile,\n    iri.flavor_camp_cheese,\n    iri.flavor_camp_cheese_decile,\n    iri.sabra_hummus_tubs,\n    iri.sabra_hummus_tubs_decile,\n    iri.oj_category_switchers,\n    iri.oj_category_switchers_decile,\n    iri.standard_quaker_oats,\n    iri.standard_quaker_oats_decile,\n    iri.csd_multiserve,\n    iri.csd_multiserve_decile,\n    iri.dew_ice,\n    iri.dew_ice_decile,\n    iri.flavor_camp_dairy,\n    iri.flavor_camp_dairy_decile,\n    iri.online_curbside_pickup,\n    iri.online_curbside_pickup_decile,\n    iri.flavor_camp_herb_spice_veggie,\n    iri.flavor_camp_herb_spice_veggie_decile,\n    iri.flv_salty_snacks,\n    iri.flv_salty_snacks_decile,\n    iri.g2,\n    iri.g2_decile,\n    iri.flavor_camp_salted_plain,\n    iri.flavor_camp_salted_plain_decile,\n    iri.keto_cookies,\n    iri.keto_cookies_decile,\n    iri.low_fat_salty_snacks,\n    iri.low_fat_salty_snacks_decile,\n    iri.aha,\n    iri.aha_decile,\n    iri.plant_based_protein_powder,\n    iri.plant_based_protein_powder_decile,\n    iri.pretzel_category,\n    iri.pretzel_category_decile,\n    iri.flavor_camp_spicy_burn,\n    iri.flavor_camp_spicy_burn_decile,\n    iri.dots_pretzels,\n    iri.dots_pretzels_decile,\n    iri.santitas,\n    iri.santitas_decile,\n    iri.flavor_camp_tangy,\n    iri.flavor_camp_tangy_decile,\n    iri.tropicana_probiotics_purchasers,\n    iri.tropicana_probiotics_purchasers_decile,\n    iri.tropicana_pure_premium_purchasers,\n    iri.tropicana_pure_premium_purchasers_decile,\n    iri.rfg_yogurt_drinks,\n    iri.rfg_yogurt_drinks_decile,\n    iri.flavor_camp_aggregate_all_intense_bold,\n    iri.flavor_camp_aggregate_all_intense_bold_decile,\n    iri.total_regular_cola,\n    iri.total_regular_cola_decile,\n    iri.flavor_camp_meat,\n    iri.flavor_camp_meat_decile,\n    iri.fritos_original,\n    iri.fritos_original_decile,\n    iri.flavored_pretzels,\n    iri.flavored_pretzels_decile,\n    iri.nutrition_engaged,\n    iri.nutrition_engaged_decile,\n    iri.mainstream_engaged,\n    iri.mainstream_engaged_decile,\n    iri.oj_category,\n    iri.oj_category_decile,\n    iri.nutrition_bars,\n    iri.nutrition_bars_decile,\n    iri.oatmeal_category,\n    iri.oatmeal_category_decile,\n    iri.alt_dairy_category,\n    iri.alt_dairy_category_decile,\n    iri.kombucha_functional_juices,\n    iri.kombucha_functional_juices_decile,\n    iri.single_serve_mainstream_juice,\n    iri.single_serve_mainstream_juice_decile,\n    iri.quaker_grits,\n    iri.quaker_grits_decile,\n    iri.shelf_stable_dips_category,\n    iri.shelf_stable_dips_category_decile,\n    iri.fruit_snacks,\n    iri.fruit_snacks_decile,\n    iri.fritos_flavor,\n    iri.fritos_flavor_decile,\n    iri.kevita_purchasers,\n    iri.kevita_purchasers_decile,\n    iri.heart_claim,\n    iri.heart_claim_decile,\n    iri.starbucks_frappuccino,\n    iri.starbucks_frappuccino_decile,\n    iri.single_serve_salty_snacks,\n    iri.single_serve_salty_snacks_decile,\n    iri.cholesterol_claim,\n    iri.cholesterol_claim_decile,\n    iri.g_zero,\n    iri.g_zero_decile,\n    iri.diet_csds,\n    iri.diet_csds_decile,\n    iri.candy_category,\n    iri.candy_category_decile,\n    iri.frozen_fruit_category,\n    iri.frozen_fruit_category_decile,\n    iri.salty_snacks,\n    iri.salty_snacks_decile,\n    iri.premium_greek_yogurt,\n    iri.premium_greek_yogurt_decile,\n    iri.rice_pasta_ethnic_spclty,\n    iri.rice_pasta_ethnic_spclty_decile,\n    iri.pancake_mix_syrup,\n    iri.pancake_mix_syrup_decile,\n    iri.lite_snacks,\n    iri.lite_snacks_decile,\n    iri.herbal_tea,\n    iri.herbal_tea_decile,\n    iri.tazo,\n    iri.tazo_decile,\n    iri.mini_cans,\n    iri.mini_cans_decile,\n    iri.unflavored_pretzels,\n    iri.unflavored_pretzels_decile,\n    iri.bodyarmor,\n    iri.bodyarmor_decile,\n    iri.organic_food_bev_buyers,\n    iri.organic_food_bev_buyers_decile,\n    iri.fritos_scoops,\n    iri.fritos_scoops_decile,\n    iri.grain_claim,\n    iri.grain_claim_decile,\n    iri.diet_coke,\n    iri.diet_coke_decile,\n    iri.online_in_store_pickup,\n    iri.online_in_store_pickup_decile,\n    iri.bare,\n    iri.bare_decile,\n    iri.off_the_eaten_path,\n    iri.off_the_eaten_path_decile,\n    iri.rte_cereal_all_family,\n    iri.rte_cereal_all_family_decile,\n    iri.rte_cereal_kids,\n    iri.rte_cereal_kids_decile,\n    iri.instant_quaker_oats_light_lapsed,\n    iri.instant_quaker_oats_light_lapsed_decile,\n    iri.celsius_energy,\n    iri.celsius_energy_decile,\n    iri.doritos_h_and_s,\n    iri.doritos_h_and_s_decile,\n    iri.premium_kettle_chips,\n    iri.premium_kettle_chips_decile,\n    iri.chewy_kids_snacking,\n    iri.chewy_kids_snacking_decile,\n    iri.starbucks_nitro,\n    iri.starbucks_nitro_decile,\n    iri.premium_lrb,\n    iri.premium_lrb_decile,\n    iri.rte_popcorn_full_flavor,\n    iri.rte_popcorn_full_flavor_decile,\n    iri.rte_popcorn_light_flavor,\n    iri.rte_popcorn_light_flavor_decile,\n    iri.breakfast_cereal_snack_bars,\n    iri.breakfast_cereal_snack_bars_decile,\n    iri.sports_drinks,\n    iri.sports_drinks_decile,\n    iri.takis,\n    iri.takis_decile,\n    iri.lacroix,\n    iri.lacroix_decile,\n    iri.manzanita_sol,\n    iri.manzanita_sol_decile,\n    iri.unflavored_tortilla_chips,\n    iri.unflavored_tortilla_chips_decile,\n    iri.crush,\n    iri.crush_decile,\n    iri.chewy,\n    iri.chewy_decile,\n    iri.rockstar_energy,\n    iri.rockstar_energy_decile,\n    iri.light_holiday_salty_snack_buyers,\n    iri.light_holiday_salty_snack_buyers_decile,\n    iri.medium_holiday_salty_snack_buyers,\n    iri.medium_holiday_salty_snack_buyers_decile,\n    iri.xxvl_single_serve_snacks,\n    iri.xxvl_single_serve_snacks_decile,\n    iri.svlr_single_serve_snacks,\n    iri.svlr_single_serve_snacks_decile,\n    iri.lss_single_serve_snacks,\n    iri.lss_single_serve_snacks_decile,\n    iri.bolt_24,\n    iri.bolt_24_decile,\n    iri.lemonade,\n    iri.lemonade_decile,\n    iri.gamesa_cookies,\n    iri.gamesa_cookies_decile,\n    iri.kids_organic,\n    iri.kids_organic_decile,\n    iri.rice_crisps_cakes,\n    iri.rice_crisps_cakes_decile,\n    iri.health_warrior,\n    iri.health_warrior_decile,\n    iri.simple_nutrition,\n    iri.simple_nutrition_decile,\n    iri.naked,\n    iri.naked_decile,\n    iri.yogurt,\n    iri.yogurt_decile,\n    iri.online_edible,\n    iri.online_edible_decile,\n    iri.better_for_you_bagged_snacks,\n    iri.better_for_you_bagged_snacks_decile,\n    iri.vanilla_flavored_rtd_coffee,\n    iri.vanilla_flavored_rtd_coffee_decile,\n    iri.frozen_dips,\n    iri.frozen_dips_decile,\n    iri.caramel_flavored_rtd_coffee,\n    iri.caramel_flavored_rtd_coffee_decile,\n    iri.coffee_flavored_rtd_coffee,\n    iri.coffee_flavored_rtd_coffee_decile,\n    iri.lays_stax,\n    iri.lays_stax_decile,\n    iri.popcorners,\n    iri.popcorners_decile,\n    iri.shelf_stable_dairy_dips,\n    iri.shelf_stable_dairy_dips_decile,\n    iri.probiotic_attribute,\n    iri.probiotic_attribute_decile,\n    iri.essentia,\n    iri.essentia_decile,\n    iri.core,\n    iri.core_decile,\n    iri.dasani,\n    iri.dasani_decile,\n    iri.shelf_stable_salsa,\n    iri.shelf_stable_salsa_decile,\n    iri.shelf_stable_cheese_dips,\n    iri.shelf_stable_cheese_dips_decile,\n    iri.shelf_stable_bean_dips,\n    iri.shelf_stable_bean_dips_decile,\n    iri.cheetos_cheese_core,\n    iri.cheetos_cheese_core_decile,\n    iri.frito_lay_multipack,\n    iri.frito_lay_multipack_decile,\n    iri.cheetos_flamin_hot_core,\n    iri.cheetos_flamin_hot_core_decile,\n    iri.muscle_milk,\n    iri.muscle_milk_decile,\n    iri.kst_regular_coke_transitioner,\n    iri.kst_regular_coke_transitioner_decile,\n    iri.kst_frequent_diet_pepsi_transitioner,\n    iri.kst_frequent_diet_pepsi_transitioner_decile,\n    iri.kst_hispanic_pepsi_drinker,\n    iri.kst_hispanic_pepsi_drinker_decile,\n    iri.kst_light_cola_drinker,\n    iri.kst_light_cola_drinker_decile,\n    iri.kst_frequent_blue_pepsi_drinker,\n    iri.kst_frequent_blue_pepsi_drinker_decile,\n    iri.kst_non_cola_drinkers,\n    iri.kst_non_cola_drinkers_decile,\n    iri.macaroni_and_cheese,\n    iri.macaroni_and_cheese_decile,\n    iri.heat_and_eat,\n    iri.heat_and_eat_decile,\n    iri.instant_rice_pasta_grains,\n    iri.instant_rice_pasta_grains_decile,\n    iri.better_for_you_crackers,\n    iri.better_for_you_crackers_decile,\n    iri.zero_calorie_csd,\n    iri.zero_calorie_csd_decile,\n    iri.wavy_lays,\n    iri.wavy_lays_decile,\n    iri.multiserve_starbucks,\n    iri.multiserve_starbucks_decile,\n    iri.tea_bags,\n    iri.tea_bags_decile,\n    iri.rfg_dips,\n    iri.rfg_dips_decile,\n    iri.sleeping_remedies,\n    iri.sleeping_remedies_decile,\n    iri.adaptogens,\n    iri.adaptogens_decile,\n    iri.easy_wellness,\n    iri.easy_wellness_decile,\n    iri.bang,\n    iri.bang_decile,\n    iri.kevita_adjacencies,\n    iri.kevita_adjacencies_decile,\n    iri.caffeine_attribute,\n    iri.caffeine_attribute_decile,\n    iri.vitamin_c_attribute,\n    iri.vitamin_c_attribute_decile,\n    iri.antioxidant_attribute,\n    iri.antioxidant_attribute_decile,\n    iri.poland_spring,\n    iri.poland_spring_decile,\n    iri.polar,\n    iri.polar_decile,\n    iri.diet_coke_decliners,\n    iri.diet_coke_decliners_decile,\n    iri.sprite_and_fanta_decliners,\n    iri.sprite_and_fanta_decliners_decile,\n    iri.rap_snacks,\n    iri.rap_snacks_decile,\n    iri.cheetos_crunchy,\n    iri.cheetos_crunchy_decile,\n    iri.cheetos_puffs,\n    iri.cheetos_puffs_decile,\n    iri.lays_classic,\n    iri.lays_classic_decile,\n    iri.premium_cocktail_mixers,\n    iri.premium_cocktail_mixers_decile,\n    iri.baken_ets,\n    iri.baken_ets_decile,\n    iri.mainstream_mixers,\n    iri.mainstream_mixers_decile,\n    iri.quaker_hots_light_lapsed,\n    iri.quaker_hots_light_lapsed_decile,\n    iri.zone_in_shopper,\n    iri.zone_in_shopper_decile,\n    iri.root_beer,\n    iri.root_beer_decile,\n    iri.coke,\n    iri.coke_decile,\n    iri.premium_cheese_snacks,\n    iri.premium_cheese_snacks_decile,\n    iri.stacys_thins,\n    iri.stacys_thins_decile,\n    iri.stacys_core,\n    iri.stacys_core_decile,\n    iri.diet_mountain_dew,\n    iri.diet_mountain_dew_decile,\n    iri.sparkling_ice,\n    iri.sparkling_ice_decile,\n    iri.granola,\n    iri.granola_decile,\n    iri.aj_pancake_mix_and_syrup,\n    iri.aj_pancake_mix_and_syrup_decile,\n    iri.rte_cereal_adult,\n    iri.rte_cereal_adult_decile,\n    iri.kids_ambient_juices,\n    iri.kids_ambient_juices_decile,\n    iri.non_lemonade_juice_drinks,\n    iri.non_lemonade_juice_drinks_decile,\n    iri.cheetos_mac_n_cheese,\n    iri.cheetos_mac_n_cheese_decile,\n    iri.hispanic_cookies,\n    iri.hispanic_cookies_decile,\n    iri.gamesa_crackers,\n    iri.gamesa_crackers_decile,\n    iri.naked_juice_lapsed_buyers,\n    iri.naked_juice_lapsed_buyers_decile,\n    iri.natural_attribute,\n    iri.natural_attribute_decile,\n    iri.protein_attribute,\n    iri.protein_attribute_decile,\n    iri.calcium_attribute,\n    iri.calcium_attribute_decile,\n    iri.fiber,\n    iri.fiber_decile,\n    iri.gluten_free,\n    iri.gluten_free_decile,\n    iri.low_sodium,\n    iri.low_sodium_decile,\n    iri.no_added_sugar,\n    iri.no_added_sugar_decile,\n    iri.simply,\n    iri.simply_decile,\n    iri.baked,\n    iri.baked_decile,\n    iri.non_gmo,\n    iri.non_gmo_decile,\n    iri.mt_dew_total,\n    iri.mt_dew_total_decile,\n    iri.keto_dieters,\n    iri.keto_dieters_decile,\n    iri.party_people,\n    iri.party_people_decile,\n    iri.cold_and_flu_preppers,\n    iri.cold_and_flu_preppers_decile,\n    iri.condiments_and_sauces,\n    iri.condiments_and_sauces_decile,\n    iri.flavored_csds,\n    iri.flavored_csds_decile,\n    iri.holiday_hosts,\n    iri.holiday_hosts_decile,\n    iri.immunity_boosters,\n    iri.immunity_boosters_decile,\n    iri.new_years_dieters,\n    iri.new_years_dieters_decile,\n    iri.new_years_partiers,\n    iri.new_years_partiers_decile,\n    iri.plant_based_buyers,\n    iri.plant_based_buyers_decile,\n    iri.summer_grillers,\n    iri.summer_grillers_decile,\n    iri.super_bowl_hosts,\n    iri.super_bowl_hosts_decile,\n    iri.thanksgiving_hosts,\n    iri.thanksgiving_hosts_decile,\n    iri.hard_coffee,\n    iri.hard_coffee_decile,\n    iri.hard_flavored_bevs_xlemonade,\n    iri.hard_flavored_bevs_xlemonade_decile,\n    iri.hard_kombucha,\n    iri.hard_kombucha_decile,\n    iri.hard_lemonade,\n    iri.hard_lemonade_decile,\n    iri.hard_seltzer,\n    iri.hard_seltzer_decile,\n    iri.health_warrior_competitive_products,\n    iri.health_warrior_competitive_products_decile,\n    iri.other_hmb,\n    iri.other_hmb_decile,\n    iri.cookies,\n    iri.cookies_decile,\n    iri.crackers,\n    iri.crackers_decile,\n    iri.trop_premium_juice_drinks,\n    iri.trop_premium_juice_drinks_decile,\n    iri.wine,\n    iri.wine_decile,\n    iri.spirits_liquor,\n    iri.spirits_liquor_decile,\n    iri.premade_cocktails_coolers,\n    iri.premade_cocktails_coolers_decile,\n    iri.domestic_beer,\n    iri.domestic_beer_decile,\n    iri.imported_beer,\n    iri.imported_beer_decile,\n    iri.flavored_malt_beverages,\n    iri.flavored_malt_beverages_decile,\n    iri.ambient_juice,\n    iri.ambient_juice_decile,\n    iri.new_rtd_tea_buyers_buying_lipton,\n    iri.new_rtd_tea_buyers_buying_lipton_decile,\n    iri.rtd_tea_buyers_switching_to_lipton,\n    iri.rtd_tea_buyers_switching_to_lipton_decile,\n    iri.sabritas,\n    iri.sabritas_decile,\n    iri.cbd_product_purchasers,\n    iri.cbd_product_purchasers_decile,\n    iri.dr_pepper,\n    iri.dr_pepper_decile,\n    iri.coffee_beans,\n    iri.coffee_beans_decile,\n    iri.hispanic_aisle,\n    iri.hispanic_aisle_decile,\n    iri.functional_juice_kombucha_switchers,\n    iri.functional_juice_kombucha_switchers_decile,\n    iri.dole,\n    iri.dole_decile,\n    iri.twister,\n    iri.twister_decile,\n    iri.quaker_grits_new_buyers,\n    iri.quaker_grits_new_buyers_decile,\n    iri.macro_category_multi_pack_buyers,\n    iri.macro_category_multi_pack_buyers_decile,\n    iri.frutly,\n    iri.frutly_decile,\n    iri.flavored_enhanced_water,\n    iri.flavored_enhanced_water_decile,\n    iri.shelf_stable_juice_drinks,\n    iri.shelf_stable_juice_drinks_decile,\n    iri.smart_water_centile,\n    iri.energy_csd_zero_calorie_centile,\n    iri.csd_total_centile,\n    iri.doritos_centile,\n    iri.energy_drinks_centile,\n    iri.gatorade_centile,\n    iri.lays_centile,\n    iri.lipton_base_centile,\n    iri.lipton_brisk_centile,\n    iri.mt_dew_centile,\n    iri.mtn_dew_kickstart_centile,\n    iri.nuts_centile,\n    iri.pepsi_diet_centile,\n    iri.pepsi_regular_centile,\n    iri.performance_bars_centile,\n    iri.pepsico_protein_powder_centile,\n    iri.propel_centile,\n    iri.quaker_oatmeal_centile,\n    iri.rte_cereal_centile,\n    iri.ruffles_centile,\n    iri.bottled_water_centile,\n    iri.starbucks_tripleshot_centile,\n    iri.funyuns_centile,\n    iri.chilled_tea_centile,\n    iri.coffee_rtd_centile,\n    iri.online_delivery_centile,\n    iri.csd_singles_centile,\n    iri.flv_csd_ex_dew_pepper_centile,\n    iri.rtd_protein_centile,\n    iri.sodastream_centile,\n    iri.gamefuel_centile,\n    iri.mainstream_kettle_chips_centile,\n    iri.lipton_pure_leaf_centile,\n    iri.mainstream_juices_centile,\n    iri.mt_dew_flv_seek_centile,\n    iri.instant_quaker_oats_centile,\n    iri.naked_protein_centile,\n    iri.pepsi_zero_coke_zero_centile,\n    iri.prem_juice_drinks_centile,\n    iri.lightly_flavored_tortilla_chips_centile,\n    iri.doubleshot_javam_centile,\n    iri.food_bev_centile,\n    iri.ncb_innovation_centile,\n    iri.premium_csd_centile,\n    iri.premium_tea_centile,\n    iri.premium_water_centile,\n    iri.probiotic_juices_centile,\n    iri.lays_poppables_centile,\n    iri.alternative_tortilla_chips_centile,\n    iri.snack_bars_centile,\n    iri.sparkling_water_centile,\n    iri.dips_as_meal_enhancers_centile,\n    iri.stacys_centile,\n    iri.sunchips_centile,\n    iri.super_premium_juices_centile,\n    iri.tostitos_centile,\n    iri.flavor_camp_bbq_centile,\n    iri.plant_based_rtd_protein_centile,\n    iri.veggie_chips_centile,\n    iri.g_organic_centile,\n    iri.mountain_dew_baja_blast_centile,\n    iri.cold_brew_centile,\n    iri.bubly_centile,\n    iri.ultra_premium_juice_centile,\n    iri.lightly_salted_chips_centile,\n    iri.flavor_camp_cheese_centile,\n    iri.sabra_hummus_tubs_centile,\n    iri.oj_category_switchers_centile,\n    iri.standard_quaker_oats_centile,\n    iri.csd_multiserve_centile,\n    iri.dew_ice_centile,\n    iri.flavor_camp_dairy_centile,\n    iri.online_curbside_pickup_centile,\n    iri.flavor_camp_herb_spice_veggie_centile,\n    iri.flv_salty_snacks_centile,\n    iri.g2_centile,\n    iri.flavor_camp_salted_plain_centile,\n    iri.keto_cookies_centile,\n    iri.low_fat_salty_snacks_centile,\n    iri.aha_centile,\n    iri.plant_based_protein_powder_centile,\n    iri.pretzel_category_centile,\n    iri.flavor_camp_spicy_burn_centile,\n    iri.dots_pretzels_centile,\n    iri.santitas_centile,\n    iri.flavor_camp_tangy_centile,\n    iri.tropicana_probiotics_purchasers_centile,\n    iri.tropicana_pure_premium_purchasers_centile,\n    iri.rfg_yogurt_drinks_centile,\n    iri.flavor_camp_aggregate_all_intense_bold_centile,\n    iri.total_regular_cola_centile,\n    iri.flavor_camp_meat_centile,\n    iri.fritos_original_centile,\n    iri.flavored_pretzels_centile,\n    iri.nutrition_engaged_centile,\n    iri.mainstream_engaged_centile,\n    iri.oj_category_centile,\n    iri.nutrition_bars_centile,\n    iri.oatmeal_category_centile,\n    iri.alt_dairy_category_centile,\n    iri.kombucha_functional_juices_centile,\n    iri.single_serve_mainstream_juice_centile,\n    iri.quaker_grits_centile,\n    iri.shelf_stable_dips_category_centile,\n    iri.fruit_snacks_centile,\n    iri.fritos_flavor_centile,\n    iri.kevita_purchasers_centile,\n    iri.heart_claim_centile,\n    iri.starbucks_frappuccino_centile,\n    iri.single_serve_salty_snacks_centile,\n    iri.cholesterol_claim_centile,\n    iri.g_zero_centile,\n    iri.diet_csds_centile,\n    iri.candy_category_centile,\n    iri.frozen_fruit_category_centile,\n    iri.salty_snacks_centile,\n    iri.premium_greek_yogurt_centile,\n    iri.rice_pasta_ethnic_spclty_centile,\n    iri.pancake_mix_syrup_centile,\n    iri.lite_snacks_centile,\n    iri.herbal_tea_centile,\n    iri.tazo_centile,\n    iri.mini_cans_centile,\n    iri.unflavored_pretzels_centile,\n    iri.bodyarmor_centile,\n    iri.organic_food_bev_buyers_centile,\n    iri.fritos_scoops_centile,\n    iri.grain_claim_centile,\n    iri.diet_coke_centile,\n    iri.online_in_store_pickup_centile,\n    iri.bare_centile,\n    iri.off_the_eaten_path_centile,\n    iri.rte_cereal_all_family_centile,\n    iri.rte_cereal_kids_centile,\n    iri.instant_quaker_oats_light_lapsed_centile,\n    iri.celsius_energy_centile,\n    iri.doritos_h_and_s_centile,\n    iri.premium_kettle_chips_centile,\n    iri.chewy_kids_snacking_centile,\n    iri.starbucks_nitro_centile,\n    iri.premium_lrb_centile,\n    iri.rte_popcorn_full_flavor_centile,\n    iri.rte_popcorn_light_flavor_centile,\n    iri.breakfast_cereal_snack_bars_centile,\n    iri.sports_drinks_centile,\n    iri.takis_centile,\n    iri.lacroix_centile,\n    iri.manzanita_sol_centile,\n    iri.unflavored_tortilla_chips_centile,\n    iri.crush_centile,\n    iri.chewy_centile,\n    iri.rockstar_energy_centile,\n    iri.light_holiday_salty_snack_buyers_centile,\n    iri.medium_holiday_salty_snack_buyers_centile,\n    iri.xxvl_single_serve_snacks_centile,\n    iri.svlr_single_serve_snacks_centile,\n    iri.lss_single_serve_snacks_centile,\n    iri.bolt_24_centile,\n    iri.lemonade_centile,\n    iri.gamesa_cookies_centile,\n    iri.kids_organic_centile,\n    iri.rice_crisps_cakes_centile,\n    iri.health_warrior_centile,\n    iri.simple_nutrition_centile,\n    iri.naked_centile,\n    iri.yogurt_centile,\n    iri.online_edible_centile,\n    iri.better_for_you_bagged_snacks_centile,\n    iri.vanilla_flavored_rtd_coffee_centile,\n    iri.frozen_dips_centile,\n    iri.caramel_flavored_rtd_coffee_centile,\n    iri.coffee_flavored_rtd_coffee_centile,\n    iri.lays_stax_centile,\n    iri.popcorners_centile,\n    iri.shelf_stable_dairy_dips_centile,\n    iri.probiotic_attribute_centile,\n    iri.essentia_centile,\n    iri.core_centile,\n    iri.dasani_centile,\n    iri.shelf_stable_salsa_centile,\n    iri.shelf_stable_cheese_dips_centile,\n    iri.shelf_stable_bean_dips_centile,\n    iri.cheetos_cheese_core_centile,\n    iri.frito_lay_multipack_centile,\n    iri.cheetos_flamin_hot_core_centile,\n    iri.muscle_milk_centile,\n    iri.kst_regular_coke_transitioner_centile,\n    iri.kst_frequent_diet_pepsi_transitioner_centile,\n    iri.kst_hispanic_pepsi_drinker_centile,\n    iri.kst_light_cola_drinker_centile,\n    iri.kst_frequent_blue_pepsi_drinker_centile,\n    iri.kst_non_cola_drinkers_centile,\n    iri.macaroni_and_cheese_centile,\n    iri.heat_and_eat_centile,\n    iri.instant_rice_pasta_grains_centile,\n    iri.better_for_you_crackers_centile,\n    iri.zero_calorie_csd_centile,\n    iri.wavy_lays_centile,\n    iri.multiserve_starbucks_centile,\n    iri.tea_bags_centile,\n    iri.rfg_dips_centile,\n    iri.sleeping_remedies_centile,\n    iri.adaptogens_centile,\n    iri.easy_wellness_centile,\n    iri.bang_centile,\n    iri.kevita_adjacencies_centile,\n    iri.caffeine_attribute_centile,\n    iri.vitamin_c_attribute_centile,\n    iri.antioxidant_attribute_centile,\n    iri.poland_spring_centile,\n    iri.polar_centile,\n    iri.diet_coke_decliners_centile,\n    iri.sprite_and_fanta_decliners_centile,\n    iri.rap_snacks_centile,\n    iri.cheetos_crunchy_centile,\n    iri.cheetos_puffs_centile,\n    iri.lays_classic_centile,\n    iri.premium_cocktail_mixers_centile,\n    iri.baken_ets_centile,\n    iri.mainstream_mixers_centile,\n    iri.quaker_hots_light_lapsed_centile,\n    iri.zone_in_shopper_centile,\n    iri.root_beer_centile,\n    iri.coke_centile,\n    iri.premium_cheese_snacks_centile,\n    iri.stacys_thins_centile,\n    iri.stacys_core_centile,\n    iri.diet_mountain_dew_centile,\n    iri.sparkling_ice_centile,\n    iri.granola_centile,\n    iri.aj_pancake_mix_and_syrup_centile,\n    iri.rte_cereal_adult_centile,\n    iri.kids_ambient_juices_centile,\n    iri.non_lemonade_juice_drinks_centile,\n    iri.cheetos_mac_n_cheese_centile,\n    iri.hispanic_cookies_centile,\n    iri.gamesa_crackers_centile,\n    iri.naked_juice_lapsed_buyers_centile,\n    iri.natural_attribute_centile,\n    iri.protein_attribute_centile,\n    iri.calcium_attribute_centile,\n    iri.fiber_centile,\n    iri.gluten_free_centile,\n    iri.low_sodium_centile,\n    iri.no_added_sugar_centile,\n    iri.simply_centile,\n    iri.baked_centile,\n    iri.non_gmo_centile,\n    iri.mt_dew_total_centile,\n    iri.keto_dieters_centile,\n    iri.party_people_centile,\n    iri.cold_and_flu_preppers_centile,\n    iri.condiments_and_sauces_centile,\n    iri.flavored_csds_centile,\n    iri.holiday_hosts_centile,\n    iri.immunity_boosters_centile,\n    iri.new_years_dieters_centile,\n    iri.new_years_partiers_centile,\n    iri.plant_based_buyers_centile,\n    iri.summer_grillers_centile,\n    iri.super_bowl_hosts_centile,\n    iri.thanksgiving_hosts_centile,\n    iri.hard_coffee_centile,\n    iri.hard_flavored_bevs_xlemonade_centile,\n    iri.hard_kombucha_centile,\n    iri.hard_lemonade_centile,\n    iri.hard_seltzer_centile,\n    iri.health_warrior_competitive_products_centile,\n    iri.other_hmb_centile,\n    iri.cookies_centile,\n    iri.crackers_centile,\n    iri.trop_premium_juice_drinks_centile,\n    iri.wine_centile,\n    iri.spirits_liquor_centile,\n    iri.premade_cocktails_coolers_centile,\n    iri.domestic_beer_centile,\n    iri.imported_beer_centile,\n    iri.flavored_malt_beverages_centile,\n    iri.ambient_juice_centile,\n    iri.new_rtd_tea_buyers_buying_lipton_centile,\n    iri.rtd_tea_buyers_switching_to_lipton_centile,\n    iri.sabritas_centile,\n    iri.cbd_product_purchasers_centile,\n    iri.dr_pepper_centile,\n    iri.coffee_beans_centile,\n    iri.hispanic_aisle_centile,\n    iri.functional_juice_kombucha_switchers_centile,\n    iri.dole_centile,\n    iri.twister_centile,\n    iri.quaker_grits_new_buyers_centile,\n    iri.macro_category_multi_pack_buyers_centile,\n    iri.frutly_centile,\n    iri.flavored_enhanced_water_centile,\n    iri.shelf_stable_juice_drinks_centile,\n    iri.fb_dollars_hh,\n    iri.fb_units_hh,\n    iri.fb_trips_hh,\n    iri.fb_dollar_index\nFROM {{ ref('exp_geo_is_cg_fvh') }} expgeoiscgfvh\nLEFT OUTER JOIN  {{ ref('iri_all') }} iri ON (expgeoiscgfvh.cv_living_unit_id = iri.luid)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "iri", "exp_geo_is_cg_fvh_iri"], "unique_id": "model.sdna_project.exp_geo_is_cg_fvh_iri", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/iri/exp_geo_is_cg_fvh_iri.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/iri/exp_geo_is_cg_fvh_iri.sql", "name": "exp_geo_is_cg_fvh_iri", "resource_type": "model", "alias": "exp_geo_is_cg_fvh_iri", "checksum": {"name": "sha256", "checksum": "6de51780d8da2017d6a369b6043a21865af9d6c3f3343bfcabb627953a4522ca"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is_cg_fvh"], ["iri_all"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is_cg_fvh", "model.sdna_project.iri_all"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.iri_all": {"raw_sql": "SELECT\n    cv_living_unit_id AS luid,\n    COALESCE(smart_water, 0) AS smart_water,\n    COALESCE(smart_water_decile, 0) AS smart_water_decile,\n    COALESCE(energy_csd_zero_calorie, 0) AS energy_csd_zero_calorie,\n    COALESCE(energy_csd_zero_calorie_decile, 0) AS energy_csd_zero_calorie_decile,\n    COALESCE(csd_total, 0) AS csd_total,\n    COALESCE(csd_total_decile, 0) AS csd_total_decile,\n    COALESCE(doritos, 0) AS doritos,\n    COALESCE(doritos_decile, 0) AS doritos_decile,\n    COALESCE(energy_drinks, 0) AS energy_drinks,\n    COALESCE(energy_drinks_decile, 0) AS energy_drinks_decile,\n    COALESCE(gatorade, 0) AS gatorade,\n    COALESCE(gatorade_decile, 0) AS gatorade_decile,\n    COALESCE(lays, 0) AS lays,\n    COALESCE(lays_decile, 0) AS lays_decile,\n    COALESCE(lipton_base, 0) AS lipton_base,\n    COALESCE(lipton_base_decile, 0) AS lipton_base_decile,\n    COALESCE(lipton_brisk, 0) AS lipton_brisk,\n    COALESCE(lipton_brisk_decile, 0) AS lipton_brisk_decile,\n    COALESCE(mt_dew, 0) AS mt_dew,\n    COALESCE(mt_dew_decile, 0) AS mt_dew_decile,\n    COALESCE(mtn_dew_kickstart, 0) AS mtn_dew_kickstart,\n    COALESCE(mtn_dew_kickstart_decile, 0) AS mtn_dew_kickstart_decile,\n    COALESCE(nuts, 0) AS nuts,\n    COALESCE(nuts_decile, 0) AS nuts_decile,\n    COALESCE(pepsi_diet, 0) AS pepsi_diet,\n    COALESCE(pepsi_diet_decile, 0) AS pepsi_diet_decile,\n    COALESCE(pepsi_regular, 0) AS pepsi_regular,\n    COALESCE(pepsi_regular_decile, 0) AS pepsi_regular_decile,\n    COALESCE(performance_bars, 0) AS performance_bars,\n    COALESCE(performance_bars_decile, 0) AS performance_bars_decile,\n    COALESCE(pepsico_protein_powder, 0) AS pepsico_protein_powder,\n    COALESCE(pepsico_protein_powder_decile, 0) AS pepsico_protein_powder_decile,\n    COALESCE(propel, 0) AS propel,\n    COALESCE(propel_decile, 0) AS propel_decile,\n    COALESCE(quaker_oatmeal, 0) AS quaker_oatmeal,\n    COALESCE(quaker_oatmeal_decile, 0) AS quaker_oatmeal_decile,\n    COALESCE(rte_cereal, 0) AS rte_cereal,\n    COALESCE(rte_cereal_decile, 0) AS rte_cereal_decile,\n    COALESCE(ruffles, 0) AS ruffles,\n    COALESCE(ruffles_decile, 0) AS ruffles_decile,\n    COALESCE(bottled_water, 0) AS bottled_water,\n    COALESCE(bottled_water_decile, 0) AS bottled_water_decile,\n    COALESCE(starbucks_tripleshot, 0) AS starbucks_tripleshot,\n    COALESCE(starbucks_tripleshot_decile, 0) AS starbucks_tripleshot_decile,\n    COALESCE(funyuns, 0) AS funyuns,\n    COALESCE(funyuns_decile, 0) AS funyuns_decile,\n    COALESCE(chilled_tea, 0) AS chilled_tea,\n    COALESCE(chilled_tea_decile, 0) AS chilled_tea_decile,\n    COALESCE(coffee_rtd, 0) AS coffee_rtd,\n    COALESCE(coffee_rtd_decile, 0) AS coffee_rtd_decile,\n    COALESCE(online_delivery, 0) AS online_delivery,\n    COALESCE(online_delivery_decile, 0) AS online_delivery_decile,\n    COALESCE(csd_singles, 0) AS csd_singles,\n    COALESCE(csd_singles_decile, 0) AS csd_singles_decile,\n    COALESCE(flv_csd_ex_dew_pepper, 0) AS flv_csd_ex_dew_pepper,\n    COALESCE(flv_csd_ex_dew_pepper_decile, 0) AS flv_csd_ex_dew_pepper_decile,\n    COALESCE(rtd_protein, 0) AS rtd_protein,\n    COALESCE(rtd_protein_decile, 0) AS rtd_protein_decile,\n    COALESCE(sodastream, 0) AS sodastream,\n    COALESCE(sodastream_decile, 0) AS sodastream_decile,\n    COALESCE(gamefuel, 0) AS gamefuel,\n    COALESCE(gamefuel_decile, 0) AS gamefuel_decile,\n    COALESCE(mainstream_kettle_chips, 0) AS mainstream_kettle_chips,\n    COALESCE(mainstream_kettle_chips_decile, 0) AS mainstream_kettle_chips_decile,\n    COALESCE(lipton_pure_leaf, 0) AS lipton_pure_leaf,\n    COALESCE(lipton_pure_leaf_decile, 0) AS lipton_pure_leaf_decile,\n    COALESCE(mainstream_juices, 0) AS mainstream_juices,\n    COALESCE(mainstream_juices_decile, 0) AS mainstream_juices_decile,\n    COALESCE(mt_dew_flv_seek, 0) AS mt_dew_flv_seek,\n    COALESCE(mt_dew_flv_seek_decile, 0) AS mt_dew_flv_seek_decile,\n    COALESCE(instant_quaker_oats, 0) AS instant_quaker_oats,\n    COALESCE(instant_quaker_oats_decile, 0) AS instant_quaker_oats_decile,\n    COALESCE(naked_protein, 0) AS naked_protein,\n    COALESCE(naked_protein_decile, 0) AS naked_protein_decile,\n    COALESCE(pepsi_zero_coke_zero, 0) AS pepsi_zero_coke_zero,\n    COALESCE(pepsi_zero_coke_zero_decile, 0) AS pepsi_zero_coke_zero_decile,\n    COALESCE(prem_juice_drinks, 0) AS prem_juice_drinks,\n    COALESCE(prem_juice_drinks_decile, 0) AS prem_juice_drinks_decile,\n    COALESCE(lightly_flavored_tortilla_chips, 0) AS lightly_flavored_tortilla_chips,\n    COALESCE(lightly_flavored_tortilla_chips_decile, 0) AS lightly_flavored_tortilla_chips_decile,\n    COALESCE(doubleshot_javam, 0) AS doubleshot_javam,\n    COALESCE(doubleshot_javam_decile, 0) AS doubleshot_javam_decile,\n    COALESCE(food_bev, 0) AS food_bev,\n    COALESCE(food_bev_decile, 0) AS food_bev_decile,\n    COALESCE(ncb_innovation, 0) AS ncb_innovation,\n    COALESCE(ncb_innovation_decile, 0) AS ncb_innovation_decile,\n    COALESCE(premium_csd, 0) AS premium_csd,\n    COALESCE(premium_csd_decile, 0) AS premium_csd_decile,\n    COALESCE(premium_tea, 0) AS premium_tea,\n    COALESCE(premium_tea_decile, 0) AS premium_tea_decile,\n    COALESCE(premium_water, 0) AS premium_water,\n    COALESCE(premium_water_decile, 0) AS premium_water_decile,\n    COALESCE(probiotic_juices, 0) AS probiotic_juices,\n    COALESCE(probiotic_juices_decile, 0) AS probiotic_juices_decile,\n    COALESCE(lays_poppables, 0) AS lays_poppables,\n    COALESCE(lays_poppables_decile, 0) AS lays_poppables_decile,\n    COALESCE(alternative_tortilla_chips, 0) AS alternative_tortilla_chips,\n    COALESCE(alternative_tortilla_chips_decile, 0) AS alternative_tortilla_chips_decile,\n    COALESCE(snack_bars, 0) AS snack_bars,\n    COALESCE(snack_bars_decile, 0) AS snack_bars_decile,\n    COALESCE(sparkling_water, 0) AS sparkling_water,\n    COALESCE(sparkling_water_decile, 0) AS sparkling_water_decile,\n    COALESCE(dips_as_meal_enhancers, 0) AS dips_as_meal_enhancers,\n    COALESCE(dips_as_meal_enhancers_decile, 0) AS dips_as_meal_enhancers_decile,\n    COALESCE(stacys, 0) AS stacys,\n    COALESCE(stacys_decile, 0) AS stacys_decile,\n    COALESCE(sunchips, 0) AS sunchips,\n    COALESCE(sunchips_decile, 0) AS sunchips_decile,\n    COALESCE(super_premium_juices, 0) AS super_premium_juices,\n    COALESCE(super_premium_juices_decile, 0) AS super_premium_juices_decile,\n    COALESCE(tostitos, 0) AS tostitos,\n    COALESCE(tostitos_decile, 0) AS tostitos_decile,\n    COALESCE(flavor_camp_bbq, 0) AS flavor_camp_bbq,\n    COALESCE(flavor_camp_bbq_decile, 0) AS flavor_camp_bbq_decile,\n    COALESCE(plant_based_rtd_protein, 0) AS plant_based_rtd_protein,\n    COALESCE(plant_based_rtd_protein_decile, 0) AS plant_based_rtd_protein_decile,\n    COALESCE(veggie_chips, 0) AS veggie_chips,\n    COALESCE(veggie_chips_decile, 0) AS veggie_chips_decile,\n    COALESCE(g_organic, 0) AS g_organic,\n    COALESCE(g_organic_decile, 0) AS g_organic_decile,\n    COALESCE(mountain_dew_baja_blast, 0) AS mountain_dew_baja_blast,\n    COALESCE(mountain_dew_baja_blast_decile, 0) AS mountain_dew_baja_blast_decile,\n    COALESCE(cold_brew, 0) AS cold_brew,\n    COALESCE(cold_brew_decile, 0) AS cold_brew_decile,\n    COALESCE(bubly, 0) AS bubly,\n    COALESCE(bubly_decile, 0) AS bubly_decile,\n    COALESCE(ultra_premium_juice, 0) AS ultra_premium_juice,\n    COALESCE(ultra_premium_juice_decile, 0) AS ultra_premium_juice_decile,\n    COALESCE(lightly_salted_chips, 0) AS lightly_salted_chips,\n    COALESCE(lightly_salted_chips_decile, 0) AS lightly_salted_chips_decile,\n    COALESCE(flavor_camp_cheese, 0) AS flavor_camp_cheese,\n    COALESCE(flavor_camp_cheese_decile, 0) AS flavor_camp_cheese_decile,\n    COALESCE(sabra_hummus_tubs, 0) AS sabra_hummus_tubs,\n    COALESCE(sabra_hummus_tubs_decile, 0) AS sabra_hummus_tubs_decile,\n    COALESCE(oj_category_switchers, 0) AS oj_category_switchers,\n    COALESCE(oj_category_switchers_decile, 0) AS oj_category_switchers_decile,\n    COALESCE(standard_quaker_oats, 0) AS standard_quaker_oats,\n    COALESCE(standard_quaker_oats_decile, 0) AS standard_quaker_oats_decile,\n    COALESCE(csd_multiserve, 0) AS csd_multiserve,\n    COALESCE(csd_multiserve_decile, 0) AS csd_multiserve_decile,\n    COALESCE(dew_ice, 0) AS dew_ice,\n    COALESCE(dew_ice_decile, 0) AS dew_ice_decile,\n    COALESCE(flavor_camp_dairy, 0) AS flavor_camp_dairy,\n    COALESCE(flavor_camp_dairy_decile, 0) AS flavor_camp_dairy_decile,\n    COALESCE(online_curbside_pickup, 0) AS online_curbside_pickup,\n    COALESCE(online_curbside_pickup_decile, 0) AS online_curbside_pickup_decile,\n    COALESCE(flavor_camp_herb_spice_veggie, 0) AS flavor_camp_herb_spice_veggie,\n    COALESCE(flavor_camp_herb_spice_veggie_decile, 0) AS flavor_camp_herb_spice_veggie_decile,\n    COALESCE(flv_salty_snacks, 0) AS flv_salty_snacks,\n    COALESCE(flv_salty_snacks_decile, 0) AS flv_salty_snacks_decile,\n    COALESCE(g2, 0) AS g2,\n    COALESCE(g2_decile, 0) AS g2_decile,\n    COALESCE(flavor_camp_salted_plain, 0) AS flavor_camp_salted_plain,\n    COALESCE(flavor_camp_salted_plain_decile, 0) AS flavor_camp_salted_plain_decile,\n    COALESCE(keto_cookies, 0) AS keto_cookies,\n    COALESCE(keto_cookies_decile, 0) AS keto_cookies_decile,\n    COALESCE(low_fat_salty_snacks, 0) AS low_fat_salty_snacks,\n    COALESCE(low_fat_salty_snacks_decile, 0) AS low_fat_salty_snacks_decile,\n    COALESCE(aha, 0) AS aha,\n    COALESCE(aha_decile, 0) AS aha_decile,\n    COALESCE(plant_based_protein_powder, 0) AS plant_based_protein_powder,\n    COALESCE(plant_based_protein_powder_decile, 0) AS plant_based_protein_powder_decile,\n    COALESCE(pretzel_category, 0) AS pretzel_category,\n    COALESCE(pretzel_category_decile, 0) AS pretzel_category_decile,\n    COALESCE(flavor_camp_spicy_burn, 0) AS flavor_camp_spicy_burn,\n    COALESCE(flavor_camp_spicy_burn_decile, 0) AS flavor_camp_spicy_burn_decile,\n    COALESCE(dots_pretzels, 0) AS dots_pretzels,\n    COALESCE(dots_pretzels_decile, 0) AS dots_pretzels_decile,\n    COALESCE(santitas, 0) AS santitas,\n    COALESCE(santitas_decile, 0) AS santitas_decile,\n    COALESCE(flavor_camp_tangy, 0) AS flavor_camp_tangy,\n    COALESCE(flavor_camp_tangy_decile, 0) AS flavor_camp_tangy_decile,\n    COALESCE(tropicana_probiotics_purchasers, 0) AS tropicana_probiotics_purchasers,\n    COALESCE(tropicana_probiotics_purchasers_decile, 0) AS tropicana_probiotics_purchasers_decile,\n    COALESCE(tropicana_pure_premium_purchasers, 0) AS tropicana_pure_premium_purchasers,\n    COALESCE(tropicana_pure_premium_purchasers_decile, 0) AS tropicana_pure_premium_purchasers_decile,\n    COALESCE(rfg_yogurt_drinks, 0) AS rfg_yogurt_drinks,\n    COALESCE(rfg_yogurt_drinks_decile, 0) AS rfg_yogurt_drinks_decile,\n    COALESCE(flavor_camp_aggregate_all_intense_bold, 0) AS flavor_camp_aggregate_all_intense_bold,\n    COALESCE(flavor_camp_aggregate_all_intense_bold_decile, 0) AS flavor_camp_aggregate_all_intense_bold_decile,\n    COALESCE(total_regular_cola, 0) AS total_regular_cola,\n    COALESCE(total_regular_cola_decile, 0) AS total_regular_cola_decile,\n    COALESCE(flavor_camp_meat, 0) AS flavor_camp_meat,\n    COALESCE(flavor_camp_meat_decile, 0) AS flavor_camp_meat_decile,\n    COALESCE(fritos_original, 0) AS fritos_original,\n    COALESCE(fritos_original_decile, 0) AS fritos_original_decile,\n    COALESCE(flavored_pretzels, 0) AS flavored_pretzels,\n    COALESCE(flavored_pretzels_decile, 0) AS flavored_pretzels_decile,\n    COALESCE(nutrition_engaged, 0) AS nutrition_engaged,\n    COALESCE(nutrition_engaged_decile, 0) AS nutrition_engaged_decile,\n    COALESCE(mainstream_engaged, 0) AS mainstream_engaged,\n    COALESCE(mainstream_engaged_decile, 0) AS mainstream_engaged_decile,\n    COALESCE(oj_category, 0) AS oj_category,\n    COALESCE(oj_category_decile, 0) AS oj_category_decile,\n    COALESCE(nutrition_bars, 0) AS nutrition_bars,\n    COALESCE(nutrition_bars_decile, 0) AS nutrition_bars_decile,\n    COALESCE(oatmeal_category, 0) AS oatmeal_category,\n    COALESCE(oatmeal_category_decile, 0) AS oatmeal_category_decile,\n    COALESCE(alt_dairy_category, 0) AS alt_dairy_category,\n    COALESCE(alt_dairy_category_decile, 0) AS alt_dairy_category_decile,\n    COALESCE(kombucha_functional_juices, 0) AS kombucha_functional_juices,\n    COALESCE(kombucha_functional_juices_decile, 0) AS kombucha_functional_juices_decile,\n    COALESCE(single_serve_mainstream_juice, 0) AS single_serve_mainstream_juice,\n    COALESCE(single_serve_mainstream_juice_decile, 0) AS single_serve_mainstream_juice_decile,\n    COALESCE(quaker_grits, 0) AS quaker_grits,\n    COALESCE(quaker_grits_decile, 0) AS quaker_grits_decile,\n    COALESCE(shelf_stable_dips_category, 0) AS shelf_stable_dips_category,\n    COALESCE(shelf_stable_dips_category_decile, 0) AS shelf_stable_dips_category_decile,\n    COALESCE(fruit_snacks, 0) AS fruit_snacks,\n    COALESCE(fruit_snacks_decile, 0) AS fruit_snacks_decile,\n    COALESCE(fritos_flavor, 0) AS fritos_flavor,\n    COALESCE(fritos_flavor_decile, 0) AS fritos_flavor_decile,\n    COALESCE(kevita_purchasers, 0) AS kevita_purchasers,\n    COALESCE(kevita_purchasers_decile, 0) AS kevita_purchasers_decile,\n    COALESCE(heart_claim, 0) AS heart_claim,\n    COALESCE(heart_claim_decile, 0) AS heart_claim_decile,\n    COALESCE(starbucks_frappuccino, 0) AS starbucks_frappuccino,\n    COALESCE(starbucks_frappuccino_decile, 0) AS starbucks_frappuccino_decile,\n    COALESCE(single_serve_salty_snacks, 0) AS single_serve_salty_snacks,\n    COALESCE(single_serve_salty_snacks_decile, 0) AS single_serve_salty_snacks_decile,\n    COALESCE(cholesterol_claim, 0) AS cholesterol_claim,\n    COALESCE(cholesterol_claim_decile, 0) AS cholesterol_claim_decile,\n    COALESCE(g_zero, 0) AS g_zero,\n    COALESCE(g_zero_decile, 0) AS g_zero_decile,\n    COALESCE(diet_csds, 0) AS diet_csds,\n    COALESCE(diet_csds_decile, 0) AS diet_csds_decile,\n    COALESCE(candy_category, 0) AS candy_category,\n    COALESCE(candy_category_decile, 0) AS candy_category_decile,\n    COALESCE(frozen_fruit_category, 0) AS frozen_fruit_category,\n    COALESCE(frozen_fruit_category_decile, 0) AS frozen_fruit_category_decile,\n    COALESCE(salty_snacks, 0) AS salty_snacks,\n    COALESCE(salty_snacks_decile, 0) AS salty_snacks_decile,\n    COALESCE(premium_greek_yogurt, 0) AS premium_greek_yogurt,\n    COALESCE(premium_greek_yogurt_decile, 0) AS premium_greek_yogurt_decile,\n    COALESCE(rice_pasta_ethnic_spclty, 0) AS rice_pasta_ethnic_spclty,\n    COALESCE(rice_pasta_ethnic_spclty_decile, 0) AS rice_pasta_ethnic_spclty_decile,\n    COALESCE(pancake_mix_syrup, 0) AS pancake_mix_syrup,\n    COALESCE(pancake_mix_syrup_decile, 0) AS pancake_mix_syrup_decile,\n    COALESCE(lite_snacks, 0) AS lite_snacks,\n    COALESCE(lite_snacks_decile, 0) AS lite_snacks_decile,\n    COALESCE(herbal_tea, 0) AS herbal_tea,\n    COALESCE(herbal_tea_decile, 0) AS herbal_tea_decile,\n    COALESCE(tazo, 0) AS tazo,\n    COALESCE(tazo_decile, 0) AS tazo_decile,\n    COALESCE(mini_cans, 0) AS mini_cans,\n    COALESCE(mini_cans_decile, 0) AS mini_cans_decile,\n    COALESCE(unflavored_pretzels, 0) AS unflavored_pretzels,\n    COALESCE(unflavored_pretzels_decile, 0) AS unflavored_pretzels_decile,\n    COALESCE(bodyarmor, 0) AS bodyarmor,\n    COALESCE(bodyarmor_decile, 0) AS bodyarmor_decile,\n    COALESCE(organic_food_bev_buyers, 0) AS organic_food_bev_buyers,\n    COALESCE(organic_food_bev_buyers_decile, 0) AS organic_food_bev_buyers_decile,\n    COALESCE(fritos_scoops, 0) AS fritos_scoops,\n    COALESCE(fritos_scoops_decile, 0) AS fritos_scoops_decile,\n    COALESCE(grain_claim, 0) AS grain_claim,\n    COALESCE(grain_claim_decile, 0) AS grain_claim_decile,\n    COALESCE(diet_coke, 0) AS diet_coke,\n    COALESCE(diet_coke_decile, 0) AS diet_coke_decile,\n    COALESCE(online_in_store_pickup, 0) AS online_in_store_pickup,\n    COALESCE(online_in_store_pickup_decile, 0) AS online_in_store_pickup_decile,\n    COALESCE(bare, 0) AS bare,\n    COALESCE(bare_decile, 0) AS bare_decile,\n    COALESCE(off_the_eaten_path, 0) AS off_the_eaten_path,\n    COALESCE(off_the_eaten_path_decile, 0) AS off_the_eaten_path_decile,\n    COALESCE(rte_cereal_all_family, 0) AS rte_cereal_all_family,\n    COALESCE(rte_cereal_all_family_decile, 0) AS rte_cereal_all_family_decile,\n    COALESCE(rte_cereal_kids, 0) AS rte_cereal_kids,\n    COALESCE(rte_cereal_kids_decile, 0) AS rte_cereal_kids_decile,\n    COALESCE(instant_quaker_oats_light_lapsed, 0) AS instant_quaker_oats_light_lapsed,\n    COALESCE(instant_quaker_oats_light_lapsed_decile, 0) AS instant_quaker_oats_light_lapsed_decile,\n    COALESCE(celsius_energy, 0) AS celsius_energy,\n    COALESCE(celsius_energy_decile, 0) AS celsius_energy_decile,\n    COALESCE(doritos_h_and_s, 0) AS doritos_h_and_s,\n    COALESCE(doritos_h_and_s_decile, 0) AS doritos_h_and_s_decile,\n    COALESCE(premium_kettle_chips, 0) AS premium_kettle_chips,\n    COALESCE(premium_kettle_chips_decile, 0) AS premium_kettle_chips_decile,\n    COALESCE(chewy_kids_snacking, 0) AS chewy_kids_snacking,\n    COALESCE(chewy_kids_snacking_decile, 0) AS chewy_kids_snacking_decile,\n    COALESCE(starbucks_nitro, 0) AS starbucks_nitro,\n    COALESCE(starbucks_nitro_decile, 0) AS starbucks_nitro_decile,\n    COALESCE(premium_lrb, 0) AS premium_lrb,\n    COALESCE(premium_lrb_decile, 0) AS premium_lrb_decile,\n    COALESCE(rte_popcorn_full_flavor, 0) AS rte_popcorn_full_flavor,\n    COALESCE(rte_popcorn_full_flavor_decile, 0) AS rte_popcorn_full_flavor_decile,\n    COALESCE(rte_popcorn_light_flavor, 0) AS rte_popcorn_light_flavor,\n    COALESCE(rte_popcorn_light_flavor_decile, 0) AS rte_popcorn_light_flavor_decile,\n    COALESCE(breakfast_cereal_snack_bars, 0) AS breakfast_cereal_snack_bars,\n    COALESCE(breakfast_cereal_snack_bars_decile, 0) AS breakfast_cereal_snack_bars_decile,\n    COALESCE(sports_drinks, 0) AS sports_drinks,\n    COALESCE(sports_drinks_decile, 0) AS sports_drinks_decile,\n    COALESCE(takis, 0) AS takis,\n    COALESCE(takis_decile, 0) AS takis_decile,\n    COALESCE(lacroix, 0) AS lacroix,\n    COALESCE(lacroix_decile, 0) AS lacroix_decile,\n    COALESCE(manzanita_sol, 0) AS manzanita_sol,\n    COALESCE(manzanita_sol_decile, 0) AS manzanita_sol_decile,\n    COALESCE(unflavored_tortilla_chips, 0) AS unflavored_tortilla_chips,\n    COALESCE(unflavored_tortilla_chips_decile, 0) AS unflavored_tortilla_chips_decile,\n    COALESCE(crush, 0) AS crush,\n    COALESCE(crush_decile, 0) AS crush_decile,\n    COALESCE(chewy, 0) AS chewy,\n    COALESCE(chewy_decile, 0) AS chewy_decile,\n    COALESCE(rockstar_energy, 0) AS rockstar_energy,\n    COALESCE(rockstar_energy_decile, 0) AS rockstar_energy_decile,\n    COALESCE(light_holiday_salty_snack_buyers, 0) AS light_holiday_salty_snack_buyers,\n    COALESCE(light_holiday_salty_snack_buyers_decile, 0) AS light_holiday_salty_snack_buyers_decile,\n    COALESCE(medium_holiday_salty_snack_buyers, 0) AS medium_holiday_salty_snack_buyers,\n    COALESCE(medium_holiday_salty_snack_buyers_decile, 0) AS medium_holiday_salty_snack_buyers_decile,\n    COALESCE(xxvl_single_serve_snacks, 0) AS xxvl_single_serve_snacks,\n    COALESCE(xxvl_single_serve_snacks_decile, 0) AS xxvl_single_serve_snacks_decile,\n    COALESCE(svlr_single_serve_snacks, 0) AS svlr_single_serve_snacks,\n    COALESCE(svlr_single_serve_snacks_decile, 0) AS svlr_single_serve_snacks_decile,\n    COALESCE(lss_single_serve_snacks, 0) AS lss_single_serve_snacks,\n    COALESCE(lss_single_serve_snacks_decile, 0) AS lss_single_serve_snacks_decile,\n    COALESCE(bolt_24, 0) AS bolt_24,\n    COALESCE(bolt_24_decile, 0) AS bolt_24_decile,\n    COALESCE(lemonade, 0) AS lemonade,\n    COALESCE(lemonade_decile, 0) AS lemonade_decile,\n    COALESCE(gamesa_cookies, 0) AS gamesa_cookies,\n    COALESCE(gamesa_cookies_decile, 0) AS gamesa_cookies_decile,\n    COALESCE(kids_organic, 0) AS kids_organic,\n    COALESCE(kids_organic_decile, 0) AS kids_organic_decile,\n    COALESCE(rice_crisps_cakes, 0) AS rice_crisps_cakes,\n    COALESCE(rice_crisps_cakes_decile, 0) AS rice_crisps_cakes_decile,\n    COALESCE(health_warrior, 0) AS health_warrior,\n    COALESCE(health_warrior_decile, 0) AS health_warrior_decile,\n    COALESCE(simple_nutrition, 0) AS simple_nutrition,\n    COALESCE(simple_nutrition_decile, 0) AS simple_nutrition_decile,\n    COALESCE(naked, 0) AS naked,\n    COALESCE(naked_decile, 0) AS naked_decile,\n    COALESCE(yogurt, 0) AS yogurt,\n    COALESCE(yogurt_decile, 0) AS yogurt_decile,\n    COALESCE(online_edible, 0) AS online_edible,\n    COALESCE(online_edible_decile, 0) AS online_edible_decile,\n    COALESCE(better_for_you_bagged_snacks, 0) AS better_for_you_bagged_snacks,\n    COALESCE(better_for_you_bagged_snacks_decile, 0) AS better_for_you_bagged_snacks_decile,\n    COALESCE(vanilla_flavored_rtd_coffee, 0) AS vanilla_flavored_rtd_coffee,\n    COALESCE(vanilla_flavored_rtd_coffee_decile, 0) AS vanilla_flavored_rtd_coffee_decile,\n    COALESCE(frozen_dips, 0) AS frozen_dips,\n    COALESCE(frozen_dips_decile, 0) AS frozen_dips_decile,\n    COALESCE(caramel_flavored_rtd_coffee, 0) AS caramel_flavored_rtd_coffee,\n    COALESCE(caramel_flavored_rtd_coffee_decile, 0) AS caramel_flavored_rtd_coffee_decile,\n    COALESCE(coffee_flavored_rtd_coffee, 0) AS coffee_flavored_rtd_coffee,\n    COALESCE(coffee_flavored_rtd_coffee_decile, 0) AS coffee_flavored_rtd_coffee_decile,\n    COALESCE(lays_stax, 0) AS lays_stax,\n    COALESCE(lays_stax_decile, 0) AS lays_stax_decile,\n    COALESCE(popcorners, 0) AS popcorners,\n    COALESCE(popcorners_decile, 0) AS popcorners_decile,\n    COALESCE(shelf_stable_dairy_dips, 0) AS shelf_stable_dairy_dips,\n    COALESCE(shelf_stable_dairy_dips_decile, 0) AS shelf_stable_dairy_dips_decile,\n    COALESCE(probiotic_attribute, 0) AS probiotic_attribute,\n    COALESCE(probiotic_attribute_decile, 0) AS probiotic_attribute_decile,\n    COALESCE(essentia, 0) AS essentia,\n    COALESCE(essentia_decile, 0) AS essentia_decile,\n    COALESCE(core, 0) AS core,\n    COALESCE(core_decile, 0) AS core_decile,\n    COALESCE(dasani, 0) AS dasani,\n    COALESCE(dasani_decile, 0) AS dasani_decile,\n    COALESCE(shelf_stable_salsa, 0) AS shelf_stable_salsa,\n    COALESCE(shelf_stable_salsa_decile, 0) AS shelf_stable_salsa_decile,\n    COALESCE(shelf_stable_cheese_dips, 0) AS shelf_stable_cheese_dips,\n    COALESCE(shelf_stable_cheese_dips_decile, 0) AS shelf_stable_cheese_dips_decile,\n    COALESCE(shelf_stable_bean_dips, 0) AS shelf_stable_bean_dips,\n    COALESCE(shelf_stable_bean_dips_decile, 0) AS shelf_stable_bean_dips_decile,\n    COALESCE(cheetos_cheese_core, 0) AS cheetos_cheese_core,\n    COALESCE(cheetos_cheese_core_decile, 0) AS cheetos_cheese_core_decile,\n    COALESCE(frito_lay_multipack, 0) AS frito_lay_multipack,\n    COALESCE(frito_lay_multipack_decile, 0) AS frito_lay_multipack_decile,\n    COALESCE(cheetos_flamin_hot_core, 0) AS cheetos_flamin_hot_core,\n    COALESCE(cheetos_flamin_hot_core_decile, 0) AS cheetos_flamin_hot_core_decile,\n    COALESCE(muscle_milk, 0) AS muscle_milk,\n    COALESCE(muscle_milk_decile, 0) AS muscle_milk_decile,\n    COALESCE(kst_regular_coke_transitioner, 0) AS kst_regular_coke_transitioner,\n    COALESCE(kst_regular_coke_transitioner_decile, 0) AS kst_regular_coke_transitioner_decile,\n    COALESCE(kst_frequent_diet_pepsi_transitioner, 0) AS kst_frequent_diet_pepsi_transitioner,\n    COALESCE(kst_frequent_diet_pepsi_transitioner_decile, 0) AS kst_frequent_diet_pepsi_transitioner_decile,\n    COALESCE(kst_hispanic_pepsi_drinker, 0) AS kst_hispanic_pepsi_drinker,\n    COALESCE(kst_hispanic_pepsi_drinker_decile, 0) AS kst_hispanic_pepsi_drinker_decile,\n    COALESCE(kst_light_cola_drinker, 0) AS kst_light_cola_drinker,\n    COALESCE(kst_light_cola_drinker_decile, 0) AS kst_light_cola_drinker_decile,\n    COALESCE(kst_frequent_blue_pepsi_drinker, 0) AS kst_frequent_blue_pepsi_drinker,\n    COALESCE(kst_frequent_blue_pepsi_drinker_decile, 0) AS kst_frequent_blue_pepsi_drinker_decile,\n    COALESCE(kst_non_cola_drinkers, 0) AS kst_non_cola_drinkers,\n    COALESCE(kst_non_cola_drinkers_decile, 0) AS kst_non_cola_drinkers_decile,\n    COALESCE(macaroni_and_cheese, 0) AS macaroni_and_cheese,\n    COALESCE(macaroni_and_cheese_decile, 0) AS macaroni_and_cheese_decile,\n    COALESCE(heat_and_eat, 0) AS heat_and_eat,\n    COALESCE(heat_and_eat_decile, 0) AS heat_and_eat_decile,\n    COALESCE(instant_rice_pasta_grains, 0) AS instant_rice_pasta_grains,\n    COALESCE(instant_rice_pasta_grains_decile, 0) AS instant_rice_pasta_grains_decile,\n    COALESCE(better_for_you_crackers, 0) AS better_for_you_crackers,\n    COALESCE(better_for_you_crackers_decile, 0) AS better_for_you_crackers_decile,\n    COALESCE(zero_calorie_csd, 0) AS zero_calorie_csd,\n    COALESCE(zero_calorie_csd_decile, 0) AS zero_calorie_csd_decile,\n    COALESCE(wavy_lays, 0) AS wavy_lays,\n    COALESCE(wavy_lays_decile, 0) AS wavy_lays_decile,\n    COALESCE(multiserve_starbucks, 0) AS multiserve_starbucks,\n    COALESCE(multiserve_starbucks_decile, 0) AS multiserve_starbucks_decile,\n    COALESCE(tea_bags, 0) AS tea_bags,\n    COALESCE(tea_bags_decile, 0) AS tea_bags_decile,\n    COALESCE(rfg_dips, 0) AS rfg_dips,\n    COALESCE(rfg_dips_decile, 0) AS rfg_dips_decile,\n    COALESCE(sleeping_remedies, 0) AS sleeping_remedies,\n    COALESCE(sleeping_remedies_decile, 0) AS sleeping_remedies_decile,\n    COALESCE(adaptogens, 0) AS adaptogens,\n    COALESCE(adaptogens_decile, 0) AS adaptogens_decile,\n    COALESCE(easy_wellness, 0) AS easy_wellness,\n    COALESCE(easy_wellness_decile, 0) AS easy_wellness_decile,\n    COALESCE(bang, 0) AS bang,\n    COALESCE(bang_decile, 0) AS bang_decile,\n    COALESCE(kevita_adjacencies, 0) AS kevita_adjacencies,\n    COALESCE(kevita_adjacencies_decile, 0) AS kevita_adjacencies_decile,\n    COALESCE(caffeine_attribute, 0) AS caffeine_attribute,\n    COALESCE(caffeine_attribute_decile, 0) AS caffeine_attribute_decile,\n    COALESCE(vitamin_c_attribute, 0) AS vitamin_c_attribute,\n    COALESCE(vitamin_c_attribute_decile, 0) AS vitamin_c_attribute_decile,\n    COALESCE(antioxidant_attribute, 0) AS antioxidant_attribute,\n    COALESCE(antioxidant_attribute_decile, 0) AS antioxidant_attribute_decile,\n    COALESCE(poland_spring, 0) AS poland_spring,\n    COALESCE(poland_spring_decile, 0) AS poland_spring_decile,\n    COALESCE(polar, 0) AS polar,\n    COALESCE(polar_decile, 0) AS polar_decile,\n    COALESCE(diet_coke_decliners, 0) AS diet_coke_decliners,\n    COALESCE(diet_coke_decliners_decile, 0) AS diet_coke_decliners_decile,\n    COALESCE(sprite_and_fanta_decliners, 0) AS sprite_and_fanta_decliners,\n    COALESCE(sprite_and_fanta_decliners_decile, 0) AS sprite_and_fanta_decliners_decile,\n    COALESCE(rap_snacks, 0) AS rap_snacks,\n    COALESCE(rap_snacks_decile, 0) AS rap_snacks_decile,\n    COALESCE(cheetos_crunchy, 0) AS cheetos_crunchy,\n    COALESCE(cheetos_crunchy_decile, 0) AS cheetos_crunchy_decile,\n    COALESCE(cheetos_puffs, 0) AS cheetos_puffs,\n    COALESCE(cheetos_puffs_decile, 0) AS cheetos_puffs_decile,\n    COALESCE(lays_classic, 0) AS lays_classic,\n    COALESCE(lays_classic_decile, 0) AS lays_classic_decile,\n    COALESCE(premium_cocktail_mixers, 0) AS premium_cocktail_mixers,\n    COALESCE(premium_cocktail_mixers_decile, 0) AS premium_cocktail_mixers_decile,\n    COALESCE(baken_ets, 0) AS baken_ets,\n    COALESCE(baken_ets_decile, 0) AS baken_ets_decile,\n    COALESCE(mainstream_mixers, 0) AS mainstream_mixers,\n    COALESCE(mainstream_mixers_decile, 0) AS mainstream_mixers_decile,\n    COALESCE(quaker_hots_light_lapsed, 0) AS quaker_hots_light_lapsed,\n    COALESCE(quaker_hots_light_lapsed_decile, 0) AS quaker_hots_light_lapsed_decile,\n    COALESCE(zone_in_shopper, 0) AS zone_in_shopper,\n    COALESCE(zone_in_shopper_decile, 0) AS zone_in_shopper_decile,\n    COALESCE(root_beer, 0) AS root_beer,\n    COALESCE(root_beer_decile, 0) AS root_beer_decile,\n    COALESCE(coke, 0) AS coke,\n    COALESCE(coke_decile, 0) AS coke_decile,\n    COALESCE(premium_cheese_snacks, 0) AS premium_cheese_snacks,\n    COALESCE(premium_cheese_snacks_decile, 0) AS premium_cheese_snacks_decile,\n    COALESCE(stacys_thins, 0) AS stacys_thins,\n    COALESCE(stacys_thins_decile, 0) AS stacys_thins_decile,\n    COALESCE(stacys_core, 0) AS stacys_core,\n    COALESCE(stacys_core_decile, 0) AS stacys_core_decile,\n    COALESCE(diet_mountain_dew, 0) AS diet_mountain_dew,\n    COALESCE(diet_mountain_dew_decile, 0) AS diet_mountain_dew_decile,\n    COALESCE(sparkling_ice, 0) AS sparkling_ice,\n    COALESCE(sparkling_ice_decile, 0) AS sparkling_ice_decile,\n    COALESCE(granola, 0) AS granola,\n    COALESCE(granola_decile, 0) AS granola_decile,\n    COALESCE(aj_pancake_mix_and_syrup, 0) AS aj_pancake_mix_and_syrup,\n    COALESCE(aj_pancake_mix_and_syrup_decile, 0) AS aj_pancake_mix_and_syrup_decile,\n    COALESCE(rte_cereal_adult, 0) AS rte_cereal_adult,\n    COALESCE(rte_cereal_adult_decile, 0) AS rte_cereal_adult_decile,\n    COALESCE(kids_ambient_juices, 0) AS kids_ambient_juices,\n    COALESCE(kids_ambient_juices_decile, 0) AS kids_ambient_juices_decile,\n    COALESCE(non_lemonade_juice_drinks, 0) AS non_lemonade_juice_drinks,\n    COALESCE(non_lemonade_juice_drinks_decile, 0) AS non_lemonade_juice_drinks_decile,\n    COALESCE(cheetos_mac_n_cheese, 0) AS cheetos_mac_n_cheese,\n    COALESCE(cheetos_mac_n_cheese_decile, 0) AS cheetos_mac_n_cheese_decile,\n    COALESCE(hispanic_cookies, 0) AS hispanic_cookies,\n    COALESCE(hispanic_cookies_decile, 0) AS hispanic_cookies_decile,\n    COALESCE(gamesa_crackers, 0) AS gamesa_crackers,\n    COALESCE(gamesa_crackers_decile, 0) AS gamesa_crackers_decile,\n    COALESCE(naked_juice_lapsed_buyers, 0) AS naked_juice_lapsed_buyers,\n    COALESCE(naked_juice_lapsed_buyers_decile, 0) AS naked_juice_lapsed_buyers_decile,\n    COALESCE(natural_attribute, 0) AS natural_attribute,\n    COALESCE(natural_attribute_decile, 0) AS natural_attribute_decile,\n    COALESCE(protein_attribute, 0) AS protein_attribute,\n    COALESCE(protein_attribute_decile, 0) AS protein_attribute_decile,\n    COALESCE(calcium_attribute, 0) AS calcium_attribute,\n    COALESCE(calcium_attribute_decile, 0) AS calcium_attribute_decile,\n    COALESCE(fiber, 0) AS fiber,\n    COALESCE(fiber_decile, 0) AS fiber_decile,\n    COALESCE(gluten_free, 0) AS gluten_free,\n    COALESCE(gluten_free_decile, 0) AS gluten_free_decile,\n    COALESCE(low_sodium, 0) AS low_sodium,\n    COALESCE(low_sodium_decile, 0) AS low_sodium_decile,\n    COALESCE(no_added_sugar, 0) AS no_added_sugar,\n    COALESCE(no_added_sugar_decile, 0) AS no_added_sugar_decile,\n    COALESCE(simply, 0) AS simply,\n    COALESCE(simply_decile, 0) AS simply_decile,\n    COALESCE(baked, 0) AS baked,\n    COALESCE(baked_decile, 0) AS baked_decile,\n    COALESCE(non_gmo, 0) AS non_gmo,\n    COALESCE(non_gmo_decile, 0) AS non_gmo_decile,\n    COALESCE(mt_dew_total, 0) AS mt_dew_total,\n    COALESCE(mt_dew_total_decile, 0) AS mt_dew_total_decile,\n    COALESCE(keto_dieters, 0) AS keto_dieters,\n    COALESCE(keto_dieters_decile, 0) AS keto_dieters_decile,\n    COALESCE(party_people, 0) AS party_people,\n    COALESCE(party_people_decile, 0) AS party_people_decile,\n    COALESCE(cold_and_flu_preppers, 0) AS cold_and_flu_preppers,\n    COALESCE(cold_and_flu_preppers_decile, 0) AS cold_and_flu_preppers_decile,\n    COALESCE(condiments_and_sauces, 0) AS condiments_and_sauces,\n    COALESCE(condiments_and_sauces_decile, 0) AS condiments_and_sauces_decile,\n    COALESCE(flavored_csds, 0) AS flavored_csds,\n    COALESCE(flavored_csds_decile, 0) AS flavored_csds_decile,\n    COALESCE(holiday_hosts, 0) AS holiday_hosts,\n    COALESCE(holiday_hosts_decile, 0) AS holiday_hosts_decile,\n    COALESCE(immunity_boosters, 0) AS immunity_boosters,\n    COALESCE(immunity_boosters_decile, 0) AS immunity_boosters_decile,\n    COALESCE(new_years_dieters, 0) AS new_years_dieters,\n    COALESCE(new_years_dieters_decile, 0) AS new_years_dieters_decile,\n    COALESCE(new_years_partiers, 0) AS new_years_partiers,\n    COALESCE(new_years_partiers_decile, 0) AS new_years_partiers_decile,\n    COALESCE(plant_based_buyers, 0) AS plant_based_buyers,\n    COALESCE(plant_based_buyers_decile, 0) AS plant_based_buyers_decile,\n    COALESCE(summer_grillers, 0) AS summer_grillers,\n    COALESCE(summer_grillers_decile, 0) AS summer_grillers_decile,\n    COALESCE(super_bowl_hosts, 0) AS super_bowl_hosts,\n    COALESCE(super_bowl_hosts_decile, 0) AS super_bowl_hosts_decile,\n    COALESCE(thanksgiving_hosts, 0) AS thanksgiving_hosts,\n    COALESCE(thanksgiving_hosts_decile, 0) AS thanksgiving_hosts_decile,\n    COALESCE(hard_coffee, 0) AS hard_coffee,\n    COALESCE(hard_coffee_decile, 0) AS hard_coffee_decile,\n    COALESCE(hard_flavored_bevs_xlemonade, 0) AS hard_flavored_bevs_xlemonade,\n    COALESCE(hard_flavored_bevs_xlemonade_decile, 0) AS hard_flavored_bevs_xlemonade_decile,\n    COALESCE(hard_kombucha, 0) AS hard_kombucha,\n    COALESCE(hard_kombucha_decile, 0) AS hard_kombucha_decile,\n    COALESCE(hard_lemonade, 0) AS hard_lemonade,\n    COALESCE(hard_lemonade_decile, 0) AS hard_lemonade_decile,\n    COALESCE(hard_seltzer, 0) AS hard_seltzer,\n    COALESCE(hard_seltzer_decile, 0) AS hard_seltzer_decile,\n    COALESCE(health_warrior_competitive_products, 0) AS health_warrior_competitive_products,\n    COALESCE(health_warrior_competitive_products_decile, 0) AS health_warrior_competitive_products_decile,\n    COALESCE(other_hmb, 0) AS other_hmb,\n    COALESCE(other_hmb_decile, 0) AS other_hmb_decile,\n    COALESCE(cookies, 0) AS cookies,\n    COALESCE(cookies_decile, 0) AS cookies_decile,\n    COALESCE(crackers, 0) AS crackers,\n    COALESCE(crackers_decile, 0) AS crackers_decile,\n    COALESCE(trop_premium_juice_drinks, 0) AS trop_premium_juice_drinks,\n    COALESCE(trop_premium_juice_drinks_decile, 0) AS trop_premium_juice_drinks_decile,\n    COALESCE(wine, 0) AS wine,\n    COALESCE(wine_decile, 0) AS wine_decile,\n    COALESCE(spirits_liquor, 0) AS spirits_liquor,\n    COALESCE(spirits_liquor_decile, 0) AS spirits_liquor_decile,\n    COALESCE(premade_cocktails_coolers, 0) AS premade_cocktails_coolers,\n    COALESCE(premade_cocktails_coolers_decile, 0) AS premade_cocktails_coolers_decile,\n    COALESCE(domestic_beer, 0) AS domestic_beer,\n    COALESCE(domestic_beer_decile, 0) AS domestic_beer_decile,\n    COALESCE(imported_beer, 0) AS imported_beer,\n    COALESCE(imported_beer_decile, 0) AS imported_beer_decile,\n    COALESCE(flavored_malt_beverages, 0) AS flavored_malt_beverages,\n    COALESCE(flavored_malt_beverages_decile, 0) AS flavored_malt_beverages_decile,\n    COALESCE(ambient_juice, 0) AS ambient_juice,\n    COALESCE(ambient_juice_decile, 0) AS ambient_juice_decile,\n    COALESCE(new_rtd_tea_buyers_buying_lipton, 0) AS new_rtd_tea_buyers_buying_lipton,\n    COALESCE(new_rtd_tea_buyers_buying_lipton_decile, 0) AS new_rtd_tea_buyers_buying_lipton_decile,\n    COALESCE(rtd_tea_buyers_switching_to_lipton, 0) AS rtd_tea_buyers_switching_to_lipton,\n    COALESCE(rtd_tea_buyers_switching_to_lipton_decile, 0) AS rtd_tea_buyers_switching_to_lipton_decile,\n    COALESCE(sabritas, 0) AS sabritas,\n    COALESCE(sabritas_decile, 0) AS sabritas_decile,\n    COALESCE(cbd_product_purchasers, 0) AS cbd_product_purchasers,\n    COALESCE(cbd_product_purchasers_decile, 0) AS cbd_product_purchasers_decile,\n    COALESCE(dr_pepper, 0) AS dr_pepper,\n    COALESCE(dr_pepper_decile, 0) AS dr_pepper_decile,\n    COALESCE(coffee_beans, 0) AS coffee_beans,\n    COALESCE(coffee_beans_decile, 0) AS coffee_beans_decile,\n    COALESCE(hispanic_aisle, 0) AS hispanic_aisle,\n    COALESCE(hispanic_aisle_decile, 0) AS hispanic_aisle_decile,\n    COALESCE(functional_juice_kombucha_switchers, 0) AS functional_juice_kombucha_switchers,\n    COALESCE(functional_juice_kombucha_switchers_decile, 0) AS functional_juice_kombucha_switchers_decile,\n    COALESCE(dole, 0) AS dole,\n    COALESCE(dole_decile, 0) AS dole_decile,\n    COALESCE(twister, 0) AS twister,\n    COALESCE(twister_decile, 0) AS twister_decile,\n    COALESCE(quaker_grits_new_buyers, 0) AS quaker_grits_new_buyers,\n    COALESCE(quaker_grits_new_buyers_decile, 0) AS quaker_grits_new_buyers_decile,\n    COALESCE(macro_category_multi_pack_buyers, 0) AS macro_category_multi_pack_buyers,\n    COALESCE(macro_category_multi_pack_buyers_decile, 0) AS macro_category_multi_pack_buyers_decile,\n    COALESCE(frutly, 0) AS frutly,\n    COALESCE(frutly_decile, 0) AS frutly_decile,\n    COALESCE(flavored_enhanced_water, 0) AS flavored_enhanced_water,\n    COALESCE(flavored_enhanced_water_decile, 0) AS flavored_enhanced_water_decile,\n    COALESCE(shelf_stable_juice_drinks, 0) AS shelf_stable_juice_drinks,\n    COALESCE(shelf_stable_juice_drinks_decile, 0) AS shelf_stable_juice_drinks_decile,\n    COALESCE(smart_water_centile, 0) AS smart_water_centile,\n    COALESCE(energy_csd_zero_calorie_centile, 0) AS energy_csd_zero_calorie_centile,\n    COALESCE(csd_total_centile, 0) AS csd_total_centile,\n    COALESCE(doritos_centile, 0) AS doritos_centile,\n    COALESCE(energy_drinks_centile, 0) AS energy_drinks_centile,\n    COALESCE(gatorade_centile, 0) AS gatorade_centile,\n    COALESCE(lays_centile, 0) AS lays_centile,\n    COALESCE(lipton_base_centile, 0) AS lipton_base_centile,\n    COALESCE(lipton_brisk_centile, 0) AS lipton_brisk_centile,\n    COALESCE(mt_dew_centile, 0) AS mt_dew_centile,\n    COALESCE(mtn_dew_kickstart_centile, 0) AS mtn_dew_kickstart_centile,\n    COALESCE(nuts_centile, 0) AS nuts_centile,\n    COALESCE(pepsi_diet_centile, 0) AS pepsi_diet_centile,\n    COALESCE(pepsi_regular_centile, 0) AS pepsi_regular_centile,\n    COALESCE(performance_bars_centile, 0) AS performance_bars_centile,\n    COALESCE(pepsico_protein_powder_centile, 0) AS pepsico_protein_powder_centile,\n    COALESCE(propel_centile, 0) AS propel_centile,\n    COALESCE(quaker_oatmeal_centile, 0) AS quaker_oatmeal_centile,\n    COALESCE(rte_cereal_centile, 0) AS rte_cereal_centile,\n    COALESCE(ruffles_centile, 0) AS ruffles_centile,\n    COALESCE(bottled_water_centile, 0) AS bottled_water_centile,\n    COALESCE(starbucks_tripleshot_centile, 0) AS starbucks_tripleshot_centile,\n    COALESCE(funyuns_centile, 0) AS funyuns_centile,\n    COALESCE(chilled_tea_centile, 0) AS chilled_tea_centile,\n    COALESCE(coffee_rtd_centile, 0) AS coffee_rtd_centile,\n    COALESCE(online_delivery_centile, 0) AS online_delivery_centile,\n    COALESCE(csd_singles_centile, 0) AS csd_singles_centile,\n    COALESCE(flv_csd_ex_dew_pepper_centile, 0) AS flv_csd_ex_dew_pepper_centile,\n    COALESCE(rtd_protein_centile, 0) AS rtd_protein_centile,\n    COALESCE(sodastream_centile, 0) AS sodastream_centile,\n    COALESCE(gamefuel_centile, 0) AS gamefuel_centile,\n    COALESCE(mainstream_kettle_chips_centile, 0) AS mainstream_kettle_chips_centile,\n    COALESCE(lipton_pure_leaf_centile, 0) AS lipton_pure_leaf_centile,\n    COALESCE(mainstream_juices_centile, 0) AS mainstream_juices_centile,\n    COALESCE(mt_dew_flv_seek_centile, 0) AS mt_dew_flv_seek_centile,\n    COALESCE(instant_quaker_oats_centile, 0) AS instant_quaker_oats_centile,\n    COALESCE(naked_protein_centile, 0) AS naked_protein_centile,\n    COALESCE(pepsi_zero_coke_zero_centile, 0) AS pepsi_zero_coke_zero_centile,\n    COALESCE(prem_juice_drinks_centile, 0) AS prem_juice_drinks_centile,\n    COALESCE(lightly_flavored_tortilla_chips_centile, 0) AS lightly_flavored_tortilla_chips_centile,\n    COALESCE(doubleshot_javam_centile, 0) AS doubleshot_javam_centile,\n    COALESCE(food_bev_centile, 0) AS food_bev_centile,\n    COALESCE(ncb_innovation_centile, 0) AS ncb_innovation_centile,\n    COALESCE(premium_csd_centile, 0) AS premium_csd_centile,\n    COALESCE(premium_tea_centile, 0) AS premium_tea_centile,\n    COALESCE(premium_water_centile, 0) AS premium_water_centile,\n    COALESCE(probiotic_juices_centile, 0) AS probiotic_juices_centile,\n    COALESCE(lays_poppables_centile, 0) AS lays_poppables_centile,\n    COALESCE(alternative_tortilla_chips_centile, 0) AS alternative_tortilla_chips_centile,\n    COALESCE(snack_bars_centile, 0) AS snack_bars_centile,\n    COALESCE(sparkling_water_centile, 0) AS sparkling_water_centile,\n    COALESCE(dips_as_meal_enhancers_centile, 0) AS dips_as_meal_enhancers_centile,\n    COALESCE(stacys_centile, 0) AS stacys_centile,\n    COALESCE(sunchips_centile, 0) AS sunchips_centile,\n    COALESCE(super_premium_juices_centile, 0) AS super_premium_juices_centile,\n    COALESCE(tostitos_centile, 0) AS tostitos_centile,\n    COALESCE(flavor_camp_bbq_centile, 0) AS flavor_camp_bbq_centile,\n    COALESCE(plant_based_rtd_protein_centile, 0) AS plant_based_rtd_protein_centile,\n    COALESCE(veggie_chips_centile, 0) AS veggie_chips_centile,\n    COALESCE(g_organic_centile, 0) AS g_organic_centile,\n    COALESCE(mountain_dew_baja_blast_centile, 0) AS mountain_dew_baja_blast_centile,\n    COALESCE(cold_brew_centile, 0) AS cold_brew_centile,\n    COALESCE(bubly_centile, 0) AS bubly_centile,\n    COALESCE(ultra_premium_juice_centile, 0) AS ultra_premium_juice_centile,\n    COALESCE(lightly_salted_chips_centile, 0) AS lightly_salted_chips_centile,\n    COALESCE(flavor_camp_cheese_centile, 0) AS flavor_camp_cheese_centile,\n    COALESCE(sabra_hummus_tubs_centile, 0) AS sabra_hummus_tubs_centile,\n    COALESCE(oj_category_switchers_centile, 0) AS oj_category_switchers_centile,\n    COALESCE(standard_quaker_oats_centile, 0) AS standard_quaker_oats_centile,\n    COALESCE(csd_multiserve_centile, 0) AS csd_multiserve_centile,\n    COALESCE(dew_ice_centile, 0) AS dew_ice_centile,\n    COALESCE(flavor_camp_dairy_centile, 0) AS flavor_camp_dairy_centile,\n    COALESCE(online_curbside_pickup_centile, 0) AS online_curbside_pickup_centile,\n    COALESCE(flavor_camp_herb_spice_veggie_centile, 0) AS flavor_camp_herb_spice_veggie_centile,\n    COALESCE(flv_salty_snacks_centile, 0) AS flv_salty_snacks_centile,\n    COALESCE(g2_centile, 0) AS g2_centile,\n    COALESCE(flavor_camp_salted_plain_centile, 0) AS flavor_camp_salted_plain_centile,\n    COALESCE(keto_cookies_centile, 0) AS keto_cookies_centile,\n    COALESCE(low_fat_salty_snacks_centile, 0) AS low_fat_salty_snacks_centile,\n    COALESCE(aha_centile, 0) AS aha_centile,\n    COALESCE(plant_based_protein_powder_centile, 0) AS plant_based_protein_powder_centile,\n    COALESCE(pretzel_category_centile, 0) AS pretzel_category_centile,\n    COALESCE(flavor_camp_spicy_burn_centile, 0) AS flavor_camp_spicy_burn_centile,\n    COALESCE(dots_pretzels_centile, 0) AS dots_pretzels_centile,\n    COALESCE(santitas_centile, 0) AS santitas_centile,\n    COALESCE(flavor_camp_tangy_centile, 0) AS flavor_camp_tangy_centile,\n    COALESCE(tropicana_probiotics_purchasers_centile, 0) AS tropicana_probiotics_purchasers_centile,\n    COALESCE(tropicana_pure_premium_purchasers_centile, 0) AS tropicana_pure_premium_purchasers_centile,\n    COALESCE(rfg_yogurt_drinks_centile, 0) AS rfg_yogurt_drinks_centile,\n    COALESCE(flavor_camp_aggregate_all_intense_bold_centile, 0) AS flavor_camp_aggregate_all_intense_bold_centile,\n    COALESCE(total_regular_cola_centile, 0) AS total_regular_cola_centile,\n    COALESCE(flavor_camp_meat_centile, 0) AS flavor_camp_meat_centile,\n    COALESCE(fritos_original_centile, 0) AS fritos_original_centile,\n    COALESCE(flavored_pretzels_centile, 0) AS flavored_pretzels_centile,\n    COALESCE(nutrition_engaged_centile, 0) AS nutrition_engaged_centile,\n    COALESCE(mainstream_engaged_centile, 0) AS mainstream_engaged_centile,\n    COALESCE(oj_category_centile, 0) AS oj_category_centile,\n    COALESCE(nutrition_bars_centile, 0) AS nutrition_bars_centile,\n    COALESCE(oatmeal_category_centile, 0) AS oatmeal_category_centile,\n    COALESCE(alt_dairy_category_centile, 0) AS alt_dairy_category_centile,\n    COALESCE(kombucha_functional_juices_centile, 0) AS kombucha_functional_juices_centile,\n    COALESCE(single_serve_mainstream_juice_centile, 0) AS single_serve_mainstream_juice_centile,\n    COALESCE(quaker_grits_centile, 0) AS quaker_grits_centile,\n    COALESCE(shelf_stable_dips_category_centile, 0) AS shelf_stable_dips_category_centile,\n    COALESCE(fruit_snacks_centile, 0) AS fruit_snacks_centile,\n    COALESCE(fritos_flavor_centile, 0) AS fritos_flavor_centile,\n    COALESCE(kevita_purchasers_centile, 0) AS kevita_purchasers_centile,\n    COALESCE(heart_claim_centile, 0) AS heart_claim_centile,\n    COALESCE(starbucks_frappuccino_centile, 0) AS starbucks_frappuccino_centile,\n    COALESCE(single_serve_salty_snacks_centile, 0) AS single_serve_salty_snacks_centile,\n    COALESCE(cholesterol_claim_centile, 0) AS cholesterol_claim_centile,\n    COALESCE(g_zero_centile, 0) AS g_zero_centile,\n    COALESCE(diet_csds_centile, 0) AS diet_csds_centile,\n    COALESCE(candy_category_centile, 0) AS candy_category_centile,\n    COALESCE(frozen_fruit_category_centile, 0) AS frozen_fruit_category_centile,\n    COALESCE(salty_snacks_centile, 0) AS salty_snacks_centile,\n    COALESCE(premium_greek_yogurt_centile, 0) AS premium_greek_yogurt_centile,\n    COALESCE(rice_pasta_ethnic_spclty_centile, 0) AS rice_pasta_ethnic_spclty_centile,\n    COALESCE(pancake_mix_syrup_centile, 0) AS pancake_mix_syrup_centile,\n    COALESCE(lite_snacks_centile, 0) AS lite_snacks_centile,\n    COALESCE(herbal_tea_centile, 0) AS herbal_tea_centile,\n    COALESCE(tazo_centile, 0) AS tazo_centile,\n    COALESCE(mini_cans_centile, 0) AS mini_cans_centile,\n    COALESCE(unflavored_pretzels_centile, 0) AS unflavored_pretzels_centile,\n    COALESCE(bodyarmor_centile, 0) AS bodyarmor_centile,\n    COALESCE(organic_food_bev_buyers_centile, 0) AS organic_food_bev_buyers_centile,\n    COALESCE(fritos_scoops_centile, 0) AS fritos_scoops_centile,\n    COALESCE(grain_claim_centile, 0) AS grain_claim_centile,\n    COALESCE(diet_coke_centile, 0) AS diet_coke_centile,\n    COALESCE(online_in_store_pickup_centile, 0) AS online_in_store_pickup_centile,\n    COALESCE(bare_centile, 0) AS bare_centile,\n    COALESCE(off_the_eaten_path_centile, 0) AS off_the_eaten_path_centile,\n    COALESCE(rte_cereal_all_family_centile, 0) AS rte_cereal_all_family_centile,\n    COALESCE(rte_cereal_kids_centile, 0) AS rte_cereal_kids_centile,\n    COALESCE(instant_quaker_oats_light_lapsed_centile, 0) AS instant_quaker_oats_light_lapsed_centile,\n    COALESCE(celsius_energy_centile, 0) AS celsius_energy_centile,\n    COALESCE(doritos_h_and_s_centile, 0) AS doritos_h_and_s_centile,\n    COALESCE(premium_kettle_chips_centile, 0) AS premium_kettle_chips_centile,\n    COALESCE(chewy_kids_snacking_centile, 0) AS chewy_kids_snacking_centile,\n    COALESCE(starbucks_nitro_centile, 0) AS starbucks_nitro_centile,\n    COALESCE(premium_lrb_centile, 0) AS premium_lrb_centile,\n    COALESCE(rte_popcorn_full_flavor_centile, 0) AS rte_popcorn_full_flavor_centile,\n    COALESCE(rte_popcorn_light_flavor_centile, 0) AS rte_popcorn_light_flavor_centile,\n    COALESCE(breakfast_cereal_snack_bars_centile, 0) AS breakfast_cereal_snack_bars_centile,\n    COALESCE(sports_drinks_centile, 0) AS sports_drinks_centile,\n    COALESCE(takis_centile, 0) AS takis_centile,\n    COALESCE(lacroix_centile, 0) AS lacroix_centile,\n    COALESCE(manzanita_sol_centile, 0) AS manzanita_sol_centile,\n    COALESCE(unflavored_tortilla_chips_centile, 0) AS unflavored_tortilla_chips_centile,\n    COALESCE(crush_centile, 0) AS crush_centile,\n    COALESCE(chewy_centile, 0) AS chewy_centile,\n    COALESCE(rockstar_energy_centile, 0) AS rockstar_energy_centile,\n    COALESCE(light_holiday_salty_snack_buyers_centile, 0) AS light_holiday_salty_snack_buyers_centile,\n    COALESCE(medium_holiday_salty_snack_buyers_centile, 0) AS medium_holiday_salty_snack_buyers_centile,\n    COALESCE(xxvl_single_serve_snacks_centile, 0) AS xxvl_single_serve_snacks_centile,\n    COALESCE(svlr_single_serve_snacks_centile, 0) AS svlr_single_serve_snacks_centile,\n    COALESCE(lss_single_serve_snacks_centile, 0) AS lss_single_serve_snacks_centile,\n    COALESCE(bolt_24_centile, 0) AS bolt_24_centile,\n    COALESCE(lemonade_centile, 0) AS lemonade_centile,\n    COALESCE(gamesa_cookies_centile, 0) AS gamesa_cookies_centile,\n    COALESCE(kids_organic_centile, 0) AS kids_organic_centile,\n    COALESCE(rice_crisps_cakes_centile, 0) AS rice_crisps_cakes_centile,\n    COALESCE(health_warrior_centile, 0) AS health_warrior_centile,\n    COALESCE(simple_nutrition_centile, 0) AS simple_nutrition_centile,\n    COALESCE(naked_centile, 0) AS naked_centile,\n    COALESCE(yogurt_centile, 0) AS yogurt_centile,\n    COALESCE(online_edible_centile, 0) AS online_edible_centile,\n    COALESCE(better_for_you_bagged_snacks_centile, 0) AS better_for_you_bagged_snacks_centile,\n    COALESCE(vanilla_flavored_rtd_coffee_centile, 0) AS vanilla_flavored_rtd_coffee_centile,\n    COALESCE(frozen_dips_centile, 0) AS frozen_dips_centile,\n    COALESCE(caramel_flavored_rtd_coffee_centile, 0) AS caramel_flavored_rtd_coffee_centile,\n    COALESCE(coffee_flavored_rtd_coffee_centile, 0) AS coffee_flavored_rtd_coffee_centile,\n    COALESCE(lays_stax_centile, 0) AS lays_stax_centile,\n    COALESCE(popcorners_centile, 0) AS popcorners_centile,\n    COALESCE(shelf_stable_dairy_dips_centile, 0) AS shelf_stable_dairy_dips_centile,\n    COALESCE(probiotic_attribute_centile, 0) AS probiotic_attribute_centile,\n    COALESCE(essentia_centile, 0) AS essentia_centile,\n    COALESCE(core_centile, 0) AS core_centile,\n    COALESCE(dasani_centile, 0) AS dasani_centile,\n    COALESCE(shelf_stable_salsa_centile, 0) AS shelf_stable_salsa_centile,\n    COALESCE(shelf_stable_cheese_dips_centile, 0) AS shelf_stable_cheese_dips_centile,\n    COALESCE(shelf_stable_bean_dips_centile, 0) AS shelf_stable_bean_dips_centile,\n    COALESCE(cheetos_cheese_core_centile, 0) AS cheetos_cheese_core_centile,\n    COALESCE(frito_lay_multipack_centile, 0) AS frito_lay_multipack_centile,\n    COALESCE(cheetos_flamin_hot_core_centile, 0) AS cheetos_flamin_hot_core_centile,\n    COALESCE(muscle_milk_centile, 0) AS muscle_milk_centile,\n    COALESCE(kst_regular_coke_transitioner_centile, 0) AS kst_regular_coke_transitioner_centile,\n    COALESCE(kst_frequent_diet_pepsi_transitioner_centile, 0) AS kst_frequent_diet_pepsi_transitioner_centile,\n    COALESCE(kst_hispanic_pepsi_drinker_centile, 0) AS kst_hispanic_pepsi_drinker_centile,\n    COALESCE(kst_light_cola_drinker_centile, 0) AS kst_light_cola_drinker_centile,\n    COALESCE(kst_frequent_blue_pepsi_drinker_centile, 0) AS kst_frequent_blue_pepsi_drinker_centile,\n    COALESCE(kst_non_cola_drinkers_centile, 0) AS kst_non_cola_drinkers_centile,\n    COALESCE(macaroni_and_cheese_centile, 0) AS macaroni_and_cheese_centile,\n    COALESCE(heat_and_eat_centile, 0) AS heat_and_eat_centile,\n    COALESCE(instant_rice_pasta_grains_centile, 0) AS instant_rice_pasta_grains_centile,\n    COALESCE(better_for_you_crackers_centile, 0) AS better_for_you_crackers_centile,\n    COALESCE(zero_calorie_csd_centile, 0) AS zero_calorie_csd_centile,\n    COALESCE(wavy_lays_centile, 0) AS wavy_lays_centile,\n    COALESCE(multiserve_starbucks_centile, 0) AS multiserve_starbucks_centile,\n    COALESCE(tea_bags_centile, 0) AS tea_bags_centile,\n    COALESCE(rfg_dips_centile, 0) AS rfg_dips_centile,\n    COALESCE(sleeping_remedies_centile, 0) AS sleeping_remedies_centile,\n    COALESCE(adaptogens_centile, 0) AS adaptogens_centile,\n    COALESCE(easy_wellness_centile, 0) AS easy_wellness_centile,\n    COALESCE(bang_centile, 0) AS bang_centile,\n    COALESCE(kevita_adjacencies_centile, 0) AS kevita_adjacencies_centile,\n    COALESCE(caffeine_attribute_centile, 0) AS caffeine_attribute_centile,\n    COALESCE(vitamin_c_attribute_centile, 0) AS vitamin_c_attribute_centile,\n    COALESCE(antioxidant_attribute_centile, 0) AS antioxidant_attribute_centile,\n    COALESCE(poland_spring_centile, 0) AS poland_spring_centile,\n    COALESCE(polar_centile, 0) AS polar_centile,\n    COALESCE(diet_coke_decliners_centile, 0) AS diet_coke_decliners_centile,\n    COALESCE(sprite_and_fanta_decliners_centile, 0) AS sprite_and_fanta_decliners_centile,\n    COALESCE(rap_snacks_centile, 0) AS rap_snacks_centile,\n    COALESCE(cheetos_crunchy_centile, 0) AS cheetos_crunchy_centile,\n    COALESCE(cheetos_puffs_centile, 0) AS cheetos_puffs_centile,\n    COALESCE(lays_classic_centile, 0) AS lays_classic_centile,\n    COALESCE(premium_cocktail_mixers_centile, 0) AS premium_cocktail_mixers_centile,\n    COALESCE(baken_ets_centile, 0) AS baken_ets_centile,\n    COALESCE(mainstream_mixers_centile, 0) AS mainstream_mixers_centile,\n    COALESCE(quaker_hots_light_lapsed_centile, 0) AS quaker_hots_light_lapsed_centile,\n    COALESCE(zone_in_shopper_centile, 0) AS zone_in_shopper_centile,\n    COALESCE(root_beer_centile, 0) AS root_beer_centile,\n    COALESCE(coke_centile, 0) AS coke_centile,\n    COALESCE(premium_cheese_snacks_centile, 0) AS premium_cheese_snacks_centile,\n    COALESCE(stacys_thins_centile, 0) AS stacys_thins_centile,\n    COALESCE(stacys_core_centile, 0) AS stacys_core_centile,\n    COALESCE(diet_mountain_dew_centile, 0) AS diet_mountain_dew_centile,\n    COALESCE(sparkling_ice_centile, 0) AS sparkling_ice_centile,\n    COALESCE(granola_centile, 0) AS granola_centile,\n    COALESCE(aj_pancake_mix_and_syrup_centile, 0) AS aj_pancake_mix_and_syrup_centile,\n    COALESCE(rte_cereal_adult_centile, 0) AS rte_cereal_adult_centile,\n    COALESCE(kids_ambient_juices_centile, 0) AS kids_ambient_juices_centile,\n    COALESCE(non_lemonade_juice_drinks_centile, 0) AS non_lemonade_juice_drinks_centile,\n    COALESCE(cheetos_mac_n_cheese_centile, 0) AS cheetos_mac_n_cheese_centile,\n    COALESCE(hispanic_cookies_centile, 0) AS hispanic_cookies_centile,\n    COALESCE(gamesa_crackers_centile, 0) AS gamesa_crackers_centile,\n    COALESCE(naked_juice_lapsed_buyers_centile, 0) AS naked_juice_lapsed_buyers_centile,\n    COALESCE(natural_attribute_centile, 0) AS natural_attribute_centile,\n    COALESCE(protein_attribute_centile, 0) AS protein_attribute_centile,\n    COALESCE(calcium_attribute_centile, 0) AS calcium_attribute_centile,\n    COALESCE(fiber_centile, 0) AS fiber_centile,\n    COALESCE(gluten_free_centile, 0) AS gluten_free_centile,\n    COALESCE(low_sodium_centile, 0) AS low_sodium_centile,\n    COALESCE(no_added_sugar_centile, 0) AS no_added_sugar_centile,\n    COALESCE(simply_centile, 0) AS simply_centile,\n    COALESCE(baked_centile, 0) AS baked_centile,\n    COALESCE(non_gmo_centile, 0) AS non_gmo_centile,\n    COALESCE(mt_dew_total_centile, 0) AS mt_dew_total_centile,\n    COALESCE(keto_dieters_centile, 0) AS keto_dieters_centile,\n    COALESCE(party_people_centile, 0) AS party_people_centile,\n    COALESCE(cold_and_flu_preppers_centile, 0) AS cold_and_flu_preppers_centile,\n    COALESCE(condiments_and_sauces_centile, 0) AS condiments_and_sauces_centile,\n    COALESCE(flavored_csds_centile, 0) AS flavored_csds_centile,\n    COALESCE(holiday_hosts_centile, 0) AS holiday_hosts_centile,\n    COALESCE(immunity_boosters_centile, 0) AS immunity_boosters_centile,\n    COALESCE(new_years_dieters_centile, 0) AS new_years_dieters_centile,\n    COALESCE(new_years_partiers_centile, 0) AS new_years_partiers_centile,\n    COALESCE(plant_based_buyers_centile, 0) AS plant_based_buyers_centile,\n    COALESCE(summer_grillers_centile, 0) AS summer_grillers_centile,\n    COALESCE(super_bowl_hosts_centile, 0) AS super_bowl_hosts_centile,\n    COALESCE(thanksgiving_hosts_centile, 0) AS thanksgiving_hosts_centile,\n    COALESCE(hard_coffee_centile, 0) AS hard_coffee_centile,\n    COALESCE(hard_flavored_bevs_xlemonade_centile, 0) AS hard_flavored_bevs_xlemonade_centile,\n    COALESCE(hard_kombucha_centile, 0) AS hard_kombucha_centile,\n    COALESCE(hard_lemonade_centile, 0) AS hard_lemonade_centile,\n    COALESCE(hard_seltzer_centile, 0) AS hard_seltzer_centile,\n    COALESCE(health_warrior_competitive_products_centile, 0) AS health_warrior_competitive_products_centile,\n    COALESCE(other_hmb_centile, 0) AS other_hmb_centile,\n    COALESCE(cookies_centile, 0) AS cookies_centile,\n    COALESCE(crackers_centile, 0) AS crackers_centile,\n    COALESCE(trop_premium_juice_drinks_centile, 0) AS trop_premium_juice_drinks_centile,\n    COALESCE(wine_centile, 0) AS wine_centile,\n    COALESCE(spirits_liquor_centile, 0) AS spirits_liquor_centile,\n    COALESCE(premade_cocktails_coolers_centile, 0) AS premade_cocktails_coolers_centile,\n    COALESCE(domestic_beer_centile, 0) AS domestic_beer_centile,\n    COALESCE(imported_beer_centile, 0) AS imported_beer_centile,\n    COALESCE(flavored_malt_beverages_centile, 0) AS flavored_malt_beverages_centile,\n    COALESCE(ambient_juice_centile, 0) AS ambient_juice_centile,\n    COALESCE(new_rtd_tea_buyers_buying_lipton_centile, 0) AS new_rtd_tea_buyers_buying_lipton_centile,\n    COALESCE(rtd_tea_buyers_switching_to_lipton_centile, 0) AS rtd_tea_buyers_switching_to_lipton_centile,\n    COALESCE(sabritas_centile, 0) AS sabritas_centile,\n    COALESCE(cbd_product_purchasers_centile, 0) AS cbd_product_purchasers_centile,\n    COALESCE(dr_pepper_centile, 0) AS dr_pepper_centile,\n    COALESCE(coffee_beans_centile, 0) AS coffee_beans_centile,\n    COALESCE(hispanic_aisle_centile, 0) AS hispanic_aisle_centile,\n    COALESCE(functional_juice_kombucha_switchers_centile, 0) AS functional_juice_kombucha_switchers_centile,\n    COALESCE(dole_centile, 0) AS dole_centile,\n    COALESCE(twister_centile, 0) AS twister_centile,\n    COALESCE(quaker_grits_new_buyers_centile, 0) AS quaker_grits_new_buyers_centile,\n    COALESCE(macro_category_multi_pack_buyers_centile, 0) AS macro_category_multi_pack_buyers_centile,\n    COALESCE(frutly_centile, 0) AS frutly_centile,\n    COALESCE(flavored_enhanced_water_centile, 0) AS flavored_enhanced_water_centile,\n    COALESCE(shelf_stable_juice_drinks_centile, 0) AS shelf_stable_juice_drinks_centile,\n    COALESCE(fb_dollars_hh, 0) AS fb_dollars_hh,\n    COALESCE(fb_units_hh, 0) AS fb_units_hh,\n    COALESCE(fb_trips_hh, 0) AS fb_trips_hh,\n    COALESCE(fb_dollar_index, 0) AS fb_dollar_index\nFROM {{ source('iri', 'MVH_IRI_PROSCORES_X261') }} psc\nLEFT OUTER JOIN {{ ref('iri_pepsi_fb_raw') }} pfb ON (psc.food_bev_decile = pfb.fb_decile)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "iri", "iri_all"], "unique_id": "model.sdna_project.iri_all", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/iri/iri_all.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/iri/iri_all.sql", "name": "iri_all", "resource_type": "model", "alias": "iri_all", "checksum": {"name": "sha256", "checksum": "0f81adec56a24bde55b63b55b81143101f1435a35ee1b167e11c8437a9c0f0c6"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["iri_pepsi_fb_raw"]], "sources": [["iri", "MVH_IRI_PROSCORES_X261"]], "depends_on": {"macros": [], "nodes": ["source.sdna_project.iri.MVH_IRI_PROSCORES_X261", "model.sdna_project.iri_pepsi_fb_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.exp_geo_is": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load exp_geo_is\n\n-- {{ ref('exp_geo') }}\n-- {{ ref('is_hh_store_tc_transpose') }}\n\nSELECT\n    cv_living_unit_id,\n\tcv_address_id,\n\tcv_short_city_name,\n\tcv_city_name,\n\tcv_county_name,\n\tcv_state_abb,\n\tcv_zipcode_5,\n\tcv_zipcode_4,\n\tcv_zipcode_9,\n\tcv_zip_locality,\n\tcv_delvy_pt_bar_cd,\n\tcv_carr_route,\n\tcv_state_cd,\n\tcv_county_cd,\n\tcv_cen2010_tract_block_grp,\n\tcv_cen2010_blockid,\n\tcv_latitude,\n\tcv_longitude,\n\tcv_mat_level_geodata,\n\tcv_addr_qlty_ind,\n\tcv_recp_reliable_cd,\n\tcv_acty_dt,\n\tcv_tme_zn,\n\tcv_p1_pid,\n\tcv_p1_ptyp,\n\tcv_p1_etnc_etnc,\n\tcv_p1_etnc_exp_grp,\n\tcv_p1_etnc_religion,\n\tcv_p1_etnc_lang_pref,\n\tcv_p1_etnc_grp,\n\tcv_p1_etnc_country_of_origin,\n\tcv_p1_gender,\n\tcv_p1_birth_dt,\n\tcv_p1_est_age,\n\tcv_p1_exact_age,\n\tcv_p1_com_age,\n\tcv_p1_edu_mdl,\n\tcv_p1_marital_st,\n\tcv_p1_occ_grp,\n\tcv_p1_occ_cd,\n\tcv_p1_bus_own,\n\tcv_p2_pid,\n\tcv_p2_ptyp,\n\tcv_p2_etnc_etnc,\n\tcv_p2_etnc_exp_grp,\n\tcv_p2_etnc_religion,\n\tcv_p2_etnc_lang_pref,\n\tcv_p2_etnc_grp,\n\tcv_p2_etnc_country_of_origin,\n\tcv_p2_gender,\n\tcv_p2_birth_dt,\n\tcv_p2_est_age,\n\tcv_p2_exact_age,\n\tcv_p2_com_age,\n\tcv_p2_edu_mdl,\n\tcv_p2_marital_st,\n\tcv_p2_occ_grp,\n\tcv_p2_occ_cd,\n\tcv_p2_bus_own,\n\tcv_p3_pid,\n\tcv_p3_ptyp,\n\tcv_p3_etnc_etnc,\n\tcv_p3_etnc_exp_grp,\n\tcv_p3_etnc_religion,\n\tcv_p3_etnc_lang_pref,\n\tcv_p3_etnc_grp,\n\tcv_p3_etnc_country_of_origin,\n\tcv_p3_gender,\n\tcv_p3_birth_dt,\n\tcv_p3_est_age,\n\tcv_p3_exact_age,\n\tcv_p3_com_age,\n\tcv_p3_edu_mdl,\n\tcv_p3_marital_st,\n\tcv_p3_occ_grp,\n\tcv_p3_occ_cd,\n\tcv_p3_bus_own,\n\tcv_p4_pid,\n\tcv_p4_ptyp,\n\tcv_p4_etnc_etnc,\n\tcv_p4_etnc_exp_grp,\n\tcv_p4_etnc_religion,\n\tcv_p4_etnc_lang_pref,\n\tcv_p4_etnc_grp,\n\tcv_p4_etnc_country_of_origin,\n\tcv_p4_gender,\n\tcv_p4_birth_dt,\n\tcv_p4_est_age,\n\tcv_p4_exact_age,\n\tcv_p4_com_age,\n\tcv_p4_edu_mdl,\n\tcv_p4_marital_st,\n\tcv_p4_occ_grp,\n\tcv_p4_occ_cd,\n\tcv_p4_bus_own,\n\tcv_p5_pid,\n\tcv_p5_ptyp,\n\tcv_p5_etnc_etnc,\n\tcv_p5_etnc_exp_grp,\n\tcv_p5_etnc_religion,\n\tcv_p5_etnc_lang_pref,\n\tcv_p5_etnc_grp,\n\tcv_p5_etnc_country_of_origin,\n\tcv_p5_gender,\n\tcv_p5_birth_dt,\n\tcv_p5_est_age,\n\tcv_p5_exact_age,\n\tcv_p5_com_age,\n\tcv_p5_edu_mdl,\n\tcv_p5_marital_st,\n\tcv_p5_occ_grp,\n\tcv_p5_occ_cd,\n\tcv_p5_bus_own,\n\tcv_p6_pid,\n\tcv_p6_ptyp,\n\tcv_p6_etnc_etnc,\n\tcv_p6_etnc_exp_grp,\n\tcv_p6_etnc_religion,\n\tcv_p6_etnc_lang_pref,\n\tcv_p6_etnc_grp,\n\tcv_p6_etnc_country_of_origin,\n\tcv_p6_gender,\n\tcv_p6_birth_dt,\n\tcv_p6_est_age,\n\tcv_p6_exact_age,\n\tcv_p6_com_age,\n\tcv_p6_edu_mdl,\n\tcv_p6_marital_st,\n\tcv_p6_occ_grp,\n\tcv_p6_occ_cd,\n\tcv_p6_bus_own,\n\tcv_mor,\n\tcv_mor_bank_book,\n\tcv_mor_bank_spl_food,\n\tcv_mor_bank_craft_merch,\n\tcv_mor_bank_culinary_int,\n\tcv_mor_bank_dedupe_hit,\n\tcv_mor_bank_doit_yourself,\n\tcv_mor_bank_famgen_mag,\n\tcv_mor_bank_f_merch,\n\tcv_mor_bank_f_orient_mag,\n\tcv_mor_bank_gar_farm_buy,\n\tcv_mor_bank_gar_farm_mag,\n\tcv_mor_bank_gen_contrib,\n\tcv_mor_bank_gen_merch,\n\tcv_mor_bank_gift_gadgs,\n\tcv_mor_bank_health_inst_contib,\n\tcv_mor_bank_health_fit_mag,\n\tcv_mor_bank_m_merch,\n\tcv_mor_bank_m_sports_mag,\n\tcv_mor_bank_misc,\n\tcv_mor_bank_nondedupe_hit,\n\tcv_mor_bank_odds_end,\n\tcv_mor_bank_opp_seek_ce,\n\tcv_mor_bank_photograph,\n\tcv_mor_bank_political_cont,\n\tcv_mor_bank_religious_cont,\n\tcv_mor_bank_religious_mag,\n\tcv_mor_bank_upscale_merch,\n\tcv_mor_bank_news_finan,\n\tcv_ncoa_cd,\n\tcv_ncoa_dt,\n\tcv_green_aware,\n\tcv_green_aware_deciles,\n\tcv_no_adults_unit,\n\tcv_no_pers_unit,\n\tcv_no_child_unit,\n\tcv_child_age_0_3,\n\tcv_child_age_4_6,\n\tcv_child_age_7_9,\n\tcv_child_age_10_12,\n\tcv_child_age_13_15,\n\tcv_child_age_16_18,\n\tcv_mosaic_household,\n\tcv_mosaic_zip4,\n\tcv_home_bus,\n\tcv_dwelling_type,\n\tcv_dwelling_unit_size,\n\tcv_length_of_residence,\n\tcv_household_comp,\n\tcv_hmeown_hmeown,\n\tcv_hmeown_prob_hmeown,\n\tcv_hmeown_comb_hmeown_renter,\n\tcv_est_curr_hme_val,\n\tcv_est_curr_hme_val_range,\n\tcv_cons_vw_proft,\n\tcv_incom_per_national,\n\tcv_county_ehi_per,\n\tcv_auto_in_market_new,\n\tcv_aut_mark_used,\n\tcv_aut_mark_used_0_5_vehicle,\n\tcv_aut_mark_used_11_vehicle,\n\tcv_aut_mark_used_6_10_vehicle,\n\tcv_est_inc_amtv5,\n\tcv_est_hh_incv5,\n\tcv_county_echv_index,\n\tcv_county_echv_per,\n\tcv_state_ehi_index,\n\tcv_county_ehi_index,\n\tcv_cen_rur_urban_county_szcd,\n\tcv_cbsa,\n\tcv_cbsa_type,\n\tcv_cape_edu_ispsa,\n\tcv_cape_edu_ispsa_decile,\n\tcv_cape_inc_fam_state_decile,\n\tcv_cape_dens_per_per_pop,\n\tcv_cape_age_pop_0_17,\n\tcv_cape_age_pop_0_4,\n\tcv_cape_age_pop_5_9,\n\tcv_cape_age_pop_10_13,\n\tcv_cape_age_pop_14_17,\n\tcv_cape_age_pop_18_99,\n\tcv_cape_age_pop_65_99,\n\tcv_cape_age_pop_median_age,\n\tcv_cape_built_median_hous_age,\n\tcv_cape_child_couple_famw_lt18,\n\tcv_cape_child_couple_famwo_lt18,\n\tcv_cape_child_wper_lt18,\n\tcv_cape_edu_pop25_med_edu_attain,\n\tcv_cape_occ_empid_health_tech,\n\tcv_cape_ethnic_pop_black_only,\n\tcv_cape_ethnic_pop_asian_only,\n\tcv_cape_ethnic_pop_hispanic,\n\tcv_cape_ethnic_pop_white_only,\n\tcv_cape_avg_hh_size,\n\tcv_cape_oohu_med_hme_val,\n\tcv_cape_hu_mob_hme,\n\tcv_cape_med_fam_hh_inc,\n\tcv_cape_lang_spanish_speak,\n\tcv_cape_occhu_own_occu,\n\tcv_cape_oochu_rent_occu,\n\tcv_cape_marr_couple_fam,\n\tcv_hh_int_read_bible_devo,\n\tcv_hh_pc_use_net_service,\n\tcv_hh_crafts,\n\tcv_hh_finan_stks_bond,\n\tcv_hh_finan_cds_money_mkt,\n\tcv_hh_finan_iras_currently,\n\tcv_hh_finan_mutual_funds,\n\tcv_hh_finan_real_estate,\n\tcv_act_amusement_park_visit,\n\tcv_act_zoo_visit,\n\tcv_act_coffee_connoisseurs,\n\tcv_act_wine_lover,\n\tcv_act_doit_yourself,\n\tcv_act_hme_imp_spenders,\n\tcv_act_hunt_enthus,\n\tcv_act_digi_mag_buyer,\n\tcv_act_attend_edu_pgm,\n\tcv_act_video_gamer,\n\tcv_act_mlb_enthus,\n\tcv_act_nascar_enthus,\n\tcv_act_nba_enthus,\n\tcv_act_nfl_enthus,\n\tcv_act_nhl_enthus,\n\tcv_act_pga_tour_enthus,\n\tcv_act_politics_viewing_tv_lib,\n\tcv_act_politics_viewing_tv_libcom,\n\tcv_act_politics_viewing_tv_conserv,\n\tcv_act_eats_fam_restaurant,\n\tcv_act_eats_ff_restaurant,\n\tcv_act_canoeing_kayaking,\n\tcv_act_play_golf,\n\tcv_act_gourment_cooking,\n\tcv_act_cat_owners,\n\tcv_act_dog_owners,\n\tcv_act_pet_enthus,\n\tcv_act_arts_crafts,\n\tcv_act_scrapbooking,\n\tcv_act_cultural_arts,\n\tcv_hobbies_gardening,\n\tcv_act_photography,\n\tcv_act_book_reader,\n\tcv_act_ebook_reader,\n\tcv_act_audiobook_reader,\n\tcv_act_avid_runners,\n\tcv_act_outdoor_enthus,\n\tcv_act_fishing,\n\tcv_act_snow_sport,\n\tcv_act_boating,\n\tcv_act_plays_hockey,\n\tcv_act_plays_soccer,\n\tcv_act_plays_tennis,\n\tcv_act_sport_enthusiast,\n\tcv_act_healthy_living,\n\tcv_act_fitness_enthus,\n\tcv_act_on_diet,\n\tcv_act_weight_conscious,\n\tcv_act_casino_gambling,\n\tcv_act_sweepstakes_lottery,\n\tcv_act_music_download,\n\tcv_act_music_stream,\n\tcv_act_listen_christian_music,\n\tcv_act_listen_classical_music,\n\tcv_act_listen_country_music,\n\tcv_act_listen_music,\n\tcv_act_listen_oldies_music,\n\tcv_act_listen_rock_music,\n\tcv_act_listen_80s_music,\n\tcv_act_listen_hiphop_music,\n\tcv_act_listen_alter_music,\n\tcv_act_listen_jazz_music,\n\tcv_act_listen_pop_music,\n\tcv_buyer_lap_own,\n\tcv_buyer_security_sys_own,\n\tcv_buyer_tab_own,\n\tcv_buyer_coupon_users,\n\tcv_buyer_lux_store_shopp,\n\tcv_buyer_lux_hme_goods_shopp,\n\tcv_buyer_yng_adult_cloth_shopp,\n\tcv_buyer_supercenter_shopp,\n\tcv_buyer_warehouse_club_mem,\n\tcv_buyer_loyalty_card_usr,\n\tcv_buyer_presence_auto,\n\tcv_buyer_nonpres_makeup_usr,\n\tcv_buyer_pres_makeup_usr,\n\tcv_buyer_highend_spirit_drinker,\n\tcv_lfstyl_lf_insure_plcy_hldr,\n\tcv_lfstyl_med_insure_plcy_hldrs,\n\tcv_lfstyl_medicare_plcy_hldrs,\n\tcv_lfstyl_have_grand_child,\n\tcv_lfstyl_high_freq_business_trav,\n\tcv_lfstyl_high_freq_cruise_enthus,\n\tcv_lfstyl_high_freq_domes_vacationer,\n\tcv_lfstyl_high_freq_forgn_vacationer,\n\tcv_lfstyl_freq_fly_pgm_mem,\n\tcv_lfstyl_hostel_guest_loyal_pgm,\n\tcv_lfstyl_interest_religion,\n\tcv_lfstyl_military_act,\n\tcv_lfstyl_military_inact,\n\tcv_donor_contrib_charities,\n\tcv_donor_contrib_arts_charities,\n\tcv_donor_contrib_edu_charities,\n\tcv_donor_contrib_health_charities,\n\tcv_donor_contrib_political_charities,\n\tcv_donor_contrib_pvt_found,\n\tcv_donor_contrib_volunteer,\n\tcv_finan_debit_card_usr,\n\tcv_finan_corp_credit_card_usr,\n\tcv_finan_major_credit_card_usr,\n\tcv_finan_premium_credit_card_usr,\n\tcv_finan_credit_card_usr,\n\tcv_finan_store_credit_card_usr,\n\tcv_invest_retire_finan_plan,\n\tcv_invest_part_online_trade,\n\tcv_invest_brokerage_acct_own,\n\tcv_invest_actv_investor,\n\tcv_invest_mutual_fund_invest,\n\tcv_memship_aarp_mem,\n\tcv_memship_union_mem,\n\tcv_tt_brick_mortar,\n\tcv_tt_onlie_mid_high,\n\tcv_tt_etailer,\n\tcv_tt_online_discount,\n\tcv_tt_online_bid_mrktplc,\n\tcv_tt_broadcast_cable_tv,\n\tcv_tt_direct_mail,\n\tcv_tt_email,\n\tcv_tt_internet_radio,\n\tcv_tt_mobile_display,\n\tcv_tt_mobile_video,\n\tcv_tt_online_video,\n\tcv_tt_online_display,\n\tcv_tt_online_stream_tv,\n\tcv_tt_satellite_radio,\n\tcv_tt_buy_american,\n\tcv_tt_showme_money,\n\tcv_tt_go_with_flow,\n\tcv_tt_no_time_like_present,\n\tcv_tt_never_empty_handed,\n\tcv_tt_on_road_again,\n\tcv_tt_look_at_me_now,\n\tcv_tt_stop_smell_roses,\n\tcv_tt_wrk_hard_play_hard,\n\tcv_tt_penny_saved_penny_earned,\n\tcv_tt_its_all_in_name,\n\tcv_p1_retail_shopp,\n\tcv_p2_retail_shopp,\n\tcv_p3_retail_shopp,\n\tcv_p4_retail_shopp,\n\tcv_p5_retail_shopp,\n\tcv_p6_retail_shopp,\n\tcv_p1_health_well_being,\n\tcv_p2_health_well_being,\n\tcv_p3_health_well_being,\n\tcv_p4_health_well_being,\n\tcv_p5_health_well_being,\n\tcv_p6_health_well_being,\n\tcv_p1_mobile_usrs,\n\tcv_p2_mobile_usrs,\n\tcv_p3_mobile_usrs,\n\tcv_p4_mobile_usrs,\n\tcv_p5_mobile_usrs,\n\tcv_p6_mobile_usrs,\n\tcv_p1_tech_adoption,\n\tcv_p2_tech_adoption,\n\tcv_p3_tech_adoption,\n\tcv_p4_tech_adoption,\n\tcv_p5_tech_adoption,\n\tcv_p6_tech_adoption,\n\tcv_p1_mor,\n\tcv_p2_mor,\n\tcv_p3_mor,\n\tcv_p4_mor,\n\tcv_p5_mor,\n\tcv_p6_mor,\n\tcv_mosaic_glob_hh,\n\tcv_mosaic_glob_zip4,\n\tcv_child_pres_0_18,\n\tcv_child_age_0_3_mdl,\n\tcv_child_age_scor_0_3,\n\tcv_child_age_4_6_mdl,\n\tcv_child_age_scor_4_6,\n\tcv_child_age_7_9_mdl,\n\tcv_child_age_scor_7_9_,\n\tcv_child_age_10_12_mdl,\n\tcv_child_age_scor_10_12_,\n\tcv_child_age_13_15_mdl,\n\tcv_child_age_scor_13_15,\n\tcv_child_age_16_18_mdl,\n\tcv_child_age_scor_16_18_,\n\tcv_hh_ail_meds_vis_ctnt_lenses,\n\t--populated with null value from Experian from Q4 2020\n\tcv_bhvr_bank_cntct_lens_wearer,\n\t--populated with null value from Experian from Q4 2020\n\tcv_bhvr_bnk_reg_pres_drug_users,\n\t--populated with null value from Experian from Q4 2020\n\tcv_bhvr_bnk_intrst_vid_dvd,\n\tcv_bhvr_bnk_intrst_golf,\n\tcv_bhvr_bnk_contri_charities,\n\tcv_bhvr_bnk_pet_enthusiast,\n\tcv_bhvr_bnk_intrst_cultural_arts,\n\tcv_bhvr_bnk_purchased_thu_mail,\n\tcv_bhvr_bnk_intrst_fitness,\n\tcv_bhvr_bnk_intrst_outdoors,\n\tcv_bhvr_bnk_intrst_travel,\n\tcv_bhvr_bnk_investors,\n\tcv_bhvr_bnk_pres_of_automobile,\n\tcv_bhvr_bnk_pres_of_credit_card,\n\tcv_bhvr_bnk_intrst_gardening,\n\tcv_bhvr_bnk_intrst_crafts,\n\tcv_bhvr_bnk_collectors,\n\tcv_bhvr_bnk_cruise_enthusiasts,\n\tcv_bhvr_bnk_intrst_sports,\n\tcv_bhvr_bnk_intrst_grmt_cooking,\n\tcv_bhvr_bnk_sweepstakes_gambling,\n\tcv_bhvr_bnk_intrst_politics,\n\tcv_bhvr_bnk_intrst_music,\n\tcv_bhvr_bnk_intrst_reading,\n\tcv_bhvr_bnk_child_parenting_prod,\n\tcv_bhvr_bnk_do_it_yourselfer,\n\tcv_bhvr_bnk_self_improvement,\n\tcv_bhvr_bnk_intrst_in_religion,\n\tcv_bhvr_bnk_grandparent,\n\tcv_bhvr_bnk_intrst_clothing,\n\tcv_bhvr_bnk_donates_envrn_causes,\n\tcv_bhvr_bnk_invests_mutual_funds,\n\tcv_bhvr_bnk_wght_conscious,\n\tcv_bhvr_bnk_mail_order_multibuyer,\n\tcv_bhvr_bnk_dog_enthusiasts,\n\tcv_bhvr_bnk_cat_enthusiasts,\n\tcv_bhvr_bnk_hlthy_living,\n\tcv_bhvr_bnk_intrst_automotive,\n\tcv_bhvr_bnk_intrst_skiing,\n\tcv_bhvr_bnk_intrst_boating,\n\tcv_bhvr_bnk_pres_of_cell_phone,\n\tcv_bhvr_bnk_commn_connectivity,\n\tcv_bhvr_bnk_computers,\n\tcv_bhvr_bnk_hi_tech_owner,\n\tcv_bhvr_bnk_home_decor_furnish,\n\tcv_bhvr_bnk_homeentmnt_video,\n\tcv_bhvr_bnk_kitchen_aids_applns,\n\tcv_bhvr_bnk_mo_buyer_music_video,\n\tcv_bhvr_bnk_mob_books,\n\tcv_bhvr_bnk_mo_buyer_cloth_shoe,\n\tcv_bhvr_bnk_mob_ins_fin,\n\tcv_bhvr_bnk_mail_order_buyer_gift,\n\tcv_bhvr_bnk_mob_grdng,\n\tcv_bhvr_bnk_mob_jewelry,\n\tcv_bhvr_bnk_clas_opra_big_bnd_mus,\n\tcv_bhvr_bnk_country_music,\n\tcv_bhvr_bnk_christian_music,\n\tcv_bhvr_bnk_rock_music,\n\tcv_bhvr_bnk_internet_online_subs,\n\tcv_bhvr_bnk_intrst_photo,\n\tcv_bhvr_bnk_purchase_via_online,\n\tcv_bhvr_bnk_intrst_affluence_ls,\n\tcv_bhvr_bnk_domestic_traveler,\n\tcv_bhvr_bnk_foreign_traveler,\n\tcv_bhvr_bnk_pres_of_prem_cc,\n\tcv_bhvr_bnk_active_military,\n\tcv_bhvr_bnk_inactive_military,\n\tcv_hh_acty_int_hob_photography,\n\tcv_hh_acty_int_hobbies_gardening,\n\tcv_hh_acty_int_hob_home_ws_diy,\n\tcv_hh_acty_int_hob_cars_auto_rep,\n\tcv_hh_acty_int_hob_bird_watching,\n\tcv_hh_acty_int_hob_self_imprvmnt,\n\tcv_hh_acty_int_music_chrstn_gosp,\n\tcv_hh_acty_int_music_r_and_b,\n\tcv_hh_acty_int_music_jazz_new_age,\n\tcv_hh_acty_int_music_classical,\n\tcv_hh_acty_int_music_rock_n_roll,\n\tcv_hh_acty_int_music_country,\n\tcv_hh_acty_int_music_in_gen,\n\tcv_hh_acty_int_music_other_music,\n\tcv_hh_acty_int_read_bs_fiction,\n\tcv_hh_acty_int_childrens_reading,\n\tcv_hh_acty_int_reading_computer,\n\tcv_hh_acty_int_read_cook_culinary,\n\tcv_hh_acty_int_reading_country_ls,\n\tcv_hh_acty_int_read_entmnt_ppl,\n\tcv_hh_acty_int_reading_fashion,\n\tcv_hh_acty_int_reading_history,\n\tcv_hh_acty_int_read_intr_decor,\n\tcv_hh_acty_int_read_med_hlth,\n\tcv_hh_acty_int_reading_military,\n\tcv_hh_acty_int_reading_mystery,\n\tcv_hh_acty_int_read_ntrl_hlth_rmd,\n\tcv_hh_acty_int_reading_romance,\n\tcv_hh_acty_int_read_sc_fiction,\n\tcv_hh_acty_int_read_sc_tech,\n\tcv_hh_acty_int_sports_read,\n\tcv_hh_acty_int_read_wrld_news_pol,\n\tcv_hh_acty_int_book_reader,\n\tcv_hh_acty_int_soc_ani_wf_soc,\n\tcv_hh_acty_int_soc_env_wildlife,\n\tcv_hh_acty_int_soc_pol_cons,\n\tcv_hh_acty_int_soc_pol_liberal,\n\tcv_hh_acty_int_soc_religion,\n\tcv_hh_acty_int_soc_child,\n\tcv_hh_acty_int_soc_veterans,\n\tcv_hh_acty_int_soc_hlth,\n\tcv_hh_acty_int_soc_othr,\n\tcv_hh_acty_int_sportsbaseball,\n\tcv_hh_acty_int_sportsbasketball,\n\tcv_hh_acty_int_sports_rec_hockey,\n\tcv_hh_acty_int_sportscampng_hikng,\n\tcv_hh_acty_int_sports_rec_hunting,\n\tcv_hh_acty_int_sports_rec_fishing,\n\tcv_hh_acty_int_sports_rec_nascar,\n\tcv_hh_acty_int_sprt_fitness_exer,\n\tcv_hh_acty_int_sportsscuba_diving,\n\tcv_hh_acty_int_sportsfootball,\n\tcv_hh_acty_int_sports_rec_golf,\n\tcv_hh_acty_int_sportssnow_skng,\n\tcv_hh_acty_int_boating_sailing,\n\tcv_hh_acty_int_sports_rec_walking,\n\tcv_hh_acty_int_sports_rec_cycling,\n\tcv_hh_acty_int_sportsmotorcycles,\n\tcv_hh_acty_int_running_jogging,\n\tcv_hh_acty_int_sports_rec_soccer,\n\tcv_hh_acty_int_sportsswimming,\n\tcv_hh_acty_int_play_sprt_in_gen,\n\tcv_hh_acty_int_sweepstakes,\n\tcv_hh_acty_int_swpstakes_loteries,\n\tcv_hh_acty_int_casino_gambling,\n\tcv_hh_acty_int_travel_cruise,\n\tcv_hh_acty_int_trvl_inter,\n\tcv_hh_acty_int_travel_domestic,\n\tcv_hh_acty_int_travel_time_share,\n\tcv_hh_acty_int_trvl_rec_vehicle,\n\tcv_hh_acty_int_rv_travel,\n\tcv_hh_acty_int_trvl_bus_trvl,\n\tcv_hh_acty_int_trvl_per_trvl,\n\tcv_hh_acty_int_pc_i_own_computer,\n\tcv_hh_acty_int_pc__i_usedsl_hispd,\n\tcv_hh_acty_int_pc_i_plan_buy_comp,\n\tcv_hh_acty_int_eg_cell_phone,\n\tcv_hh_acty_int_eg_com_disc_player,\n\tcv_hh_acty_int_eg_dvd_player,\n\tcv_hh_acty_int_eg_satellite_dish,\n\tcv_hh_acty_int_eg_dig_cam,\n\tcv_hh_acty_int_eg_hdtv,\n\tcv_hh_acty_int_eg__electronics,\n\tcv_hh_acty_int_eg_pda_blackberry,\n\tcv_hh_acty_int_eg_video_camera,\n\tcv_hh_acty_int_eg_video_game_sys,\n\tcv_hh_acty_int_eg_hom_theater_sys,\n\tcv_hh_acty_int_eg_cellph_priphln,\n\tcv_hh_acty_int_cltrl_arts,\n\tcv_hh_acty_int_magzn_bus_fin,\n\tcv_hh_acty_int_childrens_magzn,\n\tcv_hh_acty_int_magzn_comp_elctrns,\n\tcv_hh_acty_int_magzn_crft_gms_hob,\n\tcv_hh_acty_int_magazines_fitness,\n\tcv_hh_acty_int_mgzn_fd_wine_ckng,\n\tcv_hh_acty_int_magzn_grdng_magzn,\n\tcv_hh_acty_int_magzn_hntg_fshng,\n\tcv_hh_acty_int_magazines_mens,\n\tcv_hh_acty_int_magazines_music,\n\tcv_hh_acty_int_mgzn_prtntg_babies,\n\tcv_hh_acty_int_mgzn_sports_mgzn,\n\tcv_hh_acty_int_magzn_subs,\n\tcv_hh_acty_int_magazines_travel,\n\tcv_hh_acty_int_magazines_womens,\n\tcv_hh_acty_int_magzn_cur_evnt_nws,\n\tcv_hh_ls_veh_hav_leased_a_veh,\n\tcv_hh_ls_veh_hav_purchased_a_veh,\n\tcv_hh_ls_afltn_mem_book_club,\n\tcv_hh_ls_afltn_mem_music_club,\n\tcv_hh_ls_cc_amer_exp_prem,\n\tcv_hh_ls_cc_amer_exp_regular,\n\tcv_hh_ls_cc_discover_premium,\n\tcv_hh_ls_cc_discover_regular,\n\tcv_hh_ls_cc_other_card_premium,\n\tcv_hh_ls_cc_other_card_regular,\n\tcv_hh_ls_cc_store_ret_reg,\n\tcv_hh_ls_cc_visa_regular,\n\tcv_hh_ls_cc_mastercard_regular,\n\tcv_hh_ls_contri_hmntrn,\n\tcv_hh_ls_entmnt_buy_prercrdvideo,\n\tcv_hh_ls_entmnt_wtch_cabletv,\n\tcv_hh_ls_entmnt_watch_videos,\n\tcv_hh_ls_outdoor_lvng_entmnt,\n\tcv_hh_ls_entmnt_season_hldy_prod,\n\tcv_hh_ls_fin_iras_future_intrst,\n\tcv_hh_ls_fin_life_insur_cur,\n\tcv_hh_ls_fin_mutl_funds,\n\tcv_hh_ls_fin_othr_invest_cur,\n\tcv_hh_ls_fin_othr_invest_future,\n\tcv_hh_ls_fin_real_estate_fut,\n\tcv_hh_ls_fin_stks_bond_fut,\n\tcv_hh_ls_grndkids_proud_grndprnt,\n\tcv_hh_ls_info_byng_purc_by_intrnt,\n\tcv_hh_ls_mil_gov_active_mil_mem,\n\tcv_hh_ls_military_gov_vetern,\n\tcv_hh_lifestyl_pets_own_a_cat,\n\tcv_hh_lifestyl_pets_own_a_dog,\n\tcv_hh_lifestyl_pets_own_a_pet,\n\tcv_hh_ls_biy_internet,\n\tcv_hh_ls_bib_mail,\n\tcv_hh_ls_bib_catalog,\n\tcv_hh_ls_buying_interest_apparel,\n\tcv_hh_ls_buying_intrst_comp_elec,\n\tcv_hh_ls_buying_intrst_book_music,\n\tcv_hh_ls_bi_home_garden,\n\tcv_hh_ls_bi_sports_related,\n\tcv_hh_ls_buying_interest_big_tall,\n\tcv_hh_ls_byng_intrst_moc,\n\tcv_hh_ls_byng_intrst_mog,\n\tcv_hh_ls_bi_mail_order_gift,\n\tcv_hh_ls_byng_intrst_mjc,\n\tcv_hh_ls_bi_mail_music_videos,\n\tcv_hh_ls_byng_intrst_mcp,\n\tcv_hh_ls_bi_mail_books_magzn,\n\tcv_hh_ls_bi_food_and_beverage,\n\tcv_hh_ls_bi_home_decorating,\n\tcv_hh_ls_bi_furniture,\n\tcv_hh_ls_bi_domestics,\n\tcv_hh_ls_buying_interest_footwear,\n\tcv_hh_ml_ordr_apprl_acsries,\n\tcv_cape_age_pop_0_9,\n\tcv_cape_age_pop_0_24,\n\tcv_cape_age_pop_25_34,\n\tcv_cape_age_pop_35_44,\n\tcv_cape_age_pop_45_54,\n\tcv_cape_age_pop_55_64,\n\tcv_cape_age_pop_18_65,\n\tcv_cape_age_pop_75_99,\n\tcv_cape_pop_med_age_of_adults_18,\n\tcv_cape_child_hh_fem_hh_fam_plt18,\n\tcv_cape_child_hh_without_per_lt18,\n\tcv_cape_cmte_com_travtowrk_60_89,\n\tcv_cape_cmter_travtowork_90,\n\tcv_cape_cmter_avg_trav_timetowork,\n\tcv_cape_cmter_med_trav_timetowork,\n\tcv_cape_cmte_wrkrs_carpld_to_work,\n\tcv_cape_emply_fem16_lbr_frce,\n\tcv_cape_etnc_hh_nonhisp_whte_only,\n\tcv_cape_etnc_pop_black_only_hisp,\n\tcv_cape_etnc_pop_non_hispanic,\n\tcv_cape_etnc_pop_white_only_hisp,\n\tcv_cape_inc_hh_inc_under_10k,\n\tcv_cape_inc_hh_inc_10_14k,\n\tcv_cape_inc_hh_inc_15_19k,\n\tcv_cape_inc_hh_inc_20_24k,\n\tcv_cape_inc_hh_inc_25_29k,\n\tcv_cape_inc_hh_inc_30_34k,\n\tcv_cape_inc_hh_inc_35_39k,\n\tcv_cape_inc_hh_inc_40_44k,\n\tcv_cape_inc_hh_inc_45_49k,\n\tcv_cape_inc_hh_inc_50_59k,\n\tcv_cape_inc_hh_inc_60_74k,\n\tcv_cape_inc_hh_inc_75_99k,\n\tcv_cape_inc_hh_inc_100_124k,\n\tcv_cape_inc_hh_inc_125_149k,\n\tcv_cape_inc_hh_inc_150_199k,\n\tcv_cape_inc_hh_inc_200_249k,\n\tcv_cape_inc_hh_inc_250_499k,\n\tcv_cape_inc_hh_incm_500k_more,\n\tcv_cape_inc_hh_med_hh_inc,\n\tcv_cape_inc_hh_med_non_fam_hh_inc,\n\tcv_cape_inc_pop_per_capita_income,\n\tcv_cape_ind_empld_acmdn_food_svcs,\n\tcv_cape_ind_empld_adm_supwstemgmt,\n\tcv_cape_ind_empld_agr_fst_fsh_hnt,\n\tcv_cape_ind_empld_arts_entmnt,\n\tcv_cape_indus_empld_construction,\n\tcv_cape_ind_empld_edu_srvs,\n\tcv_cape_ind_empld_fin_and_ins,\n\tcv_cape_indus_empld_hc_soc_ass,\n\tcv_cape_indus_empld_information,\n\tcv_cape_indus_empld_manufacturing,\n\tcv_cape_ind_empld_mgmt_com_entrps,\n\tcv_cape_indus_empld_mining,\n\tcv_cape_ind_empld_oth_svcs,\n\tcv_cape_ind_empld_public_admin,\n\tcv_cape_ind_empld_rer_lsng,\n\tcv_cape_indus_empld_retail_trade,\n\tcv_cape_ind_empld_prof_sc_tch_scs,\n\tcv_cape_ind_empld_trans_wh,\n\tcv_cape_indus_empld_utilities,\n\tcv_cape_ind_empld_wholesale_trade,\n\tcv_cape_mrtg_oohu_first_mrtg_only,\n\tcv_cape_move_occhu_med_len_res,\n\tcv_cape_rent_rntl_median_rent,\n\tcv_cape_tenancy_hu_occupied,\n\tcv_cape_typ_pop_child_in_fam_hh,\n\tcv_cape_typ_pop_in_family_hh,\n\tcv_cape_typ_pop_in_non_family_hh,\n\tcv_cape_pop_nat_adpt_child_fam_hh,\n\tcv_cape_typ_pop_spouse_in_fam_hh,\n\tcv_cape_urban_pop_rural_on_farms,\n\tcv_cape_urban_pop_rur_not_on_frms,\n\tcv_cape_urban_pop_in_urban_area,\n\tcv_cape_urban_pop_in_urban_clstrs,\n\tcv_cape_inc_fam_inc_state_indx,\n\tcv_prop_rlty_home_year_built,\n\tcv_mrtg_home_pur_mrtg_term,\n\tcv_mrtg_home_pur_home_pur_date,\n\tcv_mrtg_home_pur_mrtg_rate_type,\n\tcv_mrtg_home_pur_mrtg_loan_type,\n\tcv_mrtg_home_purc_type_of_purc,\n\tcv_mrtg_home_pur_pur_amt_rng,\n\tcv_mrtg_home_pur_mrtg_amt_rng,\n\tcv_rlty_mdl_confdnce_cdv2,\n\tcv_rlty_mdl_est_avl_equity_cd_v2,\n\tcv_rlty_mdl_est_avl_equity_amt_v2,\n\tcv_rlty_mdl_est_cur_lntoval_ratv2,\n\tcv_rlty_mdl_est_cur_mrtg_pmtv21,\n\tcv_rlty_mdl_est_cur_mrtg_pmtv22,\n\tcv_rlty_mdl_est_cur_mrtg_amtcdv2,\n\tcv_rlty_mdl_est_cur_mrtg_am_v2,\n\tgeo_zipcode,\n\tCASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_kroger_banner END AS geo_kroger_banner,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_kroger END AS geo_all_other_kroger,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_albertsons_safeway END AS geo_albertsons_safeway,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_publix END AS geo_publix,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_ahold_delhaize END AS geo_ahold_delhaize,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_wakefern END AS geo_wakefern,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_hy_vee END AS geo_hy_vee,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_heb END AS geo_heb,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_whole_foods END AS geo_whole_foods,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_aldi END AS geo_aldi,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_trader_joes END AS geo_trader_joes,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_bi_lo END AS geo_bi_lo,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_grocery END AS geo_all_other_grocery,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_cvs END AS geo_cvs,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_walgreens END AS geo_walgreens,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_drug END AS geo_all_other_drug,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_target END AS geo_target,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_wm_neighborhood_market END AS geo_wm_neighborhood_market,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_walmart END AS geo_all_other_walmart,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_mass END AS geo_all_other_mass,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_costco END AS geo_costco,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_bjs END AS geo_bjs,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_sams_club END AS geo_sams_club,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_club END AS geo_all_other_club,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_total_c_and_g END AS geo_total_c_and_g,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_7_eleven END AS geo_7_eleven,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_circle_k END AS geo_circle_k,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_speedway END AS geo_speedway,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_c_and_g END AS geo_all_other_c_and_g,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_dollar_general END AS geo_dollar_general,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_family_dollar END AS geo_family_dollar,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_dollar END AS geo_all_other_dollar,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_amazon_com END AS geo_amazon_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_walmart_com END AS geo_walmart_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_all_other_ao END AS geo_all_other_ao,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE geo_not_assigned END AS geo_not_assigned,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE _7_eleven END AS is_7_eleven,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE ahold_delhaize END AS is_ahold_delhaize,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE albertsons END AS is_albertsons,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE aldi END AS is_aldi,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE amazon_com END AS is_amazon_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE bi_lo END AS is_bi_lo,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE bjs END AS is_bjs,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE circle_k END AS is_circle_k,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE costco END AS is_costco,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE cvs END AS is_cvs,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE dollar_general END AS is_dollar_general,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE family_dollar END AS is_family_dollar,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE heb END AS is_heb,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE speedway END AS is_speedway,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE hy_vee END AS is_hy_vee,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE kroger_banner END AS is_kroger_banner,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_kroger END AS is_all_other_kroger,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_club END AS is_all_other_club,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_dollar END AS is_all_other_dollar,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_drug END AS is_all_other_drug,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_c_and_g END AS is_all_other_c_and_g,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_grocery END AS is_all_other_grocery,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_mass END AS is_all_other_mass,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE publix END AS is_publix,\n    --CASE WHEN geo_zipcode IS NULL THEN 0 ELSE  safeway  END AS --is_safeway,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE sams_club END AS is_sams_club,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE target END AS is_target,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE trader_joes END AS is_trader_joes,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE wakefern END AS is_wakefern,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE walgreens END AS is_walgreens,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE walmart_com END AS is_walmart_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE wm_neighborhood_market END AS is_wm_neighborhood_market,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE all_other_walmart END AS is_all_other_walmart,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE whole_foods END AS is_whole_foods,\n    0 AS is_all_other_ao,\n    0 AS is_not_assigned,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE target_com END AS is_target_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE kroger_com END AS is_kroger_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE kmart_com END AS is_kmart_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE walgreens_com END AS is_walgreens_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE samsclub_com END AS is_samsclub_com,\n    CASE WHEN geo_zipcode IS NULL THEN 0 ELSE costco_com END is_costco_com\nFROM {{ ref('exp_geo') }} AS expgeo\nLEFT OUTER JOIN {{ ref('is_hh_store_tc_transpose') }} AS ins ON expgeo.cv_living_unit_id = ins.luid", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "is", "exp_geo_is"], "unique_id": "model.sdna_project.exp_geo_is", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/is/exp_geo_is.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/is/exp_geo_is.sql", "name": "exp_geo_is", "resource_type": "model", "alias": "exp_geo_is", "checksum": {"name": "sha256", "checksum": "b9bdd99141bc81662fe82f2bff59611bd6427e9b0355da7e873934fce3766375"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo"], ["is_hh_store_tc_transpose"], ["exp_geo"], ["is_hh_store_tc_transpose"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo", "model.sdna_project.is_hh_store_tc_transpose", "model.sdna_project.exp_geo", "model.sdna_project.is_hh_store_tc_transpose"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_coeff_raw": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT\n    trim(store, '\"') as store,\n    is_intercept,\n    cv_act_digi_mag_buyer,\n    cv_bhvr_bnk_computers_u,\n    cv_bhvr_bnk_computers_y,\n    cv_bhvr_bnk_do_it_yourselfer_u,\n    cv_bhvr_bnk_do_it_yourselfer_y,\n    cv_bhvr_bnk_hi_tech_owner_u,\n    cv_bhvr_bnk_hi_tech_owner_y,\n    cv_bhvr_bnk_internet_online_subs_u,\n    cv_bhvr_bnk_internet_online_subs_y,\n    cv_bhvr_bnk_intrst_crafts_u,\n    cv_bhvr_bnk_intrst_crafts_y,\n    cv_bhvr_bnk_intrst_grmt_cooking_u,\n    cv_bhvr_bnk_intrst_grmt_cooking_y,\n    cv_bhvr_bnk_pres_of_credit_card_u,\n    cv_bhvr_bnk_pres_of_credit_card_y,\n    cv_buyer_coupon_users,\n    cv_buyer_lap_own,\n    cv_buyer_lux_store_shopp,\n    cv_buyer_nonpres_makeup_usr,\n    cv_buyer_supercenter_shopp,\n    cv_buyer_tab_own,\n    cv_buyer_warehouse_club_mem,\n    cv_buyer_yng_adult_cloth_shopp,\n    cv_cape_age_pop_0_17,\n    cv_cape_age_pop_0_24,\n    cv_cape_age_pop_0_9,\n    cv_cape_age_pop_18_65,\n    cv_cape_age_pop_25_34,\n    cv_cape_age_pop_35_44,\n    cv_cape_age_pop_45_54,\n    cv_cape_age_pop_55_64,\n    cv_cape_age_pop_65_99,\n    cv_cape_age_pop_75_99,\n    cv_cape_age_pop_median_age,\n    cv_cape_avg_hh_size,\n    cv_cape_built_median_hous_age,\n    cv_cape_child_hh_fem_hh_fam_plt18,\n    cv_cape_child_hh_without_per_lt18,\n    cv_cape_child_wper_lt18,\n    cv_cape_cmte_com_travtowrk_60_89,\n    cv_cape_cmte_wrkrs_carpld_to_work,\n    cv_cape_cmter_avg_trav_timetowork,\n    cv_cape_edu_ispsa,\n    cv_cape_edu_ispsa_decile,\n    cv_cape_edu_pop25_med_edu_attain,\n    cv_cape_emply_fem16_lbr_frce,\n    cv_cape_ethnic_pop_asian_only,\n    cv_cape_ethnic_pop_black_only,\n    cv_cape_ethnic_pop_hispanic,\n    cv_cape_ethnic_pop_white_only,\n    cv_cape_etnc_hh_nonhisp_whte_only,\n    cv_cape_etnc_pop_black_only_hisp,\n    cv_cape_etnc_pop_white_only_hisp,\n    cv_cape_inc_fam_inc_state_indx,\n    cv_cape_inc_fam_state_decile,\n    cv_cape_inc_hh_inc_10_14k,\n    cv_cape_inc_hh_inc_100_124k,\n    cv_cape_inc_hh_inc_125_149k,\n    cv_cape_inc_hh_inc_15_19k,\n    cv_cape_inc_hh_inc_150_199k,\n    cv_cape_inc_hh_inc_20_24k,\n    cv_cape_inc_hh_inc_200_249k,\n    cv_cape_inc_hh_inc_25_29k,\n    cv_cape_inc_hh_inc_250_499k,\n    cv_cape_inc_hh_inc_30_34k,\n    cv_cape_inc_hh_inc_35_39k,\n    cv_cape_inc_hh_inc_40_44k,\n    cv_cape_inc_hh_inc_45_49k,\n    cv_cape_inc_hh_inc_50_59k,\n    cv_cape_inc_hh_inc_60_74k,\n    cv_cape_inc_hh_inc_75_99k,\n    cv_cape_inc_hh_inc_under_10k,\n    cv_cape_inc_hh_incm_500k_more,\n    cv_cape_inc_hh_med_hh_inc,\n    cv_cape_ind_empld_acmdn_food_svcs,\n    cv_cape_ind_empld_adm_supwstemgmt,\n    cv_cape_ind_empld_edu_srvs,\n    cv_cape_ind_empld_fin_and_ins,\n    cv_cape_ind_empld_public_admin,\n    cv_cape_ind_empld_trans_wh,\n    cv_cape_ind_empld_wholesale_trade,\n    cv_cape_indus_empld_construction,\n    cv_cape_indus_empld_hc_soc_ass,\n    cv_cape_indus_empld_information,\n    cv_cape_indus_empld_retail_trade,\n    cv_cape_lang_spanish_speak,\n    cv_cape_marr_couple_fam,\n    cv_cape_move_occhu_med_len_res,\n    cv_cape_mrtg_oohu_first_mrtg_only,\n    cv_cape_occhu_own_occu,\n    cv_cape_oohu_med_hme_val,\n    cv_cape_rent_rntl_median_rent,\n    cv_cape_tenancy_hu_occupied,\n    cv_cape_typ_pop_in_family_hh,\n    cv_cape_typ_pop_in_non_family_hh,\n    cv_cape_typ_pop_spouse_in_fam_hh,\n    cv_cape_urban_pop_in_urban_area,\n    cv_cbsa,\n    cv_cen_rur_urban_county_szcd_1,\n    cv_cen_rur_urban_county_szcd_2,\n    cv_cen_rur_urban_county_szcd_3,\n    cv_cen_rur_urban_county_szcd_4,\n    cv_cen_rur_urban_county_szcd_5,\n    cv_cen_rur_urban_county_szcd_6,\n    cv_cen_rur_urban_county_szcd_9,\n    cv_child_age_0_3_mdl_n,\n    cv_child_age_0_3_mdl_u,\n    cv_child_age_0_3_mdl_y,\n    cv_child_age_10_12_mdl_n,\n    cv_child_age_10_12_mdl_u,\n    cv_child_age_10_12_mdl_y,\n    cv_child_age_13_15_mdl_n,\n    cv_child_age_13_15_mdl_u,\n    cv_child_age_13_15_mdl_y,\n    cv_child_age_16_18_mdl_n,\n    cv_child_age_16_18_mdl_u,\n    cv_child_age_16_18_mdl_y,\n    cv_child_age_4_6_mdl_n,\n    cv_child_age_4_6_mdl_u,\n    cv_child_age_4_6_mdl_y,\n    cv_child_age_7_9_mdl_n,\n    cv_child_age_7_9_mdl_u,\n    cv_child_age_7_9_mdl_y,\n    cv_child_pres_0_18_n,\n    cv_child_pres_0_18_u,\n    cv_child_pres_0_18_y,\n    cv_cons_vw_proft,\n    cv_county_echv_index,\n    cv_county_echv_per,\n    cv_county_ehi_index,\n    cv_county_ehi_per,\n    cv_dwelling_type_m,\n    cv_dwelling_type_p,\n    cv_dwelling_type_s,\n    cv_dwelling_unit_size_a,\n    cv_dwelling_unit_size_b,\n    cv_dwelling_unit_size_c,\n    cv_dwelling_unit_size_d,\n    cv_dwelling_unit_size_e,\n    cv_dwelling_unit_size_f,\n    cv_dwelling_unit_size_g,\n    cv_dwelling_unit_size_h,\n    cv_dwelling_unit_size_i,\n    cv_est_curr_hme_val,\n    cv_est_hh_incv5_a,\n    cv_est_hh_incv5_b,\n    cv_est_hh_incv5_c,\n    cv_est_hh_incv5_d,\n    cv_est_hh_incv5_e,\n    cv_est_hh_incv5_f,\n    cv_est_hh_incv5_g,\n    cv_est_hh_incv5_h,\n    cv_est_hh_incv5_i,\n    cv_est_hh_incv5_j,\n    cv_est_hh_incv5_k,\n    cv_est_hh_incv5_l,\n    cv_est_inc_amtv5,\n    cv_green_aware,\n    cv_hh_finan_cds_money_mkt_u,\n    cv_hh_finan_cds_money_mkt_y,\n    cv_hh_finan_iras_currently_u,\n    cv_hh_finan_iras_currently_y,\n    cv_hh_finan_stks_bond_u,\n    cv_hh_finan_stks_bond_y,\n    cv_hh_ls_afltn_mem_book_club_u,\n    cv_hh_ls_afltn_mem_book_club_y,\n    cv_hh_ls_bi_home_garden_u,\n    cv_hh_ls_bi_home_garden_y,\n    cv_hh_ls_bi_sports_related_u,\n    cv_hh_ls_bi_sports_related_y,\n    cv_hh_ls_buying_intrst_comp_elec_u,\n    cv_hh_ls_buying_intrst_comp_elec_y,\n    cv_hh_ls_cc_amer_exp_prem_u,\n    cv_hh_ls_cc_amer_exp_prem_y,\n    cv_hh_ls_cc_amer_exp_regular_u,\n    cv_hh_ls_cc_amer_exp_regular_y,\n    cv_hh_ls_cc_discover_premium_u,\n    cv_hh_ls_cc_discover_premium_y,\n    cv_hh_ls_cc_discover_regular_u,\n    cv_hh_ls_cc_discover_regular_y,\n    cv_hh_ls_cc_mastercard_regular_u,\n    cv_hh_ls_cc_mastercard_regular_y,\n    cv_hh_ls_cc_other_card_premium_u,\n    cv_hh_ls_cc_other_card_premium_y,\n    cv_hh_ls_cc_other_card_regular_u,\n    cv_hh_ls_cc_other_card_regular_y,\n    cv_hh_ls_cc_store_ret_reg_u,\n    cv_hh_ls_cc_store_ret_reg_y,\n    cv_hh_ls_cc_visa_regular_u,\n    cv_hh_ls_cc_visa_regular_y,\n    cv_hh_ls_military_gov_vetern_u,\n    cv_hh_ls_military_gov_vetern_y,\n    cv_hmeown_comb_hmeown_renter_7,\n    cv_hmeown_comb_hmeown_renter_8,\n    cv_hmeown_comb_hmeown_renter_9,\n    cv_hmeown_comb_hmeown_renter_h,\n    cv_hmeown_comb_hmeown_renter_r,\n    cv_hmeown_comb_hmeown_renter_t,\n    cv_hmeown_comb_hmeown_renter_u,\n    cv_home_bus_u,\n    cv_home_bus_y,\n    cv_household_comp_a,\n    cv_household_comp_b,\n    cv_household_comp_c,\n    cv_household_comp_d,\n    cv_household_comp_e,\n    cv_household_comp_f,\n    cv_household_comp_g,\n    cv_household_comp_h,\n    cv_household_comp_i,\n    cv_household_comp_j,\n    cv_household_comp_u,\n    cv_incom_per_national,\n    cv_length_of_residence,\n    cv_lfstyl_interest_religion,\n    cv_lfstyl_lf_insure_plcy_hldr,\n    cv_lfstyl_med_insure_plcy_hldrs,\n    cv_lfstyl_medicare_plcy_hldrs,\n    cv_memship_aarp_mem,\n    cv_mor_bank_book,\n    cv_mor_bank_craft_merch,\n    cv_mor_bank_f_orient_mag,\n    cv_mor_bank_famgen_mag,\n    cv_mor_bank_gen_merch,\n    cv_mor_bank_gift_gadgs,\n    cv_mor_bank_health_fit_mag,\n    cv_mor_bank_health_inst_contib,\n    cv_mor_bank_misc,\n    cv_mor_bank_news_finan,\n    cv_mor_bank_odds_end,\n    cv_mor_bank_opp_seek_ce,\n    cv_mor_m,\n    cv_mor_u,\n    cv_mor_y,\n    cv_mosaic_glob_zip4_a,\n    cv_mosaic_glob_zip4_b,\n    cv_mosaic_glob_zip4_c,\n    cv_mosaic_glob_zip4_d,\n    cv_mosaic_glob_zip4_e,\n    cv_mosaic_glob_zip4_f,\n    cv_mosaic_glob_zip4_g,\n    cv_mosaic_glob_zip4_h,\n    cv_mosaic_glob_zip4_i,\n    cv_mosaic_glob_zip4_j,\n    cv_mrtg_home_purc_type_of_purc_n,\n    cv_mrtg_home_purc_type_of_purc_r,\n    cv_no_adults_unit,\n    cv_no_child_unit,\n    cv_p1_bus_own_u,\n    cv_p1_bus_own_y,\n    cv_p1_com_age,\n    cv_p1_edu_mdl_1,\n    cv_p1_edu_mdl_2,\n    cv_p1_edu_mdl_3,\n    cv_p1_edu_mdl_4,\n    cv_p1_edu_mdl_5,\n    cv_p1_gender_f,\n    cv_p1_gender_m,\n    cv_p1_gender_u,\n    cv_p1_health_well_being,\n    cv_p1_marital_st_m,\n    cv_p1_marital_st_s,\n    cv_p1_marital_st_u,\n    cv_p1_mobile_usrs,\n    cv_p1_mor_u,\n    cv_p1_mor_y,\n    cv_p1_occ_cd_2,\n    cv_p1_occ_cd_7,\n    cv_p1_occ_cd_9,\n    cv_p1_occ_cd_u,\n    cv_p1_occ_grp_1,\n    cv_p1_occ_grp_2,\n    cv_p1_occ_grp_3,\n    cv_p1_occ_grp_4,\n    cv_p1_occ_grp_5,\n    cv_p1_occ_grp_7,\n    cv_p1_occ_grp_8,\n    cv_p1_occ_grp_9,\n    cv_p1_tech_adoption,\n    cv_recp_reliable_cd_1,\n    cv_recp_reliable_cd_2,\n    cv_recp_reliable_cd_5,\n    cv_rlty_mdl_est_cur_lntoval_ratv2,\n    cv_state_cd_11,\n    cv_state_cd_12,\n    cv_state_cd_16,\n    cv_state_cd_17,\n    cv_state_cd_18,\n    cv_state_cd_2,\n    cv_state_cd_20,\n    cv_state_cd_21,\n    cv_state_cd_23,\n    cv_state_cd_24,\n    cv_state_cd_25,\n    cv_state_cd_26,\n    cv_state_cd_27,\n    cv_state_cd_28,\n    cv_state_cd_33,\n    cv_state_cd_35,\n    cv_state_cd_36,\n    cv_state_cd_38,\n    cv_state_cd_39,\n    cv_state_cd_4,\n    cv_state_cd_41,\n    cv_state_cd_44,\n    cv_state_cd_46,\n    cv_state_cd_47,\n    cv_state_cd_49,\n    cv_state_cd_50,\n    cv_state_cd_51,\n    cv_state_cd_54,\n    cv_state_cd_56,\n    cv_state_cd_6,\n    cv_state_cd_8,\n    cv_state_cd_9,\n    cv_state_ehi_index,\n    cv_tme_zn_1,\n    cv_tme_zn_2,\n    cv_tme_zn_3,\n    cv_tme_zn_4,\n    cv_tme_zn_9,\n    cv_tt_brick_mortar,\n    cv_tt_broadcast_cable_tv,\n    cv_tt_buy_american,\n    cv_tt_direct_mail,\n    cv_tt_etailer,\n    cv_tt_go_with_flow,\n    cv_tt_internet_radio,\n    cv_tt_its_all_in_name,\n    cv_tt_look_at_me_now,\n    cv_tt_mobile_display,\n    cv_tt_mobile_video,\n    cv_tt_never_empty_handed,\n    cv_tt_no_time_like_present,\n    cv_tt_on_road_again,\n    cv_tt_onlie_mid_high,\n    cv_tt_online_bid_mrktplc,\n    cv_tt_online_discount,\n    cv_tt_online_display,\n    cv_tt_online_stream_tv,\n    cv_tt_online_video,\n    cv_tt_penny_saved_penny_earned,\n    cv_tt_satellite_radio,\n    cv_tt_showme_money,\n    cv_tt_stop_smell_roses,\n    cv_tt_wrk_hard_play_hard,\n    geo_7_eleven,\n    geo_ahold_delhaize,\n    geo_albertsons_safeway,\n    geo_aldi,\n    geo_all_other_ao,\n    geo_all_other_c_and_g,\n    geo_all_other_club,\n    geo_all_other_dollar,\n    geo_all_other_drug,\n    geo_all_other_grocery,\n    geo_all_other_kroger,\n    geo_all_other_mass,\n    geo_all_other_walmart,\n    geo_bi_lo,\n    geo_bjs,\n    geo_circle_k,\n    geo_costco,\n    geo_cvs,\n    geo_dollar_general,\n    geo_family_dollar,\n    geo_heb,\n    geo_hy_vee,\n    geo_kroger_banner,\n    geo_not_assigned,\n    geo_publix,\n    geo_sams_club,\n    geo_speedway,\n    geo_target,\n    geo_total_c_and_g,\n    geo_trader_joes,\n    geo_wakefern,\n    geo_walgreens,\n    geo_whole_foods,\n    geo_wm_neighborhood_market,\n    last_updt_dt\nFROM {{ ref('is_coeff_raw_stg') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "is", "is_coeff_raw"], "unique_id": "model.sdna_project.is_coeff_raw", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/is/is_coeff_raw.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/is/is_coeff_raw.sql", "name": "is_coeff_raw", "resource_type": "model", "alias": "is_coeff_raw", "checksum": {"name": "sha256", "checksum": "b38114ea11a13482eb8f286d4efb374f9e5de886246cc3c5736d78ed03a5bea9"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["is_coeff_raw_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.is_coeff_raw_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "view", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_hh_store_tc": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load is_hh_store_tc\n\n-- {{ ref('is_hh_transpose') }}\n-- {{ ref('is_coeff_raw') }}\n-- {{ ref('is_means_raw') }}\n\nSELECT\n    hh.cv_living_unit_id as luid,\n    ce.store,\n    ce.is_intercept +\n        (\n            ce.cv_act_digi_mag_buyer  *( hh.cv_act_digi_mag_buyer  - im.cv_act_digi_mag_buyer )\n            + ce.cv_bhvr_bnk_computers_U  *( hh.cv_bhvr_bnk_computers_U  - im.cv_bhvr_bnk_computers_U )\n            + ce.cv_bhvr_bnk_computers_Y  *( hh.cv_bhvr_bnk_computers_Y  - im.cv_bhvr_bnk_computers_Y )\n            + ce.cv_bhvr_bnk_do_it_yourselfer_U  *( hh.cv_bhvr_bnk_do_it_yourselfer_U  - im.cv_bhvr_bnk_do_it_yourselfer_U )\n            + ce.cv_bhvr_bnk_do_it_yourselfer_Y  *( hh.cv_bhvr_bnk_do_it_yourselfer_Y  - im.cv_bhvr_bnk_do_it_yourselfer_Y )\n            + ce.cv_bhvr_bnk_hi_tech_owner_U  *( hh.cv_bhvr_bnk_hi_tech_owner_U  - im.cv_bhvr_bnk_hi_tech_owner_U )\n            + ce.cv_bhvr_bnk_hi_tech_owner_Y  *( hh.cv_bhvr_bnk_hi_tech_owner_Y  - im.cv_bhvr_bnk_hi_tech_owner_Y )\n            + ce.cv_bhvr_bnk_internet_online_subs_U  *( hh.cv_bhvr_bnk_internet_online_subs_U  - im.cv_bhvr_bnk_internet_online_subs_U )\n            + ce.cv_bhvr_bnk_internet_online_subs_Y  *( hh.cv_bhvr_bnk_internet_online_subs_Y  - im.cv_bhvr_bnk_internet_online_subs_Y )\n            + ce.cv_bhvr_bnk_intrst_crafts_U  *( hh.cv_bhvr_bnk_intrst_crafts_U  - im.cv_bhvr_bnk_intrst_crafts_U )\n            + ce.cv_bhvr_bnk_intrst_crafts_Y  *( hh.cv_bhvr_bnk_intrst_crafts_Y  - im.cv_bhvr_bnk_intrst_crafts_Y )\n            + ce.cv_bhvr_bnk_intrst_grmt_cooking_U  *( hh.cv_bhvr_bnk_intrst_grmt_cooking_U  - im.cv_bhvr_bnk_intrst_grmt_cooking_U )\n            + ce.cv_bhvr_bnk_intrst_grmt_cooking_Y  *( hh.cv_bhvr_bnk_intrst_grmt_cooking_Y  - im.cv_bhvr_bnk_intrst_grmt_cooking_Y )\n            + ce.cv_bhvr_bnk_pres_of_credit_card_U  *( hh.cv_bhvr_bnk_pres_of_credit_card_U  - im.cv_bhvr_bnk_pres_of_credit_card_U )\n            + ce.cv_bhvr_bnk_pres_of_credit_card_Y  *( hh.cv_bhvr_bnk_pres_of_credit_card_Y  - im.cv_bhvr_bnk_pres_of_credit_card_Y )\n            + ce.cv_buyer_coupon_users  *( hh.cv_buyer_coupon_users  - im.cv_buyer_coupon_users )\n            + ce.cv_buyer_lap_own  *( hh.cv_buyer_lap_own  - im.cv_buyer_lap_own )\n            + ce.cv_buyer_lux_store_shopp  *( hh.cv_buyer_lux_store_shopp  - im.cv_buyer_lux_store_shopp )\n            + ce.cv_buyer_nonpres_makeup_usr  *( hh.cv_buyer_nonpres_makeup_usr  - im.cv_buyer_nonpres_makeup_usr )\n            + ce.cv_buyer_supercenter_shopp  *( hh.cv_buyer_supercenter_shopp  - im.cv_buyer_supercenter_shopp )\n            + ce.cv_buyer_tab_own  *( hh.cv_buyer_tab_own  - im.cv_buyer_tab_own )\n            + ce.cv_buyer_warehouse_club_mem  *( hh.cv_buyer_warehouse_club_mem  - im.cv_buyer_warehouse_club_mem )\n            + ce.cv_buyer_yng_adult_cloth_shopp  *( hh.cv_buyer_yng_adult_cloth_shopp  - im.cv_buyer_yng_adult_cloth_shopp )\n            + ce.cv_cape_age_pop_0_17  *( hh.cv_cape_age_pop_0_17  - im.cv_cape_age_pop_0_17 )\n            + ce.cv_cape_age_pop_0_24  *( hh.cv_cape_age_pop_0_24  - im.cv_cape_age_pop_0_24 )\n            + ce.cv_cape_age_pop_0_9  *( hh.cv_cape_age_pop_0_9  - im.cv_cape_age_pop_0_9 )\n            + ce.cv_cape_age_pop_18_65  *( hh.cv_cape_age_pop_18_65  - im.cv_cape_age_pop_18_65 )\n            + ce.cv_cape_age_pop_25_34  *( hh.cv_cape_age_pop_25_34  - im.cv_cape_age_pop_25_34 )\n            + ce.cv_cape_age_pop_35_44  *( hh.cv_cape_age_pop_35_44  - im.cv_cape_age_pop_35_44 )\n            + ce.cv_cape_age_pop_45_54  *( hh.cv_cape_age_pop_45_54  - im.cv_cape_age_pop_45_54 )\n            + ce.cv_cape_age_pop_55_64  *( hh.cv_cape_age_pop_55_64  - im.cv_cape_age_pop_55_64 )\n            + ce.cv_cape_age_pop_65_99  *( hh.cv_cape_age_pop_65_99  - im.cv_cape_age_pop_65_99 )\n            + ce.cv_cape_age_pop_75_99  *( hh.cv_cape_age_pop_75_99  - im.cv_cape_age_pop_75_99 )\n            + ce.cv_cape_age_pop_median_age  *( hh.cv_cape_age_pop_median_age  - im.cv_cape_age_pop_median_age )\n            + ce.cv_cape_avg_hh_size  *( hh.cv_cape_avg_hh_size  - im.cv_cape_avg_hh_size )\n            + ce.cv_cape_built_median_hous_age  *( hh.cv_cape_built_median_hous_age  - im.cv_cape_built_median_hous_age )\n            + ce.cv_cape_child_hh_fem_hh_fam_plt18  *( hh.cv_cape_child_hh_fem_hh_fam_plt18  - im.cv_cape_child_hh_fem_hh_fam_plt18 )\n            + ce.cv_cape_child_hh_without_per_lt18  *( hh.cv_cape_child_hh_without_per_lt18  - im.cv_cape_child_hh_without_per_lt18 )\n            + ce.cv_cape_child_wper_lt18  *( hh.cv_cape_child_wper_lt18  - im.cv_cape_child_wper_lt18 )\n            + ce.cv_cape_cmte_com_travtowrk_60_89  *( hh.cv_cape_cmte_com_travtowrk_60_89  - im.cv_cape_cmte_com_travtowrk_60_89 )\n            + ce.cv_cape_cmte_wrkrs_carpld_to_work  *( hh.cv_cape_cmte_wrkrs_carpld_to_work  - im.cv_cape_cmte_wrkrs_carpld_to_work )\n            + ce.cv_cape_cmter_avg_trav_timetowork  *( hh.cv_cape_cmter_avg_trav_timetowork  - im.cv_cape_cmter_avg_trav_timetowork )\n            + ce.cv_cape_edu_ispsa  *( hh.cv_cape_edu_ispsa  - im.cv_cape_edu_ispsa )\n            + ce.cv_cape_edu_ispsa_decile  *( hh.cv_cape_edu_ispsa_decile  - im.cv_cape_edu_ispsa_decile )\n            + ce.cv_cape_edu_pop25_med_edu_attain  *( hh.cv_cape_edu_pop25_med_edu_attain  - im.cv_cape_edu_pop25_med_edu_attain )\n            + ce.cv_cape_emply_fem16_lbr_frce  *( hh.cv_cape_emply_fem16_lbr_frce  - im.cv_cape_emply_fem16_lbr_frce )\n            + ce.cv_cape_ethnic_pop_asian_only  *( hh.cv_cape_ethnic_pop_asian_only  - im.cv_cape_ethnic_pop_asian_only )\n            + ce.cv_cape_ethnic_pop_black_only  *( hh.cv_cape_ethnic_pop_black_only  - im.cv_cape_ethnic_pop_black_only )\n            + ce.cv_cape_ethnic_pop_hispanic  *( hh.cv_cape_ethnic_pop_hispanic  - im.cv_cape_ethnic_pop_hispanic )\n            + ce.cv_cape_ethnic_pop_white_only  *( hh.cv_cape_ethnic_pop_white_only  - im.cv_cape_ethnic_pop_white_only )\n            + ce.cv_cape_etnc_hh_nonhisp_whte_only  *( hh.cv_cape_etnc_hh_nonhisp_whte_only  - im.cv_cape_etnc_hh_nonhisp_whte_only )\n            + ce.cv_cape_etnc_pop_black_only_hisp  *( hh.cv_cape_etnc_pop_black_only_hisp  - im.cv_cape_etnc_pop_black_only_hisp )\n            + ce.cv_cape_etnc_pop_white_only_hisp  *( hh.cv_cape_etnc_pop_white_only_hisp  - im.cv_cape_etnc_pop_white_only_hisp )\n            + ce.cv_cape_inc_fam_inc_state_indx  *( hh.cv_cape_inc_fam_inc_state_indx  - im.cv_cape_inc_fam_inc_state_indx )\n            + ce.cv_cape_inc_fam_state_decile  *( hh.cv_cape_inc_fam_state_decile  - im.cv_cape_inc_fam_state_decile )\n            + ce.cv_cape_inc_hh_inc_10_14k  *( hh.cv_cape_inc_hh_inc_10_14k  - im.cv_cape_inc_hh_inc_10_14k )\n            + ce.cv_cape_inc_hh_inc_100_124k  *( hh.cv_cape_inc_hh_inc_100_124k  - im.cv_cape_inc_hh_inc_100_124k )\n            + ce.cv_cape_inc_hh_inc_125_149k  *( hh.cv_cape_inc_hh_inc_125_149k  - im.cv_cape_inc_hh_inc_125_149k )\n            + ce.cv_cape_inc_hh_inc_15_19k  *( hh.cv_cape_inc_hh_inc_15_19k  - im.cv_cape_inc_hh_inc_15_19k )\n            + ce.cv_cape_inc_hh_inc_150_199k  *( hh.cv_cape_inc_hh_inc_150_199k  - im.cv_cape_inc_hh_inc_150_199k )\n            + ce.cv_cape_inc_hh_inc_20_24k  *( hh.cv_cape_inc_hh_inc_20_24k  - im.cv_cape_inc_hh_inc_20_24k )\n            + ce.cv_cape_inc_hh_inc_200_249k  *( hh.cv_cape_inc_hh_inc_200_249k  - im.cv_cape_inc_hh_inc_200_249k )\n            + ce.cv_cape_inc_hh_inc_25_29k  *( hh.cv_cape_inc_hh_inc_25_29k  - im.cv_cape_inc_hh_inc_25_29k )\n            + ce.cv_cape_inc_hh_inc_250_499k  *( hh.cv_cape_inc_hh_inc_250_499k  - im.cv_cape_inc_hh_inc_250_499k )\n            + ce.cv_cape_inc_hh_inc_30_34k  *( hh.cv_cape_inc_hh_inc_30_34k  - im.cv_cape_inc_hh_inc_30_34k )\n            + ce.cv_cape_inc_hh_inc_35_39k  *( hh.cv_cape_inc_hh_inc_35_39k  - im.cv_cape_inc_hh_inc_35_39k )\n            + ce.cv_cape_inc_hh_inc_40_44k  *( hh.cv_cape_inc_hh_inc_40_44k  - im.cv_cape_inc_hh_inc_40_44k )\n            + ce.cv_cape_inc_hh_inc_45_49k  *( hh.cv_cape_inc_hh_inc_45_49k  - im.cv_cape_inc_hh_inc_45_49k )\n            + ce.cv_cape_inc_hh_inc_50_59k  *( hh.cv_cape_inc_hh_inc_50_59k  - im.cv_cape_inc_hh_inc_50_59k )\n            + ce.cv_cape_inc_hh_inc_60_74k  *( hh.cv_cape_inc_hh_inc_60_74k  - im.cv_cape_inc_hh_inc_60_74k )\n            + ce.cv_cape_inc_hh_inc_75_99k  *( hh.cv_cape_inc_hh_inc_75_99k  - im.cv_cape_inc_hh_inc_75_99k )\n            + ce.cv_cape_inc_hh_inc_under_10k  *( hh.cv_cape_inc_hh_inc_under_10k  - im.cv_cape_inc_hh_inc_under_10k )\n            + ce.cv_cape_inc_hh_incm_500k_more  *( hh.cv_cape_inc_hh_incm_500k_more  - im.cv_cape_inc_hh_incm_500k_more )\n            + ce.cv_cape_inc_hh_med_hh_inc  *( hh.cv_cape_inc_hh_med_hh_inc  - im.cv_cape_inc_hh_med_hh_inc )\n            + ce.cv_cape_ind_empld_acmdn_food_svcs  *( hh.cv_cape_ind_empld_acmdn_food_svcs  - im.cv_cape_ind_empld_acmdn_food_svcs )\n            + ce.cv_cape_ind_empld_adm_supwstemgmt  *( hh.cv_cape_ind_empld_adm_supwstemgmt  - im.cv_cape_ind_empld_adm_supwstemgmt )\n            + ce.cv_cape_ind_empld_edu_srvs  *( hh.cv_cape_ind_empld_edu_srvs  - im.cv_cape_ind_empld_edu_srvs )\n            + ce.cv_cape_ind_empld_fin_and_ins  *( hh.cv_cape_ind_empld_fin_and_ins  - im.cv_cape_ind_empld_fin_and_ins )\n            + ce.cv_cape_ind_empld_public_admin  *( hh.cv_cape_ind_empld_public_admin  - im.cv_cape_ind_empld_public_admin )\n            + ce.cv_cape_ind_empld_trans_wh  *( hh.cv_cape_ind_empld_trans_wh  - im.cv_cape_ind_empld_trans_wh )\n            + ce.cv_cape_ind_empld_wholesale_trade  *( hh.cv_cape_ind_empld_wholesale_trade  - im.cv_cape_ind_empld_wholesale_trade )\n            + ce.cv_cape_indus_empld_construction  *( hh.cv_cape_indus_empld_construction  - im.cv_cape_indus_empld_construction )\n            + ce.cv_cape_indus_empld_hc_soc_ass  *( hh.cv_cape_indus_empld_hc_soc_ass  - im.cv_cape_indus_empld_hc_soc_ass )\n            + ce.cv_cape_indus_empld_information  *( hh.cv_cape_indus_empld_information  - im.cv_cape_indus_empld_information )\n            + ce.cv_cape_indus_empld_retail_trade  *( hh.cv_cape_indus_empld_retail_trade  - im.cv_cape_indus_empld_retail_trade )\n            + ce.cv_cape_lang_spanish_speak  *( hh.cv_cape_lang_spanish_speak  - im.cv_cape_lang_spanish_speak )\n            + ce.cv_cape_marr_couple_fam  *( hh.cv_cape_marr_couple_fam  - im.cv_cape_marr_couple_fam )\n            + ce.cv_cape_move_occhu_med_len_res  *( hh.cv_cape_move_occhu_med_len_res  - im.cv_cape_move_occhu_med_len_res )\n            + ce.cv_cape_mrtg_oohu_first_mrtg_only  *( hh.cv_cape_mrtg_oohu_first_mrtg_only  - im.cv_cape_mrtg_oohu_first_mrtg_only )\n            + ce.cv_cape_occhu_own_occu  *( hh.cv_cape_occhu_own_occu  - im.cv_cape_occhu_own_occu )\n            + ce.cv_cape_oohu_med_hme_val  *( hh.cv_cape_oohu_med_hme_val  - im.cv_cape_oohu_med_hme_val )\n            + ce.cv_cape_rent_rntl_median_rent  *( hh.cv_cape_rent_rntl_median_rent  - im.cv_cape_rent_rntl_median_rent )\n            + ce.cv_cape_tenancy_hu_occupied  *( hh.cv_cape_tenancy_hu_occupied  - im.cv_cape_tenancy_hu_occupied )\n            + ce.cv_cape_typ_pop_in_family_hh  *( hh.cv_cape_typ_pop_in_family_hh  - im.cv_cape_typ_pop_in_family_hh )\n            + ce.cv_cape_typ_pop_in_non_family_hh  *( hh.cv_cape_typ_pop_in_non_family_hh  - im.cv_cape_typ_pop_in_non_family_hh )\n            + ce.cv_cape_typ_pop_spouse_in_fam_hh  *( hh.cv_cape_typ_pop_spouse_in_fam_hh  - im.cv_cape_typ_pop_spouse_in_fam_hh )\n            + ce.cv_cape_urban_pop_in_urban_area  *( hh.cv_cape_urban_pop_in_urban_area  - im.cv_cape_urban_pop_in_urban_area )\n            + ce.cv_cbsa  *( hh.cv_cbsa  - im.cv_cbsa )\n            + ce.cv_cen_rur_urban_county_szcd_1  *( hh.cv_cen_rur_urban_county_szcd_1  - im.cv_cen_rur_urban_county_szcd_1 )\n            + ce.cv_cen_rur_urban_county_szcd_2  *( hh.cv_cen_rur_urban_county_szcd_2  - im.cv_cen_rur_urban_county_szcd_2 )\n            + ce.cv_cen_rur_urban_county_szcd_3  *( hh.cv_cen_rur_urban_county_szcd_3  - im.cv_cen_rur_urban_county_szcd_3 )\n            + ce.cv_cen_rur_urban_county_szcd_4  *( hh.cv_cen_rur_urban_county_szcd_4  - im.cv_cen_rur_urban_county_szcd_4 )\n            + ce.cv_cen_rur_urban_county_szcd_5  *( hh.cv_cen_rur_urban_county_szcd_5  - im.cv_cen_rur_urban_county_szcd_5 )\n            + ce.cv_cen_rur_urban_county_szcd_6  *( hh.cv_cen_rur_urban_county_szcd_6  - im.cv_cen_rur_urban_county_szcd_6 )\n            + ce.cv_cen_rur_urban_county_szcd_9  *( hh.cv_cen_rur_urban_county_szcd_9  - im.cv_cen_rur_urban_county_szcd_9 )\n            + ce.cv_child_age_0_3_mdl_N  *( hh.cv_child_age_0_3_mdl_N  - im.cv_child_age_0_3_mdl_N )\n            + ce.cv_child_age_0_3_mdl_U  *( hh.cv_child_age_0_3_mdl_U  - im.cv_child_age_0_3_mdl_U )\n            + ce.cv_child_age_0_3_mdl_Y  *( hh.cv_child_age_0_3_mdl_Y  - im.cv_child_age_0_3_mdl_Y )\n            + ce.cv_child_age_10_12_mdl_N  *( hh.cv_child_age_10_12_mdl_N  - im.cv_child_age_10_12_mdl_N )\n            + ce.cv_child_age_10_12_mdl_U  *( hh.cv_child_age_10_12_mdl_U  - im.cv_child_age_10_12_mdl_U )\n            + ce.cv_child_age_10_12_mdl_Y  *( hh.cv_child_age_10_12_mdl_Y  - im.cv_child_age_10_12_mdl_Y )\n            + ce.cv_child_age_13_15_mdl_N  *( hh.cv_child_age_13_15_mdl_N  - im.cv_child_age_13_15_mdl_N )\n            + ce.cv_child_age_13_15_mdl_U  *( hh.cv_child_age_13_15_mdl_U  - im.cv_child_age_13_15_mdl_U )\n            + ce.cv_child_age_13_15_mdl_Y  *( hh.cv_child_age_13_15_mdl_Y  - im.cv_child_age_13_15_mdl_Y )\n            + ce.cv_child_age_16_18_mdl_N  *( hh.cv_child_age_16_18_mdl_N  - im.cv_child_age_16_18_mdl_N )\n            + ce.cv_child_age_16_18_mdl_U  *( hh.cv_child_age_16_18_mdl_U  - im.cv_child_age_16_18_mdl_U )\n            + ce.cv_child_age_16_18_mdl_Y  *( hh.cv_child_age_16_18_mdl_Y  - im.cv_child_age_16_18_mdl_Y )\n            + ce.cv_child_age_4_6_mdl_N  *( hh.cv_child_age_4_6_mdl_N  - im.cv_child_age_4_6_mdl_N )\n            + ce.cv_child_age_4_6_mdl_U  *( hh.cv_child_age_4_6_mdl_U  - im.cv_child_age_4_6_mdl_U )\n            + ce.cv_child_age_4_6_mdl_Y  *( hh.cv_child_age_4_6_mdl_Y  - im.cv_child_age_4_6_mdl_Y )\n            + ce.cv_child_age_7_9_mdl_N  *( hh.cv_child_age_7_9_mdl_N  - im.cv_child_age_7_9_mdl_N )\n            + ce.cv_child_age_7_9_mdl_U  *( hh.cv_child_age_7_9_mdl_U  - im.cv_child_age_7_9_mdl_U )\n            + ce.cv_child_age_7_9_mdl_Y  *( hh.cv_child_age_7_9_mdl_Y  - im.cv_child_age_7_9_mdl_Y )\n            + ce.cv_child_pres_0_18_N  *( hh.cv_child_pres_0_18_N  - im.cv_child_pres_0_18_N )\n            + ce.cv_child_pres_0_18_U  *( hh.cv_child_pres_0_18_U  - im.cv_child_pres_0_18_U )\n            + ce.cv_child_pres_0_18_Y  *( hh.cv_child_pres_0_18_Y  - im.cv_child_pres_0_18_Y )\n            + ce.cv_cons_vw_proft  *( hh.cv_cons_vw_proft  - im.cv_cons_vw_proft )\n            + ce.cv_county_echv_index  *( hh.cv_county_echv_index  - im.cv_county_echv_index )\n            + ce.cv_county_echv_per  *( hh.cv_county_echv_per  - im.cv_county_echv_per )\n            + ce.cv_county_ehi_index  *( hh.cv_county_ehi_index  - im.cv_county_ehi_index )\n            + ce.cv_county_ehi_per  *( hh.cv_county_ehi_per  - im.cv_county_ehi_per )\n            + ce.cv_dwelling_type_M  *( hh.cv_dwelling_type_M  - im.cv_dwelling_type_M )\n            + ce.cv_dwelling_type_P  *( hh.cv_dwelling_type_P  - im.cv_dwelling_type_P )\n            + ce.cv_dwelling_type_S  *( hh.cv_dwelling_type_S  - im.cv_dwelling_type_S )\n            + ce.cv_dwelling_unit_size_A  *( hh.cv_dwelling_unit_size_A  - im.cv_dwelling_unit_size_A )\n            + ce.cv_dwelling_unit_size_B  *( hh.cv_dwelling_unit_size_B  - im.cv_dwelling_unit_size_B )\n            + ce.cv_dwelling_unit_size_C  *( hh.cv_dwelling_unit_size_C  - im.cv_dwelling_unit_size_C )\n            + ce.cv_dwelling_unit_size_D  *( hh.cv_dwelling_unit_size_D  - im.cv_dwelling_unit_size_D )\n            + ce.cv_dwelling_unit_size_E  *( hh.cv_dwelling_unit_size_E  - im.cv_dwelling_unit_size_E )\n            + ce.cv_dwelling_unit_size_F  *( hh.cv_dwelling_unit_size_F  - im.cv_dwelling_unit_size_F )\n            + ce.cv_dwelling_unit_size_G  *( hh.cv_dwelling_unit_size_G  - im.cv_dwelling_unit_size_G )\n            + ce.cv_dwelling_unit_size_H  *( hh.cv_dwelling_unit_size_H  - im.cv_dwelling_unit_size_H )\n            + ce.cv_dwelling_unit_size_I  *( hh.cv_dwelling_unit_size_I  - im.cv_dwelling_unit_size_I )\n            + ce.cv_est_curr_hme_val  *( hh.cv_est_curr_hme_val  - im.cv_est_curr_hme_val )\n            + ce.cv_est_hh_incv5_A  *( hh.cv_est_hh_incv5_A  - im.cv_est_hh_incv5_A )\n            + ce.cv_est_hh_incv5_B  *( hh.cv_est_hh_incv5_B  - im.cv_est_hh_incv5_B )\n            + ce.cv_est_hh_incv5_C  *( hh.cv_est_hh_incv5_C  - im.cv_est_hh_incv5_C )\n            + ce.cv_est_hh_incv5_D  *( hh.cv_est_hh_incv5_D  - im.cv_est_hh_incv5_D )\n            + ce.cv_est_hh_incv5_E  *( hh.cv_est_hh_incv5_E  - im.cv_est_hh_incv5_E )\n            + ce.cv_est_hh_incv5_F  *( hh.cv_est_hh_incv5_F  - im.cv_est_hh_incv5_F )\n            + ce.cv_est_hh_incv5_G  *( hh.cv_est_hh_incv5_G  - im.cv_est_hh_incv5_G )\n            + ce.cv_est_hh_incv5_H  *( hh.cv_est_hh_incv5_H  - im.cv_est_hh_incv5_H )\n            + ce.cv_est_hh_incv5_I  *( hh.cv_est_hh_incv5_I  - im.cv_est_hh_incv5_I )\n            + ce.cv_est_hh_incv5_J  *( hh.cv_est_hh_incv5_J  - im.cv_est_hh_incv5_J )\n            + ce.cv_est_hh_incv5_K  *( hh.cv_est_hh_incv5_K  - im.cv_est_hh_incv5_K )\n            + ce.cv_est_hh_incv5_L  *( hh.cv_est_hh_incv5_L  - im.cv_est_hh_incv5_L )\n            + ce.cv_est_inc_amtv5  *( hh.cv_est_inc_amtv5  - im.cv_est_inc_amtv5 )\n            + ce.cv_green_aware  *( hh.cv_green_aware  - im.cv_green_aware )\n            + ce.cv_hh_finan_cds_money_mkt_U  *( hh.cv_hh_finan_cds_money_mkt_U  - im.cv_hh_finan_cds_money_mkt_U )\n            + ce.cv_hh_finan_cds_money_mkt_Y  *( hh.cv_hh_finan_cds_money_mkt_Y  - im.cv_hh_finan_cds_money_mkt_Y )\n            + ce.cv_hh_finan_iras_currently_U  *( hh.cv_hh_finan_iras_currently_U  - im.cv_hh_finan_iras_currently_U )\n            + ce.cv_hh_finan_iras_currently_Y  *( hh.cv_hh_finan_iras_currently_Y  - im.cv_hh_finan_iras_currently_Y )\n            + ce.cv_hh_finan_stks_bond_U  *( hh.cv_hh_finan_stks_bond_U  - im.cv_hh_finan_stks_bond_U )\n            + ce.cv_hh_finan_stks_bond_Y  *( hh.cv_hh_finan_stks_bond_Y  - im.cv_hh_finan_stks_bond_Y )\n            + ce.cv_hh_ls_afltn_mem_book_club_U  *( hh.cv_hh_ls_afltn_mem_book_club_U  - im.cv_hh_ls_afltn_mem_book_club_U )\n            + ce.cv_hh_ls_afltn_mem_book_club_Y  *( hh.cv_hh_ls_afltn_mem_book_club_Y  - im.cv_hh_ls_afltn_mem_book_club_Y )\n            + ce.cv_hh_ls_bi_home_garden_U  *( hh.cv_hh_ls_bi_home_garden_U  - im.cv_hh_ls_bi_home_garden_U )\n            + ce.cv_hh_ls_bi_home_garden_Y  *( hh.cv_hh_ls_bi_home_garden_Y  - im.cv_hh_ls_bi_home_garden_Y )\n            + ce.cv_hh_ls_bi_sports_related_U  *( hh.cv_hh_ls_bi_sports_related_U  - im.cv_hh_ls_bi_sports_related_U )\n            + ce.cv_hh_ls_bi_sports_related_Y  *( hh.cv_hh_ls_bi_sports_related_Y  - im.cv_hh_ls_bi_sports_related_Y )\n            + ce.cv_hh_ls_buying_intrst_comp_elec_U  *( hh.cv_hh_ls_buying_intrst_comp_elec_U  - im.cv_hh_ls_buying_intrst_comp_elec_U )\n            + ce.cv_hh_ls_buying_intrst_comp_elec_Y  *( hh.cv_hh_ls_buying_intrst_comp_elec_Y  - im.cv_hh_ls_buying_intrst_comp_elec_Y )\n            + ce.cv_hh_ls_cc_amer_exp_prem_U  *( hh.cv_hh_ls_cc_amer_exp_prem_U  - im.cv_hh_ls_cc_amer_exp_prem_U )\n            + ce.cv_hh_ls_cc_amer_exp_prem_Y  *( hh.cv_hh_ls_cc_amer_exp_prem_Y  - im.cv_hh_ls_cc_amer_exp_prem_Y )\n            + ce.cv_hh_ls_cc_amer_exp_regular_U  *( hh.cv_hh_ls_cc_amer_exp_regular_U  - im.cv_hh_ls_cc_amer_exp_regular_U )\n            + ce.cv_hh_ls_cc_amer_exp_regular_Y  *( hh.cv_hh_ls_cc_amer_exp_regular_Y  - im.cv_hh_ls_cc_amer_exp_regular_Y )\n            + ce.cv_hh_ls_cc_discover_premium_U  *( hh.cv_hh_ls_cc_discover_premium_U  - im.cv_hh_ls_cc_discover_premium_U )\n            + ce.cv_hh_ls_cc_discover_premium_Y  *( hh.cv_hh_ls_cc_discover_premium_Y  - im.cv_hh_ls_cc_discover_premium_Y )\n            + ce.cv_hh_ls_cc_discover_regular_U  *( hh.cv_hh_ls_cc_discover_regular_U  - im.cv_hh_ls_cc_discover_regular_U )\n            + ce.cv_hh_ls_cc_discover_regular_Y  *( hh.cv_hh_ls_cc_discover_regular_Y  - im.cv_hh_ls_cc_discover_regular_Y )\n            + ce.cv_hh_ls_cc_mastercard_regular_U  *( hh.cv_hh_ls_cc_mastercard_regular_U  - im.cv_hh_ls_cc_mastercard_regular_U )\n            + ce.cv_hh_ls_cc_mastercard_regular_Y  *( hh.cv_hh_ls_cc_mastercard_regular_Y  - im.cv_hh_ls_cc_mastercard_regular_Y )\n            + ce.cv_hh_ls_cc_other_card_premium_U  *( hh.cv_hh_ls_cc_other_card_premium_U  - im.cv_hh_ls_cc_other_card_premium_U )\n            + ce.cv_hh_ls_cc_other_card_premium_Y  *( hh.cv_hh_ls_cc_other_card_premium_Y  - im.cv_hh_ls_cc_other_card_premium_Y )\n            + ce.cv_hh_ls_cc_other_card_regular_U  *( hh.cv_hh_ls_cc_other_card_regular_U  - im.cv_hh_ls_cc_other_card_regular_U )\n            + ce.cv_hh_ls_cc_other_card_regular_Y  *( hh.cv_hh_ls_cc_other_card_regular_Y  - im.cv_hh_ls_cc_other_card_regular_Y )\n            + ce.cv_hh_ls_cc_store_ret_reg_U  *( hh.cv_hh_ls_cc_store_ret_reg_U  - im.cv_hh_ls_cc_store_ret_reg_U )\n            + ce.cv_hh_ls_cc_store_ret_reg_Y  *( hh.cv_hh_ls_cc_store_ret_reg_Y  - im.cv_hh_ls_cc_store_ret_reg_Y )\n            + ce.cv_hh_ls_cc_visa_regular_U  *( hh.cv_hh_ls_cc_visa_regular_U  - im.cv_hh_ls_cc_visa_regular_U )\n            + ce.cv_hh_ls_cc_visa_regular_Y  *( hh.cv_hh_ls_cc_visa_regular_Y  - im.cv_hh_ls_cc_visa_regular_Y )\n            + ce.cv_hh_ls_military_gov_vetern_U  *( hh.cv_hh_ls_military_gov_vetern_U  - im.cv_hh_ls_military_gov_vetern_U )\n            + ce.cv_hh_ls_military_gov_vetern_Y  *( hh.cv_hh_ls_military_gov_vetern_Y  - im.cv_hh_ls_military_gov_vetern_Y )\n            + ce.cv_hmeown_comb_hmeown_renter_7  *( hh.cv_hmeown_comb_hmeown_renter_7  - im.cv_hmeown_comb_hmeown_renter_7 )\n            + ce.cv_hmeown_comb_hmeown_renter_8  *( hh.cv_hmeown_comb_hmeown_renter_8  - im.cv_hmeown_comb_hmeown_renter_8 )\n            + ce.cv_hmeown_comb_hmeown_renter_9  *( hh.cv_hmeown_comb_hmeown_renter_9  - im.cv_hmeown_comb_hmeown_renter_9 )\n            + ce.cv_hmeown_comb_hmeown_renter_H  *( hh.cv_hmeown_comb_hmeown_renter_H  - im.cv_hmeown_comb_hmeown_renter_H )\n            + ce.cv_hmeown_comb_hmeown_renter_R  *( hh.cv_hmeown_comb_hmeown_renter_R  - im.cv_hmeown_comb_hmeown_renter_R )\n            + ce.cv_hmeown_comb_hmeown_renter_T  *( hh.cv_hmeown_comb_hmeown_renter_T  - im.cv_hmeown_comb_hmeown_renter_T )\n            + ce.cv_hmeown_comb_hmeown_renter_U  *( hh.cv_hmeown_comb_hmeown_renter_U  - im.cv_hmeown_comb_hmeown_renter_U )\n            + ce.cv_home_bus_U  *( hh.cv_home_bus_U  - im.cv_home_bus_U )\n            + ce.cv_home_bus_Y  *( hh.cv_home_bus_Y  - im.cv_home_bus_Y )\n            + ce.cv_household_comp_A  *( hh.cv_household_comp_A  - im.cv_household_comp_A )\n            + ce.cv_household_comp_B  *( hh.cv_household_comp_B  - im.cv_household_comp_B )\n            + ce.cv_household_comp_C  *( hh.cv_household_comp_C  - im.cv_household_comp_C )\n            + ce.cv_household_comp_D  *( hh.cv_household_comp_D  - im.cv_household_comp_D )\n            + ce.cv_household_comp_E  *( hh.cv_household_comp_E  - im.cv_household_comp_E )\n            + ce.cv_household_comp_F  *( hh.cv_household_comp_F  - im.cv_household_comp_F )\n            + ce.cv_household_comp_G  *( hh.cv_household_comp_G  - im.cv_household_comp_G )\n            + ce.cv_household_comp_H  *( hh.cv_household_comp_H  - im.cv_household_comp_H )\n            + ce.cv_household_comp_I  *( hh.cv_household_comp_I  - im.cv_household_comp_I )\n            + ce.cv_household_comp_J  *( hh.cv_household_comp_J  - im.cv_household_comp_J )\n            + ce.cv_household_comp_U  *( hh.cv_household_comp_U  - im.cv_household_comp_U )\n            + ce.cv_incom_per_national  *( hh.cv_incom_per_national  - im.cv_incom_per_national )\n            + ce.cv_length_of_residence  *( hh.cv_length_of_residence  - im.cv_length_of_residence )\n            + ce.cv_lfstyl_interest_religion  *( hh.cv_lfstyl_interest_religion  - im.cv_lfstyl_interest_religion )\n            + ce.cv_lfstyl_lf_insure_plcy_hldr  *( hh.cv_lfstyl_lf_insure_plcy_hldr  - im.cv_lfstyl_lf_insure_plcy_hldr )\n            + ce.cv_lfstyl_med_insure_plcy_hldrs  *( hh.cv_lfstyl_med_insure_plcy_hldrs  - im.cv_lfstyl_med_insure_plcy_hldrs )\n            + ce.cv_lfstyl_medicare_plcy_hldrs  *( hh.cv_lfstyl_medicare_plcy_hldrs  - im.cv_lfstyl_medicare_plcy_hldrs )\n            + ce.cv_memship_aarp_mem  *( hh.cv_memship_aarp_mem  - im.cv_memship_aarp_mem )\n            + ce.cv_mor_bank_book  *( hh.cv_mor_bank_book  - im.cv_mor_bank_book )\n            + ce.cv_mor_bank_craft_merch  *( hh.cv_mor_bank_craft_merch  - im.cv_mor_bank_craft_merch )\n            + ce.cv_mor_bank_f_orient_mag  *( hh.cv_mor_bank_f_orient_mag  - im.cv_mor_bank_f_orient_mag )\n            + ce.cv_mor_bank_famgen_mag  *( hh.cv_mor_bank_famgen_mag  - im.cv_mor_bank_famgen_mag )\n            + ce.cv_mor_bank_gen_merch  *( hh.cv_mor_bank_gen_merch  - im.cv_mor_bank_gen_merch )\n            + ce.cv_mor_bank_gift_gadgs  *( hh.cv_mor_bank_gift_gadgs  - im.cv_mor_bank_gift_gadgs )\n            + ce.cv_mor_bank_health_fit_mag  *( hh.cv_mor_bank_health_fit_mag  - im.cv_mor_bank_health_fit_mag )\n            + ce.cv_mor_bank_health_inst_contib  *( hh.cv_mor_bank_health_inst_contib  - im.cv_mor_bank_health_inst_contib )\n            + ce.cv_mor_bank_misc  *( hh.cv_mor_bank_misc  - im.cv_mor_bank_misc )\n            + ce.cv_mor_bank_news_finan  *( hh.cv_mor_bank_news_finan  - im.cv_mor_bank_news_finan )\n            + ce.cv_mor_bank_odds_end  *( hh.cv_mor_bank_odds_end  - im.cv_mor_bank_odds_end )\n            + ce.cv_mor_bank_opp_seek_ce  *( hh.cv_mor_bank_opp_seek_ce  - im.cv_mor_bank_opp_seek_ce )\n            + ce.cv_mor_M  *( hh.cv_mor_M  - im.cv_mor_M )\n            + ce.cv_mor_U  *( hh.cv_mor_U  - im.cv_mor_U )\n            + ce.cv_mor_Y  *( hh.cv_mor_Y  - im.cv_mor_Y )\n            + ce.cv_mosaic_glob_zip4_A  *( hh.cv_mosaic_glob_zip4_A  - im.cv_mosaic_glob_zip4_A )\n            + ce.cv_mosaic_glob_zip4_B  *( hh.cv_mosaic_glob_zip4_B  - im.cv_mosaic_glob_zip4_B )\n            + ce.cv_mosaic_glob_zip4_C  *( hh.cv_mosaic_glob_zip4_C  - im.cv_mosaic_glob_zip4_C )\n            + ce.cv_mosaic_glob_zip4_D  *( hh.cv_mosaic_glob_zip4_D  - im.cv_mosaic_glob_zip4_D )\n            + ce.cv_mosaic_glob_zip4_E  *( hh.cv_mosaic_glob_zip4_E  - im.cv_mosaic_glob_zip4_E )\n            + ce.cv_mosaic_glob_zip4_F  *( hh.cv_mosaic_glob_zip4_F  - im.cv_mosaic_glob_zip4_F )\n            + ce.cv_mosaic_glob_zip4_G  *( hh.cv_mosaic_glob_zip4_G  - im.cv_mosaic_glob_zip4_G )\n            + ce.cv_mosaic_glob_zip4_H  *( hh.cv_mosaic_glob_zip4_H  - im.cv_mosaic_glob_zip4_H )\n            + ce.cv_mosaic_glob_zip4_I  *( hh.cv_mosaic_glob_zip4_I  - im.cv_mosaic_glob_zip4_I )\n            + ce.cv_mosaic_glob_zip4_J  *( hh.cv_mosaic_glob_zip4_J  - im.cv_mosaic_glob_zip4_J )\n            + ce.cv_mrtg_home_purc_type_of_purc_N  *( hh.cv_mrtg_home_purc_type_of_purc_N  - im.cv_mrtg_home_purc_type_of_purc_N )\n            + ce.cv_mrtg_home_purc_type_of_purc_R  *( hh.cv_mrtg_home_purc_type_of_purc_R  - im.cv_mrtg_home_purc_type_of_purc_R )\n            + ce.cv_no_adults_unit  *( hh.cv_no_adults_unit  - im.cv_no_adults_unit )\n            + ce.cv_no_child_unit  *( hh.cv_no_child_unit  - im.cv_no_child_unit )\n            + ce.cv_p1_bus_own_U  *( hh.cv_p1_bus_own_U  - im.cv_p1_bus_own_U )\n            + ce.cv_p1_bus_own_Y  *( hh.cv_p1_bus_own_Y  - im.cv_p1_bus_own_Y )\n            + ce.cv_p1_com_age  *( hh.cv_p1_com_age  - im.cv_p1_com_age )\n            + ce.cv_p1_edu_mdl_1  *( hh.cv_p1_edu_mdl_1  - im.cv_p1_edu_mdl_1 )\n            + ce.cv_p1_edu_mdl_2  *( hh.cv_p1_edu_mdl_2  - im.cv_p1_edu_mdl_2 )\n            + ce.cv_p1_edu_mdl_3  *( hh.cv_p1_edu_mdl_3  - im.cv_p1_edu_mdl_3 )\n            + ce.cv_p1_edu_mdl_4  *( hh.cv_p1_edu_mdl_4  - im.cv_p1_edu_mdl_4 )\n            + ce.cv_p1_edu_mdl_5  *( hh.cv_p1_edu_mdl_5  - im.cv_p1_edu_mdl_5 )\n            + ce.cv_p1_gender_F  *( hh.cv_p1_gender_F  - im.cv_p1_gender_F )\n            + ce.cv_p1_gender_M  *( hh.cv_p1_gender_M  - im.cv_p1_gender_M )\n            + ce.cv_p1_gender_U  *( hh.cv_p1_gender_U  - im.cv_p1_gender_U )\n            + ce.cv_p1_health_well_being  *( hh.cv_p1_health_well_being  - im.cv_p1_health_well_being )\n            + ce.cv_p1_marital_st_M  *( hh.cv_p1_marital_st_M  - im.cv_p1_marital_st_M )\n            + ce.cv_p1_marital_st_S  *( hh.cv_p1_marital_st_S  - im.cv_p1_marital_st_S )\n            + ce.cv_p1_marital_st_U  *( hh.cv_p1_marital_st_U  - im.cv_p1_marital_st_U )\n            + ce.cv_p1_mobile_usrs  *( hh.cv_p1_mobile_usrs  - im.cv_p1_mobile_usrs )\n            + ce.cv_p1_mor_U  *( hh.cv_p1_mor_U  - im.cv_p1_mor_U )\n            + ce.cv_p1_mor_Y  *( hh.cv_p1_mor_Y  - im.cv_p1_mor_Y )\n            + ce.cv_p1_occ_cd_2  *( hh.cv_p1_occ_cd_2  - im.cv_p1_occ_cd_2 )\n            + ce.cv_p1_occ_cd_7  *( hh.cv_p1_occ_cd_7  - im.cv_p1_occ_cd_7 )\n            + ce.cv_p1_occ_cd_9  *( hh.cv_p1_occ_cd_9  - im.cv_p1_occ_cd_9 )\n            + ce.cv_p1_occ_cd_U  *( hh.cv_p1_occ_cd_U  - im.cv_p1_occ_cd_U )\n            + ce.cv_p1_occ_grp_1  *( hh.cv_p1_occ_grp_1  - im.cv_p1_occ_grp_1 )\n            + ce.cv_p1_occ_grp_2  *( hh.cv_p1_occ_grp_2  - im.cv_p1_occ_grp_2 )\n            + ce.cv_p1_occ_grp_3  *( hh.cv_p1_occ_grp_3  - im.cv_p1_occ_grp_3 )\n            + ce.cv_p1_occ_grp_4  *( hh.cv_p1_occ_grp_4  - im.cv_p1_occ_grp_4 )\n            + ce.cv_p1_occ_grp_5  *( hh.cv_p1_occ_grp_5  - im.cv_p1_occ_grp_5 )\n            + ce.cv_p1_occ_grp_7  *( hh.cv_p1_occ_grp_7  - im.cv_p1_occ_grp_7 )\n            + ce.cv_p1_occ_grp_8  *( hh.cv_p1_occ_grp_8  - im.cv_p1_occ_grp_8 )\n            + ce.cv_p1_occ_grp_9  *( hh.cv_p1_occ_grp_9  - im.cv_p1_occ_grp_9 )\n            + ce.cv_p1_tech_adoption  *( hh.cv_p1_tech_adoption  - im.cv_p1_tech_adoption )\n            + ce.cv_recp_reliable_cd_1  *( hh.cv_recp_reliable_cd_1  - im.cv_recp_reliable_cd_1 )\n            + ce.cv_recp_reliable_cd_2  *( hh.cv_recp_reliable_cd_2  - im.cv_recp_reliable_cd_2 )\n            + ce.cv_recp_reliable_cd_5  *( hh.cv_recp_reliable_cd_5  - im.cv_recp_reliable_cd_5 )\n            + ce.cv_rlty_mdl_est_cur_lntoval_ratv2  *( hh.cv_rlty_mdl_est_cur_lntoval_ratv2  - im.cv_rlty_mdl_est_cur_lntoval_ratv2 )\n            + ce.cv_state_cd_11  *( hh.cv_state_cd_11  - im.cv_state_cd_11 )\n            + ce.cv_state_cd_12  *( hh.cv_state_cd_12  - im.cv_state_cd_12 )\n            + ce.cv_state_cd_16  *( hh.cv_state_cd_16  - im.cv_state_cd_16 )\n            + ce.cv_state_cd_17  *( hh.cv_state_cd_17  - im.cv_state_cd_17 )\n            + ce.cv_state_cd_18  *( hh.cv_state_cd_18  - im.cv_state_cd_18 )\n            + ce.cv_state_cd_2  *( hh.cv_state_cd_2  - im.cv_state_cd_2 )\n            + ce.cv_state_cd_20  *( hh.cv_state_cd_20  - im.cv_state_cd_20 )\n            + ce.cv_state_cd_21  *( hh.cv_state_cd_21  - im.cv_state_cd_21 )\n            + ce.cv_state_cd_23  *( hh.cv_state_cd_23  - im.cv_state_cd_23 )\n            + ce.cv_state_cd_24  *( hh.cv_state_cd_24  - im.cv_state_cd_24 )\n            + ce.cv_state_cd_25  *( hh.cv_state_cd_25  - im.cv_state_cd_25 )\n            + ce.cv_state_cd_26  *( hh.cv_state_cd_26  - im.cv_state_cd_26 )\n            + ce.cv_state_cd_27  *( hh.cv_state_cd_27  - im.cv_state_cd_27 )\n            + ce.cv_state_cd_28  *( hh.cv_state_cd_28  - im.cv_state_cd_28 )\n            + ce.cv_state_cd_33  *( hh.cv_state_cd_33  - im.cv_state_cd_33 )\n            + ce.cv_state_cd_35  *( hh.cv_state_cd_35  - im.cv_state_cd_35 )\n            + ce.cv_state_cd_36  *( hh.cv_state_cd_36  - im.cv_state_cd_36 )\n            + ce.cv_state_cd_38  *( hh.cv_state_cd_38  - im.cv_state_cd_38 )\n            + ce.cv_state_cd_39  *( hh.cv_state_cd_39  - im.cv_state_cd_39 )\n            + ce.cv_state_cd_4  *( hh.cv_state_cd_4  - im.cv_state_cd_4 )\n            + ce.cv_state_cd_41  *( hh.cv_state_cd_41  - im.cv_state_cd_41 )\n            + ce.cv_state_cd_44  *( hh.cv_state_cd_44  - im.cv_state_cd_44 )\n            + ce.cv_state_cd_46  *( hh.cv_state_cd_46  - im.cv_state_cd_46 )\n            + ce.cv_state_cd_47  *( hh.cv_state_cd_47  - im.cv_state_cd_47 )\n            + ce.cv_state_cd_49  *( hh.cv_state_cd_49  - im.cv_state_cd_49 )\n            + ce.cv_state_cd_50  *( hh.cv_state_cd_50  - im.cv_state_cd_50 )\n            + ce.cv_state_cd_51  *( hh.cv_state_cd_51  - im.cv_state_cd_51 )\n            + ce.cv_state_cd_54  *( hh.cv_state_cd_54  - im.cv_state_cd_54 )\n            + ce.cv_state_cd_56  *( hh.cv_state_cd_56  - im.cv_state_cd_56 )\n            + ce.cv_state_cd_6  *( hh.cv_state_cd_6  - im.cv_state_cd_6 )\n            + ce.cv_state_cd_8  *( hh.cv_state_cd_8  - im.cv_state_cd_8 )\n            + ce.cv_state_cd_9  *( hh.cv_state_cd_9  - im.cv_state_cd_9 )\n            + ce.cv_state_ehi_index  *( hh.cv_state_ehi_index  - im.cv_state_ehi_index )\n            + ce.cv_tme_zn_1  *( hh.cv_tme_zn_1  - im.cv_tme_zn_1 )\n            + ce.cv_tme_zn_2  *( hh.cv_tme_zn_2  - im.cv_tme_zn_2 )\n            + ce.cv_tme_zn_3  *( hh.cv_tme_zn_3  - im.cv_tme_zn_3 )\n            + ce.cv_tme_zn_4  *( hh.cv_tme_zn_4  - im.cv_tme_zn_4 )\n            + ce.cv_tme_zn_9  *( hh.cv_tme_zn_9  - im.cv_tme_zn_9 )\n            + ce.cv_tt_brick_mortar  *( hh.cv_tt_brick_mortar  - im.cv_tt_brick_mortar )\n            + ce.cv_tt_broadcast_cable_tv  *( hh.cv_tt_broadcast_cable_tv  - im.cv_tt_broadcast_cable_tv )\n            + ce.cv_tt_buy_american  *( hh.cv_tt_buy_american  - im.cv_tt_buy_american )\n            + ce.cv_tt_direct_mail  *( hh.cv_tt_direct_mail  - im.cv_tt_direct_mail )\n            + ce.cv_tt_etailer  *( hh.cv_tt_etailer  - im.cv_tt_etailer )\n            + ce.cv_tt_go_with_flow  *( hh.cv_tt_go_with_flow  - im.cv_tt_go_with_flow )\n            + ce.cv_tt_internet_radio  *( hh.cv_tt_internet_radio  - im.cv_tt_internet_radio )\n            + ce.cv_tt_its_all_in_name  *( hh.cv_tt_its_all_in_name  - im.cv_tt_its_all_in_name )\n            + ce.cv_tt_look_at_me_now  *( hh.cv_tt_look_at_me_now  - im.cv_tt_look_at_me_now )\n            + ce.cv_tt_mobile_display  *( hh.cv_tt_mobile_display  - im.cv_tt_mobile_display )\n            + ce.cv_tt_mobile_video  *( hh.cv_tt_mobile_video  - im.cv_tt_mobile_video )\n            + ce.cv_tt_never_empty_handed  *( hh.cv_tt_never_empty_handed  - im.cv_tt_never_empty_handed )\n            + ce.cv_tt_no_time_like_present  *( hh.cv_tt_no_time_like_present  - im.cv_tt_no_time_like_present )\n            + ce.cv_tt_on_road_again  *( hh.cv_tt_on_road_again  - im.cv_tt_on_road_again )\n            + ce.cv_tt_onlie_mid_high  *( hh.cv_tt_onlie_mid_high  - im.cv_tt_onlie_mid_high )\n            + ce.cv_tt_online_bid_mrktplc  *( hh.cv_tt_online_bid_mrktplc  - im.cv_tt_online_bid_mrktplc )\n            + ce.cv_tt_online_discount  *( hh.cv_tt_online_discount  - im.cv_tt_online_discount )\n            + ce.cv_tt_online_display  *( hh.cv_tt_online_display  - im.cv_tt_online_display )\n            + ce.cv_tt_online_stream_tv  *( hh.cv_tt_online_stream_tv  - im.cv_tt_online_stream_tv )\n            + ce.cv_tt_online_video  *( hh.cv_tt_online_video  - im.cv_tt_online_video )\n            + ce.cv_tt_penny_saved_penny_earned  *( hh.cv_tt_penny_saved_penny_earned  - im.cv_tt_penny_saved_penny_earned )\n            + ce.cv_tt_satellite_radio  *( hh.cv_tt_satellite_radio  - im.cv_tt_satellite_radio )\n            + ce.cv_tt_showme_money  *( hh.cv_tt_showme_money  - im.cv_tt_showme_money )\n            + ce.cv_tt_stop_smell_roses  *( hh.cv_tt_stop_smell_roses  - im.cv_tt_stop_smell_roses )\n            + ce.cv_tt_wrk_hard_play_hard  *( hh.cv_tt_wrk_hard_play_hard  - im.cv_tt_wrk_hard_play_hard )\n            + ce.geo_7_eleven  *( hh.geo_7_eleven  - im.geo_7_eleven )\n            + ce.geo_ahold_delhaize  *( hh.geo_ahold_delhaize  - im.geo_ahold_delhaize )\n            + ce.geo_albertsons_safeway  *( hh.geo_albertsons_safeway  - im.geo_albertsons_safeway )\n            + ce.geo_aldi  *( hh.geo_aldi  - im.geo_aldi )\n            + ce.geo_all_other_ao  *( hh.geo_all_other_ao  - im.geo_all_other_ao )\n            + ce.geo_all_other_c_and_g  *( hh.geo_all_other_c_and_g  - im.geo_all_other_c_and_g )\n            + ce.geo_all_other_club  *( hh.geo_all_other_club  - im.geo_all_other_club )\n            + ce.geo_all_other_dollar  *( hh.geo_all_other_dollar  - im.geo_all_other_dollar )\n            + ce.geo_all_other_drug  *( hh.geo_all_other_drug  - im.geo_all_other_drug )\n            + ce.geo_all_other_grocery  *( hh.geo_all_other_grocery  - im.geo_all_other_grocery )\n            + ce.geo_all_other_kroger  *( hh.geo_all_other_kroger  - im.geo_all_other_kroger )\n            + ce.geo_all_other_mass  *( hh.geo_all_other_mass  - im.geo_all_other_mass )\n            + ce.geo_all_other_walmart  *( hh.geo_all_other_walmart  - im.geo_all_other_walmart )\n            + ce.geo_bi_lo  *( hh.geo_bi_lo  - im.geo_bi_lo )\n            + ce.geo_bjs  *( hh.geo_bjs  - im.geo_bjs )\n            + ce.geo_circle_k  *( hh.geo_circle_k  - im.geo_circle_k )\n            + ce.geo_costco  *( hh.geo_costco  - im.geo_costco )\n            + ce.geo_cvs  *( hh.geo_cvs  - im.geo_cvs )\n            + ce.geo_dollar_general  *( hh.geo_dollar_general  - im.geo_dollar_general )\n            + ce.geo_family_dollar  *( hh.geo_family_dollar  - im.geo_family_dollar )\n            + ce.geo_heb  *( hh.geo_heb  - im.geo_heb )\n            + ce.geo_hy_vee  *( hh.geo_hy_vee  - im.geo_hy_vee )\n            + ce.geo_kroger_banner  *( hh.geo_kroger_banner  - im.geo_kroger_banner )\n            + ce.geo_kroger_banner  *( hh.geo_kroger_banner  - im.geo_kroger_banner )\n            + ce.geo_not_assigned  *( hh.geo_not_assigned  - im.geo_not_assigned )\n            + ce.geo_publix  *( hh.geo_publix  - im.geo_publix )\n            + ce.geo_sams_club  *( hh.geo_sams_club  - im.geo_sams_club )\n            + ce.geo_speedway  *( hh.geo_speedway  - im.geo_speedway )\n            + ce.geo_target  *( hh.geo_target  - im.geo_target )\n            + ce.geo_total_c_and_g  *( hh.geo_total_c_and_g  - im.geo_total_c_and_g )\n            + ce.geo_trader_joes  *( hh.geo_trader_joes  - im.geo_trader_joes )\n            + ce.geo_wakefern  *( hh.geo_wakefern  - im.geo_wakefern )\n            + ce.geo_walgreens  *( hh.geo_walgreens  - im.geo_walgreens )\n            + ce.geo_whole_foods  *( hh.geo_whole_foods  - im.geo_whole_foods )\n            + ce.geo_wm_neighborhood_market  *( hh.geo_wm_neighborhood_market  - im.geo_wm_neighborhood_market )\n        ) AS trip_count\nFROM {{ ref('is_hh_transpose') }} AS hh,\n     {{ ref('is_coeff_raw') }} AS ce,\n     {{ ref('is_means_raw') }} AS im", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "is", "is_hh_store_tc"], "unique_id": "model.sdna_project.is_hh_store_tc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/is/is_hh_store_tc.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/is/is_hh_store_tc.sql", "name": "is_hh_store_tc", "resource_type": "model", "alias": "is_hh_store_tc", "checksum": {"name": "sha256", "checksum": "6cfa2b25ef6715a182d2c2ce5be9e3917b50c86f4d897ad4161abb9510c6f3dd"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["is_hh_transpose"], ["is_coeff_raw"], ["is_means_raw"], ["is_hh_transpose"], ["is_coeff_raw"], ["is_means_raw"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.is_hh_transpose", "model.sdna_project.is_coeff_raw", "model.sdna_project.is_means_raw", "model.sdna_project.is_hh_transpose", "model.sdna_project.is_coeff_raw", "model.sdna_project.is_means_raw"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_hh_store_tc_transpose": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load is_hh_store_tc_transpose\n\n-- {{ ref('is_hh_store_tc') }}\n\nSELECT\n     luid,\n     MAX(CASE store WHEN 'seven_eleven' THEN trip_count ELSE 0 END) AS _7_eleven,\n     MAX(CASE store WHEN 'ahold_delhaize' THEN trip_count ELSE 0 END) AS ahold_delhaize,\n     MAX(CASE store WHEN 'albertsons' THEN trip_count ELSE 0 END) AS albertsons,\n     MAX(CASE store WHEN 'aldi' THEN trip_count ELSE 0 END) AS aldi,\n     MAX(CASE store WHEN 'amazoncom' THEN trip_count ELSE 0 END) AS amazon_com,\n     MAX(CASE store WHEN 'bi_lo' THEN trip_count ELSE 0 END) AS bi_lo,\n     MAX(CASE store WHEN 'bjs_wholesale' THEN trip_count ELSE 0 END) AS bjs,\n     MAX(CASE store WHEN 'circle_k' THEN trip_count ELSE 0 END) AS circle_k,\n     MAX(CASE store WHEN 'costco' THEN trip_count ELSE 0 END) AS costco,\n     MAX(CASE store WHEN 'cvs' THEN trip_count ELSE 0 END) AS cvs,\n     MAX(CASE store WHEN 'dollar_general' THEN trip_count ELSE 0 END) AS dollar_general,\n     MAX(CASE store WHEN 'family_dollar' THEN trip_count ELSE 0 END) AS family_dollar,\n     MAX(CASE store WHEN 'heb' THEN trip_count ELSE 0 END) AS heb,\n     MAX(CASE store WHEN 'hess_speedway' THEN trip_count ELSE 0 END) AS speedway,\n     MAX(CASE store WHEN 'hyvee' THEN trip_count ELSE 0 END) AS hy_vee,\n     MAX(CASE store WHEN 'kroger' THEN trip_count ELSE 0 END) AS kroger_banner,\n     MAX(CASE store WHEN 'kroger_other' THEN trip_count ELSE 0 END) AS all_other_kroger,\n     MAX(CASE store WHEN 'all_other_club' THEN trip_count ELSE 0 END) AS all_other_club,\n     MAX(CASE store WHEN 'all_other_club' THEN trip_count ELSE 0 END) AS all_other_dollar,\n     MAX(CASE store WHEN 'all_other_drug' THEN trip_count ELSE 0 END) AS all_other_drug,\n     MAX(CASE store WHEN 'all_other_gc' THEN trip_count ELSE 0 END) AS all_other_c_and_g,\n     MAX(CASE store WHEN 'all_other_grocery' THEN trip_count ELSE 0 END) AS all_other_grocery,\n     MAX(CASE store WHEN 'all_other_mass' THEN trip_count ELSE 0 END) AS all_other_mass,\n     MAX(CASE store WHEN 'publix' THEN trip_count ELSE 0 END) AS publix,\n     MAX(CASE store WHEN 'samsclub' THEN trip_count ELSE 0 END) AS sams_club,\n     MAX(CASE store WHEN 'target' THEN trip_count ELSE 0 END) AS target,\n     MAX(CASE store WHEN 'trader_joes' THEN trip_count ELSE 0 END) AS trader_joes,\n     MAX(CASE store WHEN 'wakefern' THEN trip_count ELSE 0 END) AS wakefern,\n     MAX(CASE store WHEN 'walgreens' THEN trip_count ELSE 0 END) AS walgreens,\n     MAX(CASE store WHEN 'walmartcom' THEN trip_count ELSE 0 END) AS walmart_com,\n     MAX(CASE store WHEN 'walmart_neighborhood_market' THEN trip_count ELSE 0 END) AS wm_neighborhood_market,\n     MAX(CASE store WHEN 'all_other_walmart' THEN trip_count ELSE 0 END) AS all_other_walmart,\n     MAX(CASE store WHEN 'whole_foods' THEN trip_count ELSE 0 END) AS whole_foods,\n     MAX(CASE store WHEN 'targetcom' THEN trip_count ELSE 0 END) AS target_com,\n     MAX(CASE store WHEN 'krogercom' THEN trip_count ELSE 0 END) AS kroger_com,\n     MAX(CASE store WHEN 'kmartcom' THEN trip_count ELSE 0 END) AS kmart_com,\n     MAX(CASE store WHEN 'walgreenscom' THEN trip_count ELSE 0 END) AS walgreens_com,\n     MAX(CASE store WHEN 'samsclubcom' THEN trip_count ELSE 0 END) AS samsclub_com,\n     MAX(CASE store WHEN 'costcocom' THEN trip_count ELSE 0 END) AS costco_com\nFROM {{ ref('is_hh_store_tc') }}\nGROUP BY luid", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "is", "is_hh_store_tc_transpose"], "unique_id": "model.sdna_project.is_hh_store_tc_transpose", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/is/is_hh_store_tc_transpose.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/is/is_hh_store_tc_transpose.sql", "name": "is_hh_store_tc_transpose", "resource_type": "model", "alias": "is_hh_store_tc_transpose", "checksum": {"name": "sha256", "checksum": "ca3a8fe848d9bac41a97ca822a115e56581442aa62d1ba50e4eacdcc157045f2"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["is_hh_store_tc"], ["is_hh_store_tc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.is_hh_store_tc", "model.sdna_project.is_hh_store_tc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_hh_transpose": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load is_hh_transpose\n\n-- {{ ref('exp_geo') }}\n\nSELECT\n    cv_living_unit_id,\n    CASE cv_act_digi_mag_buyer WHEN '' THEN 0 ELSE CAST(COALESCE(cv_act_digi_mag_buyer,'0') AS NUMBER(34, 4)) END AS cv_act_digi_mag_buyer,\n    CASE cv_bhvr_bnk_computers WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_computers_U,\n    CASE cv_bhvr_bnk_computers WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_computers_Y,\n    CASE cv_bhvr_bnk_do_it_yourselfer WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_do_it_yourselfer_U,\n    CASE cv_bhvr_bnk_do_it_yourselfer WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_do_it_yourselfer_Y,\n    CASE cv_bhvr_bnk_hi_tech_owner WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_hi_tech_owner_U,\n    CASE cv_bhvr_bnk_hi_tech_owner WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_hi_tech_owner_Y,\n    CASE cv_bhvr_bnk_internet_online_subs WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_internet_online_subs_U,\n    CASE cv_bhvr_bnk_internet_online_subs WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_internet_online_subs_Y,\n    CASE cv_bhvr_bnk_intrst_crafts WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_intrst_crafts_U,\n    CASE cv_bhvr_bnk_intrst_crafts WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_intrst_crafts_Y,\n    CASE cv_bhvr_bnk_intrst_grmt_cooking WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_intrst_grmt_cooking_U,\n    CASE cv_bhvr_bnk_intrst_grmt_cooking WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_intrst_grmt_cooking_Y,\n    CASE cv_bhvr_bnk_pres_of_credit_card WHEN 'U' THEN 1 ELSE 0 END AS cv_bhvr_bnk_pres_of_credit_card_U,\n    CASE cv_bhvr_bnk_pres_of_credit_card WHEN 'Y' THEN 1 ELSE 0 END AS cv_bhvr_bnk_pres_of_credit_card_Y,\n    CASE cv_buyer_coupon_users WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_coupon_users,'0') AS NUMBER(34, 4)) END AS cv_buyer_coupon_users,\n    CASE cv_buyer_lap_own WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_lap_own,'0') AS NUMBER(34, 4)) END AS cv_buyer_lap_own,\n    CASE cv_buyer_lux_store_shopp WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_lux_store_shopp,'0') AS NUMBER(34, 4)) END AS cv_buyer_lux_store_shopp,\n    CASE cv_buyer_nonpres_makeup_usr WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_nonpres_makeup_usr,'0') AS NUMBER(34, 4)) END AS cv_buyer_nonpres_makeup_usr,\n    CASE cv_buyer_supercenter_shopp WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_supercenter_shopp,'0') AS NUMBER(34, 4)) END AS cv_buyer_supercenter_shopp,\n    CASE cv_buyer_tab_own WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_tab_own,'0') AS NUMBER(34, 4)) END AS cv_buyer_tab_own,\n    CASE cv_buyer_warehouse_club_mem WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_warehouse_club_mem,'0') AS NUMBER(34, 4)) END AS cv_buyer_warehouse_club_mem,\n    CASE cv_buyer_yng_adult_cloth_shopp WHEN '' THEN 0 ELSE CAST(COALESCE(cv_buyer_yng_adult_cloth_shopp,'0') AS NUMBER(34, 4)) END AS cv_buyer_yng_adult_cloth_shopp,\n    CASE cv_cape_age_pop_0_17 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_0_17,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_0_17,\n    CASE cv_cape_age_pop_0_24 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_0_24,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_0_24,\n    CASE cv_cape_age_pop_0_9 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_0_9,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_0_9,\n    CASE cv_cape_age_pop_18_65 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_18_65,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_18_65,\n    CASE cv_cape_age_pop_25_34 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_25_34,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_25_34,\n    CASE cv_cape_age_pop_35_44 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_35_44,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_35_44,\n    CASE cv_cape_age_pop_45_54 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_45_54,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_45_54,\n    CASE cv_cape_age_pop_55_64 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_55_64,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_55_64,\n    CASE cv_cape_age_pop_65_99 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_65_99,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_65_99,\n    CASE cv_cape_age_pop_75_99 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_75_99,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_75_99,\n    CASE cv_cape_age_pop_median_age WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_age_pop_median_age,'0') AS NUMBER(34, 4)) END AS cv_cape_age_pop_median_age,\n    CASE cv_cape_avg_hh_size WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_avg_hh_size,'0') AS NUMBER(34, 4)) END AS cv_cape_avg_hh_size,\n    CASE cv_cape_built_median_hous_age WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_built_median_hous_age,'0') AS NUMBER(34, 4)) END AS cv_cape_built_median_hous_age,\n    CASE cv_cape_child_hh_fem_hh_fam_plt18 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_child_hh_fem_hh_fam_plt18,'0') AS NUMBER(34, 4)) END AS cv_cape_child_hh_fem_hh_fam_plt18,\n    CASE cv_cape_child_hh_without_per_lt18 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_child_hh_without_per_lt18,'0') AS NUMBER(34, 4)) END AS cv_cape_child_hh_without_per_lt18,\n    CASE cv_cape_child_wper_lt18 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_child_wper_lt18,'0') AS NUMBER(34, 4)) END AS cv_cape_child_wper_lt18,\n    CASE cv_cape_cmte_com_travtowrk_60_89 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_cmte_com_travtowrk_60_89,'0') AS NUMBER(34, 4)) END AS cv_cape_cmte_com_travtowrk_60_89,\n    CASE cv_cape_cmte_wrkrs_carpld_to_work WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_cmte_wrkrs_carpld_to_work,'0') AS NUMBER(34, 4)) END AS cv_cape_cmte_wrkrs_carpld_to_work,\n    CASE cv_cape_cmter_avg_trav_timetowork WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_cmter_avg_trav_timetowork,'0') AS NUMBER(34, 4)) END AS cv_cape_cmter_avg_trav_timetowork,\n    CASE cv_cape_edu_ispsa WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_edu_ispsa,'0') AS NUMBER(34, 4)) END AS cv_cape_edu_ispsa,\n    CASE cv_cape_edu_ispsa_decile WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_edu_ispsa_decile,'0') AS NUMBER(34, 4)) END AS cv_cape_edu_ispsa_decile,\n    CASE cv_cape_edu_pop25_med_edu_attain WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_edu_pop25_med_edu_attain,'0') AS NUMBER(34, 4)) END AS cv_cape_edu_pop25_med_edu_attain,\n    CASE cv_cape_emply_fem16_lbr_frce WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_emply_fem16_lbr_frce,'0') AS NUMBER(34, 4)) END AS cv_cape_emply_fem16_lbr_frce,\n    CASE cv_cape_ethnic_pop_asian_only WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ethnic_pop_asian_only,'0') AS NUMBER(34, 4)) END AS cv_cape_ethnic_pop_asian_only,\n    CASE cv_cape_ethnic_pop_black_only WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ethnic_pop_black_only,'0') AS NUMBER(34, 4)) END AS cv_cape_ethnic_pop_black_only,\n    CASE cv_cape_ethnic_pop_hispanic WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ethnic_pop_hispanic,'0') AS NUMBER(34, 4)) END AS cv_cape_ethnic_pop_hispanic,\n    CASE cv_cape_ethnic_pop_white_only WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ethnic_pop_white_only,'0') AS NUMBER(34, 4)) END AS cv_cape_ethnic_pop_white_only,\n    CASE cv_cape_etnc_hh_nonhisp_whte_only WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_etnc_hh_nonhisp_whte_only,'0') AS NUMBER(34, 4)) END AS cv_cape_etnc_hh_nonhisp_whte_only,\n    CASE cv_cape_etnc_pop_black_only_hisp WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_etnc_pop_black_only_hisp,'0') AS NUMBER(34, 4)) END AS cv_cape_etnc_pop_black_only_hisp,\n    CASE cv_cape_etnc_pop_white_only_hisp WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_etnc_pop_white_only_hisp,'0') AS NUMBER(34, 4)) END AS cv_cape_etnc_pop_white_only_hisp,\n    CASE cv_cape_inc_fam_inc_state_indx WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_fam_inc_state_indx,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_fam_inc_state_indx,\n    CASE cv_cape_inc_fam_state_decile WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_fam_state_decile,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_fam_state_decile,\n    CASE cv_cape_inc_hh_inc_10_14k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_10_14k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_10_14k,\n    CASE cv_cape_inc_hh_inc_100_124k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_100_124k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_100_124k,\n    CASE cv_cape_inc_hh_inc_125_149k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_125_149k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_125_149k,\n    CASE cv_cape_inc_hh_inc_15_19k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_15_19k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_15_19k,\n    CASE cv_cape_inc_hh_inc_150_199k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_150_199k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_150_199k,\n    CASE cv_cape_inc_hh_inc_20_24k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_20_24k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_20_24k,\n    CASE cv_cape_inc_hh_inc_200_249k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_200_249k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_200_249k,\n    CASE cv_cape_inc_hh_inc_25_29k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_25_29k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_25_29k,\n    CASE cv_cape_inc_hh_inc_250_499k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_250_499k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_250_499k,\n    CASE cv_cape_inc_hh_inc_30_34k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_30_34k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_30_34k,\n    CASE cv_cape_inc_hh_inc_35_39k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_35_39k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_35_39k,\n    CASE cv_cape_inc_hh_inc_40_44k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_40_44k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_40_44k,\n    CASE cv_cape_inc_hh_inc_45_49k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_45_49k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_45_49k,\n    CASE cv_cape_inc_hh_inc_50_59k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_50_59k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_50_59k,\n    CASE cv_cape_inc_hh_inc_60_74k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_60_74k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_60_74k,\n    CASE cv_cape_inc_hh_inc_75_99k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_75_99k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_75_99k,\n    CASE cv_cape_inc_hh_inc_under_10k WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_inc_under_10k,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_inc_under_10k,\n    CASE cv_cape_inc_hh_incm_500k_more WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_incm_500k_more,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_incm_500k_more,\n    CASE cv_cape_inc_hh_med_hh_inc WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_inc_hh_med_hh_inc,'0') AS NUMBER(34, 4)) END AS cv_cape_inc_hh_med_hh_inc,\n    CASE cv_cape_ind_empld_acmdn_food_svcs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_acmdn_food_svcs,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_acmdn_food_svcs,\n    CASE cv_cape_ind_empld_adm_supwstemgmt WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_adm_supwstemgmt,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_adm_supwstemgmt,\n    CASE cv_cape_ind_empld_edu_srvs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_edu_srvs,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_edu_srvs,\n    CASE cv_cape_ind_empld_fin_and_ins WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_fin_and_ins,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_fin_and_ins,\n    CASE cv_cape_ind_empld_public_admin WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_public_admin,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_public_admin,\n    CASE cv_cape_ind_empld_trans_wh WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_trans_wh,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_trans_wh,\n    CASE cv_cape_ind_empld_wholesale_trade WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_ind_empld_wholesale_trade,'0') AS NUMBER(34, 4)) END AS cv_cape_ind_empld_wholesale_trade,\n    CASE cv_cape_indus_empld_construction WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_indus_empld_construction,'0') AS NUMBER(34, 4)) END AS cv_cape_indus_empld_construction,\n    CASE cv_cape_indus_empld_hc_soc_ass WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_indus_empld_hc_soc_ass,'0') AS NUMBER(34, 4)) END AS cv_cape_indus_empld_hc_soc_ass,\n    CASE cv_cape_indus_empld_information WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_indus_empld_information,'0') AS NUMBER(34, 4)) END AS cv_cape_indus_empld_information,\n    CASE cv_cape_indus_empld_retail_trade WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_indus_empld_retail_trade,'0') AS NUMBER(34, 4)) END AS cv_cape_indus_empld_retail_trade,\n    CASE cv_cape_lang_spanish_speak WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_lang_spanish_speak,'0') AS NUMBER(34, 4)) END AS cv_cape_lang_spanish_speak,\n    CASE cv_cape_marr_couple_fam WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_marr_couple_fam,'0') AS NUMBER(34, 4)) END AS cv_cape_marr_couple_fam,\n    CASE cv_cape_move_occhu_med_len_res WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_move_occhu_med_len_res,'0') AS NUMBER(34, 4)) END AS cv_cape_move_occhu_med_len_res,\n    CASE cv_cape_mrtg_oohu_first_mrtg_only WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_mrtg_oohu_first_mrtg_only,'0') AS NUMBER(34, 4)) END AS cv_cape_mrtg_oohu_first_mrtg_only,\n    CASE cv_cape_occhu_own_occu WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_occhu_own_occu,'0') AS NUMBER(34, 4)) END AS cv_cape_occhu_own_occu,\n    CASE cv_cape_oohu_med_hme_val WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_oohu_med_hme_val,'0') AS NUMBER(34, 4)) END AS cv_cape_oohu_med_hme_val,\n    CASE cv_cape_rent_rntl_median_rent WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_rent_rntl_median_rent,'0') AS NUMBER(34, 4)) END AS cv_cape_rent_rntl_median_rent,\n    CASE cv_cape_tenancy_hu_occupied WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_tenancy_hu_occupied,'0') AS NUMBER(34, 4)) END AS cv_cape_tenancy_hu_occupied,\n    CASE cv_cape_typ_pop_in_family_hh WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_typ_pop_in_family_hh,'0') AS NUMBER(34, 4)) END AS cv_cape_typ_pop_in_family_hh,\n    CASE cv_cape_typ_pop_in_non_family_hh WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_typ_pop_in_non_family_hh,'0') AS NUMBER(34, 4)) END AS cv_cape_typ_pop_in_non_family_hh,\n    CASE cv_cape_typ_pop_spouse_in_fam_hh WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_typ_pop_spouse_in_fam_hh,'0') AS NUMBER(34, 4)) END AS cv_cape_typ_pop_spouse_in_fam_hh,\n    CASE cv_cape_urban_pop_in_urban_area WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cape_urban_pop_in_urban_area,'0') AS NUMBER(34, 4)) END AS cv_cape_urban_pop_in_urban_area,\n    CASE cv_cbsa WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cbsa,'0') AS NUMBER(34, 4)) END AS cv_cbsa,\n    CASE cv_cen_rur_urban_county_szcd WHEN '1' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_1,\n    CASE cv_cen_rur_urban_county_szcd WHEN '2' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_2,\n    CASE cv_cen_rur_urban_county_szcd WHEN '3' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_3,\n    CASE cv_cen_rur_urban_county_szcd WHEN '4' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_4,\n    CASE cv_cen_rur_urban_county_szcd WHEN '5' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_5,\n    CASE cv_cen_rur_urban_county_szcd WHEN '6' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_6,\n    CASE cv_cen_rur_urban_county_szcd WHEN '9' THEN 1 ELSE 0 END AS cv_cen_rur_urban_county_szcd_9,\n    CASE substr(cv_child_age_0_3_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_0_3_mdl_N,\n    CASE substr(cv_child_age_0_3_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_0_3_mdl_U,\n    CASE substr(cv_child_age_0_3_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_0_3_mdl_Y,\n    CASE substr(cv_child_age_10_12_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_10_12_mdl_N,\n    CASE substr(cv_child_age_10_12_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_10_12_mdl_U,\n    CASE substr(cv_child_age_10_12_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_10_12_mdl_Y,\n    CASE substr(cv_child_age_13_15_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_13_15_mdl_N,\n    CASE substr(cv_child_age_13_15_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_13_15_mdl_U,\n    CASE substr(cv_child_age_13_15_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_13_15_mdl_Y,\n    CASE substr(cv_child_age_16_18_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_16_18_mdl_N,\n    CASE substr(cv_child_age_16_18_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_16_18_mdl_U,\n    CASE substr(cv_child_age_16_18_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_16_18_mdl_Y,\n    CASE substr(cv_child_age_4_6_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_4_6_mdl_N,\n    CASE substr(cv_child_age_4_6_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_4_6_mdl_U,\n    CASE substr(cv_child_age_4_6_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_4_6_mdl_Y,\n    CASE substr(cv_child_age_7_9_mdl,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_age_7_9_mdl_N,\n    CASE substr(cv_child_age_7_9_mdl,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_age_7_9_mdl_U,\n    CASE substr(cv_child_age_7_9_mdl,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_age_7_9_mdl_Y,\n    CASE substr(cv_child_pres_0_18,2) WHEN 'N' THEN 1 ELSE 0 END AS cv_child_pres_0_18_N,\n    CASE substr(cv_child_pres_0_18,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_child_pres_0_18_U,\n    CASE substr(cv_child_pres_0_18,2) WHEN 'Y' THEN 1 ELSE 0 END AS cv_child_pres_0_18_Y,\n    CASE cv_cons_vw_proft WHEN '' THEN 0 ELSE CAST(COALESCE(cv_cons_vw_proft,'0') AS NUMBER(34, 4)) END AS cv_cons_vw_proft,\n    CASE cv_county_echv_index WHEN '' THEN 0 ELSE CAST(COALESCE(cv_county_echv_index,'0') AS NUMBER(34, 4)) END AS cv_county_echv_index,\n    CASE cv_county_echv_per WHEN '' THEN 0 ELSE CAST(COALESCE(cv_county_echv_per,'0') AS NUMBER(34, 4)) END AS cv_county_echv_per,\n    CASE cv_county_ehi_index WHEN '' THEN 0 ELSE CAST(COALESCE(cv_county_ehi_index,'0') AS NUMBER(34, 4)) END AS cv_county_ehi_index,\n    CASE cv_county_ehi_per WHEN '' THEN 0 ELSE CAST(COALESCE(cv_county_ehi_per,'0') AS NUMBER(34, 4)) END AS cv_county_ehi_per,\n    CASE cv_dwelling_type WHEN 'M' THEN 1 ELSE 0 END AS cv_dwelling_type_M,\n    CASE cv_dwelling_type WHEN 'P' THEN 1 ELSE 0 END AS cv_dwelling_type_P,\n    CASE cv_dwelling_type WHEN 'S' THEN 1 ELSE 0 END AS cv_dwelling_type_S,\n    CASE cv_dwelling_unit_size WHEN 'A' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_A,\n    CASE cv_dwelling_unit_size WHEN 'B' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_B,\n    CASE cv_dwelling_unit_size WHEN 'C' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_C,\n    CASE cv_dwelling_unit_size WHEN 'D' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_D,\n    CASE cv_dwelling_unit_size WHEN 'E' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_E,\n    CASE cv_dwelling_unit_size WHEN 'F' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_F,\n    CASE cv_dwelling_unit_size WHEN 'G' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_G,\n    CASE cv_dwelling_unit_size WHEN 'H' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_H,\n    CASE cv_dwelling_unit_size WHEN 'I' THEN 1 ELSE 0 END AS cv_dwelling_unit_size_I,\n    CASE cv_est_curr_hme_val WHEN '' THEN 0 ELSE CAST(COALESCE(cv_est_curr_hme_val,'0') AS NUMBER(34, 4)) END AS cv_est_curr_hme_val,\n    CASE cv_est_hh_incv5 WHEN 'A' THEN 1 ELSE 0 END AS cv_est_hh_incv5_A,\n    CASE cv_est_hh_incv5 WHEN 'B' THEN 1 ELSE 0 END AS cv_est_hh_incv5_B,\n    CASE cv_est_hh_incv5 WHEN 'C' THEN 1 ELSE 0 END AS cv_est_hh_incv5_C,\n    CASE cv_est_hh_incv5 WHEN 'D' THEN 1 ELSE 0 END AS cv_est_hh_incv5_D,\n    CASE cv_est_hh_incv5 WHEN 'E' THEN 1 ELSE 0 END AS cv_est_hh_incv5_E,\n    CASE cv_est_hh_incv5 WHEN 'F' THEN 1 ELSE 0 END AS cv_est_hh_incv5_F,\n    CASE cv_est_hh_incv5 WHEN 'G' THEN 1 ELSE 0 END AS cv_est_hh_incv5_G,\n    CASE cv_est_hh_incv5 WHEN 'H' THEN 1 ELSE 0 END AS cv_est_hh_incv5_H,\n    CASE cv_est_hh_incv5 WHEN 'I' THEN 1 ELSE 0 END AS cv_est_hh_incv5_I,\n    CASE cv_est_hh_incv5 WHEN 'J' THEN 1 ELSE 0 END AS cv_est_hh_incv5_J,\n    CASE cv_est_hh_incv5 WHEN 'K' THEN 1 ELSE 0 END AS cv_est_hh_incv5_K,\n    CASE cv_est_hh_incv5 WHEN 'L' THEN 1 ELSE 0 END AS cv_est_hh_incv5_L,\n    CASE cv_est_inc_amtv5 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_est_inc_amtv5,'0') AS NUMBER(34, 4)) END AS cv_est_inc_amtv5,\n    CASE cv_green_aware WHEN '' THEN 0 ELSE CAST(COALESCE(cv_green_aware,'0') AS NUMBER(34, 4)) END AS cv_green_aware,\n    CASE cv_hh_finan_cds_money_mkt WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_finan_cds_money_mkt_U,\n    CASE cv_hh_finan_cds_money_mkt WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_finan_cds_money_mkt_Y,\n    CASE cv_hh_finan_iras_currently WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_finan_iras_currently_U,\n    CASE cv_hh_finan_iras_currently WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_finan_iras_currently_Y,\n    CASE cv_hh_finan_stks_bond WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_finan_stks_bond_U,\n    CASE cv_hh_finan_stks_bond WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_finan_stks_bond_Y,\n    CASE cv_hh_ls_afltn_mem_book_club WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_afltn_mem_book_club_U,\n    CASE cv_hh_ls_afltn_mem_book_club WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_afltn_mem_book_club_Y,\n    CASE cv_hh_ls_bi_home_garden WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_bi_home_garden_U,\n    CASE cv_hh_ls_bi_home_garden WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_bi_home_garden_Y,\n    CASE cv_hh_ls_bi_sports_related WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_bi_sports_related_U,\n    CASE cv_hh_ls_bi_sports_related WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_bi_sports_related_Y,\n    CASE cv_hh_ls_buying_intrst_comp_elec WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_buying_intrst_comp_elec_U,\n    CASE cv_hh_ls_buying_intrst_comp_elec WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_buying_intrst_comp_elec_Y,\n    CASE cv_hh_ls_cc_amer_exp_prem WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_amer_exp_prem_U,\n    CASE cv_hh_ls_cc_amer_exp_prem WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_amer_exp_prem_Y,\n    CASE cv_hh_ls_cc_amer_exp_regular WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_amer_exp_regular_U,\n    CASE cv_hh_ls_cc_amer_exp_regular WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_amer_exp_regular_Y,\n    CASE cv_hh_ls_cc_discover_premium WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_discover_premium_U,\n    CASE cv_hh_ls_cc_discover_premium WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_discover_premium_Y,\n    CASE cv_hh_ls_cc_discover_regular WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_discover_regular_U,\n    CASE cv_hh_ls_cc_discover_regular WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_discover_regular_Y,\n    CASE cv_hh_ls_cc_mastercard_regular WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_mastercard_regular_U,\n    CASE cv_hh_ls_cc_mastercard_regular WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_mastercard_regular_Y,\n    CASE cv_hh_ls_cc_other_card_premium WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_other_card_premium_U,\n    CASE cv_hh_ls_cc_other_card_premium WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_other_card_premium_Y,\n    CASE cv_hh_ls_cc_other_card_regular WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_other_card_regular_U,\n    CASE cv_hh_ls_cc_other_card_regular WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_other_card_regular_Y,\n    CASE cv_hh_ls_cc_store_ret_reg WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_store_ret_reg_U,\n    CASE cv_hh_ls_cc_store_ret_reg WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_store_ret_reg_Y,\n    CASE cv_hh_ls_cc_visa_regular WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_cc_visa_regular_U,\n    CASE cv_hh_ls_cc_visa_regular WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_cc_visa_regular_Y,\n    CASE cv_hh_ls_military_gov_vetern WHEN 'U' THEN 1 ELSE 0 END AS cv_hh_ls_military_gov_vetern_U,\n    CASE cv_hh_ls_military_gov_vetern WHEN 'Y' THEN 1 ELSE 0 END AS cv_hh_ls_military_gov_vetern_Y,\n    CASE cv_hmeown_comb_hmeown_renter WHEN '7' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_7,\n    CASE cv_hmeown_comb_hmeown_renter WHEN '8' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_8,\n    CASE cv_hmeown_comb_hmeown_renter WHEN '9' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_9,\n    CASE cv_hmeown_comb_hmeown_renter WHEN 'H' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_H,\n    CASE cv_hmeown_comb_hmeown_renter WHEN 'R' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_R,\n    CASE cv_hmeown_comb_hmeown_renter WHEN 'T' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_T,\n    CASE cv_hmeown_comb_hmeown_renter WHEN 'U' THEN 1 ELSE 0 END AS cv_hmeown_comb_hmeown_renter_U,\n    CASE cv_home_bus WHEN 'U' THEN 1 ELSE 0 END AS cv_home_bus_U,\n    CASE cv_home_bus WHEN 'Y' THEN 1 ELSE 0 END AS cv_home_bus_Y,\n    CASE cv_household_comp WHEN 'A' THEN 1 ELSE 0 END AS cv_household_comp_A,\n    CASE cv_household_comp WHEN 'B' THEN 1 ELSE 0 END AS cv_household_comp_B,\n    CASE cv_household_comp WHEN 'C' THEN 1 ELSE 0 END AS cv_household_comp_C,\n    CASE cv_household_comp WHEN 'D' THEN 1 ELSE 0 END AS cv_household_comp_D,\n    CASE cv_household_comp WHEN 'E' THEN 1 ELSE 0 END AS cv_household_comp_E,\n    CASE cv_household_comp WHEN 'F' THEN 1 ELSE 0 END AS cv_household_comp_F,\n    CASE cv_household_comp WHEN 'G' THEN 1 ELSE 0 END AS cv_household_comp_G,\n    CASE cv_household_comp WHEN 'H' THEN 1 ELSE 0 END AS cv_household_comp_H,\n    CASE cv_household_comp WHEN 'I' THEN 1 ELSE 0 END AS cv_household_comp_I,\n    CASE cv_household_comp WHEN 'J' THEN 1 ELSE 0 END AS cv_household_comp_J,\n    CASE cv_household_comp WHEN 'U' THEN 1 ELSE 0 END AS cv_household_comp_U,\n    CASE cv_incom_per_national WHEN '' THEN 0 ELSE CAST(COALESCE(cv_incom_per_national,'0') AS NUMBER(34, 4)) END AS cv_incom_per_national,\n    CASE cv_length_of_residence WHEN '' THEN 0 ELSE CAST(COALESCE(cv_length_of_residence,'0') AS NUMBER(34, 4)) END AS cv_length_of_residence,\n    CASE cv_lfstyl_interest_religion WHEN '' THEN 0 ELSE CAST(COALESCE(cv_lfstyl_interest_religion,'0') AS NUMBER(34, 4)) END AS cv_lfstyl_interest_religion,\n    CASE cv_lfstyl_lf_insure_plcy_hldr WHEN '' THEN 0 ELSE CAST(COALESCE(cv_lfstyl_lf_insure_plcy_hldr,'0') AS NUMBER(34, 4)) END AS cv_lfstyl_lf_insure_plcy_hldr,\n    CASE cv_lfstyl_med_insure_plcy_hldrs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_lfstyl_med_insure_plcy_hldrs,'0') AS NUMBER(34, 4)) END AS cv_lfstyl_med_insure_plcy_hldrs,\n    CASE cv_lfstyl_medicare_plcy_hldrs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_lfstyl_medicare_plcy_hldrs,'0') AS NUMBER(34, 4)) END AS cv_lfstyl_medicare_plcy_hldrs,\n    CASE cv_memship_aarp_mem WHEN '' THEN 0 ELSE CAST(COALESCE(cv_memship_aarp_mem,'0') AS NUMBER(34, 4)) END AS cv_memship_aarp_mem,\n    CASE cv_mor_bank_book WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_book,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_book,\n    CASE cv_mor_bank_craft_merch WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_craft_merch,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_craft_merch,\n    CASE cv_mor_bank_f_orient_mag WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_f_orient_mag,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_f_orient_mag,\n    CASE cv_mor_bank_famgen_mag WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_famgen_mag,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_famgen_mag,\n    CASE cv_mor_bank_gen_merch WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_gen_merch,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_gen_merch,\n    CASE cv_mor_bank_gift_gadgs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_gift_gadgs,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_gift_gadgs,\n    CASE cv_mor_bank_health_fit_mag WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_health_fit_mag,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_health_fit_mag,\n    CASE cv_mor_bank_health_inst_contib WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_health_inst_contib,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_health_inst_contib,\n    CASE cv_mor_bank_misc WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_misc,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_misc,\n    CASE cv_mor_bank_news_finan WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_news_finan,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_news_finan,\n    CASE cv_mor_bank_odds_end WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_odds_end,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_odds_end,\n    CASE cv_mor_bank_opp_seek_ce WHEN '' THEN 0 ELSE CAST(COALESCE(cv_mor_bank_opp_seek_ce,'0') AS NUMBER(34, 4)) END AS cv_mor_bank_opp_seek_ce,\n    CASE cv_mor WHEN 'M' THEN 1 ELSE 0 END AS cv_mor_M,\n    CASE cv_mor WHEN 'U' THEN 1 ELSE 0 END AS cv_mor_U,\n    CASE cv_mor WHEN 'Y' THEN 1 ELSE 0 END AS cv_mor_Y,\n    CASE cv_mosaic_glob_zip4 WHEN 'A' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_A,\n    CASE cv_mosaic_glob_zip4 WHEN 'B' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_B,\n    CASE cv_mosaic_glob_zip4 WHEN 'C' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_C,\n    CASE cv_mosaic_glob_zip4 WHEN 'D' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_D,\n    CASE cv_mosaic_glob_zip4 WHEN 'E' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_E,\n    CASE cv_mosaic_glob_zip4 WHEN 'F' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_F,\n    CASE cv_mosaic_glob_zip4 WHEN 'G' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_G,\n    CASE cv_mosaic_glob_zip4 WHEN 'H' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_H,\n    CASE cv_mosaic_glob_zip4 WHEN 'I' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_I,\n    CASE cv_mosaic_glob_zip4 WHEN 'J' THEN 1 ELSE 0 END AS cv_mosaic_glob_zip4_J,\n    CASE cv_mrtg_home_purc_type_of_purc WHEN 'N' THEN 1 ELSE 0 END AS cv_mrtg_home_purc_type_of_purc_N,\n    CASE cv_mrtg_home_purc_type_of_purc WHEN 'R' THEN 1 ELSE 0 END AS cv_mrtg_home_purc_type_of_purc_R,\n    CASE cv_no_adults_unit WHEN '' THEN 0 ELSE CAST(COALESCE(cv_no_adults_unit,'0') AS NUMBER(34, 4)) END AS cv_no_adults_unit,\n    CASE cv_no_child_unit WHEN '' THEN 0 ELSE CAST(COALESCE(cv_no_child_unit,'0') AS NUMBER(34, 4)) END AS cv_no_child_unit,\n    CASE cv_p1_bus_own WHEN 'U' THEN 1 ELSE 0 END AS cv_p1_bus_own_U,\n    CASE cv_p1_bus_own WHEN 'Y' THEN 1 ELSE 0 END AS cv_p1_bus_own_Y,\n    CASE cv_p1_com_age WHEN '' THEN 0 ELSE CAST(COALESCE(substr(cv_p1_com_age,2),'0') AS NUMBER(34, 4)) END AS cv_p1_com_age,\n    CASE substr(cv_p1_edu_mdl,2) WHEN '1' THEN 1 ELSE 0 END AS cv_p1_edu_mdl_1,\n    CASE substr(cv_p1_edu_mdl,2) WHEN '2' THEN 1 ELSE 0 END AS cv_p1_edu_mdl_2,\n    CASE substr(cv_p1_edu_mdl,2) WHEN '3' THEN 1 ELSE 0 END AS cv_p1_edu_mdl_3,\n    CASE substr(cv_p1_edu_mdl,2) WHEN '4' THEN 1 ELSE 0 END AS cv_p1_edu_mdl_4,\n    CASE substr(cv_p1_edu_mdl,2) WHEN '5' THEN 1 ELSE 0 END AS cv_p1_edu_mdl_5,\n    CASE cv_p1_gender WHEN 'F' THEN 1 ELSE 0 END AS cv_p1_gender_F,\n    CASE cv_p1_gender WHEN 'M' THEN 1 ELSE 0 END AS cv_p1_gender_M,\n    CASE cv_p1_gender WHEN 'U' THEN 1 ELSE 0 END AS cv_p1_gender_U,\n    CASE cv_p1_health_well_being WHEN '' THEN 0 ELSE CAST(COALESCE(cv_p1_health_well_being,'0') AS NUMBER(34, 4)) END AS cv_p1_health_well_being,\n    CASE substr(cv_p1_marital_st,2) WHEN 'M' THEN 1 ELSE 0 END AS cv_p1_marital_st_M,\n    CASE substr(cv_p1_marital_st,2) WHEN 'S' THEN 1 ELSE 0 END AS cv_p1_marital_st_S,\n    CASE substr(cv_p1_marital_st,2) WHEN 'U' THEN 1 ELSE 0 END AS cv_p1_marital_st_U,\n    CASE cv_p1_mobile_usrs WHEN '' THEN 0 ELSE CAST(COALESCE(cv_p1_mobile_usrs,'0') AS NUMBER(34, 4)) END AS cv_p1_mobile_usrs,\n    CASE cv_p1_mor WHEN 'U' THEN 1 ELSE 0 END AS cv_p1_mor_U,\n    CASE cv_p1_mor WHEN 'Y' THEN 1 ELSE 0 END AS cv_p1_mor_Y,\n    CASE cv_p1_occ_cd WHEN '2' THEN 1 ELSE 0 END AS cv_p1_occ_cd_2,\n    CASE cv_p1_occ_cd WHEN '7' THEN 1 ELSE 0 END AS cv_p1_occ_cd_7,\n    CASE cv_p1_occ_cd WHEN '9' THEN 1 ELSE 0 END AS cv_p1_occ_cd_9,\n    CASE cv_p1_occ_cd WHEN 'U' THEN 1 ELSE 0 END AS cv_p1_occ_cd_U,\n    CASE substr(cv_p1_occ_grp,2) WHEN '1' THEN 1 ELSE 0 END AS cv_p1_occ_grp_1,\n    CASE substr(cv_p1_occ_grp,2) WHEN '2' THEN 1 ELSE 0 END AS cv_p1_occ_grp_2,\n    CASE substr(cv_p1_occ_grp,2) WHEN '3' THEN 1 ELSE 0 END AS cv_p1_occ_grp_3,\n    CASE substr(cv_p1_occ_grp,2) WHEN '4' THEN 1 ELSE 0 END AS cv_p1_occ_grp_4,\n    CASE substr(cv_p1_occ_grp,2) WHEN '5' THEN 1 ELSE 0 END AS cv_p1_occ_grp_5,\n    CASE substr(cv_p1_occ_grp,2) WHEN '7' THEN 1 ELSE 0 END AS cv_p1_occ_grp_7,\n    CASE substr(cv_p1_occ_grp,2) WHEN '8' THEN 1 ELSE 0 END AS cv_p1_occ_grp_8,\n    CASE substr(cv_p1_occ_grp,2) WHEN '9' THEN 1 ELSE 0 END AS cv_p1_occ_grp_9,\n    CASE cv_p1_tech_adoption WHEN '' THEN 0 ELSE CAST(COALESCE(cv_p1_tech_adoption,'0') AS NUMBER(34, 4)) END AS cv_p1_tech_adoption,\n    CASE cv_recp_reliable_cd WHEN '1' THEN 1 ELSE 0 END AS cv_recp_reliable_cd_1,\n    CASE cv_recp_reliable_cd WHEN '2' THEN 1 ELSE 0 END AS cv_recp_reliable_cd_2,\n    CASE cv_recp_reliable_cd WHEN '5' THEN 1 ELSE 0 END AS cv_recp_reliable_cd_5,\n    CASE cv_rlty_mdl_est_cur_lntoval_ratv2 WHEN '' THEN 0 ELSE CAST(COALESCE(cv_rlty_mdl_est_cur_lntoval_ratv2,'0') AS NUMBER(34, 4)) END AS cv_rlty_mdl_est_cur_lntoval_ratv2,\n    CASE cv_state_cd WHEN '11' THEN 1 ELSE 0 END AS cv_state_cd_11,\n    CASE cv_state_cd WHEN '12' THEN 1 ELSE 0 END AS cv_state_cd_12,\n    CASE cv_state_cd WHEN '16' THEN 1 ELSE 0 END AS cv_state_cd_16,\n    CASE cv_state_cd WHEN '17' THEN 1 ELSE 0 END AS cv_state_cd_17,\n    CASE cv_state_cd WHEN '18' THEN 1 ELSE 0 END AS cv_state_cd_18,\n    CASE cv_state_cd WHEN '2' THEN 1 ELSE 0 END AS cv_state_cd_2,\n    CASE cv_state_cd WHEN '20' THEN 1 ELSE 0 END AS cv_state_cd_20,\n    CASE cv_state_cd WHEN '21' THEN 1 ELSE 0 END AS cv_state_cd_21,\n    CASE cv_state_cd WHEN '23' THEN 1 ELSE 0 END AS cv_state_cd_23,\n    CASE cv_state_cd WHEN '24' THEN 1 ELSE 0 END AS cv_state_cd_24,\n    CASE cv_state_cd WHEN '25' THEN 1 ELSE 0 END AS cv_state_cd_25,\n    CASE cv_state_cd WHEN '26' THEN 1 ELSE 0 END AS cv_state_cd_26,\n    CASE cv_state_cd WHEN '27' THEN 1 ELSE 0 END AS cv_state_cd_27,\n    CASE cv_state_cd WHEN '28' THEN 1 ELSE 0 END AS cv_state_cd_28,\n    CASE cv_state_cd WHEN '33' THEN 1 ELSE 0 END AS cv_state_cd_33,\n    CASE cv_state_cd WHEN '35' THEN 1 ELSE 0 END AS cv_state_cd_35,\n    CASE cv_state_cd WHEN '36' THEN 1 ELSE 0 END AS cv_state_cd_36,\n    CASE cv_state_cd WHEN '38' THEN 1 ELSE 0 END AS cv_state_cd_38,\n    CASE cv_state_cd WHEN '39' THEN 1 ELSE 0 END AS cv_state_cd_39,\n    CASE cv_state_cd WHEN '4' THEN 1 ELSE 0 END AS cv_state_cd_4,\n    CASE cv_state_cd WHEN '41' THEN 1 ELSE 0 END AS cv_state_cd_41,\n    CASE cv_state_cd WHEN '44' THEN 1 ELSE 0 END AS cv_state_cd_44,\n    CASE cv_state_cd WHEN '46' THEN 1 ELSE 0 END AS cv_state_cd_46,\n    CASE cv_state_cd WHEN '47' THEN 1 ELSE 0 END AS cv_state_cd_47,\n    CASE cv_state_cd WHEN '49' THEN 1 ELSE 0 END AS cv_state_cd_49,\n    CASE cv_state_cd WHEN '50' THEN 1 ELSE 0 END AS cv_state_cd_50,\n    CASE cv_state_cd WHEN '51' THEN 1 ELSE 0 END AS cv_state_cd_51,\n    CASE cv_state_cd WHEN '54' THEN 1 ELSE 0 END AS cv_state_cd_54,\n    CASE cv_state_cd WHEN '56' THEN 1 ELSE 0 END AS cv_state_cd_56,\n    CASE cv_state_cd WHEN '6' THEN 1 ELSE 0 END AS cv_state_cd_6,\n    CASE cv_state_cd WHEN '8' THEN 1 ELSE 0 END AS cv_state_cd_8,\n    CASE cv_state_cd WHEN '9' THEN 1 ELSE 0 END AS cv_state_cd_9,\n    CASE cv_state_ehi_index WHEN '' THEN 0 ELSE CAST(COALESCE(cv_state_ehi_index,'0') AS NUMBER(34, 4)) END AS cv_state_ehi_index,\n    CASE cv_tme_zn WHEN '1' THEN 1 ELSE 0 END AS cv_tme_zn_1,\n    CASE cv_tme_zn WHEN '2' THEN 1 ELSE 0 END AS cv_tme_zn_2,\n    CASE cv_tme_zn WHEN '3' THEN 1 ELSE 0 END AS cv_tme_zn_3,\n    CASE cv_tme_zn WHEN '4' THEN 1 ELSE 0 END AS cv_tme_zn_4,\n    CASE cv_tme_zn WHEN '9' THEN 1 ELSE 0 END AS cv_tme_zn_9,\n    CASE cv_tt_brick_mortar WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_brick_mortar,'0') AS NUMBER(34, 4)) END AS cv_tt_brick_mortar,\n    CASE cv_tt_broadcast_cable_tv WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_broadcast_cable_tv,'0') AS NUMBER(34, 4)) END AS cv_tt_broadcast_cable_tv,\n    CASE cv_tt_buy_american WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_buy_american,'0') AS NUMBER(34, 4)) END AS cv_tt_buy_american,\n    CASE cv_tt_direct_mail WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_direct_mail,'0') AS NUMBER(34, 4)) END AS cv_tt_direct_mail,\n    CASE cv_tt_etailer WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_etailer,'0') AS NUMBER(34, 4)) END AS cv_tt_etailer,\n    CASE cv_tt_go_with_flow WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_go_with_flow,'0') AS NUMBER(34, 4)) END AS cv_tt_go_with_flow,\n    CASE cv_tt_internet_radio WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_internet_radio,'0') AS NUMBER(34, 4)) END AS cv_tt_internet_radio,\n    CASE cv_tt_its_all_in_name WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_its_all_in_name,'0') AS NUMBER(34, 4)) END AS cv_tt_its_all_in_name,\n    CASE cv_tt_look_at_me_now WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_look_at_me_now,'0') AS NUMBER(34, 4)) END AS cv_tt_look_at_me_now,\n    CASE cv_tt_mobile_display WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_mobile_display,'0') AS NUMBER(34, 4)) END AS cv_tt_mobile_display,\n    CASE cv_tt_mobile_video WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_mobile_video,'0') AS NUMBER(34, 4)) END AS cv_tt_mobile_video,\n    CASE cv_tt_never_empty_handed WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_never_empty_handed,'0') AS NUMBER(34, 4)) END AS cv_tt_never_empty_handed,\n    CASE cv_tt_no_time_like_present WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_no_time_like_present,'0') AS NUMBER(34, 4)) END AS cv_tt_no_time_like_present,\n    CASE cv_tt_on_road_again WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_on_road_again,'0') AS NUMBER(34, 4)) END AS cv_tt_on_road_again,\n    CASE cv_tt_onlie_mid_high WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_onlie_mid_high,'0') AS NUMBER(34, 4)) END AS cv_tt_onlie_mid_high,\n    CASE cv_tt_online_bid_mrktplc WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_online_bid_mrktplc,'0') AS NUMBER(34, 4)) END AS cv_tt_online_bid_mrktplc,\n    CASE cv_tt_online_discount WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_online_discount,'0') AS NUMBER(34, 4)) END AS cv_tt_online_discount,\n    CASE cv_tt_online_display WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_online_display,'0') AS NUMBER(34, 4)) END AS cv_tt_online_display,\n    CASE cv_tt_online_stream_tv WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_online_stream_tv,'0') AS NUMBER(34, 4)) END AS cv_tt_online_stream_tv,\n    CASE cv_tt_online_video WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_online_video,'0') AS NUMBER(34, 4)) END AS cv_tt_online_video,\n    CASE cv_tt_penny_saved_penny_earned WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_penny_saved_penny_earned,'0') AS NUMBER(34, 4)) END AS cv_tt_penny_saved_penny_earned,\n    CASE cv_tt_satellite_radio WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_satellite_radio,'0') AS NUMBER(34, 4)) END AS cv_tt_satellite_radio,\n    CASE cv_tt_showme_money WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_showme_money,'0') AS NUMBER(34, 4)) END AS cv_tt_showme_money,\n    CASE cv_tt_stop_smell_roses WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_stop_smell_roses,'0') AS NUMBER(34, 4)) END AS cv_tt_stop_smell_roses,\n    CASE cv_tt_wrk_hard_play_hard WHEN '' THEN 0 ELSE CAST(COALESCE(cv_tt_wrk_hard_play_hard,'0') AS NUMBER(34, 4)) END AS cv_tt_wrk_hard_play_hard,\n\n    CAST(COALESCE(geo_7_eleven,'0') AS NUMBER(34, 4)) AS geo_7_eleven,\n    CAST(COALESCE(geo_ahold_delhaize,'0') AS NUMBER(34, 4)) AS geo_ahold_delhaize,\n    CAST(COALESCE(geo_albertsons_safeway,'0') AS NUMBER(34, 4)) AS geo_albertsons_safeway,\n    CAST(COALESCE(geo_aldi,'0') AS NUMBER(34, 4)) AS geo_aldi,\n    CAST(COALESCE(geo_all_other_ao,'0') AS NUMBER(34, 4)) AS geo_all_other_ao,\n    CAST(COALESCE(geo_all_other_c_and_g,'0') AS NUMBER(34, 4)) AS geo_all_other_c_and_g,\n    CAST(COALESCE(geo_all_other_club,'0') AS NUMBER(34, 4)) AS geo_all_other_club,\n    CAST(COALESCE(geo_all_other_dollar,'0') AS NUMBER(34, 4)) AS geo_all_other_dollar,\n    CAST(COALESCE(geo_all_other_drug,'0') AS NUMBER(34, 4)) AS geo_all_other_drug,\n    CAST(COALESCE(geo_all_other_grocery,'0') AS NUMBER(34, 4)) AS geo_all_other_grocery,\n    CAST(COALESCE(geo_all_other_kroger,'0') AS NUMBER(34, 4)) AS geo_all_other_kroger,\n    CAST(COALESCE(geo_all_other_mass,'0') AS NUMBER(34, 4)) AS geo_all_other_mass,\n    CAST(COALESCE(geo_all_other_walmart,'0') AS NUMBER(34, 4)) AS geo_all_other_walmart,\n    CAST(COALESCE(geo_bi_lo,'0') AS NUMBER(34, 4)) AS geo_bi_lo,\n    CAST(COALESCE(geo_bjs,'0') AS NUMBER(34, 4)) AS geo_bjs,\n    CAST(COALESCE(geo_circle_k,'0') AS NUMBER(34, 4)) AS geo_circle_k,\n    CAST(COALESCE(geo_costco,'0') AS NUMBER(34, 4)) AS geo_costco,\n    CAST(COALESCE(geo_cvs,'0') AS NUMBER(34, 4)) AS geo_cvs,\n    CAST(COALESCE(geo_dollar_general,'0') AS NUMBER(34, 4)) AS geo_dollar_general,\n    CAST(COALESCE(geo_family_dollar,'0') AS NUMBER(34, 4)) AS geo_family_dollar,\n    CAST(COALESCE(geo_heb,'0') AS NUMBER(34, 4)) AS geo_heb,\n    CAST(COALESCE(geo_hy_vee,'0') AS NUMBER(34, 4)) AS geo_hy_vee,\n    CAST(COALESCE(geo_kroger_banner,'0') AS NUMBER(34, 4)) AS geo_kroger_banner,\n    --        CAST(COALESCE(geo_kroger_banner,'0') AS NUMBER(34, 4)) AS geo_kroger_banner,\n    CAST(COALESCE(geo_not_assigned,'0') AS NUMBER(34, 4)) AS geo_not_assigned,\n    CAST(COALESCE(geo_publix,'0') AS NUMBER(34, 4)) AS geo_publix,\n    CAST(COALESCE(geo_sams_club,'0') AS NUMBER(34, 4)) AS geo_sams_club,\n    CAST(COALESCE(geo_speedway,'0') AS NUMBER(34, 4)) AS geo_speedway,\n    CAST(COALESCE(geo_target,'0') AS NUMBER(34, 4)) AS geo_target,\n    CAST(COALESCE(geo_total_c_and_g,'0') AS NUMBER(34, 4)) AS geo_total_c_and_g,\n    CAST(COALESCE(geo_trader_joes,'0') AS NUMBER(34, 4)) AS geo_trader_joes,\n    CAST(COALESCE(geo_wakefern,'0') AS NUMBER(34, 4)) AS geo_wakefern,\n    CAST(COALESCE(geo_walgreens,'0') AS NUMBER(34, 4)) AS geo_walgreens,\n    CAST(COALESCE(geo_whole_foods,'0') AS NUMBER(34, 4)) AS geo_whole_foods,\n    CAST(COALESCE(geo_wm_neighborhood_market,'0') AS NUMBER(34, 4)) AS geo_wm_neighborhood_market\nFROM {{ ref('exp_geo') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "is", "is_hh_transpose"], "unique_id": "model.sdna_project.is_hh_transpose", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/is/is_hh_transpose.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/is/is_hh_transpose.sql", "name": "is_hh_transpose", "resource_type": "model", "alias": "is_hh_transpose", "checksum": {"name": "sha256", "checksum": "b7ca54ae89be270c9327f1eff91b2ab7a0142800ba6412717078d30b55d3c114"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo"], ["exp_geo"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo", "model.sdna_project.exp_geo"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.retailer_data_store_full": {"raw_sql": "SELECT\n    cast(trif.cv_living_unit_id as integer) AS cv_living_unit_id,\n    trif.cv_address_id,\n    trif.cv_short_city_name,\n    trif.cv_city_name,\n    trif.cv_county_name,\n    trif.cv_state_abb,\n    trif.cv_zipcode_5,\n    trif.cv_zipcode_4,\n    trif.cv_zipcode_9,\n    trif.cv_zip_locality,\n    trif.cv_delvy_pt_bar_cd,\n    trif.cv_carr_route,\n    trif.cv_state_cd,\n    trif.cv_county_cd,\n    --FIPS_code attribute added extra, which is not part of CV attributes.\n    CONCAT(trif.cv_state_cd, trif.cv_county_cd) AS fips_code,\n    trif.cv_cen2010_tract_block_grp,\n    trif.cv_cen2010_blockid,\n    trif.cv_latitude,\n    trif.cv_longitude,\n    trif.cv_mat_level_geodata,\n    trif.cv_addr_qlty_ind,\n    trif.cv_recp_reliable_cd,\n    trif.cv_acty_dt,\n    trif.cv_tme_zn,\n    trif.cv_p1_pid,\n    trif.cv_p1_ptyp,\n    trif.cv_p1_etnc_etnc,\n    trif.cv_p1_etnc_exp_grp,\n    trif.cv_p1_etnc_religion,\n    trif.cv_p1_etnc_lang_pref,\n    trif.cv_p1_etnc_grp,\n    trif.cv_p1_etnc_country_of_origin,\n    trif.cv_p1_gender,\n    trif.cv_p1_birth_dt,\n    trif.cv_p1_est_age,\n    trif.cv_p1_exact_age,\n    trif.cv_p1_com_age,\n    trif.cv_p1_edu_mdl,\n    trif.cv_p1_marital_st,\n    trif.cv_p1_occ_grp,\n    trif.cv_p1_occ_cd,\n    trif.cv_p1_bus_own,\n    trif.cv_p2_pid,\n    trif.cv_p2_ptyp,\n    trif.cv_p2_etnc_etnc,\n    trif.cv_p2_etnc_exp_grp,\n    trif.cv_p2_etnc_religion,\n    trif.cv_p2_etnc_lang_pref,\n    trif.cv_p2_etnc_grp,\n    trif.cv_p2_etnc_country_of_origin,\n    trif.cv_p2_gender,\n    trif.cv_p2_birth_dt,\n    trif.cv_p2_est_age,\n    trif.cv_p2_exact_age,\n    trif.cv_p2_com_age,\n    trif.cv_p2_edu_mdl,\n    trif.cv_p2_marital_st,\n    trif.cv_p2_occ_grp,\n    trif.cv_p2_occ_cd,\n    trif.cv_p2_bus_own,\n    trif.cv_p3_pid,\n    trif.cv_p3_ptyp,\n    trif.cv_p3_etnc_etnc,\n    trif.cv_p3_etnc_exp_grp,\n    trif.cv_p3_etnc_religion,\n    trif.cv_p3_etnc_lang_pref,\n    trif.cv_p3_etnc_grp,\n    trif.cv_p3_etnc_country_of_origin,\n    trif.cv_p3_gender,\n    trif.cv_p3_birth_dt,\n    trif.cv_p3_est_age,\n    trif.cv_p3_exact_age,\n    trif.cv_p3_com_age,\n    trif.cv_p3_edu_mdl,\n    trif.cv_p3_marital_st,\n    trif.cv_p3_occ_grp,\n    trif.cv_p3_occ_cd,\n    trif.cv_p3_bus_own,\n    trif.cv_p4_pid,\n    trif.cv_p4_ptyp,\n    trif.cv_p4_etnc_etnc,\n    trif.cv_p4_etnc_exp_grp,\n    trif.cv_p4_etnc_religion,\n    trif.cv_p4_etnc_lang_pref,\n    trif.cv_p4_etnc_grp,\n    trif.cv_p4_etnc_country_of_origin,\n    trif.cv_p4_gender,\n    trif.cv_p4_birth_dt,\n    trif.cv_p4_est_age,\n    trif.cv_p4_exact_age,\n    trif.cv_p4_com_age,\n    trif.cv_p4_edu_mdl,\n    trif.cv_p4_marital_st,\n    trif.cv_p4_occ_grp,\n    trif.cv_p4_occ_cd,\n    trif.cv_p4_bus_own,\n    trif.cv_p5_pid,\n    trif.cv_p5_ptyp,\n    trif.cv_p5_etnc_etnc,\n    trif.cv_p5_etnc_exp_grp,\n    trif.cv_p5_etnc_religion,\n    trif.cv_p5_etnc_lang_pref,\n    trif.cv_p5_etnc_grp,\n    trif.cv_p5_etnc_country_of_origin,\n    trif.cv_p5_gender,\n    trif.cv_p5_birth_dt,\n    trif.cv_p5_est_age,\n    trif.cv_p5_exact_age,\n    trif.cv_p5_com_age,\n    trif.cv_p5_edu_mdl,\n    trif.cv_p5_marital_st,\n    trif.cv_p5_occ_grp,\n    trif.cv_p5_occ_cd,\n    trif.cv_p5_bus_own,\n    trif.cv_p6_pid,\n    trif.cv_p6_ptyp,\n    trif.cv_p6_etnc_etnc,\n    trif.cv_p6_etnc_exp_grp,\n    trif.cv_p6_etnc_religion,\n    trif.cv_p6_etnc_lang_pref,\n    trif.cv_p6_etnc_grp,\n    trif.cv_p6_etnc_country_of_origin,\n    trif.cv_p6_gender,\n    trif.cv_p6_birth_dt,\n    trif.cv_p6_est_age,\n    trif.cv_p6_exact_age,\n    trif.cv_p6_com_age,\n    trif.cv_p6_edu_mdl,\n    trif.cv_p6_marital_st,\n    trif.cv_p6_occ_grp,\n    trif.cv_p6_occ_cd,\n    trif.cv_p6_bus_own,\n    trif.cv_mor,\n    trif.cv_mor_bank_book,\n    trif.cv_mor_bank_spl_food,\n    trif.cv_mor_bank_craft_merch,\n    trif.cv_mor_bank_culinary_int,\n    trif.cv_mor_bank_dedupe_hit,\n    trif.cv_mor_bank_doit_yourself,\n    trif.cv_mor_bank_famgen_mag,\n    trif.cv_mor_bank_f_merch,\n    trif.cv_mor_bank_f_orient_mag,\n    trif.cv_mor_bank_gar_farm_buy,\n    trif.cv_mor_bank_gar_farm_mag,\n    trif.cv_mor_bank_gen_contrib,\n    trif.cv_mor_bank_gen_merch,\n    trif.cv_mor_bank_gift_gadgs,\n    trif.cv_mor_bank_health_inst_contib,\n    trif.cv_mor_bank_health_fit_mag,\n    trif.cv_mor_bank_m_merch,\n    trif.cv_mor_bank_m_sports_mag,\n    trif.cv_mor_bank_misc,\n    trif.cv_mor_bank_nondedupe_hit,\n    trif.cv_mor_bank_odds_end,\n    trif.cv_mor_bank_opp_seek_ce,\n    trif.cv_mor_bank_photograph,\n    trif.cv_mor_bank_political_cont,\n    trif.cv_mor_bank_religious_cont,\n    trif.cv_mor_bank_religious_mag,\n    trif.cv_mor_bank_upscale_merch,\n    trif.cv_mor_bank_news_finan,\n    trif.cv_ncoa_cd,\n    trif.cv_ncoa_dt,\n    trif.cv_green_aware,\n    trif.cv_green_aware_deciles,\n    trif.cv_no_adults_unit,\n    trif.cv_no_pers_unit,\n    trif.cv_no_child_unit,\n    trif.cv_child_age_0_3,\n    trif.cv_child_age_4_6,\n    trif.cv_child_age_7_9,\n    trif.cv_child_age_10_12,\n    trif.cv_child_age_13_15,\n    trif.cv_child_age_16_18,\n    trif.cv_mosaic_household,\n    trif.cv_mosaic_zip4,\n    trif.cv_home_bus,\n    trif.cv_dwelling_type,\n    trif.cv_dwelling_unit_size,\n    trif.cv_length_of_residence,\n    trif.cv_household_comp,\n    trif.cv_hmeown_hmeown,\n    trif.cv_hmeown_prob_hmeown,\n    trif.cv_hmeown_comb_hmeown_renter,\n    trif.cv_est_curr_hme_val,\n    trif.cv_est_curr_hme_val_range,\n    trif.cv_cons_vw_proft,\n    trif.cv_incom_per_national,\n    trif.cv_county_ehi_per,\n    trif.cv_auto_in_market_new,\n    trif.cv_aut_mark_used,\n    trif.cv_aut_mark_used_0_5_vehicle,\n    trif.cv_aut_mark_used_11_vehicle,\n    trif.cv_aut_mark_used_6_10_vehicle,\n    trif.cv_est_inc_amtv5,\n    trif.cv_est_hh_incv5,\n    trif.cv_county_echv_index,\n    trif.cv_county_echv_per,\n    trif.cv_state_ehi_index,\n    trif.cv_county_ehi_index,\n    trif.cv_cen_rur_urban_county_szcd,\n    trif.cv_cbsa,\n    trif.cv_cbsa_type,\n    trif.cv_cape_edu_ispsa,\n    trif.cv_cape_edu_ispsa_decile,\n    trif.cv_cape_inc_fam_state_decile,\n    trif.cv_cape_dens_per_per_pop,\n    trif.cv_cape_age_pop_0_17,\n    trif.cv_cape_age_pop_0_4,\n    trif.cv_cape_age_pop_5_9,\n    trif.cv_cape_age_pop_10_13,\n    trif.cv_cape_age_pop_14_17,\n    trif.cv_cape_age_pop_18_99,\n    trif.cv_cape_age_pop_65_99,\n    trif.cv_cape_age_pop_median_age,\n    trif.cv_cape_built_median_hous_age,\n    trif.cv_cape_child_couple_famw_lt18,\n    trif.cv_cape_child_couple_famwo_lt18,\n    trif.cv_cape_child_wper_lt18,\n    trif.cv_cape_edu_pop25_med_edu_attain,\n    trif.cv_cape_occ_empid_health_tech,\n    trif.cv_cape_ethnic_pop_black_only,\n    trif.cv_cape_ethnic_pop_asian_only,\n    trif.cv_cape_ethnic_pop_hispanic,\n    trif.cv_cape_ethnic_pop_white_only,\n    trif.cv_cape_avg_hh_size,\n    trif.cv_cape_oohu_med_hme_val,\n    trif.cv_cape_hu_mob_hme,\n    trif.cv_cape_med_fam_hh_inc,\n    trif.cv_cape_lang_spanish_speak,\n    trif.cv_cape_occhu_own_occu,\n    trif.cv_cape_oochu_rent_occu,\n    trif.cv_cape_marr_couple_fam,\n    trif.cv_hh_int_read_bible_devo,\n    trif.cv_hh_pc_use_net_service,\n    trif.cv_hh_crafts,\n    trif.cv_hh_finan_stks_bond,\n    trif.cv_hh_finan_cds_money_mkt,\n    trif.cv_hh_finan_iras_currently,\n    trif.cv_hh_finan_mutual_funds,\n    trif.cv_hh_finan_real_estate,\n    CASE\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t80\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t70\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t60\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t50\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t40\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t30\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t20\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t10\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_amusement_park_visit\tas int)\t>\t0\tAND\tCAST(trif.cv_act_amusement_park_visit\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_amusement_park_visit\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t80\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t70\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t60\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t50\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t40\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t30\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t20\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t10\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_zoo_visit\tas int)\t>\t0\tAND\tCAST(trif.cv_act_zoo_visit\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_zoo_visit\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t80\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t70\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t60\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t50\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t40\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t30\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t20\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t10\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_coffee_connoisseurs\tas int)\t>\t0\tAND\tCAST(trif.cv_act_coffee_connoisseurs\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_coffee_connoisseurs\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t80\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t70\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t60\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t50\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t40\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t30\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t20\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t10\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_wine_lover\tas int)\t>\t0\tAND\tCAST(trif.cv_act_wine_lover\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_wine_lover\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t80\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t70\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t60\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t50\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t40\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t30\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t20\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t10\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_doit_yourself\tas int)\t>\t0\tAND\tCAST(trif.cv_act_doit_yourself\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_doit_yourself\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t80\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t70\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t60\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t50\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t40\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t30\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t20\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t10\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_hme_imp_spenders\tas int)\t>\t0\tAND\tCAST(trif.cv_act_hme_imp_spenders\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_hme_imp_spenders\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_hunt_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_hunt_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_hunt_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t80\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t70\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t60\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t50\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t40\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t30\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t20\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t10\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_digi_mag_buyer\tas int)\t>\t0\tAND\tCAST(trif.cv_act_digi_mag_buyer\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_digi_mag_buyer\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t80\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t70\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t60\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t50\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t40\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t30\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t20\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t10\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_attend_edu_pgm\tas int)\t>\t0\tAND\tCAST(trif.cv_act_attend_edu_pgm\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_attend_edu_pgm\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t80\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t70\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t60\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t50\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t40\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t30\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t20\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t10\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_video_gamer\tas int)\t>\t0\tAND\tCAST(trif.cv_act_video_gamer\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_video_gamer\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_mlb_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_mlb_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_mlb_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_nascar_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_nascar_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_nascar_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_nba_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_nba_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_nba_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_nfl_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_nfl_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_nfl_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_nhl_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_nhl_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_nhl_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_pga_tour_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_pga_tour_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_pga_tour_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t80\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t70\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t60\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t50\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t40\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t30\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t20\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t10\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t>\t0\tAND\tCAST(trif.cv_act_politics_viewing_tv_lib\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_politics_viewing_tv_lib\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t80\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t70\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t60\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t50\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t40\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t30\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t20\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t10\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t>\t0\tAND\tCAST(trif.cv_act_politics_viewing_tv_libcom\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_politics_viewing_tv_libcom\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t80\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t70\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t60\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t50\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t40\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t30\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t20\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t10\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t>\t0\tAND\tCAST(trif.cv_act_politics_viewing_tv_conserv\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_politics_viewing_tv_conserv\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t80\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t70\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t60\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t50\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t40\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t30\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t20\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t10\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_eats_fam_restaurant\tas int)\t>\t0\tAND\tCAST(trif.cv_act_eats_fam_restaurant\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_eats_fam_restaurant\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t80\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t70\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t60\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t50\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t40\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t30\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t20\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t10\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_eats_ff_restaurant\tas int)\t>\t0\tAND\tCAST(trif.cv_act_eats_ff_restaurant\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_eats_ff_restaurant\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t80\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t70\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t60\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t50\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t40\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t30\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t20\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t10\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_canoeing_kayaking\tas int)\t>\t0\tAND\tCAST(trif.cv_act_canoeing_kayaking\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_canoeing_kayaking\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t80\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t70\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t60\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t50\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t40\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t30\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t20\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t10\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_play_golf\tas int)\t>\t0\tAND\tCAST(trif.cv_act_play_golf\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_play_golf\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t80\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t70\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t60\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t50\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t40\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t30\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t20\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t10\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_gourment_cooking\tas int)\t>\t0\tAND\tCAST(trif.cv_act_gourment_cooking\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_gourment_cooking\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t80\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t70\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t60\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t50\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t40\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t30\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t20\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t10\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_cat_owners\tas int)\t>\t0\tAND\tCAST(trif.cv_act_cat_owners\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_cat_owners\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t80\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t70\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t60\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t50\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t40\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t30\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t20\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t10\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_dog_owners\tas int)\t>\t0\tAND\tCAST(trif.cv_act_dog_owners\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_dog_owners\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_pet_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_pet_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_pet_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t80\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t70\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t60\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t50\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t40\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t30\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t20\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t10\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_arts_crafts\tas int)\t>\t0\tAND\tCAST(trif.cv_act_arts_crafts\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_arts_crafts\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t80\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t70\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t60\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t50\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t40\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t30\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t20\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t10\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_scrapbooking\tas int)\t>\t0\tAND\tCAST(trif.cv_act_scrapbooking\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_scrapbooking\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t80\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t70\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t60\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t50\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t40\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t30\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t20\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t10\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_cultural_arts\tas int)\t>\t0\tAND\tCAST(trif.cv_act_cultural_arts\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_cultural_arts\t,\n    CASE\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t80\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t70\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t60\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t50\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t40\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t30\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t20\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t10\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_hobbies_gardening\tas int)\t>\t0\tAND\tCAST(trif.cv_hobbies_gardening\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_hobbies_gardening\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t80\tAND\tCAST(trif.cv_act_photography\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t70\tAND\tCAST(trif.cv_act_photography\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t60\tAND\tCAST(trif.cv_act_photography\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t50\tAND\tCAST(trif.cv_act_photography\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t40\tAND\tCAST(trif.cv_act_photography\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t30\tAND\tCAST(trif.cv_act_photography\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t20\tAND\tCAST(trif.cv_act_photography\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t10\tAND\tCAST(trif.cv_act_photography\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_photography\tas int)\t>\t0\tAND\tCAST(trif.cv_act_photography\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_photography\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t80\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t70\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t60\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t50\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t40\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t30\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t20\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t10\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_book_reader\tas int)\t>\t0\tAND\tCAST(trif.cv_act_book_reader\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_book_reader\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t80\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t70\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t60\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t50\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t40\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t30\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t20\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t10\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_ebook_reader\tas int)\t>\t0\tAND\tCAST(trif.cv_act_ebook_reader\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_ebook_reader\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t80\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t70\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t60\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t50\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t40\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t30\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t20\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t10\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_audiobook_reader\tas int)\t>\t0\tAND\tCAST(trif.cv_act_audiobook_reader\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_audiobook_listener,\n    CASE\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t80\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t70\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t60\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t50\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t40\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t30\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t20\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t10\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_avid_runners\tas int)\t>\t0\tAND\tCAST(trif.cv_act_avid_runners\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_avid_runners\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_outdoor_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_outdoor_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_outdoor_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t80\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t70\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t60\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t50\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t40\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t30\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t20\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t10\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_fishing\tas int)\t>\t0\tAND\tCAST(trif.cv_act_fishing\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_fishing\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t80\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t70\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t60\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t50\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t40\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t30\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t20\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t10\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_snow_sport\tas int)\t>\t0\tAND\tCAST(trif.cv_act_snow_sport\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_snow_sport\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t80\tAND\tCAST(trif.cv_act_boating\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t70\tAND\tCAST(trif.cv_act_boating\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t60\tAND\tCAST(trif.cv_act_boating\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t50\tAND\tCAST(trif.cv_act_boating\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t40\tAND\tCAST(trif.cv_act_boating\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t30\tAND\tCAST(trif.cv_act_boating\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t20\tAND\tCAST(trif.cv_act_boating\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t10\tAND\tCAST(trif.cv_act_boating\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_boating\tas int)\t>\t0\tAND\tCAST(trif.cv_act_boating\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_boating\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t80\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t70\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t60\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t50\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t40\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t30\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t20\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t10\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_plays_hockey\tas int)\t>\t0\tAND\tCAST(trif.cv_act_plays_hockey\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_plays_hockey\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t80\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t70\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t60\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t50\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t40\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t30\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t20\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t10\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_plays_soccer\tas int)\t>\t0\tAND\tCAST(trif.cv_act_plays_soccer\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_plays_soccer\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t80\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t70\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t60\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t50\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t40\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t30\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t20\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t10\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_plays_tennis\tas int)\t>\t0\tAND\tCAST(trif.cv_act_plays_tennis\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_plays_tennis\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t80\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t70\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t60\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t50\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t40\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t30\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t20\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t10\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_sport_enthusiast\tas int)\t>\t0\tAND\tCAST(trif.cv_act_sport_enthusiast\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_sport_enthusiast\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t80\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t70\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t60\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t50\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t40\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t30\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t20\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t10\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_healthy_living\tas int)\t>\t0\tAND\tCAST(trif.cv_act_healthy_living\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_healthy_living\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t80\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t70\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t60\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t50\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t40\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t30\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t20\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t10\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_fitness_enthus\tas int)\t>\t0\tAND\tCAST(trif.cv_act_fitness_enthus\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_fitness_enthus\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t80\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t70\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t60\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t50\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t40\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t30\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t20\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t10\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_on_diet\tas int)\t>\t0\tAND\tCAST(trif.cv_act_on_diet\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_on_diet\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t80\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t70\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t60\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t50\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t40\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t30\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t20\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t10\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_weight_conscious\tas int)\t>\t0\tAND\tCAST(trif.cv_act_weight_conscious\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_weight_conscious\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t80\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t70\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t60\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t50\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t40\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t30\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t20\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t10\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_casino_gambling\tas int)\t>\t0\tAND\tCAST(trif.cv_act_casino_gambling\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_casino_gambling\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t80\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t70\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t60\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t50\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t40\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t30\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t20\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t10\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_sweepstakes_lottery\tas int)\t>\t0\tAND\tCAST(trif.cv_act_sweepstakes_lottery\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_sweepstakes_lottery\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t80\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t70\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t60\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t50\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t40\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t30\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t20\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t10\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_music_download\tas int)\t>\t0\tAND\tCAST(trif.cv_act_music_download\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_music_download\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t80\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t70\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t60\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t50\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t40\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t30\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t20\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t10\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_music_stream\tas int)\t>\t0\tAND\tCAST(trif.cv_act_music_stream\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_music_stream\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_christian_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_christian_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_christian_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_classical_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_classical_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_classical_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_country_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_country_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_country_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_oldies_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_oldies_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_oldies_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_rock_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_rock_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_rock_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_80s_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_80s_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_80s_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_hiphop_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_hiphop_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_hiphop_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_alter_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_alter_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_alter_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_jazz_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_jazz_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_jazz_music\t,\n    CASE\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t90)\t\t\t\t\t\tTHEN\t1\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t80\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=90)\tTHEN\t2\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t70\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=80)\tTHEN\t3\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t60\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=70)\tTHEN\t4\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t50\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=60)\tTHEN\t5\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t40\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=50)\tTHEN\t6\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t30\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=40)\tTHEN\t7\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t20\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=30)\tTHEN\t8\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t10\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=20)\tTHEN\t9\n        WHEN\t(CAST(trif.cv_act_listen_pop_music\tas int)\t>\t0\tAND\tCAST(trif.cv_act_listen_pop_music\tas int)\t<=10)\tTHEN\t10\n        ELSE 0\n    END\tAS\tcv_act_listen_pop_music\t,\n    CASE\n        WHEN  cast(trif.cv_buyer_lap_own as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  80 AND cast(trif.cv_buyer_lap_own as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  70 AND cast(trif.cv_buyer_lap_own as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  60 AND cast(trif.cv_buyer_lap_own as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  50 AND cast(trif.cv_buyer_lap_own as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  40 AND cast(trif.cv_buyer_lap_own as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  30 AND cast(trif.cv_buyer_lap_own as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  20 AND cast(trif.cv_buyer_lap_own as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_lap_own as int) >  10 AND cast(trif.cv_buyer_lap_own as int) <= 20) THEN 8\n        WHEN (cast(trif.cv_buyer_lap_own as int) >   0 AND cast(trif.cv_buyer_lap_own as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_lap_own,\n    CASE\n        WHEN  cast(trif.cv_buyer_security_sys_own as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  80 AND cast(trif.cv_buyer_security_sys_own as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  70 AND cast(trif.cv_buyer_security_sys_own as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  60 AND cast(trif.cv_buyer_security_sys_own as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  50 AND cast(trif.cv_buyer_security_sys_own as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  40 AND cast(trif.cv_buyer_security_sys_own as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  30 AND cast(trif.cv_buyer_security_sys_own as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  20 AND cast(trif.cv_buyer_security_sys_own as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >  10 AND cast(trif.cv_buyer_security_sys_own as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_security_sys_own as int) >   0 AND cast(trif.cv_buyer_security_sys_own as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_security_sys_own,\n    CASE\n        WHEN  cast(trif.cv_buyer_tab_own as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  80 AND cast(trif.cv_buyer_tab_own as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  70 AND cast(trif.cv_buyer_tab_own as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  60 AND cast(trif.cv_buyer_tab_own as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  50 AND cast(trif.cv_buyer_tab_own as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  40 AND cast(trif.cv_buyer_tab_own as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  30 AND cast(trif.cv_buyer_tab_own as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  20 AND cast(trif.cv_buyer_tab_own as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_tab_own as int) >  10 AND cast(trif.cv_buyer_tab_own as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_tab_own as int) >   0 AND cast(trif.cv_buyer_tab_own as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_tab_own,\n    CASE\n        WHEN  cast(trif.cv_buyer_coupon_users as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  80 AND cast(trif.cv_buyer_coupon_users as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  70 AND cast(trif.cv_buyer_coupon_users as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  60 AND cast(trif.cv_buyer_coupon_users as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  50 AND cast(trif.cv_buyer_coupon_users as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  40 AND cast(trif.cv_buyer_coupon_users as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  30 AND cast(trif.cv_buyer_coupon_users as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  20 AND cast(trif.cv_buyer_coupon_users as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >  10 AND cast(trif.cv_buyer_coupon_users as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_coupon_users as int) >   0 AND cast(trif.cv_buyer_coupon_users as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_coupon_users,\n    CASE\n        WHEN  cast(trif.cv_buyer_lux_store_shopp as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  80 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  70 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  60 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  50 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  40 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  30 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  20 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >  10 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_lux_store_shopp as int) >   0 AND cast(trif.cv_buyer_lux_store_shopp as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_lux_store_shopp,\n    CASE\n        WHEN  cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  80 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  70 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  60 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  50 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  40 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  30 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  20 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >  10 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_lux_hme_goods_shopp as int) >   0 AND cast(trif.cv_buyer_lux_hme_goods_shopp as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_lux_hme_goods_shopp,\n    CASE\n        WHEN  cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  80 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  70 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  60 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  50 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  40 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  30 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  20 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >  10 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_yng_adult_cloth_shopp as int) >   0 AND cast(trif.cv_buyer_yng_adult_cloth_shopp as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_yng_adult_cloth_shopp,\n    CASE\n        WHEN  cast(trif.cv_buyer_supercenter_shopp as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  80 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  70 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  60 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  50 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  40 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  30 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  20 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >  10 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_supercenter_shopp as int) >   0 AND cast(trif.cv_buyer_supercenter_shopp as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_supercenter_shopp,\n    CASE\n        WHEN  cast(trif.cv_buyer_warehouse_club_mem as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  80 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  70 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  60 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  50 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  40 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  30 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  20 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >  10 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_warehouse_club_mem as int) >   0 AND cast(trif.cv_buyer_warehouse_club_mem as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_warehouse_club_mem,\n    CASE\n        WHEN  cast(trif.cv_buyer_loyalty_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  80 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  70 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  60 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  50 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  40 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  30 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  20 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >  10 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_loyalty_card_usr as int) >   0 AND cast(trif.cv_buyer_loyalty_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_loyalty_card_usr,\n    CASE\n        WHEN  cast(trif.cv_buyer_presence_auto as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  80 AND cast(trif.cv_buyer_presence_auto as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  70 AND cast(trif.cv_buyer_presence_auto as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  60 AND cast(trif.cv_buyer_presence_auto as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  50 AND cast(trif.cv_buyer_presence_auto as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  40 AND cast(trif.cv_buyer_presence_auto as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  30 AND cast(trif.cv_buyer_presence_auto as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  20 AND cast(trif.cv_buyer_presence_auto as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >  10 AND cast(trif.cv_buyer_presence_auto as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_presence_auto as int) >   0 AND cast(trif.cv_buyer_presence_auto as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_presence_auto,\n    CASE\n        WHEN  cast(trif.cv_buyer_nonpres_makeup_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  80 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  70 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  60 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  50 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  40 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  30 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  20 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >  10 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_nonpres_makeup_usr as int) >   0 AND cast(trif.cv_buyer_nonpres_makeup_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_nonpres_makeup_usr,\n    CASE\n        WHEN  cast(trif.cv_buyer_pres_makeup_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  80 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  70 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  60 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  50 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  40 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  30 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  20 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >  10 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_pres_makeup_usr as int) >   0 AND cast(trif.cv_buyer_pres_makeup_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_pres_makeup_usr,\n    CASE\n        WHEN  cast(trif.cv_buyer_highend_spirit_drinker as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  80 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  70 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  60 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  50 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  40 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  30 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  20 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >  10 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_buyer_highend_spirit_drinker as int) >   0 AND cast(trif.cv_buyer_highend_spirit_drinker as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_buyer_highend_spirit_drinker,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  80 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  70 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  60 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  50 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  40 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  30 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  20 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >  10 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) >   0 AND cast(trif.cv_lfstyl_lf_insure_plcy_hldr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_lf_insure_plcy_hldr,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  80 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  70 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  60 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  50 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  40 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  30 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  20 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >  10 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) >   0 AND cast(trif.cv_lfstyl_med_insure_plcy_hldrs as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_med_insure_plcy_hldrs,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  80 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  70 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  60 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  50 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  40 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  30 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  20 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >  10 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) >   0 AND cast(trif.cv_lfstyl_medicare_plcy_hldrs as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_medicare_plcy_hldrs,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_have_grand_child as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  80 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  70 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  60 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  50 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  40 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  30 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  20 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >  10 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_have_grand_child as int) >   0 AND cast(trif.cv_lfstyl_have_grand_child as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_have_grand_child,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_high_freq_business_trav as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  80 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  70 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  60 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  50 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  40 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  30 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  20 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >  10 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_high_freq_business_trav as int) >   0 AND cast(trif.cv_lfstyl_high_freq_business_trav as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_high_freq_business_trav,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  80 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  70 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  60 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  50 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  40 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  30 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  20 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >  10 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) >   0 AND cast(trif.cv_lfstyl_high_freq_cruise_enthus as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_high_freq_cruise_enthus,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  80 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  70 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  60 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  50 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  40 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  30 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  20 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >  10 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) >   0 AND cast(trif.cv_lfstyl_high_freq_domes_vacationer as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_high_freq_domes_vacationer,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  80 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  70 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  60 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  50 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  40 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  30 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  20 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >  10 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) >   0 AND cast(trif.cv_lfstyl_high_freq_forgn_vacationer as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_high_freq_forgn_vacationer,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  80 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  70 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  60 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  50 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  40 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  30 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  20 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >  10 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) >   0 AND cast(trif.cv_lfstyl_freq_fly_pgm_mem as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_freq_fly_pgm_mem,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  80 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  70 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  60 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  50 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  40 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  30 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  20 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >  10 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) >   0 AND cast(trif.cv_lfstyl_hostel_guest_loyal_pgm as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_hostel_guest_loyal_pgm,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_interest_religion as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  80 AND cast(trif.cv_lfstyl_interest_religion as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  70 AND cast(trif.cv_lfstyl_interest_religion as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  60 AND cast(trif.cv_lfstyl_interest_religion as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  50 AND cast(trif.cv_lfstyl_interest_religion as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  40 AND cast(trif.cv_lfstyl_interest_religion as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  30 AND cast(trif.cv_lfstyl_interest_religion as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  20 AND cast(trif.cv_lfstyl_interest_religion as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >  10 AND cast(trif.cv_lfstyl_interest_religion as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_interest_religion as int) >   0 AND cast(trif.cv_lfstyl_interest_religion as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_interest_religion,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_military_act as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  80 AND cast(trif.cv_lfstyl_military_act as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  70 AND cast(trif.cv_lfstyl_military_act as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  60 AND cast(trif.cv_lfstyl_military_act as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  50 AND cast(trif.cv_lfstyl_military_act as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  40 AND cast(trif.cv_lfstyl_military_act as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  30 AND cast(trif.cv_lfstyl_military_act as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  20 AND cast(trif.cv_lfstyl_military_act as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >  10 AND cast(trif.cv_lfstyl_military_act as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_military_act as int) >   0 AND cast(trif.cv_lfstyl_military_act as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_military_act,\n    CASE\n        WHEN  cast(trif.cv_lfstyl_military_inact as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  80 AND cast(trif.cv_lfstyl_military_inact as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  70 AND cast(trif.cv_lfstyl_military_inact as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  60 AND cast(trif.cv_lfstyl_military_inact as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  50 AND cast(trif.cv_lfstyl_military_inact as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  40 AND cast(trif.cv_lfstyl_military_inact as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  30 AND cast(trif.cv_lfstyl_military_inact as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  20 AND cast(trif.cv_lfstyl_military_inact as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >  10 AND cast(trif.cv_lfstyl_military_inact as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_lfstyl_military_inact as int) >   0 AND cast(trif.cv_lfstyl_military_inact as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_lfstyl_military_inact,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_charities as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  80 AND cast(trif.cv_donor_contrib_charities as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  70 AND cast(trif.cv_donor_contrib_charities as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  60 AND cast(trif.cv_donor_contrib_charities as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  50 AND cast(trif.cv_donor_contrib_charities as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  40 AND cast(trif.cv_donor_contrib_charities as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  30 AND cast(trif.cv_donor_contrib_charities as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  20 AND cast(trif.cv_donor_contrib_charities as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >  10 AND cast(trif.cv_donor_contrib_charities as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_charities as int) >   0 AND cast(trif.cv_donor_contrib_charities as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_charities,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_arts_charities as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  80 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  70 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  60 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  50 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  40 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  30 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  20 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >  10 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_arts_charities as int) >   0 AND cast(trif.cv_donor_contrib_arts_charities as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_arts_charities,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_edu_charities as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  80 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  70 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  60 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  50 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  40 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  30 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  20 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >  10 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_edu_charities as int) >   0 AND cast(trif.cv_donor_contrib_edu_charities as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_edu_charities,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_health_charities as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  80 AND cast(trif.cv_donor_contrib_health_charities as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  70 AND cast(trif.cv_donor_contrib_health_charities as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  60 AND cast(trif.cv_donor_contrib_health_charities as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  50 AND cast(trif.cv_donor_contrib_health_charities as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  40 AND cast(trif.cv_donor_contrib_health_charities as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  30 AND cast(trif.cv_donor_contrib_health_charities as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  20 AND cast(trif.cv_donor_contrib_health_charities as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >  10 AND cast(trif.cv_donor_contrib_health_charities as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_health_charities as int) >   0 AND cast(trif.cv_donor_contrib_health_charities as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_health_charities,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_political_charities as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  80 AND cast(trif.cv_donor_contrib_political_charities as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  70 AND cast(trif.cv_donor_contrib_political_charities as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  60 AND cast(trif.cv_donor_contrib_political_charities as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  50 AND cast(trif.cv_donor_contrib_political_charities as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  40 AND cast(trif.cv_donor_contrib_political_charities as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  30 AND cast(trif.cv_donor_contrib_political_charities as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  20 AND cast(trif.cv_donor_contrib_political_charities as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >  10 AND cast(trif.cv_donor_contrib_political_charities as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_political_charities as int) >   0 AND cast(trif.cv_donor_contrib_political_charities as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_political_charities,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_pvt_found as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  80 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  70 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  60 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  50 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  40 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  30 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  20 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >  10 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_pvt_found as int) >   0 AND cast(trif.cv_donor_contrib_pvt_found as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_pvt_found,\n    CASE\n        WHEN  cast(trif.cv_donor_contrib_volunteer as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  80 AND cast(trif.cv_donor_contrib_volunteer as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  70 AND cast(trif.cv_donor_contrib_volunteer as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  60 AND cast(trif.cv_donor_contrib_volunteer as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  50 AND cast(trif.cv_donor_contrib_volunteer as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  40 AND cast(trif.cv_donor_contrib_volunteer as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  30 AND cast(trif.cv_donor_contrib_volunteer as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  20 AND cast(trif.cv_donor_contrib_volunteer as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >  10 AND cast(trif.cv_donor_contrib_volunteer as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_donor_contrib_volunteer as int) >   0 AND cast(trif.cv_donor_contrib_volunteer as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_donor_contrib_volunteer,\n    CASE\n        WHEN  cast(trif.cv_finan_debit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  80 AND cast(trif.cv_finan_debit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  70 AND cast(trif.cv_finan_debit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  60 AND cast(trif.cv_finan_debit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  50 AND cast(trif.cv_finan_debit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  40 AND cast(trif.cv_finan_debit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  30 AND cast(trif.cv_finan_debit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  20 AND cast(trif.cv_finan_debit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >  10 AND cast(trif.cv_finan_debit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_debit_card_usr as int) >   0 AND cast(trif.cv_finan_debit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_debit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_finan_corp_credit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  80 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  70 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  60 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  50 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  40 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  30 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  20 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >  10 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_corp_credit_card_usr as int) >   0 AND cast(trif.cv_finan_corp_credit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_corp_credit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_finan_major_credit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  80 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  70 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  60 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  50 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  40 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  30 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  20 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >  10 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_major_credit_card_usr as int) >   0 AND cast(trif.cv_finan_major_credit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_major_credit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_finan_premium_credit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  80 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  70 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  60 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  50 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  40 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  30 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  20 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >  10 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_premium_credit_card_usr as int) >   0 AND cast(trif.cv_finan_premium_credit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_premium_credit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_finan_credit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  80 AND cast(trif.cv_finan_credit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  70 AND cast(trif.cv_finan_credit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  60 AND cast(trif.cv_finan_credit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  50 AND cast(trif.cv_finan_credit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  40 AND cast(trif.cv_finan_credit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  30 AND cast(trif.cv_finan_credit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  20 AND cast(trif.cv_finan_credit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >  10 AND cast(trif.cv_finan_credit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_credit_card_usr as int) >   0 AND cast(trif.cv_finan_credit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_credit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_finan_store_credit_card_usr as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  80 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  70 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  60 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  50 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  40 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  30 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  20 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >  10 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_finan_store_credit_card_usr as int) >   0 AND cast(trif.cv_finan_store_credit_card_usr as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_finan_store_credit_card_usr,\n    CASE\n        WHEN  cast(trif.cv_invest_retire_finan_plan as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  80 AND cast(trif.cv_invest_retire_finan_plan as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  70 AND cast(trif.cv_invest_retire_finan_plan as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  60 AND cast(trif.cv_invest_retire_finan_plan as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  50 AND cast(trif.cv_invest_retire_finan_plan as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  40 AND cast(trif.cv_invest_retire_finan_plan as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  30 AND cast(trif.cv_invest_retire_finan_plan as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  20 AND cast(trif.cv_invest_retire_finan_plan as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >  10 AND cast(trif.cv_invest_retire_finan_plan as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_invest_retire_finan_plan as int) >   0 AND cast(trif.cv_invest_retire_finan_plan as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_invest_retire_finan_plan,\n    CASE\n        WHEN  cast(trif.cv_invest_part_online_trade as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  80 AND cast(trif.cv_invest_part_online_trade as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  70 AND cast(trif.cv_invest_part_online_trade as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  60 AND cast(trif.cv_invest_part_online_trade as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  50 AND cast(trif.cv_invest_part_online_trade as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  40 AND cast(trif.cv_invest_part_online_trade as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  30 AND cast(trif.cv_invest_part_online_trade as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  20 AND cast(trif.cv_invest_part_online_trade as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >  10 AND cast(trif.cv_invest_part_online_trade as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_invest_part_online_trade as int) >   0 AND cast(trif.cv_invest_part_online_trade as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_invest_part_online_trade,\n    CASE\n        WHEN  cast(trif.cv_invest_brokerage_acct_own as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  80 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  70 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  60 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  50 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  40 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  30 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  20 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >  10 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_invest_brokerage_acct_own as int) >   0 AND cast(trif.cv_invest_brokerage_acct_own as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_invest_brokerage_acct_own,\n    CASE\n        WHEN  cast(trif.cv_invest_actv_investor as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  80 AND cast(trif.cv_invest_actv_investor as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  70 AND cast(trif.cv_invest_actv_investor as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  60 AND cast(trif.cv_invest_actv_investor as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  50 AND cast(trif.cv_invest_actv_investor as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  40 AND cast(trif.cv_invest_actv_investor as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  30 AND cast(trif.cv_invest_actv_investor as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  20 AND cast(trif.cv_invest_actv_investor as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_invest_actv_investor as int) >  10 AND cast(trif.cv_invest_actv_investor as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_invest_actv_investor as int) >   0 AND cast(trif.cv_invest_actv_investor as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_invest_actv_investor,\n    CASE\n        WHEN  cast(trif.cv_invest_mutual_fund_invest as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  80 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  70 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  60 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  50 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  40 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  30 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  20 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >  10 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_invest_mutual_fund_invest as int) >   0 AND cast(trif.cv_invest_mutual_fund_invest as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_invest_mutual_fund_invest,\n    CASE\n        WHEN  cast(trif.cv_memship_aarp_mem as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  80 AND cast(trif.cv_memship_aarp_mem as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  70 AND cast(trif.cv_memship_aarp_mem as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  60 AND cast(trif.cv_memship_aarp_mem as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  50 AND cast(trif.cv_memship_aarp_mem as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  40 AND cast(trif.cv_memship_aarp_mem as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  30 AND cast(trif.cv_memship_aarp_mem as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  20 AND cast(trif.cv_memship_aarp_mem as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >  10 AND cast(trif.cv_memship_aarp_mem as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_memship_aarp_mem as int) >   0 AND cast(trif.cv_memship_aarp_mem as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_memship_aarp_mem,\n    CASE\n        WHEN  cast(trif.cv_memship_union_mem as int) >  90                                THEN 1\n        WHEN (cast(trif.cv_memship_union_mem as int) >  80 AND cast(trif.cv_memship_union_mem as int) <= 90) THEN 2\n        WHEN (cast(trif.cv_memship_union_mem as int) >  70 AND cast(trif.cv_memship_union_mem as int) <= 80) THEN 3\n        WHEN (cast(trif.cv_memship_union_mem as int) >  60 AND cast(trif.cv_memship_union_mem as int) <= 70) THEN 4\n        WHEN (cast(trif.cv_memship_union_mem as int) >  50 AND cast(trif.cv_memship_union_mem as int) <= 60) THEN 5\n        WHEN (cast(trif.cv_memship_union_mem as int) >  40 AND cast(trif.cv_memship_union_mem as int) <= 50) THEN 6\n        WHEN (cast(trif.cv_memship_union_mem as int) >  30 AND cast(trif.cv_memship_union_mem as int) <= 40) THEN 7\n        WHEN (cast(trif.cv_memship_union_mem as int) >  20 AND cast(trif.cv_memship_union_mem as int) <= 30) THEN 8\n        WHEN (cast(trif.cv_memship_union_mem as int) >  10 AND cast(trif.cv_memship_union_mem as int) <= 20) THEN 9\n        WHEN (cast(trif.cv_memship_union_mem as int) >   0 AND cast(trif.cv_memship_union_mem as int) <= 10) THEN 10\n        ELSE 0\n    END AS cv_memship_union_mem,\n\n    trif.cv_tt_email,\n    -- Removed old cv_tt_* columns\n    trif.cv_p1_retail_shopp,\n    trif.cv_p2_retail_shopp,\n    trif.cv_p3_retail_shopp,\n    trif.cv_p4_retail_shopp,\n    trif.cv_p5_retail_shopp,\n    trif.cv_p6_retail_shopp,\n    trif.cv_p1_health_well_being,\n    trif.cv_p2_health_well_being,\n    trif.cv_p3_health_well_being,\n    trif.cv_p4_health_well_being,\n    trif.cv_p5_health_well_being,\n    trif.cv_p6_health_well_being,\n    trif.cv_p1_mobile_usrs,\n    trif.cv_p2_mobile_usrs,\n    trif.cv_p3_mobile_usrs,\n    trif.cv_p4_mobile_usrs,\n    trif.cv_p5_mobile_usrs,\n    trif.cv_p6_mobile_usrs,\n    trif.cv_p1_tech_adoption,\n    trif.cv_p2_tech_adoption,\n    trif.cv_p3_tech_adoption,\n    trif.cv_p4_tech_adoption,\n    trif.cv_p5_tech_adoption,\n    trif.cv_p6_tech_adoption,\n    trif.cv_p1_mor,\n    trif.cv_p2_mor,\n    trif.cv_p3_mor,\n    trif.cv_p4_mor,\n    trif.cv_p5_mor,\n    trif.cv_p6_mor,\n    trif.cv_mosaic_glob_hh,\n    trif.cv_mosaic_glob_zip4,\n    trif.cv_child_pres_0_18,\n    trif.cv_child_age_0_3_mdl,\n    trif.cv_child_age_scor_0_3,\n    trif.cv_child_age_4_6_mdl,\n    trif.cv_child_age_scor_4_6,\n    trif.cv_child_age_7_9_mdl,\n    trif.cv_child_age_scor_7_9_,\n    trif.cv_child_age_10_12_mdl,\n    trif.cv_child_age_scor_10_12_,\n    trif.cv_child_age_13_15_mdl,\n    trif.cv_child_age_scor_13_15,\n    trif.cv_child_age_16_18_mdl,\n    trif.cv_child_age_scor_16_18_,\n    trif.cv_hh_ail_meds_vis_ctnt_lenses,--populated with null value from Experian from Q4 2020\n    trif.cv_bhvr_bank_cntct_lens_wearer,--populated with null value from Experian from Q4 2020\n    trif.cv_bhvr_bnk_reg_pres_drug_users,--populated with null value from Experian from Q4 2020\n    trif.cv_bhvr_bnk_intrst_vid_dvd,\n    trif.cv_bhvr_bnk_intrst_golf,\n    trif.cv_bhvr_bnk_contri_charities,\n    trif.cv_bhvr_bnk_pet_enthusiast,\n    trif.cv_bhvr_bnk_intrst_cultural_arts,\n    trif.cv_bhvr_bnk_purchased_thu_mail,\n    trif.cv_bhvr_bnk_intrst_fitness,\n    trif.cv_bhvr_bnk_intrst_outdoors,\n    trif.cv_bhvr_bnk_intrst_travel,\n    trif.cv_bhvr_bnk_investors,\n    trif.cv_bhvr_bnk_pres_of_automobile,\n    trif.cv_bhvr_bnk_pres_of_credit_card,\n    trif.cv_bhvr_bnk_intrst_gardening,\n    trif.cv_bhvr_bnk_intrst_crafts,\n    trif.cv_bhvr_bnk_collectors,\n    trif.cv_bhvr_bnk_cruise_enthusiasts,\n    trif.cv_bhvr_bnk_intrst_sports,\n    trif.cv_bhvr_bnk_intrst_grmt_cooking,\n    trif.cv_bhvr_bnk_sweepstakes_gambling,\n    trif.cv_bhvr_bnk_intrst_politics,\n    trif.cv_bhvr_bnk_intrst_music,\n    trif.cv_bhvr_bnk_intrst_reading,\n    trif.cv_bhvr_bnk_child_parenting_prod,\n    trif.cv_bhvr_bnk_do_it_yourselfer,\n    trif.cv_bhvr_bnk_self_improvement,\n    trif.cv_bhvr_bnk_intrst_in_religion,\n    trif.cv_bhvr_bnk_grandparent,\n    trif.cv_bhvr_bnk_intrst_clothing,\n    trif.cv_bhvr_bnk_donates_envrn_causes,\n    trif.cv_bhvr_bnk_invests_mutual_funds,\n    trif.cv_bhvr_bnk_wght_conscious,\n    trif.cv_bhvr_bnk_mail_order_multibuyer,\n    trif.cv_bhvr_bnk_dog_enthusiasts,\n    trif.cv_bhvr_bnk_cat_enthusiasts,\n    trif.cv_bhvr_bnk_hlthy_living,\n    trif.cv_bhvr_bnk_intrst_automotive,\n    trif.cv_bhvr_bnk_intrst_skiing,\n    trif.cv_bhvr_bnk_intrst_boating,\n    trif.cv_bhvr_bnk_pres_of_cell_phone,\n    trif.cv_bhvr_bnk_commn_connectivity,\n    trif.cv_bhvr_bnk_computers,\n    trif.cv_bhvr_bnk_hi_tech_owner,\n    trif.cv_bhvr_bnk_home_decor_furnish,\n    trif.cv_bhvr_bnk_homeentmnt_video,\n    trif.cv_bhvr_bnk_kitchen_aids_applns,\n    trif.cv_bhvr_bnk_mo_buyer_music_video,\n    trif.cv_bhvr_bnk_mob_books,\n    trif.cv_bhvr_bnk_mo_buyer_cloth_shoe,\n    trif.cv_bhvr_bnk_mob_ins_fin,\n    trif.cv_bhvr_bnk_mail_order_buyer_gift,\n    trif.cv_bhvr_bnk_mob_grdng,\n    trif.cv_bhvr_bnk_mob_jewelry,\n    trif.cv_bhvr_bnk_clas_opra_big_bnd_mus,\n    trif.cv_bhvr_bnk_country_music,\n    trif.cv_bhvr_bnk_christian_music,\n    trif.cv_bhvr_bnk_rock_music,\n    trif.cv_bhvr_bnk_internet_online_subs,\n    trif.cv_bhvr_bnk_intrst_photo,\n    trif.cv_bhvr_bnk_purchase_via_online,\n    trif.cv_bhvr_bnk_intrst_affluence_ls,\n    trif.cv_bhvr_bnk_domestic_traveler,\n    trif.cv_bhvr_bnk_foreign_traveler,\n    trif.cv_bhvr_bnk_pres_of_prem_cc,\n    trif.cv_bhvr_bnk_active_military,\n    trif.cv_bhvr_bnk_inactive_military,\n    trif.cv_hh_acty_int_hob_photography,\n    trif.cv_hh_acty_int_hobbies_gardening,\n    trif.cv_hh_acty_int_hob_home_ws_diy,\n    trif.cv_hh_acty_int_hob_cars_auto_rep,\n    trif.cv_hh_acty_int_hob_bird_watching,\n    trif.cv_hh_acty_int_hob_self_imprvmnt,\n    trif.cv_hh_acty_int_music_chrstn_gosp,\n    trif.cv_hh_acty_int_music_r_and_b,\n    trif.cv_hh_acty_int_music_jazz_new_age,\n    trif.cv_hh_acty_int_music_classical,\n    trif.cv_hh_acty_int_music_rock_n_roll,\n    trif.cv_hh_acty_int_music_country,\n    trif.cv_hh_acty_int_music_in_gen,\n    trif.cv_hh_acty_int_music_other_music,\n    trif.cv_hh_acty_int_read_bs_fiction,\n    trif.cv_hh_acty_int_childrens_reading,\n    trif.cv_hh_acty_int_reading_computer,\n    trif.cv_hh_acty_int_read_cook_culinary,\n    trif.cv_hh_acty_int_reading_country_ls,\n    trif.cv_hh_acty_int_read_entmnt_ppl,\n    trif.cv_hh_acty_int_reading_fashion,\n    trif.cv_hh_acty_int_reading_history,\n    trif.cv_hh_acty_int_read_intr_decor,\n    trif.cv_hh_acty_int_read_med_hlth,\n    trif.cv_hh_acty_int_reading_military,\n    trif.cv_hh_acty_int_reading_mystery,\n    trif.cv_hh_acty_int_read_ntrl_hlth_rmd,\n    trif.cv_hh_acty_int_reading_romance,\n    trif.cv_hh_acty_int_read_sc_fiction,\n    trif.cv_hh_acty_int_read_sc_tech,\n    trif.cv_hh_acty_int_sports_read,\n    trif.cv_hh_acty_int_read_wrld_news_pol,\n    trif.cv_hh_acty_int_book_reader,\n    trif.cv_hh_acty_int_soc_ani_wf_soc,\n    trif.cv_hh_acty_int_soc_env_wildlife,\n    trif.cv_hh_acty_int_soc_pol_cons,\n    trif.cv_hh_acty_int_soc_pol_liberal,\n    trif.cv_hh_acty_int_soc_religion,\n    trif.cv_hh_acty_int_soc_child,\n    trif.cv_hh_acty_int_soc_veterans,\n    trif.cv_hh_acty_int_soc_hlth,\n    trif.cv_hh_acty_int_soc_othr,\n    trif.cv_hh_acty_int_sportsbaseball,\n    trif.cv_hh_acty_int_sportsbasketball,\n    trif.cv_hh_acty_int_sports_rec_hockey,\n    trif.cv_hh_acty_int_sportscampng_hikng,\n    trif.cv_hh_acty_int_sports_rec_hunting,\n    trif.cv_hh_acty_int_sports_rec_fishing,\n    trif.cv_hh_acty_int_sports_rec_nascar,\n    trif.cv_hh_acty_int_sprt_fitness_exer,\n    trif.cv_hh_acty_int_sportsscuba_diving,\n    trif.cv_hh_acty_int_sportsfootball,\n    trif.cv_hh_acty_int_sports_rec_golf,\n    trif.cv_hh_acty_int_sportssnow_skng,\n    trif.cv_hh_acty_int_boating_sailing,\n    trif.cv_hh_acty_int_sports_rec_walking,\n    trif.cv_hh_acty_int_sports_rec_cycling,\n    trif.cv_hh_acty_int_sportsmotorcycles,\n    trif.cv_hh_acty_int_running_jogging,\n    trif.cv_hh_acty_int_sports_rec_soccer,\n    trif.cv_hh_acty_int_sportsswimming,\n    trif.cv_hh_acty_int_play_sprt_in_gen,\n    trif.cv_hh_acty_int_sweepstakes,\n    trif.cv_hh_acty_int_swpstakes_loteries,\n    trif.cv_hh_acty_int_casino_gambling,\n    trif.cv_hh_acty_int_travel_cruise,\n    trif.cv_hh_acty_int_trvl_inter,\n    trif.cv_hh_acty_int_travel_domestic,\n    trif.cv_hh_acty_int_travel_time_share,\n    trif.cv_hh_acty_int_trvl_rec_vehicle,\n    trif.cv_hh_acty_int_rv_travel,\n    trif.cv_hh_acty_int_trvl_bus_trvl,\n    trif.cv_hh_acty_int_trvl_per_trvl,\n    trif.cv_hh_acty_int_pc_i_own_computer,\n    trif.cv_hh_acty_int_pc__i_usedsl_hispd,\n    trif.cv_hh_acty_int_pc_i_plan_buy_comp,\n    trif.cv_hh_acty_int_eg_cell_phone,\n    trif.cv_hh_acty_int_eg_com_disc_player,\n    trif.cv_hh_acty_int_eg_dvd_player,\n    trif.cv_hh_acty_int_eg_satellite_dish,\n    trif.cv_hh_acty_int_eg_dig_cam,\n    trif.cv_hh_acty_int_eg_hdtv,\n    trif.cv_hh_acty_int_eg__electronics,\n    trif.cv_hh_acty_int_eg_pda_blackberry,\n    trif.cv_hh_acty_int_eg_video_camera,\n    trif.cv_hh_acty_int_eg_video_game_sys,\n    trif.cv_hh_acty_int_eg_hom_theater_sys,\n    trif.cv_hh_acty_int_eg_cellph_priphln,\n    trif.cv_hh_acty_int_cltrl_arts,\n    trif.cv_hh_acty_int_magzn_bus_fin,\n    trif.cv_hh_acty_int_childrens_magzn,\n    trif.cv_hh_acty_int_magzn_comp_elctrns,\n    trif.cv_hh_acty_int_magzn_crft_gms_hob,\n    trif.cv_hh_acty_int_magazines_fitness,\n    trif.cv_hh_acty_int_mgzn_fd_wine_ckng,\n    trif.cv_hh_acty_int_magzn_grdng_magzn,\n    trif.cv_hh_acty_int_magzn_hntg_fshng,\n    trif.cv_hh_acty_int_magazines_mens,\n    trif.cv_hh_acty_int_magazines_music,\n    trif.cv_hh_acty_int_mgzn_prtntg_babies,\n    trif.cv_hh_acty_int_mgzn_sports_mgzn,\n    trif.cv_hh_acty_int_magzn_subs,\n    trif.cv_hh_acty_int_magazines_travel,\n    trif.cv_hh_acty_int_magazines_womens,\n    trif.cv_hh_acty_int_magzn_cur_evnt_nws,\n    trif.cv_hh_ls_veh_hav_leased_a_veh,\n    trif.cv_hh_ls_veh_hav_purchased_a_veh,\n    trif.cv_hh_ls_afltn_mem_book_club,\n    trif.cv_hh_ls_afltn_mem_music_club,\n    trif.cv_hh_ls_cc_amer_exp_prem,\n    trif.cv_hh_ls_cc_amer_exp_regular,\n    trif.cv_hh_ls_cc_discover_premium,\n    trif.cv_hh_ls_cc_discover_regular,\n    trif.cv_hh_ls_cc_other_card_premium,\n    trif.cv_hh_ls_cc_other_card_regular,\n    trif.cv_hh_ls_cc_store_ret_reg,\n    trif.cv_hh_ls_cc_visa_regular,\n    trif.cv_hh_ls_cc_mastercard_regular,\n    trif.cv_hh_ls_contri_hmntrn,\n    trif.cv_hh_ls_entmnt_buy_prercrdvideo,\n    trif.cv_hh_ls_entmnt_wtch_cabletv,\n    trif.cv_hh_ls_entmnt_watch_videos,\n    trif.cv_hh_ls_outdoor_lvng_entmnt,\n    trif.cv_hh_ls_entmnt_season_hldy_prod,\n    trif.cv_hh_ls_fin_iras_future_intrst,\n    trif.cv_hh_ls_fin_life_insur_cur,\n    trif.cv_hh_ls_fin_mutl_funds,\n    trif.cv_hh_ls_fin_othr_invest_cur,\n    trif.cv_hh_ls_fin_othr_invest_future,\n    trif.cv_hh_ls_fin_real_estate_fut,\n    trif.cv_hh_ls_fin_stks_bond_fut,\n    trif.cv_hh_ls_grndkids_proud_grndprnt,\n    trif.cv_hh_ls_info_byng_purc_by_intrnt,\n    trif.cv_hh_ls_mil_gov_active_mil_mem,\n    trif.cv_hh_ls_military_gov_vetern,\n    trif.cv_hh_lifestyl_pets_own_a_cat,\n    trif.cv_hh_lifestyl_pets_own_a_dog,\n    trif.cv_hh_lifestyl_pets_own_a_pet,\n    trif.cv_hh_ls_biy_internet,\n    trif.cv_hh_ls_bib_mail,\n    trif.cv_hh_ls_bib_catalog,\n    trif.cv_hh_ls_buying_interest_apparel,\n    trif.cv_hh_ls_buying_intrst_comp_elec,\n    trif.cv_hh_ls_buying_intrst_book_music,\n    trif.cv_hh_ls_bi_home_garden,\n    trif.cv_hh_ls_bi_sports_related,\n    trif.cv_hh_ls_buying_interest_big_tall,\n    trif.cv_hh_ls_byng_intrst_moc,\n    trif.cv_hh_ls_byng_intrst_mog,\n    trif.cv_hh_ls_bi_mail_order_gift,\n    trif.cv_hh_ls_byng_intrst_mjc,\n    trif.cv_hh_ls_bi_mail_music_videos,\n    trif.cv_hh_ls_byng_intrst_mcp,\n    trif.cv_hh_ls_bi_mail_books_magzn,\n    trif.cv_hh_ls_bi_food_and_beverage,\n    trif.cv_hh_ls_bi_home_decorating,\n    trif.cv_hh_ls_bi_furniture,\n    trif.cv_hh_ls_bi_domestics,\n    trif.cv_hh_ls_buying_interest_footwear,\n    trif.cv_hh_ml_ordr_apprl_acsries,\n    trif.cv_cape_age_pop_0_9,\n    trif.cv_cape_age_pop_0_24,\n    trif.cv_cape_age_pop_25_34,\n    trif.cv_cape_age_pop_35_44,\n    trif.cv_cape_age_pop_45_54,\n    trif.cv_cape_age_pop_55_64,\n    trif.cv_cape_age_pop_18_65,\n    trif.cv_cape_age_pop_75_99,\n    trif.cv_cape_pop_med_age_of_adults_18,\n    trif.cv_cape_child_hh_fem_hh_fam_plt18,\n    trif.cv_cape_child_hh_without_per_lt18,\n    trif.cv_cape_cmte_com_travtowrk_60_89,\n    trif.cv_cape_cmter_travtowork_90,\n    trif.cv_cape_cmter_avg_trav_timetowork,\n    trif.cv_cape_cmter_med_trav_timetowork,\n    trif.cv_cape_cmte_wrkrs_carpld_to_work,\n    trif.cv_cape_emply_fem16_lbr_frce,\n    trif.cv_cape_etnc_hh_nonhisp_whte_only,\n    trif.cv_cape_etnc_pop_black_only_hisp,\n    trif.cv_cape_etnc_pop_non_hispanic,\n    trif.cv_cape_etnc_pop_white_only_hisp,\n    trif.cv_cape_inc_hh_inc_under_10k,\n    trif.cv_cape_inc_hh_inc_10_14k,\n    trif.cv_cape_inc_hh_inc_15_19k,\n    trif.cv_cape_inc_hh_inc_20_24k,\n    trif.cv_cape_inc_hh_inc_25_29k,\n    trif.cv_cape_inc_hh_inc_30_34k,\n    trif.cv_cape_inc_hh_inc_35_39k,\n    trif.cv_cape_inc_hh_inc_40_44k,\n    trif.cv_cape_inc_hh_inc_45_49k,\n    trif.cv_cape_inc_hh_inc_50_59k,\n    trif.cv_cape_inc_hh_inc_60_74k,\n    trif.cv_cape_inc_hh_inc_75_99k,\n    trif.cv_cape_inc_hh_inc_100_124k,\n    trif.cv_cape_inc_hh_inc_125_149k,\n    trif.cv_cape_inc_hh_inc_150_199k,\n    trif.cv_cape_inc_hh_inc_200_249k,\n    trif.cv_cape_inc_hh_inc_250_499k,\n    trif.cv_cape_inc_hh_incm_500k_more,\n    trif.cv_cape_inc_hh_med_hh_inc,\n    trif.cv_cape_inc_hh_med_non_fam_hh_inc,\n    trif.cv_cape_inc_pop_per_capita_income,\n    trif.cv_cape_ind_empld_acmdn_food_svcs,\n    trif.cv_cape_ind_empld_adm_supwstemgmt,\n    trif.cv_cape_ind_empld_agr_fst_fsh_hnt,\n    trif.cv_cape_ind_empld_arts_entmnt,\n    trif.cv_cape_indus_empld_construction,\n    trif.cv_cape_ind_empld_edu_srvs,\n    trif.cv_cape_ind_empld_fin_and_ins,\n    trif.cv_cape_indus_empld_hc_soc_ass,\n    trif.cv_cape_indus_empld_information,\n    trif.cv_cape_indus_empld_manufacturing,\n    trif.cv_cape_ind_empld_mgmt_com_entrps,\n    trif.cv_cape_indus_empld_mining,\n    trif.cv_cape_ind_empld_oth_svcs,\n    trif.cv_cape_ind_empld_public_admin,\n    trif.cv_cape_ind_empld_rer_lsng,\n    trif.cv_cape_indus_empld_retail_trade,\n    trif.cv_cape_ind_empld_prof_sc_tch_scs,\n    trif.cv_cape_ind_empld_trans_wh,\n    trif.cv_cape_indus_empld_utilities,\n    trif.cv_cape_ind_empld_wholesale_trade,\n    trif.cv_cape_mrtg_oohu_first_mrtg_only,\n    trif.cv_cape_move_occhu_med_len_res,\n    trif.cv_cape_rent_rntl_median_rent,\n    trif.cv_cape_tenancy_hu_occupied,\n    trif.cv_cape_typ_pop_child_in_fam_hh,\n    trif.cv_cape_typ_pop_in_family_hh,\n    trif.cv_cape_typ_pop_in_non_family_hh,\n    trif.cv_cape_pop_nat_adpt_child_fam_hh,\n    trif.cv_cape_typ_pop_spouse_in_fam_hh,\n    trif.cv_cape_urban_pop_rural_on_farms,\n    trif.cv_cape_urban_pop_rur_not_on_frms,\n    trif.cv_cape_urban_pop_in_urban_area,\n    trif.cv_cape_urban_pop_in_urban_clstrs,\n    trif.cv_cape_inc_fam_inc_state_indx,\n    trif.cv_prop_rlty_home_year_built,\n    trif.cv_mrtg_home_pur_mrtg_term,\n    trif.cv_mrtg_home_pur_home_pur_date,\n    trif.cv_mrtg_home_pur_mrtg_rate_type,\n    trif.cv_mrtg_home_pur_mrtg_loan_type,\n    trif.cv_mrtg_home_purc_type_of_purc,\n    trif.cv_mrtg_home_pur_pur_amt_rng,\n    trif.cv_mrtg_home_pur_mrtg_amt_rng,\n    trif.cv_rlty_mdl_confdnce_cdv2,\n    trif.cv_rlty_mdl_est_avl_equity_cd_v2,\n    trif.cv_rlty_mdl_est_avl_equity_amt_v2,\n    trif.cv_rlty_mdl_est_cur_lntoval_ratv2,\n    trif.cv_rlty_mdl_est_cur_mrtg_pmtv21,\n    trif.cv_rlty_mdl_est_cur_mrtg_pmtv22,\n    trif.cv_rlty_mdl_est_cur_mrtg_amtcdv2,\n    trif.cv_rlty_mdl_est_cur_mrtg_am_v2,\n\n    trif.hh_size,\n    trif.hoh_age,\n    trif.hoh_lifestage,\n    trif.hoh_ethnicity,\n    trif.hoh_hispanic,\n    trif.hh_income,\n    trif.hh_per_cap_income,\n    trif.hh_presence_of_child,\n    trif.hh_presence_of_child_age_0_6,\n    trif.hh_presence_of_child_age_7_12,\n    trif.hh_presence_of_child_age_13_18,\n    trif.hh_age_of_old_child,\n    trif.hh_presence_of_gender,\n    trif.hh_millennial_male,\n    trif.hh_millennial_female,\n    trif.hh_gen_x_male,\n    trif.hh_gen_x_female,\n    trif.hh_young_boomer_male,\n    trif.hh_young_boomer_female,\n    trif.hh_post_boomer_male,\n    trif.hh_post_boomer_female,\n    trif.hh_county_size,\n    trif.hh_urban_suburban_rural,\n    trif.hh_county,\n    trif.hh_state,\n    trif.hh_cbsa,\n\n    trif.geo_zipcode,\n    trif.geo_cvs,\n    trif.geo_target,\n    trif.geo_aldi,\n    trif.geo_costco,\n    trif.geo_sams_club,\n    trif.geo_7_eleven,\n    trif.geo_circle_k,\n    trif.geo_kroger_banner,\n    trif.geo_all_other_kroger,\n    trif.geo_albertsons_safeway,\n    trif.geo_publix,\n    trif.geo_ahold_delhaize,\n    trif.geo_wakefern,\n    trif.geo_hy_vee,\n    trif.geo_heb,\n    trif.geo_bi_lo,\n    trif.geo_trader_joes,\n    trif.geo_whole_foods,\n    trif.geo_walgreens,\n    trif.geo_wm_neighborhood_market,\n    trif.geo_all_other_walmart,\n    trif.geo_bjs,\n    trif.geo_speedway,\n    trif.geo_dollar_general,\n    trif.geo_family_dollar,\n    trif.geo_all_other_grocery,\n    trif.geo_all_other_drug,\n    trif.geo_all_other_mass,\n    trif.geo_all_other_club,\n    trif.geo_total_c_and_g,\n    trif.geo_all_other_c_and_g,\n    trif.geo_all_other_dollar,\n    trif.geo_amazon_com,\n    trif.geo_walmart_com,\n\n    trif.geo_all_other_ao,\n    trif.geo_not_assigned,\n\n    trif.is_all_other_ao,\n    trif.is_not_assigned,\n\n    -- INFOSCOUT CAP TRIP COUNT\n    trif.is_7_eleven_cap,\n    CASE\n        WHEN  trif.is_7_eleven_cap >  isper.is_7_eleven_90                                                         THEN 10\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_80 AND trif.is_7_eleven_cap <= isper.is_7_eleven_90) THEN 9\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_70 AND trif.is_7_eleven_cap <= isper.is_7_eleven_80) THEN 8\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_60 AND trif.is_7_eleven_cap <= isper.is_7_eleven_70) THEN 7\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_50 AND trif.is_7_eleven_cap <= isper.is_7_eleven_60) THEN 6\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_40 AND trif.is_7_eleven_cap <= isper.is_7_eleven_50) THEN 5\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_30 AND trif.is_7_eleven_cap <= isper.is_7_eleven_40) THEN 4\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_20 AND trif.is_7_eleven_cap <= isper.is_7_eleven_30) THEN 3\n        WHEN (trif.is_7_eleven_cap >  isper.is_7_eleven_10 AND trif.is_7_eleven_cap <= isper.is_7_eleven_20) THEN 2\n        WHEN (trif.is_7_eleven_cap > 0.0 AND trif.is_7_eleven_cap <= isper.is_7_eleven_10                  ) THEN 1\n        ELSE 0\n    END AS is_7_eleven_decile,\n\n    trif.is_ahold_delhaize_cap,\n    CASE\n        WHEN  trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_90                                                         THEN 10\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_80 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_90) THEN 9\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_70 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_80) THEN 8\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_60 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_70) THEN 7\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_50 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_60) THEN 6\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_40 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_50) THEN 5\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_30 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_40) THEN 4\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_20 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_30) THEN 3\n        WHEN (trif.is_ahold_delhaize_cap >  isper.is_ahold_delhaize_10 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_20) THEN 2\n        WHEN (trif.is_ahold_delhaize_cap > 0.0 AND trif.is_ahold_delhaize_cap <= isper.is_ahold_delhaize_10 )                        THEN 1\n        ELSE 0\n    END AS is_ahold_delhaize_decile,\n\n    trif.is_albertsons_cap,\n    CASE\n        WHEN  trif.is_albertsons_cap >  isper.is_albertsons_90                                                       THEN 10\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_80 AND trif.is_albertsons_cap <= isper.is_albertsons_90) THEN 9\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_70 AND trif.is_albertsons_cap <= isper.is_albertsons_80) THEN 8\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_60 AND trif.is_albertsons_cap <= isper.is_albertsons_70) THEN 7\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_50 AND trif.is_albertsons_cap <= isper.is_albertsons_60) THEN 6\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_40 AND trif.is_albertsons_cap <= isper.is_albertsons_50) THEN 5\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_30 AND trif.is_albertsons_cap <= isper.is_albertsons_40) THEN 4\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_20 AND trif.is_albertsons_cap <= isper.is_albertsons_30) THEN 3\n        WHEN (trif.is_albertsons_cap >  isper.is_albertsons_10 AND trif.is_albertsons_cap <= isper.is_albertsons_20) THEN 2\n        WHEN (trif.is_albertsons_cap > 0.0 AND trif.is_albertsons_cap <= isper.is_albertsons_10 )                    THEN 1\n        ELSE 0\n    END AS is_albertsons_decile,\n\n    trif.is_aldi_cap,\n    CASE\n        WHEN  trif.is_aldi_cap >  isper.is_aldi_90                                                         THEN 10\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_80 AND trif.is_aldi_cap <= isper.is_aldi_90) THEN 9\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_70 AND trif.is_aldi_cap <= isper.is_aldi_80) THEN 8\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_60 AND trif.is_aldi_cap <= isper.is_aldi_70) THEN 7\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_50 AND trif.is_aldi_cap <= isper.is_aldi_60) THEN 6\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_40 AND trif.is_aldi_cap <= isper.is_aldi_50) THEN 5\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_30 AND trif.is_aldi_cap <= isper.is_aldi_40) THEN 4\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_20 AND trif.is_aldi_cap <= isper.is_aldi_30) THEN 3\n        WHEN (trif.is_aldi_cap >  isper.is_aldi_10 AND trif.is_aldi_cap <= isper.is_aldi_20) THEN 2\n        WHEN (trif.is_aldi_cap > 0.0 AND trif.is_aldi_cap <= isper.is_aldi_10 )              THEN 1\n        ELSE 0\n    END AS is_aldi_decile,\n\n    trif.is_amazon_com_cap,\n    CASE\n        WHEN  trif.is_amazon_com_cap >  isper.is_amazon_com_90                                                         THEN 10\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_80 AND trif.is_amazon_com_cap <= isper.is_amazon_com_90) THEN 9\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_70 AND trif.is_amazon_com_cap <= isper.is_amazon_com_80) THEN 8\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_60 AND trif.is_amazon_com_cap <= isper.is_amazon_com_70) THEN 7\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_50 AND trif.is_amazon_com_cap <= isper.is_amazon_com_60) THEN 6\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_40 AND trif.is_amazon_com_cap <= isper.is_amazon_com_50) THEN 5\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_30 AND trif.is_amazon_com_cap <= isper.is_amazon_com_40) THEN 4\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_20 AND trif.is_amazon_com_cap <= isper.is_amazon_com_30) THEN 3\n        WHEN (trif.is_amazon_com_cap >  isper.is_amazon_com_10 AND trif.is_amazon_com_cap <= isper.is_amazon_com_20) THEN 2\n        WHEN (trif.is_amazon_com_cap > 0.0 AND trif.is_amazon_com_cap <= isper.is_amazon_com_10)                \t THEN 1\n        ELSE 0\n    END AS is_amazon_com_decile,\n\n    trif.is_bi_lo_cap,\n    CASE\n        WHEN  trif.is_bi_lo_cap >  isper.is_bi_lo_90                                                         THEN 10\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_80 AND trif.is_bi_lo_cap <= isper.is_bi_lo_90) THEN 9\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_70 AND trif.is_bi_lo_cap <= isper.is_bi_lo_80) THEN 8\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_60 AND trif.is_bi_lo_cap <= isper.is_bi_lo_70) THEN 7\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_50 AND trif.is_bi_lo_cap <= isper.is_bi_lo_60) THEN 6\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_40 AND trif.is_bi_lo_cap <= isper.is_bi_lo_50) THEN 5\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_30 AND trif.is_bi_lo_cap <= isper.is_bi_lo_40) THEN 4\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_20 AND trif.is_bi_lo_cap <= isper.is_bi_lo_30) THEN 3\n        WHEN (trif.is_bi_lo_cap >  isper.is_bi_lo_10 AND trif.is_bi_lo_cap <= isper.is_bi_lo_20) THEN 2\n        WHEN (trif.is_bi_lo_cap > 0.0 AND trif.is_bi_lo_cap <= isper.is_bi_lo_10)                THEN 1\n        ELSE 0\n    END AS is_bi_lo_decile,\n\n    trif.is_bjs_cap,\n    CASE\n        WHEN  trif.is_bjs_cap >  isper.is_bjs_90                                                         THEN 10\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_80 AND trif.is_bjs_cap <= isper.is_bjs_90) THEN 9\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_70 AND trif.is_bjs_cap <= isper.is_bjs_80) THEN 8\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_60 AND trif.is_bjs_cap <= isper.is_bjs_70) THEN 7\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_50 AND trif.is_bjs_cap <= isper.is_bjs_60) THEN 6\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_40 AND trif.is_bjs_cap <= isper.is_bjs_50) THEN 5\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_30 AND trif.is_bjs_cap <= isper.is_bjs_40) THEN 4\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_20 AND trif.is_bjs_cap <= isper.is_bjs_30) THEN 3\n        WHEN (trif.is_bjs_cap >  isper.is_bjs_10 AND trif.is_bjs_cap <= isper.is_bjs_20) THEN 2\n        WHEN (trif.is_bjs_cap > 0.0 AND trif.is_bjs_cap <= isper.is_bjs_10)              THEN 1\n        ELSE 0\n    END AS is_bjs_decile,\n\n    trif.is_circle_k_cap,\n    CASE\n        WHEN  trif.is_circle_k_cap >  isper.is_circle_k_90                                                         THEN 10\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_80 AND trif.is_circle_k_cap <= isper.is_circle_k_90) THEN 9\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_70 AND trif.is_circle_k_cap <= isper.is_circle_k_80) THEN 8\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_60 AND trif.is_circle_k_cap <= isper.is_circle_k_70) THEN 7\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_50 AND trif.is_circle_k_cap <= isper.is_circle_k_60) THEN 6\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_40 AND trif.is_circle_k_cap <= isper.is_circle_k_50) THEN 5\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_30 AND trif.is_circle_k_cap <= isper.is_circle_k_40) THEN 4\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_20 AND trif.is_circle_k_cap <= isper.is_circle_k_30) THEN 3\n        WHEN (trif.is_circle_k_cap >  isper.is_circle_k_10 AND trif.is_circle_k_cap <= isper.is_circle_k_20) THEN 2\n        WHEN (trif.is_circle_k_cap > 0.0 AND trif.is_circle_k_cap <= isper.is_circle_k_10)                   THEN 1\n        ELSE 0\n    END AS is_circle_k_decile,\n\n    trif.is_costco_cap,\n    CASE\n        WHEN  trif.is_costco_cap >  isper.is_costco_90                                                         THEN 10\n        WHEN (trif.is_costco_cap >  isper.is_costco_80 AND trif.is_costco_cap <= isper.is_costco_90) THEN 9\n        WHEN (trif.is_costco_cap >  isper.is_costco_70 AND trif.is_costco_cap <= isper.is_costco_80) THEN 8\n        WHEN (trif.is_costco_cap >  isper.is_costco_60 AND trif.is_costco_cap <= isper.is_costco_70) THEN 7\n        WHEN (trif.is_costco_cap >  isper.is_costco_50 AND trif.is_costco_cap <= isper.is_costco_60) THEN 6\n        WHEN (trif.is_costco_cap >  isper.is_costco_40 AND trif.is_costco_cap <= isper.is_costco_50) THEN 5\n        WHEN (trif.is_costco_cap >  isper.is_costco_30 AND trif.is_costco_cap <= isper.is_costco_40) THEN 4\n        WHEN (trif.is_costco_cap >  isper.is_costco_20 AND trif.is_costco_cap <= isper.is_costco_30) THEN 3\n        WHEN (trif.is_costco_cap >  isper.is_costco_10 AND trif.is_costco_cap <= isper.is_costco_20) THEN 2\n        WHEN (trif.is_costco_cap > 0.0  AND trif.is_costco_cap <= isper.is_costco_10)                THEN 1\n        ELSE 0\n    END AS is_costco_decile,\n\n    trif.is_cvs_cap,\n    CASE\n        WHEN  trif.is_cvs_cap >  isper.is_cvs_90                                                         THEN 10\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_80 AND trif.is_cvs_cap <= isper.is_cvs_90) THEN 9\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_70 AND trif.is_cvs_cap <= isper.is_cvs_80) THEN 8\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_60 AND trif.is_cvs_cap <= isper.is_cvs_70) THEN 7\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_50 AND trif.is_cvs_cap <= isper.is_cvs_60) THEN 6\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_40 AND trif.is_cvs_cap <= isper.is_cvs_50) THEN 5\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_30 AND trif.is_cvs_cap <= isper.is_cvs_40) THEN 4\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_20 AND trif.is_cvs_cap <= isper.is_cvs_30) THEN 3\n        WHEN (trif.is_cvs_cap >  isper.is_cvs_10 AND trif.is_cvs_cap <= isper.is_cvs_20) THEN 2\n        WHEN (trif.is_cvs_cap >  0.0 AND trif.is_cvs_cap <= isper.is_cvs_10)                  THEN 1\n        ELSE 0\n    END AS is_cvs_decile,\n\n    trif.is_dollar_general_cap,\n    CASE\n        WHEN  trif.is_dollar_general_cap >  isper.is_dollar_general_90                                                         THEN 10\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_80 AND trif.is_dollar_general_cap <= isper.is_dollar_general_90) THEN 9\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_70 AND trif.is_dollar_general_cap <= isper.is_dollar_general_80) THEN 8\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_60 AND trif.is_dollar_general_cap <= isper.is_dollar_general_70) THEN 7\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_50 AND trif.is_dollar_general_cap <= isper.is_dollar_general_60) THEN 6\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_40 AND trif.is_dollar_general_cap <= isper.is_dollar_general_50) THEN 5\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_30 AND trif.is_dollar_general_cap <= isper.is_dollar_general_40) THEN 4\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_20 AND trif.is_dollar_general_cap <= isper.is_dollar_general_30) THEN 3\n        WHEN (trif.is_dollar_general_cap >  isper.is_dollar_general_10 AND trif.is_dollar_general_cap <= isper.is_dollar_general_20) THEN 2\n        WHEN (trif.is_dollar_general_cap > 0.0 AND trif.is_dollar_general_cap <= isper.is_dollar_general_10)                         THEN 1\n        ELSE 0\n    END AS is_dollar_general_decile,\n\n    trif.is_family_dollar_cap,\n    CASE\n        WHEN  trif.is_family_dollar_cap >  isper.is_family_dollar_90                                                         THEN 10\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_80 AND trif.is_family_dollar_cap <= isper.is_family_dollar_90) THEN 9\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_70 AND trif.is_family_dollar_cap <= isper.is_family_dollar_80) THEN 8\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_60 AND trif.is_family_dollar_cap <= isper.is_family_dollar_70) THEN 7\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_50 AND trif.is_family_dollar_cap <= isper.is_family_dollar_60) THEN 6\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_40 AND trif.is_family_dollar_cap <= isper.is_family_dollar_50) THEN 5\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_30 AND trif.is_family_dollar_cap <= isper.is_family_dollar_40) THEN 4\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_20 AND trif.is_family_dollar_cap <= isper.is_family_dollar_30) THEN 3\n        WHEN (trif.is_family_dollar_cap >  isper.is_family_dollar_10 AND trif.is_family_dollar_cap <= isper.is_family_dollar_20) THEN 2\n        WHEN (trif.is_family_dollar_cap > 0.0 AND trif.is_family_dollar_cap <= isper.is_family_dollar_10)                        THEN 1\n        ELSE 0\n    END AS is_family_dollar_decile,\n\n    trif.is_heb_cap,\n    CASE\n        WHEN  trif.is_heb_cap >  isper.is_heb_90                                                         THEN 10\n        WHEN (trif.is_heb_cap >  isper.is_heb_80 AND trif.is_heb_cap <= isper.is_heb_90) THEN 9\n        WHEN (trif.is_heb_cap >  isper.is_heb_70 AND trif.is_heb_cap <= isper.is_heb_80) THEN 8\n        WHEN (trif.is_heb_cap >  isper.is_heb_60 AND trif.is_heb_cap <= isper.is_heb_70) THEN 7\n        WHEN (trif.is_heb_cap >  isper.is_heb_50 AND trif.is_heb_cap <= isper.is_heb_60) THEN 6\n        WHEN (trif.is_heb_cap >  isper.is_heb_40 AND trif.is_heb_cap <= isper.is_heb_50) THEN 5\n        WHEN (trif.is_heb_cap >  isper.is_heb_30 AND trif.is_heb_cap <= isper.is_heb_40) THEN 4\n        WHEN (trif.is_heb_cap >  isper.is_heb_20 AND trif.is_heb_cap <= isper.is_heb_30) THEN 3\n        WHEN (trif.is_heb_cap >  isper.is_heb_10 AND trif.is_heb_cap <= isper.is_heb_20) THEN 2\n        WHEN (trif.is_heb_cap > 0.0 AND trif.is_heb_cap <= isper.is_heb_10)              THEN 1\n        ELSE 0\n    END AS is_heb_decile,\n\n    trif.is_speedway_cap,\n    CASE\n        WHEN  trif.is_speedway_cap >  isper.is_speedway_90                                                         THEN 10\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_80 AND trif.is_speedway_cap <= isper.is_speedway_90) THEN 9\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_70 AND trif.is_speedway_cap <= isper.is_speedway_80) THEN 8\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_60 AND trif.is_speedway_cap <= isper.is_speedway_70) THEN 7\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_50 AND trif.is_speedway_cap <= isper.is_speedway_60) THEN 6\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_40 AND trif.is_speedway_cap <= isper.is_speedway_50) THEN 5\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_30 AND trif.is_speedway_cap <= isper.is_speedway_40) THEN 4\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_20 AND trif.is_speedway_cap <= isper.is_speedway_30) THEN 3\n        WHEN (trif.is_speedway_cap >  isper.is_speedway_10 AND trif.is_speedway_cap <= isper.is_speedway_20) THEN 2\n        WHEN (trif.is_speedway_cap > 0.0 AND trif.is_speedway_cap <= isper.is_speedway_10)                   THEN 1\n        ELSE 0\n    END AS is_speedway_decile,\n\n    trif.is_hy_vee_cap,\n    CASE\n        WHEN  trif.is_hy_vee_cap >  isper.is_hy_vee_90                                                         THEN 10\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_80 AND trif.is_hy_vee_cap <= isper.is_hy_vee_90) THEN 9\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_70 AND trif.is_hy_vee_cap <= isper.is_hy_vee_80) THEN 8\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_60 AND trif.is_hy_vee_cap <= isper.is_hy_vee_70) THEN 7\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_50 AND trif.is_hy_vee_cap <= isper.is_hy_vee_60) THEN 6\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_40 AND trif.is_hy_vee_cap <= isper.is_hy_vee_50) THEN 5\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_30 AND trif.is_hy_vee_cap <= isper.is_hy_vee_40) THEN 4\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_20 AND trif.is_hy_vee_cap <= isper.is_hy_vee_30) THEN 3\n        WHEN (trif.is_hy_vee_cap >  isper.is_hy_vee_10 AND trif.is_hy_vee_cap <= isper.is_hy_vee_20) THEN 2\n        WHEN (trif.is_hy_vee_cap > 0.0 AND trif.is_hy_vee_cap <= isper.is_hy_vee_10)                 THEN 1\n        ELSE 0\n    END AS is_hy_vee_decile,\n\n    trif.is_kroger_banner_cap,\n    CASE\n        WHEN  trif.is_kroger_banner_cap >  isper.is_kroger_banner_90                                                         THEN 10\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_80 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_90) THEN 9\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_70 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_80) THEN 8\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_60 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_70) THEN 7\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_50 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_60) THEN 6\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_40 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_50) THEN 5\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_30 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_40) THEN 4\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_20 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_30) THEN 3\n        WHEN (trif.is_kroger_banner_cap >  isper.is_kroger_banner_10 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_20) THEN 2\n        WHEN (trif.is_kroger_banner_cap > 0.0 AND trif.is_kroger_banner_cap <= isper.is_kroger_banner_10)                        THEN 1\n        ELSE 0\n    END AS is_kroger_banner_decile,\n\n    trif.is_all_other_kroger_cap,\n    CASE\n        WHEN  trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_90                                                         THEN 10\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_80 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_90) THEN 9\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_70 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_80) THEN 8\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_60 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_70) THEN 7\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_50 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_60) THEN 6\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_40 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_50) THEN 5\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_30 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_40) THEN 4\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_20 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_30) THEN 3\n        WHEN (trif.is_all_other_kroger_cap >  isper.is_all_other_kroger_10 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_20) THEN 2\n        WHEN (trif.is_all_other_kroger_cap > 0.0 AND trif.is_all_other_kroger_cap <= isper.is_all_other_kroger_10)                           THEN 1\n        ELSE 0\n    END AS is_all_other_kroger_decile,\n\n    trif.is_all_other_club_cap,\n    CASE\n        WHEN  trif.is_all_other_club_cap >  isper.is_all_other_club_90                                                         THEN 10\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_80 AND trif.is_all_other_club_cap <= isper.is_all_other_club_90) THEN 9\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_70 AND trif.is_all_other_club_cap <= isper.is_all_other_club_80) THEN 8\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_60 AND trif.is_all_other_club_cap <= isper.is_all_other_club_70) THEN 7\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_50 AND trif.is_all_other_club_cap <= isper.is_all_other_club_60) THEN 6\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_40 AND trif.is_all_other_club_cap <= isper.is_all_other_club_50) THEN 5\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_30 AND trif.is_all_other_club_cap <= isper.is_all_other_club_40) THEN 4\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_20 AND trif.is_all_other_club_cap <= isper.is_all_other_club_30) THEN 3\n        WHEN (trif.is_all_other_club_cap >  isper.is_all_other_club_10 AND trif.is_all_other_club_cap <= isper.is_all_other_club_20) THEN 2\n        WHEN (trif.is_all_other_club_cap > 0.0 AND trif.is_all_other_club_cap <= isper.is_all_other_club_10)                         THEN 1\n        ELSE 0\n    END AS is_all_other_club_decile,\n\n    trif.is_all_other_dollar_cap,\n    CASE\n        WHEN  trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_90                                                         THEN 10\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_80 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_90) THEN 9\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_70 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_80) THEN 8\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_60 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_70) THEN 7\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_50 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_60) THEN 6\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_40 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_50) THEN 5\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_30 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_40) THEN 4\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_20 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_30) THEN 3\n        WHEN (trif.is_all_other_dollar_cap >  isper.is_all_other_dollar_10 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_20) THEN 2\n        WHEN (trif.is_all_other_dollar_cap >  0.0 AND trif.is_all_other_dollar_cap <= isper.is_all_other_dollar_10)                          THEN 1\n        ELSE 0\n    END AS is_all_other_dollar_decile,\n\n    trif.is_all_other_drug_cap,\n    CASE\n        WHEN  trif.is_all_other_drug_cap >  isper.is_all_other_drug_90                                                         THEN 10\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_80 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_90) THEN 9\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_70 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_80) THEN 8\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_60 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_70) THEN 7\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_50 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_60) THEN 6\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_40 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_50) THEN 5\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_30 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_40) THEN 4\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_20 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_30) THEN 3\n        WHEN (trif.is_all_other_drug_cap >  isper.is_all_other_drug_10 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_20) THEN 2\n        WHEN (trif.is_all_other_drug_cap > 0.0 AND trif.is_all_other_drug_cap <= isper.is_all_other_drug_10)                         THEN 1\n        ELSE 0\n    END AS is_all_other_drug_decile,\n\n    trif.is_all_other_c_and_g_cap,\n    CASE\n        WHEN  trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_90                                                         THEN 10\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_80 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_90) THEN 9\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_70 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_80) THEN 8\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_60 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_70) THEN 7\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_50 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_60) THEN 6\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_40 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_50) THEN 5\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_30 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_40) THEN 4\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_20 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_30) THEN 3\n        WHEN (trif.is_all_other_c_and_g_cap >  isper.is_all_other_c_and_g_10 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_20) THEN 2\n        WHEN (trif.is_all_other_c_and_g_cap > 0.0 AND trif.is_all_other_c_and_g_cap <= isper.is_all_other_c_and_g_10)                            THEN 1\n        ELSE 0\n    END AS is_all_other_c_and_g_decile,\n\n    trif.is_all_other_grocery_cap,\n    CASE\n        WHEN  trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_90                                                         THEN 10\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_80 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_90) THEN 9\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_70 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_80) THEN 8\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_60 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_70) THEN 7\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_50 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_60) THEN 6\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_40 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_50) THEN 5\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_30 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_40) THEN 4\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_20 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_30) THEN 3\n        WHEN (trif.is_all_other_grocery_cap >  isper.is_all_other_grocery_10 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_20) THEN 2\n        WHEN (trif.is_all_other_grocery_cap > 0.0 AND trif.is_all_other_grocery_cap <= isper.is_all_other_grocery_10)                            THEN 1\n        ELSE 0\n    END AS is_all_other_grocery_decile,\n\n    trif.is_all_other_mass_cap,\n    CASE\n        WHEN  trif.is_all_other_mass_cap >  isper.is_all_other_mass_90                                                         THEN 10\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_80 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_90) THEN 9\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_70 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_80) THEN 8\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_60 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_70) THEN 7\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_50 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_60) THEN 6\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_40 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_50) THEN 5\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_30 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_40) THEN 4\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_20 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_30) THEN 3\n        WHEN (trif.is_all_other_mass_cap >  isper.is_all_other_mass_10 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_20) THEN 2\n        WHEN (trif.is_all_other_mass_cap > 0.0 AND trif.is_all_other_mass_cap <= isper.is_all_other_mass_10)                         THEN 1\n        ELSE 0\n    END AS is_all_other_mass_decile,\n\n    trif.is_publix_cap,\n    CASE\n        WHEN  trif.is_publix_cap >  isper.is_publix_90                                                         THEN 10\n        WHEN (trif.is_publix_cap >  isper.is_publix_80 AND trif.is_publix_cap <= isper.is_publix_90) THEN 9\n        WHEN (trif.is_publix_cap >  isper.is_publix_70 AND trif.is_publix_cap <= isper.is_publix_80) THEN 8\n        WHEN (trif.is_publix_cap >  isper.is_publix_60 AND trif.is_publix_cap <= isper.is_publix_70) THEN 7\n        WHEN (trif.is_publix_cap >  isper.is_publix_50 AND trif.is_publix_cap <= isper.is_publix_60) THEN 6\n        WHEN (trif.is_publix_cap >  isper.is_publix_40 AND trif.is_publix_cap <= isper.is_publix_50) THEN 5\n        WHEN (trif.is_publix_cap >  isper.is_publix_30 AND trif.is_publix_cap <= isper.is_publix_40) THEN 4\n        WHEN (trif.is_publix_cap >  isper.is_publix_20 AND trif.is_publix_cap <= isper.is_publix_30) THEN 3\n        WHEN (trif.is_publix_cap >  isper.is_publix_10 AND trif.is_publix_cap <= isper.is_publix_20) THEN 2\n        WHEN (trif.is_publix_cap > 0.0 AND trif.is_publix_cap <= isper.is_publix_10)                 THEN 1\n        ELSE 0\n    END AS is_publix_decile,\n\n    trif.is_sams_club_cap,\n    CASE\n        WHEN  trif.is_sams_club_cap >  isper.is_sams_club_90                                                         THEN 10\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_80 AND trif.is_sams_club_cap <= isper.is_sams_club_90) THEN 9\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_70 AND trif.is_sams_club_cap <= isper.is_sams_club_80) THEN 8\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_60 AND trif.is_sams_club_cap <= isper.is_sams_club_70) THEN 7\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_50 AND trif.is_sams_club_cap <= isper.is_sams_club_60) THEN 6\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_40 AND trif.is_sams_club_cap <= isper.is_sams_club_50) THEN 5\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_30 AND trif.is_sams_club_cap <= isper.is_sams_club_40) THEN 4\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_20 AND trif.is_sams_club_cap <= isper.is_sams_club_30) THEN 3\n        WHEN (trif.is_sams_club_cap >  isper.is_sams_club_10 AND trif.is_sams_club_cap <= isper.is_sams_club_20) THEN 2\n        WHEN (trif.is_sams_club_cap > 0.0 AND trif.is_sams_club_cap <= isper.is_sams_club_10)                    THEN 1\n        ELSE 0\n    END AS is_sams_club_decile,\n\n    trif.is_target_cap,\n    CASE\n        WHEN  trif.is_target_cap >  isper.is_target_90                                                         THEN 10\n        WHEN (trif.is_target_cap >  isper.is_target_80 AND trif.is_target_cap <= isper.is_target_90) THEN 9\n        WHEN (trif.is_target_cap >  isper.is_target_70 AND trif.is_target_cap <= isper.is_target_80) THEN 8\n        WHEN (trif.is_target_cap >  isper.is_target_60 AND trif.is_target_cap <= isper.is_target_70) THEN 7\n        WHEN (trif.is_target_cap >  isper.is_target_50 AND trif.is_target_cap <= isper.is_target_60) THEN 6\n        WHEN (trif.is_target_cap >  isper.is_target_40 AND trif.is_target_cap <= isper.is_target_50) THEN 5\n        WHEN (trif.is_target_cap >  isper.is_target_30 AND trif.is_target_cap <= isper.is_target_40) THEN 4\n        WHEN (trif.is_target_cap >  isper.is_target_20 AND trif.is_target_cap <= isper.is_target_30) THEN 3\n        WHEN (trif.is_target_cap >  isper.is_target_10 AND trif.is_target_cap <= isper.is_target_20) THEN 2\n        WHEN (trif.is_target_cap > 0.0 AND trif.is_target_cap <= isper.is_target_10)                 THEN 1\n        ELSE 0\n    END AS is_target_decile,\n\n    trif.is_trader_joes_cap,\n    CASE\n        WHEN  trif.is_trader_joes_cap >  isper.is_trader_joes_90                                                         THEN 10\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_80 AND trif.is_trader_joes_cap <= isper.is_trader_joes_90) THEN 9\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_70 AND trif.is_trader_joes_cap <= isper.is_trader_joes_80) THEN 8\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_60 AND trif.is_trader_joes_cap <= isper.is_trader_joes_70) THEN 7\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_50 AND trif.is_trader_joes_cap <= isper.is_trader_joes_60) THEN 6\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_40 AND trif.is_trader_joes_cap <= isper.is_trader_joes_50) THEN 5\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_30 AND trif.is_trader_joes_cap <= isper.is_trader_joes_40) THEN 4\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_20 AND trif.is_trader_joes_cap <= isper.is_trader_joes_30) THEN 3\n        WHEN (trif.is_trader_joes_cap >  isper.is_trader_joes_10 AND trif.is_trader_joes_cap <= isper.is_trader_joes_20) THEN 2\n        WHEN (trif.is_trader_joes_cap > 0.0 AND trif.is_trader_joes_cap <= isper.is_trader_joes_10)                      THEN 1\n        ELSE 0\n    END AS is_trader_joes_decile,\n\n    trif.is_wakefern_cap,\n    CASE\n        WHEN  trif.is_wakefern_cap >  isper.is_wakefern_90                                                         THEN 10\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_80 AND trif.is_wakefern_cap <= isper.is_wakefern_90) THEN 9\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_70 AND trif.is_wakefern_cap <= isper.is_wakefern_80) THEN 8\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_60 AND trif.is_wakefern_cap <= isper.is_wakefern_70) THEN 7\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_50 AND trif.is_wakefern_cap <= isper.is_wakefern_60) THEN 6\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_40 AND trif.is_wakefern_cap <= isper.is_wakefern_50) THEN 5\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_30 AND trif.is_wakefern_cap <= isper.is_wakefern_40) THEN 4\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_20 AND trif.is_wakefern_cap <= isper.is_wakefern_30) THEN 3\n        WHEN (trif.is_wakefern_cap >  isper.is_wakefern_10 AND trif.is_wakefern_cap <= isper.is_wakefern_20) THEN 2\n        WHEN (trif.is_wakefern_cap > 0.0 AND trif.is_wakefern_cap <= isper.is_wakefern_10)                   THEN 1\n        ELSE 0\n    END AS is_wakefern_decile,\n\n    trif.is_walgreens_cap,\n    CASE\n        WHEN  trif.is_walgreens_cap >  isper.is_walgreens_90                                                         THEN 10\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_80 AND trif.is_walgreens_cap <= isper.is_walgreens_90) THEN 9\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_70 AND trif.is_walgreens_cap <= isper.is_walgreens_80) THEN 8\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_60 AND trif.is_walgreens_cap <= isper.is_walgreens_70) THEN 7\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_50 AND trif.is_walgreens_cap <= isper.is_walgreens_60) THEN 6\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_40 AND trif.is_walgreens_cap <= isper.is_walgreens_50) THEN 5\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_30 AND trif.is_walgreens_cap <= isper.is_walgreens_40) THEN 4\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_20 AND trif.is_walgreens_cap <= isper.is_walgreens_30) THEN 3\n        WHEN (trif.is_walgreens_cap >  isper.is_walgreens_10 AND trif.is_walgreens_cap <= isper.is_walgreens_20) THEN 2\n        WHEN (trif.is_walgreens_cap > 0.0 AND trif.is_walgreens_cap <= isper.is_walgreens_10)                    THEN 1\n        ELSE 0\n    END AS is_walgreens_decile,\n\n    trif.is_walmart_com_cap,\n    CASE\n        WHEN  trif.is_walmart_com_cap >  isper.is_walmart_com_90                                                         THEN 10\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_80 AND trif.is_walmart_com_cap <= isper.is_walmart_com_90) THEN 9\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_70 AND trif.is_walmart_com_cap <= isper.is_walmart_com_80) THEN 8\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_60 AND trif.is_walmart_com_cap <= isper.is_walmart_com_70) THEN 7\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_50 AND trif.is_walmart_com_cap <= isper.is_walmart_com_60) THEN 6\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_40 AND trif.is_walmart_com_cap <= isper.is_walmart_com_50) THEN 5\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_30 AND trif.is_walmart_com_cap <= isper.is_walmart_com_40) THEN 4\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_20 AND trif.is_walmart_com_cap <= isper.is_walmart_com_30) THEN 3\n        WHEN (trif.is_walmart_com_cap >  isper.is_walmart_com_10 AND trif.is_walmart_com_cap <= isper.is_walmart_com_20) THEN 2\n        WHEN (trif.is_walmart_com_cap > 0.0 AND trif.is_walmart_com_cap <= isper.is_walmart_com_10)                      THEN 1\n        ELSE 0\n    END AS is_walmart_com_decile,\n\n    trif.is_wm_neighborhood_market_cap,\n    CASE\n        WHEN  trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_90                                                         THEN 10\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_80 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_90) THEN 9\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_70 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_80) THEN 8\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_60 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_70) THEN 7\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_50 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_60) THEN 6\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_40 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_50) THEN 5\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_30 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_40) THEN 4\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_20 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_30) THEN 3\n        WHEN (trif.is_wm_neighborhood_market_cap >  isper.is_wm_neighborhood_market_10 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_20) THEN 2\n        WHEN (trif.is_wm_neighborhood_market_cap > 0.0 AND trif.is_wm_neighborhood_market_cap <= isper.is_wm_neighborhood_market_10)                                 THEN 1\n        ELSE 0\n    END AS is_wm_neighborhood_market_decile,\n\n    trif.is_all_other_walmart_cap,\n    CASE\n        WHEN  trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_90                                                         THEN 10\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_80 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_90) THEN 9\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_70 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_80) THEN 8\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_60 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_70) THEN 7\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_50 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_60) THEN 6\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_40 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_50) THEN 5\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_30 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_40) THEN 4\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_20 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_30) THEN 3\n        WHEN (trif.is_all_other_walmart_cap >  isper.is_all_other_walmart_10 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_20) THEN 2\n        WHEN (trif.is_all_other_walmart_cap > 0.0 AND trif.is_all_other_walmart_cap <= isper.is_all_other_walmart_10)                            THEN 1\n        ELSE 0\n    END AS is_all_other_walmart_decile,\n\n    trif.is_whole_foods_cap,\n    CASE\n        WHEN  trif.is_whole_foods_cap >  isper.is_whole_foods_90                                                         THEN 10\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_80 AND trif.is_whole_foods_cap <= isper.is_whole_foods_90) THEN 9\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_70 AND trif.is_whole_foods_cap <= isper.is_whole_foods_80) THEN 8\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_60 AND trif.is_whole_foods_cap <= isper.is_whole_foods_70) THEN 7\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_50 AND trif.is_whole_foods_cap <= isper.is_whole_foods_60) THEN 6\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_40 AND trif.is_whole_foods_cap <= isper.is_whole_foods_50) THEN 5\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_30 AND trif.is_whole_foods_cap <= isper.is_whole_foods_40) THEN 4\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_20 AND trif.is_whole_foods_cap <= isper.is_whole_foods_30) THEN 3\n        WHEN (trif.is_whole_foods_cap >  isper.is_whole_foods_10 AND trif.is_whole_foods_cap <= isper.is_whole_foods_20) THEN 2\n        WHEN (trif.is_whole_foods_cap > 0.0 AND trif.is_whole_foods_cap <= isper.is_whole_foods_10)                      THEN 1\n        ELSE 0\n    END AS is_whole_foods_decile,\n\n    trif.is_target_com_cap,\n    CASE\n        WHEN  trif.is_target_com_cap >  isper.is_target_com_90                                                         THEN 10\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_80 AND trif.is_target_com_cap <= isper.is_target_com_90) THEN 9\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_70 AND trif.is_target_com_cap <= isper.is_target_com_80) THEN 8\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_60 AND trif.is_target_com_cap <= isper.is_target_com_70) THEN 7\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_50 AND trif.is_target_com_cap <= isper.is_target_com_60) THEN 6\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_40 AND trif.is_target_com_cap <= isper.is_target_com_50) THEN 5\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_30 AND trif.is_target_com_cap <= isper.is_target_com_40) THEN 4\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_20 AND trif.is_target_com_cap <= isper.is_target_com_30) THEN 3\n        WHEN (trif.is_target_com_cap >  isper.is_target_com_10 AND trif.is_target_com_cap <= isper.is_target_com_20) THEN 2\n        WHEN (trif.is_target_com_cap > 0.0 AND trif.is_target_com_cap <= isper.is_target_com_10)                     THEN 1\n        ELSE 0\n    END AS is_target_com_decile,\n\n    trif.is_kroger_com_cap,\n    CASE\n        WHEN  trif.is_kroger_com_cap >  isper.is_kroger_com_90                                                         THEN 10\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_80 AND trif.is_kroger_com_cap <= isper.is_kroger_com_90) THEN 9\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_70 AND trif.is_kroger_com_cap <= isper.is_kroger_com_80) THEN 8\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_60 AND trif.is_kroger_com_cap <= isper.is_kroger_com_70) THEN 7\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_50 AND trif.is_kroger_com_cap <= isper.is_kroger_com_60) THEN 6\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_40 AND trif.is_kroger_com_cap <= isper.is_kroger_com_50) THEN 5\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_30 AND trif.is_kroger_com_cap <= isper.is_kroger_com_40) THEN 4\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_20 AND trif.is_kroger_com_cap <= isper.is_kroger_com_30) THEN 3\n        WHEN (trif.is_kroger_com_cap >  isper.is_kroger_com_10 AND trif.is_kroger_com_cap <= isper.is_kroger_com_20) THEN 2\n        WHEN (trif.is_kroger_com_cap > 0.0 AND trif.is_kroger_com_cap <= isper.is_kroger_com_10)                     THEN 1\n        ELSE 0\n    END AS is_kroger_com_decile,\n\n\n    trif.is_kmart_com_cap,\n    CASE\n        WHEN  trif.is_kmart_com_cap >  isper.is_kmart_com_90                                                         THEN 10\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_80 AND trif.is_kmart_com_cap <= isper.is_kmart_com_90) THEN 9\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_70 AND trif.is_kmart_com_cap <= isper.is_kmart_com_80) THEN 8\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_60 AND trif.is_kmart_com_cap <= isper.is_kmart_com_70) THEN 7\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_50 AND trif.is_kmart_com_cap <= isper.is_kmart_com_60) THEN 6\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_40 AND trif.is_kmart_com_cap <= isper.is_kmart_com_50) THEN 5\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_30 AND trif.is_kmart_com_cap <= isper.is_kmart_com_40) THEN 4\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_20 AND trif.is_kmart_com_cap <= isper.is_kmart_com_30) THEN 3\n        WHEN (trif.is_kmart_com_cap >  isper.is_kmart_com_10 AND trif.is_kmart_com_cap <= isper.is_kmart_com_20) THEN 2\n        WHEN (trif.is_kmart_com_cap > 0.0 AND trif.is_kmart_com_cap <= isper.is_kmart_com_10)                    THEN 1\n        ELSE 0\n    END AS is_kmart_com_decile,\n\n    trif.is_walgreens_com_cap,\n    CASE\n        WHEN  trif.is_walgreens_com_cap >  isper.is_walgreens_com_90                                                         THEN 10\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_80 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_90) THEN 9\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_70 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_80) THEN 8\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_60 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_70) THEN 7\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_50 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_60) THEN 6\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_40 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_50) THEN 5\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_30 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_40) THEN 4\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_20 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_30) THEN 3\n        WHEN (trif.is_walgreens_com_cap >  isper.is_walgreens_com_10 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_20) THEN 2\n        WHEN (trif.is_walgreens_com_cap > 0.0 AND trif.is_walgreens_com_cap <= isper.is_walgreens_com_10)                        THEN 1\n        ELSE 0\n    END AS is_walgreens_com_decile,\n\n    trif.is_samsclub_com_cap,\n    CASE\n        WHEN  trif.is_samsclub_com_cap >  isper.is_samsclub_com_90                                                         THEN 10\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_80 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_90) THEN 9\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_70 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_80) THEN 8\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_60 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_70) THEN 7\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_50 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_60) THEN 6\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_40 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_50) THEN 5\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_30 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_40) THEN 4\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_20 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_30) THEN 3\n        WHEN (trif.is_samsclub_com_cap >  isper.is_samsclub_com_10 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_20) THEN 2\n        WHEN (trif.is_samsclub_com_cap > 0.0 AND trif.is_samsclub_com_cap <= isper.is_samsclub_com_10)                       THEN 1\n        ELSE 0\n    END AS is_samsclub_com_decile,\n\n    trif.is_costco_com_cap,\n    CASE\n        WHEN  trif.is_costco_com_cap >  isper.is_costco_com_90                                                         THEN 10\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_80 AND trif.is_costco_com_cap <= isper.is_costco_com_90) THEN 9\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_70 AND trif.is_costco_com_cap <= isper.is_costco_com_80) THEN 8\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_60 AND trif.is_costco_com_cap <= isper.is_costco_com_70) THEN 7\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_50 AND trif.is_costco_com_cap <= isper.is_costco_com_60) THEN 6\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_40 AND trif.is_costco_com_cap <= isper.is_costco_com_50) THEN 5\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_30 AND trif.is_costco_com_cap <= isper.is_costco_com_40) THEN 4\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_20 AND trif.is_costco_com_cap <= isper.is_costco_com_30) THEN 3\n        WHEN (trif.is_costco_com_cap >  isper.is_costco_com_10 AND trif.is_costco_com_cap <= isper.is_costco_com_20) THEN 2\n        WHEN (trif.is_costco_com_cap > 0.0 AND trif.is_costco_com_cap <= isper.is_costco_com_10)                     THEN 1\n        ELSE 0\n    END AS is_costco_com_decile,\n\n    trif.is_avbl_adj_7_eleven,\n    CASE\n        WHEN  trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_80 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_90) THEN 9\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_70 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_80) THEN 8\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_60 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_70) THEN 7\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_50 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_60) THEN 6\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_40 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_50) THEN 5\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_30 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_40) THEN 4\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_20 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_30) THEN 3\n        WHEN (trif.is_avbl_adj_7_eleven >  avblper.is_avbl_adj_7_eleven_10 AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_20) THEN 2\n        WHEN (trif.is_avbl_adj_7_eleven >  0.0                             AND trif.is_avbl_adj_7_eleven <= avblper.is_avbl_adj_7_eleven_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_7_eleven_decile,\n\n    trif.is_avbl_adj_ahold_delhaize,\n    CASE\n        WHEN  trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_80 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_90) THEN 9\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_70 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_80) THEN 8\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_60 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_70) THEN 7\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_50 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_60) THEN 6\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_40 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_50) THEN 5\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_30 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_40) THEN 4\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_20 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_30) THEN 3\n        WHEN (trif.is_avbl_adj_ahold_delhaize >  avblper.is_avbl_adj_ahold_delhaize_10 AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_20) THEN 2\n        WHEN (trif.is_avbl_adj_ahold_delhaize > 0.0                                    AND trif.is_avbl_adj_ahold_delhaize <= avblper.is_avbl_adj_ahold_delhaize_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_ahold_delhaize_decile,\n\n    trif.is_avbl_adj_albertsons,\n    CASE\n        WHEN  trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_80 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_90) THEN 9\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_70 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_80) THEN 8\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_60 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_70) THEN 7\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_50 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_60) THEN 6\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_40 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_50) THEN 5\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_30 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_40) THEN 4\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_20 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_30) THEN 3\n        WHEN (trif.is_avbl_adj_albertsons >  avblper.is_avbl_adj_albertsons_10 AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_20) THEN 2\n        WHEN (trif.is_avbl_adj_albertsons >  0.0                               AND trif.is_avbl_adj_albertsons <= avblper.is_avbl_adj_albertsons_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_albertsons_decile,\n\n    trif.is_avbl_adj_aldi,\n    CASE\n        WHEN  trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_80 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_90) THEN 9\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_70 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_80) THEN 8\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_60 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_70) THEN 7\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_50 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_60) THEN 6\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_40 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_50) THEN 5\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_30 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_40) THEN 4\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_20 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_30) THEN 3\n        WHEN (trif.is_avbl_adj_aldi >  avblper.is_avbl_adj_aldi_10 AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_20) THEN 2\n        WHEN (trif.is_avbl_adj_aldi > 0.0                          AND trif.is_avbl_adj_aldi <= avblper.is_avbl_adj_aldi_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_aldi_decile,\n\n    trif.is_avbl_adj_amazon_com,\n    CASE\n        WHEN  trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_80 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_70 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_60 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_50 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_40 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_30 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_20 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_amazon_com >  avblper.is_avbl_adj_amazon_com_10 AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_amazon_com >  0.0                               AND trif.is_avbl_adj_amazon_com <= avblper.is_avbl_adj_amazon_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_amazon_com_decile,\n\n    trif.is_avbl_adj_bi_lo,\n    CASE\n        WHEN  trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_80 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_90) THEN 9\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_70 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_80) THEN 8\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_60 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_70) THEN 7\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_50 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_60) THEN 6\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_40 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_50) THEN 5\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_30 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_40) THEN 4\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_20 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_30) THEN 3\n        WHEN (trif.is_avbl_adj_bi_lo >  avblper.is_avbl_adj_bi_lo_10 AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_20) THEN 2\n        WHEN (trif.is_avbl_adj_bi_lo >  0.0                          AND trif.is_avbl_adj_bi_lo <= avblper.is_avbl_adj_bi_lo_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_bi_lo_decile,\n\n    trif.is_avbl_adj_bjs,\n    CASE\n        WHEN  trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_80 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_90) THEN 9\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_70 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_80) THEN 8\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_60 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_70) THEN 7\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_50 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_60) THEN 6\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_40 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_50) THEN 5\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_30 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_40) THEN 4\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_20 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_30) THEN 3\n        WHEN (trif.is_avbl_adj_bjs >  avblper.is_avbl_adj_bjs_10 AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_20) THEN 2\n        WHEN (trif.is_avbl_adj_bjs >  0.0                        AND trif.is_avbl_adj_bjs <= avblper.is_avbl_adj_bjs_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_bjs_decile,\n\n    trif.is_avbl_adj_circle_k,\n    CASE\n        WHEN  trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_80 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_90) THEN 9\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_70 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_80) THEN 8\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_60 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_70) THEN 7\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_50 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_60) THEN 6\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_40 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_50) THEN 5\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_30 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_40) THEN 4\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_20 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_30) THEN 3\n        WHEN (trif.is_avbl_adj_circle_k >  avblper.is_avbl_adj_circle_k_10 AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_20) THEN 2\n        WHEN (trif.is_avbl_adj_circle_k >  0.0                             AND trif.is_avbl_adj_circle_k <= avblper.is_avbl_adj_circle_k_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_circle_k_decile,\n\n    trif.is_avbl_adj_costco,\n    CASE\n        WHEN  trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_80 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_90) THEN 9\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_70 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_80) THEN 8\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_60 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_70) THEN 7\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_50 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_60) THEN 6\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_40 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_50) THEN 5\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_30 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_40) THEN 4\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_20 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_30) THEN 3\n        WHEN (trif.is_avbl_adj_costco >  avblper.is_avbl_adj_costco_10 AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_20) THEN 2\n        WHEN (trif.is_avbl_adj_costco >  0.0                           AND trif.is_avbl_adj_costco <= avblper.is_avbl_adj_costco_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_costco_decile,\n\n    trif.is_avbl_adj_cvs,\n    CASE\n        WHEN  trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_80 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_90) THEN 9\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_70 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_80) THEN 8\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_60 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_70) THEN 7\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_50 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_60) THEN 6\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_40 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_50) THEN 5\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_30 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_40) THEN 4\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_20 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_30) THEN 3\n        WHEN (trif.is_avbl_adj_cvs >  avblper.is_avbl_adj_cvs_10 AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_20) THEN 2\n        WHEN (trif.is_avbl_adj_cvs >  0.0                        AND trif.is_avbl_adj_cvs <= avblper.is_avbl_adj_cvs_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_cvs_decile,\n\n    trif.is_avbl_adj_dollar_general,\n    CASE\n        WHEN  trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_80 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_90) THEN 9\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_70 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_80) THEN 8\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_60 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_70) THEN 7\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_50 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_60) THEN 6\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_40 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_50) THEN 5\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_30 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_40) THEN 4\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_20 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_30) THEN 3\n        WHEN (trif.is_avbl_adj_dollar_general >  avblper.is_avbl_adj_dollar_general_10 AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_20) THEN 2\n        WHEN (trif.is_avbl_adj_dollar_general >  0.0                                   AND trif.is_avbl_adj_dollar_general <= avblper.is_avbl_adj_dollar_general_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_dollar_general_decile,\n\n    trif.is_avbl_adj_family_dollar,\n    CASE\n        WHEN  trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_80 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_90) THEN 9\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_70 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_80) THEN 8\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_60 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_70) THEN 7\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_50 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_60) THEN 6\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_40 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_50) THEN 5\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_30 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_40) THEN 4\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_20 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_30) THEN 3\n        WHEN (trif.is_avbl_adj_family_dollar >  avblper.is_avbl_adj_family_dollar_10 AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_20) THEN 2\n        WHEN (trif.is_avbl_adj_family_dollar >  0.0                                  AND trif.is_avbl_adj_family_dollar <= avblper.is_avbl_adj_family_dollar_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_family_dollar_decile,\n\n    trif.is_avbl_adj_heb,\n    CASE\n        WHEN  trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_80 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_90) THEN 9\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_70 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_80) THEN 8\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_60 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_70) THEN 7\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_50 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_60) THEN 6\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_40 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_50) THEN 5\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_30 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_40) THEN 4\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_20 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_30) THEN 3\n        WHEN (trif.is_avbl_adj_heb >  avblper.is_avbl_adj_heb_10 AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_20) THEN 2\n        WHEN (trif.is_avbl_adj_heb >  0.0                        AND trif.is_avbl_adj_heb <= avblper.is_avbl_adj_heb_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_heb_decile,\n\n    trif.is_avbl_adj_speedway,\n    CASE\n        WHEN  trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_80 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_90) THEN 9\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_70 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_80) THEN 8\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_60 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_70) THEN 7\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_50 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_60) THEN 6\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_40 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_50) THEN 5\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_30 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_40) THEN 4\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_20 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_30) THEN 3\n        WHEN (trif.is_avbl_adj_speedway >  avblper.is_avbl_adj_speedway_10 AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_20) THEN 2\n        WHEN (trif.is_avbl_adj_speedway >  0.0                             AND trif.is_avbl_adj_speedway <= avblper.is_avbl_adj_speedway_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_speedway_decile,\n\n    trif.is_avbl_adj_hy_vee,\n    CASE\n        WHEN  trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_80 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_90) THEN 9\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_70 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_80) THEN 8\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_60 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_70) THEN 7\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_50 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_60) THEN 6\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_40 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_50) THEN 5\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_30 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_40) THEN 4\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_20 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_30) THEN 3\n        WHEN (trif.is_avbl_adj_hy_vee >  avblper.is_avbl_adj_hy_vee_10 AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_20) THEN 2\n        WHEN (trif.is_avbl_adj_hy_vee >  0.0                           AND trif.is_avbl_adj_hy_vee <= avblper.is_avbl_adj_hy_vee_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_hy_vee_decile,\n\n    trif.is_avbl_adj_kroger_banner,\n    CASE\n        WHEN  trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_80 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_90) THEN 9\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_70 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_80) THEN 8\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_60 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_70) THEN 7\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_50 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_60) THEN 6\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_40 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_50) THEN 5\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_30 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_40) THEN 4\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_20 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_30) THEN 3\n        WHEN (trif.is_avbl_adj_kroger_banner >  avblper.is_avbl_adj_kroger_banner_10 AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_20) THEN 2\n        WHEN (trif.is_avbl_adj_kroger_banner >  0.0                                  AND trif.is_avbl_adj_kroger_banner <= avblper.is_avbl_adj_kroger_banner_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_kroger_banner_decile,\n\n    trif.is_avbl_adj_all_other_kroger,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_80 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_70 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_60 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_50 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_40 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_30 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_20 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_kroger >  avblper.is_avbl_adj_all_other_kroger_10 AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_kroger >  0.0                                     AND trif.is_avbl_adj_all_other_kroger <= avblper.is_avbl_adj_all_other_kroger_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_kroger_decile,\n\n    trif.is_avbl_adj_all_other_club,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_80 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_70 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_60 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_50 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_40 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_30 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_20 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_club >  avblper.is_avbl_adj_all_other_club_10 AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_club >  0.0                                   AND trif.is_avbl_adj_all_other_club <= avblper.is_avbl_adj_all_other_club_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_club_decile,\n\n    trif.is_avbl_adj_all_other_dollar,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_80 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_70 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_60 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_50 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_40 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_30 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_20 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_dollar >  avblper.is_avbl_adj_all_other_dollar_10 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_dollar >  0.0 AND trif.is_avbl_adj_all_other_dollar <= avblper.is_avbl_adj_all_other_dollar_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_dollar_decile,\n\n    trif.is_avbl_adj_all_other_drug,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_80 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_70 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_60 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_50 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_40 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_30 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_20 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_drug >  avblper.is_avbl_adj_all_other_drug_10 AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_drug >  0.0                                   AND trif.is_avbl_adj_all_other_drug <= avblper.is_avbl_adj_all_other_drug_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_drug_decile,\n\n    trif.is_avbl_adj_all_other_c_and_g,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_80 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_70 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_60 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_50 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_40 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_30 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_20 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  avblper.is_avbl_adj_all_other_c_and_g_10 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_c_and_g >  0.0 AND trif.is_avbl_adj_all_other_c_and_g <= avblper.is_avbl_adj_all_other_c_and_g_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_c_and_g_decile,\n\n    trif.is_avbl_adj_all_other_grocery,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_80 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_70 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_60 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_50 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_40 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_30 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_20 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_grocery >  avblper.is_avbl_adj_all_other_grocery_10 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_grocery >  0.0 AND trif.is_avbl_adj_all_other_grocery <= avblper.is_avbl_adj_all_other_grocery_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_grocery_decile,\n\n    trif.is_avbl_adj_all_other_mass,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_80 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_70 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_60 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_50 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_40 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_30 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_20 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_mass >  avblper.is_avbl_adj_all_other_mass_10 AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_mass >  0.0                                   AND trif.is_avbl_adj_all_other_mass <= avblper.is_avbl_adj_all_other_mass_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_mass_decile,\n\n    trif.is_avbl_adj_publix,\n    CASE\n        WHEN  trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_80 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_90) THEN 9\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_70 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_80) THEN 8\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_60 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_70) THEN 7\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_50 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_60) THEN 6\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_40 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_50) THEN 5\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_30 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_40) THEN 4\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_20 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_30) THEN 3\n        WHEN (trif.is_avbl_adj_publix >  avblper.is_avbl_adj_publix_10 AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_20) THEN 2\n        WHEN (trif.is_avbl_adj_publix >  0.0                           AND trif.is_avbl_adj_publix <= avblper.is_avbl_adj_publix_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_publix_decile,\n\n    trif.is_avbl_adj_sams_club,\n    CASE\n        WHEN  trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_80 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_90) THEN 9\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_70 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_80) THEN 8\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_60 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_70) THEN 7\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_50 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_60) THEN 6\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_40 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_50) THEN 5\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_30 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_40) THEN 4\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_20 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_30) THEN 3\n        WHEN (trif.is_avbl_adj_sams_club >  avblper.is_avbl_adj_sams_club_10 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_20) THEN 2\n        WHEN (trif.is_avbl_adj_sams_club >  0.0 AND trif.is_avbl_adj_sams_club <= avblper.is_avbl_adj_sams_club_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_sams_club_decile,\n\n    trif.is_avbl_adj_target,\n    CASE\n        WHEN  trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_80 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_90) THEN 9\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_70 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_80) THEN 8\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_60 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_70) THEN 7\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_50 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_60) THEN 6\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_40 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_50) THEN 5\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_30 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_40) THEN 4\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_20 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_30) THEN 3\n        WHEN (trif.is_avbl_adj_target >  avblper.is_avbl_adj_target_10 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_20) THEN 2\n        WHEN (trif.is_avbl_adj_target >  0.0 AND trif.is_avbl_adj_target <= avblper.is_avbl_adj_target_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_target_decile,\n\n    trif.is_avbl_adj_trader_joes,\n    CASE\n        WHEN  trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_80 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_90) THEN 9\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_70 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_80) THEN 8\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_60 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_70) THEN 7\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_50 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_60) THEN 6\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_40 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_50) THEN 5\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_30 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_40) THEN 4\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_20 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_30) THEN 3\n        WHEN (trif.is_avbl_adj_trader_joes >  avblper.is_avbl_adj_trader_joes_10 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_20) THEN 2\n        WHEN (trif.is_avbl_adj_trader_joes >  0.0 AND trif.is_avbl_adj_trader_joes <= avblper.is_avbl_adj_trader_joes_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_trader_joes_decile,\n\n    trif.is_avbl_adj_wakefern,\n    CASE\n        WHEN  trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_80 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_90) THEN 9\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_70 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_80) THEN 8\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_60 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_70) THEN 7\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_50 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_60) THEN 6\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_40 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_50) THEN 5\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_30 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_40) THEN 4\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_20 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_30) THEN 3\n        WHEN (trif.is_avbl_adj_wakefern >  avblper.is_avbl_adj_wakefern_10 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_20) THEN 2\n        WHEN (trif.is_avbl_adj_wakefern >  0.0 AND trif.is_avbl_adj_wakefern <= avblper.is_avbl_adj_wakefern_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_wakefern_decile,\n\n    trif.is_avbl_adj_walgreens,\n    CASE\n        WHEN  trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_80 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_90) THEN 9\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_70 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_80) THEN 8\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_60 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_70) THEN 7\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_50 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_60) THEN 6\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_40 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_50) THEN 5\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_30 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_40) THEN 4\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_20 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_30) THEN 3\n        WHEN (trif.is_avbl_adj_walgreens >  avblper.is_avbl_adj_walgreens_10 AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_20) THEN 2\n        WHEN (trif.is_avbl_adj_walgreens >  0.0                              AND trif.is_avbl_adj_walgreens <= avblper.is_avbl_adj_walgreens_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_walgreens_decile,\n\n    trif.is_avbl_adj_walmart_com,\n    CASE\n        WHEN  trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_80 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_70 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_60 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_50 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_40 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_30 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_20 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_walmart_com >  avblper.is_avbl_adj_walmart_com_10 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_walmart_com >  0.0 AND trif.is_avbl_adj_walmart_com <= avblper.is_avbl_adj_walmart_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_walmart_com_decile,\n\n    trif.is_avbl_adj_wm_neighborhood_market,\n    CASE\n        WHEN  trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_90       THEN 10\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_80 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_90) THEN 9\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_70 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_80) THEN 8\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_60 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_70) THEN 7\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_50 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_60) THEN 6\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_40 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_50) THEN 5\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_30 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_40) THEN 4\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_20 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_30) THEN 3\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  avblper.is_avbl_adj_wm_neighborhood_market_10 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_20) THEN 2\n        WHEN (trif.is_avbl_adj_wm_neighborhood_market >  0.0 AND trif.is_avbl_adj_wm_neighborhood_market <= avblper.is_avbl_adj_wm_neighborhood_market_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_wm_neighborhood_market_decile,\n\n    trif.is_avbl_adj_all_other_walmart,\n    CASE\n        WHEN  trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_80 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_90) THEN 9\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_70 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_80) THEN 8\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_60 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_70) THEN 7\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_50 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_60) THEN 6\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_40 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_50) THEN 5\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_30 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_40) THEN 4\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_20 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_30) THEN 3\n        WHEN (trif.is_avbl_adj_all_other_walmart >  avblper.is_avbl_adj_all_other_walmart_10 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_20) THEN 2\n        WHEN (trif.is_avbl_adj_all_other_walmart >  0.0 AND trif.is_avbl_adj_all_other_walmart <= avblper.is_avbl_adj_all_other_walmart_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_all_other_walmart_decile,\n\n    trif.is_avbl_adj_whole_foods,\n    CASE\n        WHEN  trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_90  THEN 10\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_80 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_90) THEN 9\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_70 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_80) THEN 8\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_60 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_70) THEN 7\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_50 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_60) THEN 6\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_40 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_50) THEN 5\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_30 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_40) THEN 4\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_20 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_30) THEN 3\n        WHEN (trif.is_avbl_adj_whole_foods > avblper.is_avbl_adj_whole_foods_10 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_20) THEN 2\n        WHEN (trif.is_avbl_adj_whole_foods > 0.0 AND trif.is_avbl_adj_whole_foods <= avblper.is_avbl_adj_whole_foods_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_whole_foods_decile,\n\n    trif.is_avbl_adj_target_com,\n    CASE\n        WHEN  trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_80 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_70 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_60 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_50 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_40 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_30 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_20 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_target_com >  avblper.is_avbl_adj_target_com_10 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_target_com >  0.0 AND trif.is_avbl_adj_target_com <= avblper.is_avbl_adj_target_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_target_com_decile,\n\n    trif.is_avbl_adj_kroger_com,\n    CASE\n        WHEN  trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_80 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_70 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_60 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_50 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_40 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_30 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_20 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_kroger_com >  avblper.is_avbl_adj_kroger_com_10 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_kroger_com >  0.0 AND trif.is_avbl_adj_kroger_com <= avblper.is_avbl_adj_kroger_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_kroger_com_decile,\n\n    trif.is_avbl_adj_kmart_com,\n    CASE\n        WHEN  trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_80 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_70 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_60 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_50 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_40 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_30 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_20 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_kmart_com >  avblper.is_avbl_adj_kmart_com_10 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_kmart_com >  0.0 AND trif.is_avbl_adj_kmart_com <= avblper.is_avbl_adj_kmart_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_kmart_com_decile,\n\n    trif.is_avbl_adj_walgreens_com,\n    CASE\n        WHEN  trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_80 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_70 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_60 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_50 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_40 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_30 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_20 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_walgreens_com >  avblper.is_avbl_adj_walgreens_com_10 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_walgreens_com >  0.0 AND trif.is_avbl_adj_walgreens_com <= avblper.is_avbl_adj_walgreens_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_walgreens_com_decile,\n\n    trif.is_avbl_adj_samsclub_com,\n    CASE\n        WHEN  trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_80 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_70 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_60 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_50 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_40 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_30 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_20 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_samsclub_com >  avblper.is_avbl_adj_samsclub_com_10 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_samsclub_com >  0.0 AND trif.is_avbl_adj_samsclub_com <= avblper.is_avbl_adj_samsclub_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_samsclub_com_decile,\n\n    trif.is_avbl_adj_costco_com,\n    CASE\n        WHEN  trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_90                                                         THEN 10\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_80 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_90) THEN 9\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_70 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_80) THEN 8\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_60 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_70) THEN 7\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_50 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_60) THEN 6\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_40 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_50) THEN 5\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_30 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_40) THEN 4\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_20 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_30) THEN 3\n        WHEN (trif.is_avbl_adj_costco_com >  avblper.is_avbl_adj_costco_com_10 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_20) THEN 2\n        WHEN (trif.is_avbl_adj_costco_com >  0.0 AND trif.is_avbl_adj_costco_com <= avblper.is_avbl_adj_costco_com_10) THEN 1\n        ELSE 0\n    END AS is_avbl_adj_costco_com_decile,\n\n\n    trif.fvh_cur_lifestage,\n    trif.fvh_cur_pred_spend,\n    trif.fvh_fut_pred_spend,\n    CASE\n        WHEN  trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_90                                                         THEN 10\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_80 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_90) THEN 9\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_70 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_80) THEN 8\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_60 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_70) THEN 7\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_50 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_60) THEN 6\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_40 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_50) THEN 5\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_30 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_40) THEN 4\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_20 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_30) THEN 3\n        WHEN (trif.fvh_fut_pred_spend >  fvhper.fvh_fut_spend_10 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_20) THEN 2\n        WHEN (trif.fvh_fut_pred_spend > 0.0 AND trif.fvh_fut_pred_spend <= fvhper.fvh_fut_spend_10)                       THEN 1\n        ELSE 0\n    END AS fvh_fut_pred_spend_decile,\n    trif.fvh_growth_rate,\n    CASE\n        WHEN  trif.fvh_growth_rate >  fvhper.fvh_growth_rate_90                                                        THEN 10\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_80 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_90) THEN 9\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_70 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_80) THEN 8\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_60 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_70) THEN 7\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_50 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_60) THEN 6\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_40 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_50) THEN 5\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_30 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_40) THEN 4\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_20 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_30) THEN 3\n        WHEN (trif.fvh_growth_rate >  fvhper.fvh_growth_rate_10 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_20) THEN 2\n        WHEN (trif.fvh_growth_rate > 0.0 AND trif.fvh_growth_rate <= fvhper.fvh_growth_rate_10)                        THEN 1\n        ELSE 0\n    END AS fvh_growth_rate_decile,\n\n    trif.smart_water,\n    trif.smart_water_decile,\n    trif.energy_csd_zero_calorie,\n    trif.energy_csd_zero_calorie_decile,\n    trif.csd_total,\n    trif.csd_total_decile,\n    trif.doritos,\n    trif.doritos_decile,\n    trif.energy_drinks,\n    trif.energy_drinks_decile,\n    trif.gatorade,\n    trif.gatorade_decile,\n    trif.lays,\n    trif.lays_decile,\n    trif.lipton_base,\n    trif.lipton_base_decile,\n    trif.lipton_brisk,\n    trif.lipton_brisk_decile,\n    trif.mt_dew,\n    trif.mt_dew_decile,\n    trif.mtn_dew_kickstart,\n    trif.mtn_dew_kickstart_decile,\n    trif.nuts,\n    trif.nuts_decile,\n    trif.pepsi_diet,\n    trif.pepsi_diet_decile,\n    trif.pepsi_regular,\n    trif.pepsi_regular_decile,\n    trif.performance_bars,\n    trif.performance_bars_decile,\n    trif.pepsico_protein_powder,\n    trif.pepsico_protein_powder_decile,\n    trif.propel,\n    trif.propel_decile,\n    trif.quaker_oatmeal,\n    trif.quaker_oatmeal_decile,\n    trif.rte_cereal,\n    trif.rte_cereal_decile,\n    trif.ruffles,\n    trif.ruffles_decile,\n    trif.bottled_water,\n    trif.bottled_water_decile,\n    trif.starbucks_tripleshot,\n    trif.starbucks_tripleshot_decile,\n    trif.funyuns,\n    trif.funyuns_decile,\n    trif.chilled_tea,\n    trif.chilled_tea_decile,\n    trif.coffee_rtd,\n    trif.coffee_rtd_decile,\n    trif.online_delivery,\n    trif.online_delivery_decile,\n    trif.csd_singles,\n    trif.csd_singles_decile,\n    trif.flv_csd_ex_dew_pepper,\n    trif.flv_csd_ex_dew_pepper_decile,\n    trif.rtd_protein,\n    trif.rtd_protein_decile,\n    trif.sodastream,\n    trif.sodastream_decile,\n    trif.gamefuel,\n    trif.gamefuel_decile,\n    trif.mainstream_kettle_chips,\n    trif.mainstream_kettle_chips_decile,\n    trif.lipton_pure_leaf,\n    trif.lipton_pure_leaf_decile,\n    trif.mainstream_juices,\n    trif.mainstream_juices_decile,\n    trif.mt_dew_flv_seek,\n    trif.mt_dew_flv_seek_decile,\n    trif.instant_quaker_oats,\n    trif.instant_quaker_oats_decile,\n    trif.naked_protein,\n    trif.naked_protein_decile,\n    trif.pepsi_zero_coke_zero,\n    trif.pepsi_zero_coke_zero_decile,\n    trif.prem_juice_drinks,\n    trif.prem_juice_drinks_decile,\n    trif.lightly_flavored_tortilla_chips,\n    trif.lightly_flavored_tortilla_chips_decile,\n    trif.doubleshot_javam,\n    trif.doubleshot_javam_decile,\n    trif.food_bev,\n    trif.food_bev_decile,\n    trif.ncb_innovation,\n    trif.ncb_innovation_decile,\n    trif.premium_csd,\n    trif.premium_csd_decile,\n    trif.premium_tea,\n    trif.premium_tea_decile,\n    trif.premium_water,\n    trif.premium_water_decile,\n    trif.probiotic_juices,\n    trif.probiotic_juices_decile,\n    trif.lays_poppables,\n    trif.lays_poppables_decile,\n    trif.alternative_tortilla_chips,\n    trif.alternative_tortilla_chips_decile,\n    trif.snack_bars,\n    trif.snack_bars_decile,\n    trif.sparkling_water,\n    trif.sparkling_water_decile,\n    trif.dips_as_meal_enhancers,\n    trif.dips_as_meal_enhancers_decile,\n    trif.stacys,\n    trif.stacys_decile,\n    trif.sunchips,\n    trif.sunchips_decile,\n    trif.super_premium_juices,\n    trif.super_premium_juices_decile,\n    trif.tostitos,\n    trif.tostitos_decile,\n    trif.flavor_camp_bbq,\n    trif.flavor_camp_bbq_decile,\n    trif.plant_based_rtd_protein,\n    trif.plant_based_rtd_protein_decile,\n    trif.veggie_chips,\n    trif.veggie_chips_decile,\n    trif.g_organic,\n    trif.g_organic_decile,\n    trif.mountain_dew_baja_blast,\n    trif.mountain_dew_baja_blast_decile,\n    trif.cold_brew,\n    trif.cold_brew_decile,\n    trif.bubly,\n    trif.bubly_decile,\n    trif.ultra_premium_juice,\n    trif.ultra_premium_juice_decile,\n    trif.lightly_salted_chips,\n    trif.lightly_salted_chips_decile,\n    trif.flavor_camp_cheese,\n    trif.flavor_camp_cheese_decile,\n    trif.sabra_hummus_tubs,\n    trif.sabra_hummus_tubs_decile,\n    trif.oj_category_switchers,\n    trif.oj_category_switchers_decile,\n    trif.standard_quaker_oats,\n    trif.standard_quaker_oats_decile,\n    trif.csd_multiserve,\n    trif.csd_multiserve_decile,\n    trif.dew_ice,\n    trif.dew_ice_decile,\n    trif.flavor_camp_dairy,\n    trif.flavor_camp_dairy_decile,\n    trif.online_curbside_pickup,\n    trif.online_curbside_pickup_decile,\n    trif.flavor_camp_herb_spice_veggie,\n    trif.flavor_camp_herb_spice_veggie_decile,\n    trif.flv_salty_snacks,\n    trif.flv_salty_snacks_decile,\n    trif.g2,\n    trif.g2_decile,\n    trif.flavor_camp_salted_plain,\n    trif.flavor_camp_salted_plain_decile,\n    trif.keto_cookies,\n    trif.keto_cookies_decile,\n    trif.low_fat_salty_snacks,\n    trif.low_fat_salty_snacks_decile,\n    trif.aha,\n    trif.aha_decile,\n    trif.plant_based_protein_powder,\n    trif.plant_based_protein_powder_decile,\n    trif.pretzel_category,\n    trif.pretzel_category_decile,\n    trif.flavor_camp_spicy_burn,\n    trif.flavor_camp_spicy_burn_decile,\n    trif.dots_pretzels,\n    trif.dots_pretzels_decile,\n    trif.santitas,\n    trif.santitas_decile,\n    trif.flavor_camp_tangy,\n    trif.flavor_camp_tangy_decile,\n    trif.tropicana_probiotics_purchasers,\n    trif.tropicana_probiotics_purchasers_decile,\n    trif.tropicana_pure_premium_purchasers,\n    trif.tropicana_pure_premium_purchasers_decile,\n    trif.rfg_yogurt_drinks,\n    trif.rfg_yogurt_drinks_decile,\n    trif.flavor_camp_aggregate_all_intense_bold,\n    trif.flavor_camp_aggregate_all_intense_bold_decile,\n    trif.total_regular_cola,\n    trif.total_regular_cola_decile,\n    trif.flavor_camp_meat,\n    trif.flavor_camp_meat_decile,\n    trif.fritos_original,\n    trif.fritos_original_decile,\n    trif.flavored_pretzels,\n    trif.flavored_pretzels_decile,\n    trif.nutrition_engaged,\n    trif.nutrition_engaged_decile,\n    trif.mainstream_engaged,\n    trif.mainstream_engaged_decile,\n    trif.oj_category,\n    trif.oj_category_decile,\n    trif.nutrition_bars,\n    trif.nutrition_bars_decile,\n    trif.oatmeal_category,\n    trif.oatmeal_category_decile,\n    trif.alt_dairy_category,\n    trif.alt_dairy_category_decile,\n    trif.kombucha_functional_juices,\n    trif.kombucha_functional_juices_decile,\n    trif.single_serve_mainstream_juice,\n    trif.single_serve_mainstream_juice_decile,\n    trif.quaker_grits,\n    trif.quaker_grits_decile,\n    trif.shelf_stable_dips_category,\n    trif.shelf_stable_dips_category_decile,\n    trif.fruit_snacks,\n    trif.fruit_snacks_decile,\n    trif.fritos_flavor,\n    trif.fritos_flavor_decile,\n    trif.kevita_purchasers,\n    trif.kevita_purchasers_decile,\n    trif.heart_claim,\n    trif.heart_claim_decile,\n    trif.starbucks_frappuccino,\n    trif.starbucks_frappuccino_decile,\n    trif.single_serve_salty_snacks,\n    trif.single_serve_salty_snacks_decile,\n    trif.cholesterol_claim,\n    trif.cholesterol_claim_decile,\n    trif.g_zero,\n    trif.g_zero_decile,\n    trif.diet_csds,\n    trif.diet_csds_decile,\n    trif.candy_category,\n    trif.candy_category_decile,\n    trif.frozen_fruit_category,\n    trif.frozen_fruit_category_decile,\n    trif.salty_snacks,\n    trif.salty_snacks_decile,\n    trif.premium_greek_yogurt,\n    trif.premium_greek_yogurt_decile,\n    trif.rice_pasta_ethnic_spclty,\n    trif.rice_pasta_ethnic_spclty_decile,\n    trif.pancake_mix_syrup,\n    trif.pancake_mix_syrup_decile,\n    trif.lite_snacks,\n    trif.lite_snacks_decile,\n    trif.herbal_tea,\n    trif.herbal_tea_decile,\n    trif.tazo,\n    trif.tazo_decile,\n    trif.mini_cans,\n    trif.mini_cans_decile,\n    trif.unflavored_pretzels,\n    trif.unflavored_pretzels_decile,\n    trif.bodyarmor,\n    trif.bodyarmor_decile,\n    trif.organic_food_bev_buyers,\n    trif.organic_food_bev_buyers_decile,\n    trif.fritos_scoops,\n    trif.fritos_scoops_decile,\n    trif.grain_claim,\n    trif.grain_claim_decile,\n    trif.diet_coke,\n    trif.diet_coke_decile,\n    trif.online_in_store_pickup,\n    trif.online_in_store_pickup_decile,\n    trif.bare,\n    trif.bare_decile,\n    trif.off_the_eaten_path,\n    trif.off_the_eaten_path_decile,\n    trif.rte_cereal_all_family,\n    trif.rte_cereal_all_family_decile,\n    trif.rte_cereal_kids,\n    trif.rte_cereal_kids_decile,\n    trif.instant_quaker_oats_light_lapsed,\n    trif.instant_quaker_oats_light_lapsed_decile,\n    trif.celsius_energy,\n    trif.celsius_energy_decile,\n    trif.doritos_h_and_s,\n    trif.doritos_h_and_s_decile,\n    trif.premium_kettle_chips,\n    trif.premium_kettle_chips_decile,\n    trif.chewy_kids_snacking,\n    trif.chewy_kids_snacking_decile,\n    trif.starbucks_nitro,\n    trif.starbucks_nitro_decile,\n    trif.premium_lrb,\n    trif.premium_lrb_decile,\n    trif.rte_popcorn_full_flavor,\n    trif.rte_popcorn_full_flavor_decile,\n    trif.rte_popcorn_light_flavor,\n    trif.rte_popcorn_light_flavor_decile,\n    trif.breakfast_cereal_snack_bars,\n    trif.breakfast_cereal_snack_bars_decile,\n    trif.sports_drinks,\n    trif.sports_drinks_decile,\n    trif.takis,\n    trif.takis_decile,\n    trif.lacroix,\n    trif.lacroix_decile,\n    trif.manzanita_sol,\n    trif.manzanita_sol_decile,\n    trif.unflavored_tortilla_chips,\n    trif.unflavored_tortilla_chips_decile,\n    trif.crush,\n    trif.crush_decile,\n    trif.chewy,\n    trif.chewy_decile,\n    trif.rockstar_energy,\n    trif.rockstar_energy_decile,\n    trif.light_holiday_salty_snack_buyers,\n    trif.light_holiday_salty_snack_buyers_decile,\n    trif.medium_holiday_salty_snack_buyers,\n    trif.medium_holiday_salty_snack_buyers_decile,\n    trif.xxvl_single_serve_snacks,\n    trif.xxvl_single_serve_snacks_decile,\n    trif.svlr_single_serve_snacks,\n    trif.svlr_single_serve_snacks_decile,\n    trif.lss_single_serve_snacks,\n    trif.lss_single_serve_snacks_decile,\n    trif.bolt_24,\n    trif.bolt_24_decile,\n    trif.lemonade,\n    trif.lemonade_decile,\n    trif.gamesa_cookies,\n    trif.gamesa_cookies_decile,\n    trif.kids_organic,\n    trif.kids_organic_decile,\n    trif.rice_crisps_cakes,\n    trif.rice_crisps_cakes_decile,\n    trif.health_warrior,\n    trif.health_warrior_decile,\n    trif.simple_nutrition,\n    trif.simple_nutrition_decile,\n    trif.naked,\n    trif.naked_decile,\n    trif.yogurt,\n    trif.yogurt_decile,\n    trif.online_edible,\n    trif.online_edible_decile,\n    trif.better_for_you_bagged_snacks,\n    trif.better_for_you_bagged_snacks_decile,\n    trif.vanilla_flavored_rtd_coffee,\n    trif.vanilla_flavored_rtd_coffee_decile,\n    trif.frozen_dips,\n    trif.frozen_dips_decile,\n    trif.caramel_flavored_rtd_coffee,\n    trif.caramel_flavored_rtd_coffee_decile,\n    trif.coffee_flavored_rtd_coffee,\n    trif.coffee_flavored_rtd_coffee_decile,\n    trif.lays_stax,\n    trif.lays_stax_decile,\n    trif.popcorners,\n    trif.popcorners_decile,\n    trif.shelf_stable_dairy_dips,\n    trif.shelf_stable_dairy_dips_decile,\n    trif.probiotic_attribute,\n    trif.probiotic_attribute_decile,\n    trif.essentia,\n    trif.essentia_decile,\n    trif.core,\n    trif.core_decile,\n    trif.dasani,\n    trif.dasani_decile,\n    trif.shelf_stable_salsa,\n    trif.shelf_stable_salsa_decile,\n    trif.shelf_stable_cheese_dips,\n    trif.shelf_stable_cheese_dips_decile,\n    trif.shelf_stable_bean_dips,\n    trif.shelf_stable_bean_dips_decile,\n    trif.cheetos_cheese_core,\n    trif.cheetos_cheese_core_decile,\n    trif.frito_lay_multipack,\n    trif.frito_lay_multipack_decile,\n    trif.cheetos_flamin_hot_core,\n    trif.cheetos_flamin_hot_core_decile,\n    trif.muscle_milk,\n    trif.muscle_milk_decile,\n    trif.kst_regular_coke_transitioner,\n    trif.kst_regular_coke_transitioner_decile,\n    trif.kst_frequent_diet_pepsi_transitioner,\n    trif.kst_frequent_diet_pepsi_transitioner_decile,\n    trif.kst_hispanic_pepsi_drinker,\n    trif.kst_hispanic_pepsi_drinker_decile,\n    trif.kst_light_cola_drinker,\n    trif.kst_light_cola_drinker_decile,\n    trif.kst_frequent_blue_pepsi_drinker,\n    trif.kst_frequent_blue_pepsi_drinker_decile,\n    trif.kst_non_cola_drinkers,\n    trif.kst_non_cola_drinkers_decile,\n    trif.macaroni_and_cheese,\n    trif.macaroni_and_cheese_decile,\n    trif.heat_and_eat,\n    trif.heat_and_eat_decile,\n    trif.instant_rice_pasta_grains,\n    trif.instant_rice_pasta_grains_decile,\n    trif.better_for_you_crackers,\n    trif.better_for_you_crackers_decile,\n    trif.zero_calorie_csd,\n    trif.zero_calorie_csd_decile,\n    trif.wavy_lays,\n    trif.wavy_lays_decile,\n    trif.multiserve_starbucks,\n    trif.multiserve_starbucks_decile,\n    trif.tea_bags,\n    trif.tea_bags_decile,\n    trif.rfg_dips,\n    trif.rfg_dips_decile,\n    trif.sleeping_remedies,\n    trif.sleeping_remedies_decile,\n    trif.adaptogens,\n    trif.adaptogens_decile,\n    trif.easy_wellness,\n    trif.easy_wellness_decile,\n    trif.bang,\n    trif.bang_decile,\n    trif.kevita_adjacencies,\n    trif.kevita_adjacencies_decile,\n    trif.caffeine_attribute,\n    trif.caffeine_attribute_decile,\n    trif.vitamin_c_attribute,\n    trif.vitamin_c_attribute_decile,\n    trif.antioxidant_attribute,\n    trif.antioxidant_attribute_decile,\n    trif.poland_spring,\n    trif.poland_spring_decile,\n    trif.polar,\n    trif.polar_decile,\n    trif.diet_coke_decliners,\n    trif.diet_coke_decliners_decile,\n    trif.sprite_and_fanta_decliners,\n    trif.sprite_and_fanta_decliners_decile,\n    trif.rap_snacks,\n    trif.rap_snacks_decile,\n    trif.cheetos_crunchy,\n    trif.cheetos_crunchy_decile,\n    trif.cheetos_puffs,\n    trif.cheetos_puffs_decile,\n    trif.lays_classic,\n    trif.lays_classic_decile,\n    trif.premium_cocktail_mixers,\n    trif.premium_cocktail_mixers_decile,\n    trif.baken_ets,\n    trif.baken_ets_decile,\n    trif.mainstream_mixers,\n    trif.mainstream_mixers_decile,\n    trif.quaker_hots_light_lapsed,\n    trif.quaker_hots_light_lapsed_decile,\n    trif.zone_in_shopper,\n    trif.zone_in_shopper_decile,\n    trif.root_beer,\n    trif.root_beer_decile,\n    trif.coke,\n    trif.coke_decile,\n    trif.premium_cheese_snacks,\n    trif.premium_cheese_snacks_decile,\n    trif.stacys_thins,\n    trif.stacys_thins_decile,\n    trif.stacys_core,\n    trif.stacys_core_decile,\n    trif.diet_mountain_dew,\n    trif.diet_mountain_dew_decile,\n    trif.sparkling_ice,\n    trif.sparkling_ice_decile,\n    trif.granola,\n    trif.granola_decile,\n    trif.aj_pancake_mix_and_syrup,\n    trif.aj_pancake_mix_and_syrup_decile,\n    trif.rte_cereal_adult,\n    trif.rte_cereal_adult_decile,\n    trif.kids_ambient_juices,\n    trif.kids_ambient_juices_decile,\n    trif.non_lemonade_juice_drinks,\n    trif.non_lemonade_juice_drinks_decile,\n    trif.cheetos_mac_n_cheese,\n    trif.cheetos_mac_n_cheese_decile,\n    trif.hispanic_cookies,\n    trif.hispanic_cookies_decile,\n    trif.gamesa_crackers,\n    trif.gamesa_crackers_decile,\n    trif.naked_juice_lapsed_buyers,\n    trif.naked_juice_lapsed_buyers_decile,\n    trif.natural_attribute,\n    trif.natural_attribute_decile,\n    trif.protein_attribute,\n    trif.protein_attribute_decile,\n    trif.calcium_attribute,\n    trif.calcium_attribute_decile,\n    trif.fiber,\n    trif.fiber_decile,\n    trif.gluten_free,\n    trif.gluten_free_decile,\n    trif.low_sodium,\n    trif.low_sodium_decile,\n    trif.no_added_sugar,\n    trif.no_added_sugar_decile,\n    trif.simply,\n    trif.simply_decile,\n    trif.baked,\n    trif.baked_decile,\n    trif.non_gmo,\n    trif.non_gmo_decile,\n    trif.mt_dew_total,\n    trif.mt_dew_total_decile,\n    trif.keto_dieters,\n    trif.keto_dieters_decile,\n    trif.party_people,\n    trif.party_people_decile,\n    trif.cold_and_flu_preppers,\n    trif.cold_and_flu_preppers_decile,\n    trif.condiments_and_sauces,\n    trif.condiments_and_sauces_decile,\n    trif.flavored_csds,\n    trif.flavored_csds_decile,\n    trif.holiday_hosts,\n    trif.holiday_hosts_decile,\n    trif.immunity_boosters,\n    trif.immunity_boosters_decile,\n    trif.new_years_dieters,\n    trif.new_years_dieters_decile,\n    trif.new_years_partiers,\n    trif.new_years_partiers_decile,\n    trif.plant_based_buyers,\n    trif.plant_based_buyers_decile,\n    trif.summer_grillers,\n    trif.summer_grillers_decile,\n    trif.super_bowl_hosts,\n    trif.super_bowl_hosts_decile,\n    trif.thanksgiving_hosts,\n    trif.thanksgiving_hosts_decile,\n    trif.hard_coffee,\n    trif.hard_coffee_decile,\n    trif.hard_flavored_bevs_xlemonade,\n    trif.hard_flavored_bevs_xlemonade_decile,\n    trif.hard_kombucha,\n    trif.hard_kombucha_decile,\n    trif.hard_lemonade,\n    trif.hard_lemonade_decile,\n    trif.hard_seltzer,\n    trif.hard_seltzer_decile,\n    trif.health_warrior_competitive_products,\n    trif.health_warrior_competitive_products_decile,\n    trif.other_hmb,\n    trif.other_hmb_decile,\n    trif.cookies,\n    trif.cookies_decile,\n    trif.crackers,\n    trif.crackers_decile,\n    trif.trop_premium_juice_drinks,\n    trif.trop_premium_juice_drinks_decile,\n    trif.wine,\n    trif.wine_decile,\n    trif.spirits_liquor,\n    trif.spirits_liquor_decile,\n    trif.premade_cocktails_coolers,\n    trif.premade_cocktails_coolers_decile,\n    trif.domestic_beer,\n    trif.domestic_beer_decile,\n    trif.imported_beer,\n    trif.imported_beer_decile,\n    trif.flavored_malt_beverages,\n    trif.flavored_malt_beverages_decile,\n    trif.ambient_juice,\n    trif.ambient_juice_decile,\n    trif.new_rtd_tea_buyers_buying_lipton,\n    trif.new_rtd_tea_buyers_buying_lipton_decile,\n    trif.rtd_tea_buyers_switching_to_lipton,\n    trif.rtd_tea_buyers_switching_to_lipton_decile,\n    trif.sabritas,\n    trif.sabritas_decile,\n    trif.cbd_product_purchasers,\n    trif.cbd_product_purchasers_decile,\n    trif.dr_pepper,\n    trif.dr_pepper_decile,\n    trif.coffee_beans,\n    trif.coffee_beans_decile,\n    trif.hispanic_aisle,\n    trif.hispanic_aisle_decile,\n    trif.functional_juice_kombucha_switchers,\n    trif.functional_juice_kombucha_switchers_decile,\n    trif.dole,\n    trif.dole_decile,\n    trif.twister,\n    trif.twister_decile,\n    trif.quaker_grits_new_buyers,\n    trif.quaker_grits_new_buyers_decile,\n    trif.macro_category_multi_pack_buyers,\n    trif.macro_category_multi_pack_buyers_decile,\n    trif.frutly,\n    trif.frutly_decile,\n    trif.flavored_enhanced_water,\n    trif.flavored_enhanced_water_decile,\n    trif.shelf_stable_juice_drinks,\n    trif.shelf_stable_juice_drinks_decile,\n    --\n    trif.smart_water_centile,\n    trif.energy_csd_zero_calorie_centile,\n    trif.csd_total_centile,\n    trif.doritos_centile,\n    trif.energy_drinks_centile,\n    trif.gatorade_centile,\n    trif.lays_centile,\n    trif.lipton_base_centile,\n    trif.lipton_brisk_centile,\n    trif.mt_dew_centile,\n    trif.mtn_dew_kickstart_centile,\n    trif.nuts_centile,\n    trif.pepsi_diet_centile,\n    trif.pepsi_regular_centile,\n    trif.performance_bars_centile,\n    trif.pepsico_protein_powder_centile,\n    trif.propel_centile,\n    trif.quaker_oatmeal_centile,\n    trif.rte_cereal_centile,\n    trif.ruffles_centile,\n    trif.bottled_water_centile,\n    trif.starbucks_tripleshot_centile,\n    trif.funyuns_centile,\n    trif.chilled_tea_centile,\n    trif.coffee_rtd_centile,\n    trif.online_delivery_centile,\n    trif.csd_singles_centile,\n    trif.flv_csd_ex_dew_pepper_centile,\n    trif.rtd_protein_centile,\n    trif.sodastream_centile,\n    trif.gamefuel_centile,\n    trif.mainstream_kettle_chips_centile,\n    trif.lipton_pure_leaf_centile,\n    trif.mainstream_juices_centile,\n    trif.mt_dew_flv_seek_centile,\n    trif.instant_quaker_oats_centile,\n    trif.naked_protein_centile,\n    trif.pepsi_zero_coke_zero_centile,\n    trif.prem_juice_drinks_centile,\n    trif.lightly_flavored_tortilla_chips_centile,\n    trif.doubleshot_javam_centile,\n    trif.food_bev_centile,\n    trif.ncb_innovation_centile,\n    trif.premium_csd_centile,\n    trif.premium_tea_centile,\n    trif.premium_water_centile,\n    trif.probiotic_juices_centile,\n    trif.lays_poppables_centile,\n    trif.alternative_tortilla_chips_centile,\n    trif.snack_bars_centile,\n    trif.sparkling_water_centile,\n    trif.dips_as_meal_enhancers_centile,\n    trif.stacys_centile,\n    trif.sunchips_centile,\n    trif.super_premium_juices_centile,\n    trif.tostitos_centile,\n    trif.flavor_camp_bbq_centile,\n    trif.plant_based_rtd_protein_centile,\n    trif.veggie_chips_centile,\n    trif.g_organic_centile,\n    trif.mountain_dew_baja_blast_centile,\n    trif.cold_brew_centile,\n    trif.bubly_centile,\n    trif.ultra_premium_juice_centile,\n    trif.lightly_salted_chips_centile,\n    trif.flavor_camp_cheese_centile,\n    trif.sabra_hummus_tubs_centile,\n    trif.oj_category_switchers_centile,\n    trif.standard_quaker_oats_centile,\n    trif.csd_multiserve_centile,\n    trif.dew_ice_centile,\n    trif.flavor_camp_dairy_centile,\n    trif.online_curbside_pickup_centile,\n    trif.flavor_camp_herb_spice_veggie_centile,\n    trif.flv_salty_snacks_centile,\n    trif.g2_centile,\n    trif.flavor_camp_salted_plain_centile,\n    trif.keto_cookies_centile,\n    trif.low_fat_salty_snacks_centile,\n    trif.aha_centile,\n    trif.plant_based_protein_powder_centile,\n    trif.pretzel_category_centile,\n    trif.flavor_camp_spicy_burn_centile,\n    trif.dots_pretzels_centile,\n    trif.santitas_centile,\n    trif.flavor_camp_tangy_centile,\n    trif.tropicana_probiotics_purchasers_centile,\n    trif.tropicana_pure_premium_purchasers_centile,\n    trif.rfg_yogurt_drinks_centile,\n    trif.flavor_camp_aggregate_all_intense_bold_centile,\n    trif.total_regular_cola_centile,\n    trif.flavor_camp_meat_centile,\n    trif.fritos_original_centile,\n    trif.flavored_pretzels_centile,\n    trif.nutrition_engaged_centile,\n    trif.mainstream_engaged_centile,\n    trif.oj_category_centile,\n    trif.nutrition_bars_centile,\n    trif.oatmeal_category_centile,\n    trif.alt_dairy_category_centile,\n    trif.kombucha_functional_juices_centile,\n    trif.single_serve_mainstream_juice_centile,\n    trif.quaker_grits_centile,\n    trif.shelf_stable_dips_category_centile,\n    trif.fruit_snacks_centile,\n    trif.fritos_flavor_centile,\n    trif.kevita_purchasers_centile,\n    trif.heart_claim_centile,\n    trif.starbucks_frappuccino_centile,\n    trif.single_serve_salty_snacks_centile,\n    trif.cholesterol_claim_centile,\n    trif.g_zero_centile,\n    trif.diet_csds_centile,\n    trif.candy_category_centile,\n    trif.frozen_fruit_category_centile,\n    trif.salty_snacks_centile,\n    trif.premium_greek_yogurt_centile,\n    trif.rice_pasta_ethnic_spclty_centile,\n    trif.pancake_mix_syrup_centile,\n    trif.lite_snacks_centile,\n    trif.herbal_tea_centile,\n    trif.tazo_centile,\n    trif.mini_cans_centile,\n    trif.unflavored_pretzels_centile,\n    trif.bodyarmor_centile,\n    trif.organic_food_bev_buyers_centile,\n    trif.fritos_scoops_centile,\n    trif.grain_claim_centile,\n    trif.diet_coke_centile,\n    trif.online_in_store_pickup_centile,\n    trif.bare_centile,\n    trif.off_the_eaten_path_centile,\n    trif.rte_cereal_all_family_centile,\n    trif.rte_cereal_kids_centile,\n    trif.instant_quaker_oats_light_lapsed_centile,\n    trif.celsius_energy_centile,\n    trif.doritos_h_and_s_centile,\n    trif.premium_kettle_chips_centile,\n    trif.chewy_kids_snacking_centile,\n    trif.starbucks_nitro_centile,\n    trif.premium_lrb_centile,\n    trif.rte_popcorn_full_flavor_centile,\n    trif.rte_popcorn_light_flavor_centile,\n    trif.breakfast_cereal_snack_bars_centile,\n    trif.sports_drinks_centile,\n    trif.takis_centile,\n    trif.lacroix_centile,\n    trif.manzanita_sol_centile,\n    trif.unflavored_tortilla_chips_centile,\n    trif.crush_centile,\n    trif.chewy_centile,\n    trif.rockstar_energy_centile,\n    trif.light_holiday_salty_snack_buyers_centile,\n    trif.medium_holiday_salty_snack_buyers_centile,\n    trif.xxvl_single_serve_snacks_centile,\n    trif.svlr_single_serve_snacks_centile,\n    trif.lss_single_serve_snacks_centile,\n    trif.bolt_24_centile,\n    trif.lemonade_centile,\n    trif.gamesa_cookies_centile,\n    trif.kids_organic_centile,\n    trif.rice_crisps_cakes_centile,\n    trif.health_warrior_centile,\n    trif.simple_nutrition_centile,\n    trif.naked_centile,\n    trif.yogurt_centile,\n    trif.online_edible_centile,\n    trif.better_for_you_bagged_snacks_centile,\n    trif.vanilla_flavored_rtd_coffee_centile,\n    trif.frozen_dips_centile,\n    trif.caramel_flavored_rtd_coffee_centile,\n    trif.coffee_flavored_rtd_coffee_centile,\n    trif.lays_stax_centile,\n    trif.popcorners_centile,\n    trif.shelf_stable_dairy_dips_centile,\n    trif.probiotic_attribute_centile,\n    trif.essentia_centile,\n    trif.core_centile,\n    trif.dasani_centile,\n    trif.shelf_stable_salsa_centile,\n    trif.shelf_stable_cheese_dips_centile,\n    trif.shelf_stable_bean_dips_centile,\n    trif.cheetos_cheese_core_centile,\n    trif.frito_lay_multipack_centile,\n    trif.cheetos_flamin_hot_core_centile,\n    trif.muscle_milk_centile,\n    trif.kst_regular_coke_transitioner_centile,\n    trif.kst_frequent_diet_pepsi_transitioner_centile,\n    trif.kst_hispanic_pepsi_drinker_centile,\n    trif.kst_light_cola_drinker_centile,\n    trif.kst_frequent_blue_pepsi_drinker_centile,\n    trif.kst_non_cola_drinkers_centile,\n    trif.macaroni_and_cheese_centile,\n    trif.heat_and_eat_centile,\n    trif.instant_rice_pasta_grains_centile,\n    trif.better_for_you_crackers_centile,\n    trif.zero_calorie_csd_centile,\n    trif.wavy_lays_centile,\n    trif.multiserve_starbucks_centile,\n    trif.tea_bags_centile,\n    trif.rfg_dips_centile,\n    trif.sleeping_remedies_centile,\n    trif.adaptogens_centile,\n    trif.easy_wellness_centile,\n    trif.bang_centile,\n    trif.kevita_adjacencies_centile,\n    trif.caffeine_attribute_centile,\n    trif.vitamin_c_attribute_centile,\n    trif.antioxidant_attribute_centile,\n    trif.poland_spring_centile,\n    trif.polar_centile,\n    trif.diet_coke_decliners_centile,\n    trif.sprite_and_fanta_decliners_centile,\n    trif.rap_snacks_centile,\n    trif.cheetos_crunchy_centile,\n    trif.cheetos_puffs_centile,\n    trif.lays_classic_centile,\n    trif.premium_cocktail_mixers_centile,\n    trif.baken_ets_centile,\n    trif.mainstream_mixers_centile,\n    trif.quaker_hots_light_lapsed_centile,\n    trif.zone_in_shopper_centile,\n    trif.root_beer_centile,\n    trif.coke_centile,\n    trif.premium_cheese_snacks_centile,\n    trif.stacys_thins_centile,\n    trif.stacys_core_centile,\n    trif.diet_mountain_dew_centile,\n    trif.sparkling_ice_centile,\n    trif.granola_centile,\n    trif.aj_pancake_mix_and_syrup_centile,\n    trif.rte_cereal_adult_centile,\n    trif.kids_ambient_juices_centile,\n    trif.non_lemonade_juice_drinks_centile,\n    trif.cheetos_mac_n_cheese_centile,\n    trif.hispanic_cookies_centile,\n    trif.gamesa_crackers_centile,\n    trif.naked_juice_lapsed_buyers_centile,\n    trif.natural_attribute_centile,\n    trif.protein_attribute_centile,\n    trif.calcium_attribute_centile,\n    trif.fiber_centile,\n    trif.gluten_free_centile,\n    trif.low_sodium_centile,\n    trif.no_added_sugar_centile,\n    trif.simply_centile,\n    trif.baked_centile,\n    trif.non_gmo_centile,\n    trif.mt_dew_total_centile,\n    trif.keto_dieters_centile,\n    trif.party_people_centile,\n    trif.cold_and_flu_preppers_centile,\n    trif.condiments_and_sauces_centile,\n    trif.flavored_csds_centile,\n    trif.holiday_hosts_centile,\n    trif.immunity_boosters_centile,\n    trif.new_years_dieters_centile,\n    trif.new_years_partiers_centile,\n    trif.plant_based_buyers_centile,\n    trif.summer_grillers_centile,\n    trif.super_bowl_hosts_centile,\n    trif.thanksgiving_hosts_centile,\n    trif.hard_coffee_centile,\n    trif.hard_flavored_bevs_xlemonade_centile,\n    trif.hard_kombucha_centile,\n    trif.hard_lemonade_centile,\n    trif.hard_seltzer_centile,\n    trif.health_warrior_competitive_products_centile,\n    trif.other_hmb_centile,\n    trif.cookies_centile,\n    trif.crackers_centile,\n    trif.trop_premium_juice_drinks_centile,\n    trif.wine_centile,\n    trif.spirits_liquor_centile,\n    trif.premade_cocktails_coolers_centile,\n    trif.domestic_beer_centile,\n    trif.imported_beer_centile,\n    trif.flavored_malt_beverages_centile,\n    trif.ambient_juice_centile,\n    trif.new_rtd_tea_buyers_buying_lipton_centile,\n    trif.rtd_tea_buyers_switching_to_lipton_centile,\n    trif.sabritas_centile,\n    trif.cbd_product_purchasers_centile,\n    trif.dr_pepper_centile,\n    trif.coffee_beans_centile,\n    trif.hispanic_aisle_centile,\n    trif.functional_juice_kombucha_switchers_centile,\n    trif.dole_centile,\n    trif.twister_centile,\n    trif.quaker_grits_new_buyers_centile,\n    trif.macro_category_multi_pack_buyers_centile,\n    trif.frutly_centile,\n    trif.flavored_enhanced_water_centile,\n    trif.shelf_stable_juice_drinks_centile,\n    trif.fb_dollars_hh,\n    trif.fb_units_hh,\n    trif.fb_trips_hh,\n    trif.fb_dollar_index,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('trifecta_is_cap_iri_adjf_avbl') }} trif,               --TABLE 1 TRIFACTA TEMPORARY TABLE + IS CAP + IRI TRIP COUNT ADJUSTMENT FACTOR, IS IRI ADJUSTED TRIP COUNT\n     {{ ref('is_percentile') }} isper,                              --TABLE 2 INFO SCOUT PERCENTILE VALUES\n     {{ ref('fvh_percentile') }} fvhper,                            --TABLE 3 FUTURE SPEND + GROWTH RATE PERCENTILE VALUES\n     {{ ref('avbl_is_percentile') }} avblper                        --TABLE 4 AVAILABLE ADJUSTED IS TRIP COUNT PERCENTILE VALUES", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "mvh_data_store", "retailer_data_store_full"], "unique_id": "model.sdna_project.retailer_data_store_full", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/mvh_data_store/retailer_data_store_full.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/mvh_data_store/retailer_data_store_full.sql", "name": "retailer_data_store_full", "resource_type": "model", "alias": "retailer_data_store_full", "checksum": {"name": "sha256", "checksum": "6f498f22e8315f37a10ec879a48da495bd4a81bd65f5cb19a5ff65432065ecf0"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl"], ["is_percentile"], ["fvh_percentile"], ["avbl_is_percentile"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl", "model.sdna_project.is_percentile", "model.sdna_project.fvh_percentile", "model.sdna_project.avbl_is_percentile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_dim": {"raw_sql": "SELECT\n\tretailer_key,\n\tretailer_name,\n\tcurr_prior_flag,\n\tkey_kpi_nm,\n\tCONCAT('geo_', key_kpi_nm) AS geo_kpi_nm,\n\t'is_iri_adj_albertsons' AS is_iri_adj_kpi_nm,\n\t'is_iri_adj_albertsons_decile' AS is_iri_adj_decile_kpi_nm,\n\t'is_avbl_adj_albertsons' AS is_avbl_adj_kpi_nm,\n\t'is_avbl_adj_albertsons_decile' AS is_avbl_adj_decile_kpi_nm\nFROM {{ ref('mvh_retailer_dim_temp2') }}\nWHERE retailer_key in (3)\n\nUNION ALL\n\nSELECT retailer_key,\n       retailer_name,\n       curr_prior_flag,\n       key_kpi_nm,\n       CONCAT('geo_' ,key_kpi_nm) AS geo_kpi_nm,\n       CONCAT('is_iri_adj_', key_kpi_nm) AS is_iri_adj_kpi_nm,\n       CONCAT('is_iri_adj_', key_kpi_nm, '_decile') AS is_iri_adj_decile_kpi_nm,\n       CONCAT('is_avbl_adj_', key_kpi_nm) AS is_avbl_adj_kpi_nm,\n       CONCAT('is_avbl_adj_', key_kpi_nm, '_decile') AS is_avbl_adj_decile_kpi_nm\nFROM {{ ref('mvh_retailer_dim_temp2') }}\nWHERE retailer_key not in (3)", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "shopperstore", "mvh_retailer_dim"], "unique_id": "model.sdna_project.mvh_retailer_dim", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/shopperstore/mvh_retailer_dim.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/shopperstore/mvh_retailer_dim.sql", "name": "mvh_retailer_dim", "resource_type": "model", "alias": "mvh_retailer_dim", "checksum": {"name": "sha256", "checksum": "757683067855712f9bb7d1421bd53dc765a5c9566f43c662e917a04ea916d47c"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_retailer_dim_temp2"], ["mvh_retailer_dim_temp2"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_retailer_dim_temp2", "model.sdna_project.mvh_retailer_dim_temp2"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_fact": {"raw_sql": "SELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n1 as retailer_key, '7-ELEVEN' as retailer, geo_7_eleven as geo_proximity, is_7_eleven_cap as is_cap, is_7_eleven_decile as is_decile, is_avbl_adj_7_eleven as is_avbl_cap, is_avbl_adj_7_eleven_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n2 as retailer_key, 'AHOLD/DELHAIZE' as retailer, geo_ahold_delhaize as geo_proximity, is_ahold_delhaize_cap as is_cap, is_ahold_delhaize_decile as is_decile, is_avbl_adj_ahold_delhaize as is_avbl_cap , is_avbl_adj_ahold_delhaize_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n3 as retailer_key, 'ALBERTSONS/SAFEWAY' as retailer, geo_albertsons_safeway as geo_proximity, is_albertsons_cap as is_cap, is_albertsons_decile as is_decile, is_avbl_adj_albertsons as is_avbl_cap , is_avbl_adj_albertsons_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n4 as retailer_key, 'ALDI' as retailer, geo_aldi  as geo_proximity, is_aldi_cap as is_cap, is_aldi_decile as is_decile, is_avbl_adj_aldi as is_avbl_cap , is_avbl_adj_aldi_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n5 as retailer_key, 'ALL OTHER AO' as retailer, geo_all_other_ao  as geo_proximity, 0  as is_cap, 0 as is_decile, 0 as is_avbl_cap , 0 as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n6 as retailer_key, 'ALL OTHER C&G' as retailer, geo_all_other_c_and_g  as geo_proximity, is_all_other_c_and_g_cap  as is_cap, is_all_other_c_and_g_decile as is_decile, is_avbl_adj_all_other_c_and_g as is_avbl_cap , is_avbl_adj_all_other_c_and_g_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n7 as retailer_key, 'ALL OTHER CLUB' as retailer, geo_all_other_club  as geo_proximity, is_all_other_club_cap  as is_cap, is_all_other_club_decile as is_decile, is_avbl_adj_all_other_club as is_avbl_cap , is_avbl_adj_all_other_club_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n8 as retailer_key, 'ALL OTHER DOLLAR' as retailer, geo_all_other_dollar  as geo_proximity, is_all_other_dollar_cap  as is_cap, is_all_other_dollar_decile as is_decile, is_avbl_adj_all_other_dollar as is_avbl_cap , is_avbl_adj_all_other_dollar_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n9 as retailer_key, 'ALL OTHER DRUG' as retailer, geo_all_other_drug  as geo_proximity, is_all_other_drug_cap  as is_cap, is_all_other_drug_decile as is_decile, is_avbl_adj_all_other_drug as is_avbl_cap , is_avbl_adj_all_other_drug_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n10 as retailer_key, 'ALL OTHER GROCERY' as retailer, geo_all_other_grocery  as geo_proximity, is_all_other_grocery_cap  as is_cap, is_all_other_grocery_decile as is_decile, is_avbl_adj_all_other_grocery as is_avbl_cap , is_avbl_adj_all_other_grocery_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n11 as retailer_key, 'ALL OTHER KROGER' as retailer, geo_all_other_kroger  as geo_proximity, is_all_other_kroger_cap  as is_cap, is_all_other_kroger_decile as is_decile, is_avbl_adj_all_other_kroger as is_avbl_cap , is_avbl_adj_all_other_kroger_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n12 as retailer_key, 'ALL OTHER MASS' as retailer, geo_all_other_mass  as geo_proximity, is_all_other_mass_cap  as is_cap, is_all_other_mass_decile as is_decile, is_avbl_adj_all_other_mass as is_avbl_cap , is_avbl_adj_all_other_mass_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n13 as retailer_key, 'ALL OTHER WALMART' as retailer, geo_all_other_walmart  as geo_proximity, is_all_other_walmart_cap  as is_cap, is_all_other_walmart_decile as is_decile, is_avbl_adj_all_other_walmart as is_avbl_cap , is_avbl_adj_all_other_walmart_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n14 as retailer_key, 'BI-LO' as retailer, geo_bi_lo  as geo_proximity, is_bi_lo_cap  as is_cap, is_bi_lo_decile as is_decile, is_avbl_adj_bi_lo as is_avbl_cap , is_avbl_adj_bi_lo_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n15 as retailer_key, 'BJS' as retailer, geo_bjs  as geo_proximity, is_bjs_cap  as is_cap, is_bjs_decile as is_decile, is_avbl_adj_bjs as is_avbl_cap , is_avbl_adj_bjs_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n16 as retailer_key, 'CIRCLE K' as retailer, geo_circle_k  as geo_proximity, is_circle_k_cap  as is_cap, is_circle_k_decile as is_decile, is_avbl_adj_circle_k as is_avbl_cap , is_avbl_adj_circle_k_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n17 as retailer_key, 'COSTCO' as retailer, geo_costco  as geo_proximity, is_costco_cap  as is_cap, is_costco_decile as is_decile, is_avbl_adj_costco as is_avbl_cap , is_avbl_adj_costco_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n18 as retailer_key, 'CVS' as retailer, geo_cvs  as geo_proximity, is_cvs_cap  as is_cap, is_cvs_decile as is_decile, is_avbl_adj_cvs as is_avbl_cap , is_avbl_adj_cvs_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n19 as retailer_key, 'DOLLAR GENERAL' as retailer, geo_dollar_general  as geo_proximity, is_dollar_general_cap  as is_cap, is_dollar_general_decile as is_decile, is_avbl_adj_dollar_general as is_avbl_cap , is_avbl_adj_dollar_general_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n20 as retailer_key, 'FAMILY DOLLAR' as retailer, geo_family_dollar  as geo_proximity, is_family_dollar_cap  as is_cap, is_family_dollar_decile as is_decile, is_avbl_adj_family_dollar as is_avbl_cap , is_avbl_adj_family_dollar_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n21 as retailer_key, 'HEB' as retailer, geo_heb  as geo_proximity, is_heb_cap  as is_cap, is_heb_decile as is_decile, is_avbl_adj_heb as is_avbl_cap , is_avbl_adj_heb_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n22 as retailer_key, 'HY-VEE' as retailer, geo_hy_vee  as geo_proximity, is_hy_vee_cap  as is_cap, is_hy_vee_decile as is_decile, is_avbl_adj_hy_vee as is_avbl_cap , is_avbl_adj_hy_vee_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n23 as retailer_key, 'KROGER BANNER' as retailer, geo_kroger_banner  as geo_proximity, is_kroger_banner_cap  as is_cap, is_kroger_banner_decile as is_decile, is_avbl_adj_kroger_banner as is_avbl_cap , is_avbl_adj_kroger_banner_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n24 as retailer_key, 'NEIGHBORHOOD MARKET' as retailer, geo_wm_neighborhood_market  as geo_proximity, is_wm_neighborhood_market_cap  as is_cap, is_wm_neighborhood_market_decile as is_decile, is_avbl_adj_wm_neighborhood_market as is_avbl_cap , is_avbl_adj_wm_neighborhood_market_decile as is_avbl_decile  FROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n25 as retailer_key, 'NOT ASSIGNED' as retailer, geo_not_assigned  as geo_proximity,  0  as is_cap,  0 as is_decile, 0 as is_avbl_cap , 0 as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n26 as retailer_key, 'PUBLIX' as retailer, geo_publix  as geo_proximity, is_publix_cap as is_cap, is_publix_decile as is_decile, is_avbl_adj_publix as is_avbl_cap , is_avbl_adj_publix_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n27 as retailer_key, 'SAMS CLUB' as retailer, geo_sams_club  as geo_proximity, is_sams_club_cap as is_cap, is_sams_club_decile as is_decile, is_avbl_adj_sams_club as is_avbl_cap , is_avbl_adj_sams_club_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n28 as retailer_key, 'SPEEDWAY' as retailer, geo_speedway  as geo_proximity, is_speedway_cap as is_cap, is_speedway_decile as is_decile, is_avbl_adj_speedway as is_avbl_cap , is_avbl_adj_speedway_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n29 as retailer_key, 'TARGET' as retailer, geo_target as geo_proximity, is_target_cap as is_cap, is_target_decile as is_decile, is_avbl_adj_target as is_avbl_cap , is_avbl_adj_target_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n30 as retailer_key, 'TRADER JOES' as retailer, geo_trader_joes  as geo_proximity, is_trader_joes_cap  as is_cap, is_trader_joes_decile as is_decile, is_avbl_adj_trader_joes as is_avbl_cap , is_avbl_adj_trader_joes_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n31 as retailer_key, 'WAKEFERN' as retailer, geo_wakefern as geo_proximity, is_wakefern_cap  as is_cap, is_wakefern_decile as is_decile, is_avbl_adj_wakefern as is_avbl_cap , is_avbl_adj_wakefern_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n32 as retailer_key, 'WALGREENS' as retailer, geo_walgreens as geo_proximity, is_walgreens_cap  as is_cap, is_walgreens_decile as is_decile, is_avbl_adj_walgreens as is_avbl_cap , is_avbl_adj_walgreens_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n33 as retailer_key, 'WHOLE FOODS' as retailer, geo_whole_foods as geo_proximity, is_whole_foods_cap as is_cap, is_whole_foods_decile as is_decile, is_avbl_adj_whole_foods as is_avbl_cap , is_avbl_adj_whole_foods_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n34 as retailer_key, 'WALMART.COM' as retailer, geo_walmart_com as geo_proximity, is_walmart_com_cap as is_cap, is_walmart_com_decile as is_decile, is_avbl_adj_walmart_com as is_avbl_cap , is_avbl_adj_walmart_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n35 as retailer_key, 'AMAZON.COM' as retailer, geo_amazon_com as geo_proximity, is_amazon_com_cap as is_cap, is_amazon_com_decile as is_decile, is_avbl_adj_amazon_com as is_avbl_cap , is_avbl_adj_amazon_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n36 as retailer_key, 'TARGET.COM' as retailer, 0 as geo_proximity, is_target_com_cap as is_cap, is_target_com_decile as is_decile, is_avbl_adj_target_com as is_avbl_cap , is_avbl_adj_target_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n37 as retailer_key, 'KROGER.COM' as retailer, 0 as geo_proximity, is_kroger_com_cap as is_cap, is_kroger_com_decile as is_decile, is_avbl_adj_kroger_com as is_avbl_cap , is_avbl_adj_kroger_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n38 as retailer_key, 'KMART.COM' as retailer, 0 as geo_proximity, is_kmart_com_cap as is_cap, is_kmart_com_decile as is_decile, is_avbl_adj_kmart_com as is_avbl_cap , is_avbl_adj_kmart_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n39 as retailer_key, 'WALGREENS.COM' as retailer, 0 as geo_proximity, is_walgreens_com_cap as is_cap, is_walgreens_com_decile as is_decile, is_avbl_adj_walgreens_com as is_avbl_cap , is_avbl_adj_walgreens_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n40 as retailer_key, 'SAMSCLUB.COM' as retailer, 0 as geo_proximity, is_samsclub_com_cap as is_cap, is_samsclub_com_decile as is_decile, is_avbl_adj_samsclub_com as is_avbl_cap , is_avbl_adj_samsclub_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}\n\nUNION ALL\nSELECT cv_living_unit_id, cv_city_name, cv_zipcode_5, cv_zipcode_9, cv_latitude, cv_longitude,\n41 as retailer_key, 'COSTCO.COM' as retailer, 0 as geo_proximity, is_costco_com_cap  as is_cap, is_costco_com_decile as is_decile, is_avbl_adj_costco_com as is_avbl_cap , is_avbl_adj_costco_com_decile as is_avbl_decile\nFROM {{ ref('retailer_data_store_full') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "shopperstore", "mvh_retailer_fact"], "unique_id": "model.sdna_project.mvh_retailer_fact", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/shopperstore/mvh_retailer_fact.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/shopperstore/mvh_retailer_fact.sql", "name": "mvh_retailer_fact", "resource_type": "model", "alias": "mvh_retailer_fact", "checksum": {"name": "sha256", "checksum": "8dc77f1793bf4094ee44d1e708f8949db171d8276f2d837f858a4a1e379127d3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"], ["retailer_data_store_full"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.retailer_sp_hh_all_store": {"raw_sql": "SELECT\n    a.cv_living_unit_id,\n    a.cv_city_name,\n    a.cv_zipcode_5,\n    a.cv_zipcode_9,\n    a.usps_zip9,\n    a.cv_latitude,\n    a.cv_longitude,\n\n    a.hh_size,\n    a.hoh_age,\n    a.hoh_lifestage,\n    a.hoh_ethnicity,\n    a.hoh_hispanic,\n    a.hh_income,\n    a.hh_presence_of_child,\n    a.hh_presence_of_gender,\n    a.hh_urban_suburban_rural,\n\n    a.dx_id ,\n    a.retailer ,\n    a.store_name ,\n    --a.store_nbr ,\n    --a.pbc_cis_id ,\n    --a.flna_cis_id ,\n    a.city ,\n    a.county,\n    a.state ,\n    a.store_zip ,\n    a.latitude ,\n    a.longitude ,\n    a.drive_minutes ,\n    a.drive_miles,\n    b.is_cap,\n    b.is_decile,\n    b.is_avbl_cap,\n    b.is_avbl_decile,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('retailer_sp_msa_drivetime') }} a,\n     {{ ref('mvh_retailer_fact') }} b\nWHERE a.cv_living_unit_id = b.cv_living_unit_id AND a.retailer = b.retailer", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "shopperstore", "retailer_sp_hh_all_store"], "unique_id": "model.sdna_project.retailer_sp_hh_all_store", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/shopperstore/retailer_sp_hh_all_store.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/shopperstore/retailer_sp_hh_all_store.sql", "name": "retailer_sp_hh_all_store", "resource_type": "model", "alias": "retailer_sp_hh_all_store", "checksum": {"name": "sha256", "checksum": "952d5a1d2c595dae4d11dd24bf0671480870a681303ab9af8b62ff89c2751c00"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["retailer_sp_msa_drivetime"], ["mvh_retailer_fact"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.retailer_sp_msa_drivetime", "model.sdna_project.mvh_retailer_fact"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.retailer_sp_msa_drivetime": {"raw_sql": "SELECT\n    a.cv_living_unit_id,\n    a.cv_city_name,\n    a.cv_zipcode_5,\n    a.cv_zipcode_9,\n    a.usps_zip9,\n    a.cv_latitude,\n    a.cv_longitude,\n\n    a.hh_size,\n    a.hoh_age,\n    a.hoh_lifestage,\n    a.hoh_ethnicity,\n    a.hoh_hispanic,\n    a.hh_income,\n    a.hh_presence_of_child,\n    a.hh_presence_of_gender,\n    a.hh_urban_suburban_rural,\n\n    b.dx_id,\n    b.msa_id_look_alike,\n    UPPER(b.retailer) AS retailer,\n    b.store_name,\n    --b.store_nbr,\n    --b.pbc_cis_id,\n    --b.flna_cis_id,\n    b.city,\n    b.county,\n    b.state,\n    b.store_zip,\n    b.latitude,\n    b.longitude,\n    a.drive_minutes,\n    a.drive_miles\nFROM {{ ref('retailer_sp_zip9_drivetime') }} a,\n     {{ ref('geo_retailer_stg') }} b\nWHERE a.dx_id = b.msa_id_look_alike", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "shopperstore", "retailer_sp_msa_drivetime"], "unique_id": "model.sdna_project.retailer_sp_msa_drivetime", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/shopperstore/retailer_sp_msa_drivetime.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/shopperstore/retailer_sp_msa_drivetime.sql", "name": "retailer_sp_msa_drivetime", "resource_type": "model", "alias": "retailer_sp_msa_drivetime", "checksum": {"name": "sha256", "checksum": "88b13177ef64281efd4931cf2c20332af7edff39c51c0b82d2211b5c9690bc42"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["retailer_sp_zip9_drivetime"], ["geo_retailer_stg"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.retailer_sp_zip9_drivetime", "model.sdna_project.geo_retailer_stg"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.retailer_sp_zip9_drivetime": {"raw_sql": "WITH drive_time_fl AS (\n\tSELECT\n\txref.dx_id,\n\tgsczip.drive_minutes,\n\tgsczip.drive_miles,\n\tgsczip.usps_zip9\n\tFROM {{ ref('dx_msa_xref') }} xref\n\tINNER JOIN {{ ref('gsc_msa_z9_drivetime') }} gsczip\n\tON xref.fl_msa_id=gsczip.msa_id\n),\n\ndrive_time_pbc AS (\n\tSELECT\n\txref.dx_id,\n\tgsczip.drive_minutes,\n\tgsczip.drive_miles,\n\tgsczip.usps_zip9\n\tFROM {{ ref('dx_msa_xref') }} xref\n\tINNER JOIN {{ ref('gsc_msa_z9_drivetime') }} gsczip\n\tON xref.pbc_msa_id=gsczip.msa_id\n),\n\ndrive_time_all AS (\n\tSELECT *\n    FROM drive_time_fl\n\n\tUNION\n\n\tSELECT *\n    FROM drive_time_pbc\n)\n\nSELECT\n    mvhstor.cv_living_unit_id as cv_living_unit_id,\n    mvhstor.cv_city_name as cv_city_name,\n    mvhstor.cv_zipcode_5 as cv_zipcode_5,\n    mvhstor.cv_zipcode_9 as cv_zipcode_9,\n\n    drive_time_all.usps_zip9 as usps_zip9,\n\n    mvhstor.cv_latitude as cv_latitude,\n    mvhstor.cv_longitude as cv_longitude,\n    mvhstor.hh_size,\n    mvhstor.hoh_age,\n    mvhstor.hoh_lifestage,\n    mvhstor.hoh_ethnicity,\n    mvhstor.hoh_hispanic,\n    mvhstor.hh_income,\n    mvhstor.hh_presence_of_child,\n    mvhstor.hh_presence_of_gender,\n    mvhstor.hh_urban_suburban_rural,\n\n    drive_time_all.dx_id as dx_id,\n    drive_time_all.drive_minutes as drive_minutes,\n    drive_time_all.drive_miles as drive_miles\nFROM {{ ref('retailer_data_store_full') }} mvhstor\nLEFT OUTER JOIN drive_time_all ON mvhstor.cv_zipcode_9=drive_time_all.usps_zip9", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "shopperstore", "retailer_sp_zip9_drivetime"], "unique_id": "model.sdna_project.retailer_sp_zip9_drivetime", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/shopperstore/retailer_sp_zip9_drivetime.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/shopperstore/retailer_sp_zip9_drivetime.sql", "name": "retailer_sp_zip9_drivetime", "resource_type": "model", "alias": "retailer_sp_zip9_drivetime", "checksum": {"name": "sha256", "checksum": "b3a0ed49d8430674b39703e251243bfb8a4205cddd5f8b05d71482703794266c"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_msa_xref"], ["gsc_msa_z9_drivetime"], ["dx_msa_xref"], ["gsc_msa_z9_drivetime"], ["retailer_data_store_full"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_msa_xref", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.dx_msa_xref", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.retailer_data_store_full"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.avbl_is_percentile": {"raw_sql": "{#- Combination of avbl_is_percentile[1-5].hql.\n    Each new row in the columns list is the\n    row of columns from each corresponding\n    avbl_is_percentile[1-5] query. Creates\n    one new CTE table per column to filter out 0s -#}\n\n\n{%- set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{%- set columns = [\n    'is_avbl_adj_7_eleven', 'is_avbl_adj_ahold_delhaize', 'is_avbl_adj_albertsons', 'is_avbl_adj_aldi', 'is_avbl_adj_amazon_com', 'is_avbl_adj_bi_lo', 'is_avbl_adj_bjs', 'is_avbl_adj_circle_k',\n    'is_avbl_adj_costco', 'is_avbl_adj_cvs', 'is_avbl_adj_dollar_general', 'is_avbl_adj_family_dollar', 'is_avbl_adj_heb', 'is_avbl_adj_speedway', 'is_avbl_adj_hy_vee', 'is_avbl_adj_kroger_banner', 'is_avbl_adj_all_other_kroger',\n    'is_avbl_adj_all_other_club', 'is_avbl_adj_all_other_dollar', 'is_avbl_adj_all_other_drug', 'is_avbl_adj_all_other_c_and_g', 'is_avbl_adj_all_other_grocery', 'is_avbl_adj_all_other_mass', 'is_avbl_adj_publix', 'is_avbl_adj_safeway', 'is_avbl_adj_sams_club',\n    'is_avbl_adj_target', 'is_avbl_adj_trader_joes', 'is_avbl_adj_wakefern', 'is_avbl_adj_walgreens', 'is_avbl_adj_walmart_com', 'is_avbl_adj_wm_neighborhood_market', 'is_avbl_adj_all_other_walmart', 'is_avbl_adj_whole_foods',\n    'is_avbl_adj_target_com', 'is_avbl_adj_kroger_com', 'is_avbl_adj_kmart_com', 'is_avbl_adj_walgreens_com', 'is_avbl_adj_samsclub_com', 'is_avbl_adj_costco_com'\n] %}\n{%- set default_columns = ['is_avbl_adj_safeway'] %}\n\n\n{% for column in columns %}\n{{ 'WITH' if loop.first }} T{{ loop.index }} AS (\n    SELECT\n    {%- for percentile in percentiles %}\n    {%- if column in default_columns %}\n      0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- else %}\n      APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n    {%- endif %}\n    {%- endfor %}\n    {%- if column not in default_columns %}\n    FROM {{ ref('trifecta_is_cap_iri_adjf_avbl_tmp') }}\n    WHERE {{ column }} <> 0 {% endif %}\n){{ ',' if not loop.last }}\n{% endfor %}\n\n\nSELECT\n{%- for column in columns %}\n  T{{ loop.index }}.*{{ ',' if not loop.last }}\n{%- endfor %}\nFROM\n{%- for column in columns %}\n  T{{ loop.index }}{{ ',' if not loop.last }}\n{%- endfor %}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "trifecta", "avbl_is_percentile"], "unique_id": "model.sdna_project.avbl_is_percentile", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/trifecta/avbl_is_percentile.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/trifecta/avbl_is_percentile.sql", "name": "avbl_is_percentile", "resource_type": "model", "alias": "avbl_is_percentile", "checksum": {"name": "sha256", "checksum": "79d60e1b31f3026af5c25b6d860f24015d6f34f10dae46c77a98cc411c7d777d"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"], ["trifecta_is_cap_iri_adjf_avbl_tmp"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fvh_percentile": {"raw_sql": "{% set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n\nSELECT\nMAX(fv_future_spend) AS fvh_fut_spend_max,\nAVG(fv_future_spend) AS fvh_fut_spend_avg,\n{%- for percentile in percentiles %}\nAPPROX_PERCENTILE(fv_future_spend, {{ percentile }}) AS fvh_fut_spend_{{ percentile|replace('.', '') }},\n{%- endfor %}\nMAX(fv_growth_rate)  AS fvh_growth_rate_max,\nAVG(fv_growth_rate)  fvh_growth_rate_avg,\n{%- for percentile in percentiles %}\nAPPROX_PERCENTILE(fv_growth_rate, {{ percentile }}) AS fvh_growth_rate_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endfor %}\nFROM {{ ref('fvh_cs_fs') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "trifecta", "fvh_percentile"], "unique_id": "model.sdna_project.fvh_percentile", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/trifecta/fvh_percentile.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/trifecta/fvh_percentile.sql", "name": "fvh_percentile", "resource_type": "model", "alias": "fvh_percentile", "checksum": {"name": "sha256", "checksum": "d10613a208f58c56d826f2c4d0557c80216985e8e08c52d673865f1684a0b954"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fvh_cs_fs"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fvh_cs_fs"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.is_percentile": {"raw_sql": "{#- Combination of is_percentile_[1-7].hql\n   Each new row in the columns list is the\n   row of columns from each corresponding\n   is_percentile[1-7] query -#}\n\n{%- set percentiles = ['.10', '.20', '.30', '.40', '.50', '.60', '.70', '.80', '.90', '.95', '.99'] %}\n{%- set columns = [\n    'is_7_eleven', 'is_ahold_delhaize', 'is_albertsons', 'is_aldi', 'is_amazon_com',\n    'is_bi_lo', 'is_bjs', 'is_circle_k', 'is_costco', 'is_cvs',\n    'is_dollar_general', 'is_family_dollar', 'is_heb', 'is_speedway', 'is_hy_vee',\n    'is_kroger_banner', 'is_all_other_kroger', 'is_all_other_club', 'is_all_other_dollar', 'is_all_other_drug',\n    'is_all_other_c_and_g', 'is_all_other_grocery', 'is_all_other_mass', 'is_publix', 'is_safeway',\n    'is_sams_club', 'is_target', 'is_trader_joes', 'is_wakefern', 'is_walgreens',\n    'is_walmart_com', 'is_wm_neighborhood_market', 'is_all_other_walmart', 'is_whole_foods',\n    'is_target_com', 'is_kroger_com', 'is_kmart_com', 'is_walgreens_com', 'is_samsclub_com', 'is_costco_com'\n] -%}\n{%- set default_columns = ['is_safeway'] %}\n\n\nSELECT\n{%- for column in columns %}\n{%- for percentile in percentiles %}\n{%- if column in default_columns %}\n --- Set safeway percentiles to 0 default\n 0.0 AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n {%- else %}\n APPROX_PERCENTILE({{ column }}, {{ percentile }}) AS {{ column }}_{{ percentile|replace('.', '') }}{{ ',' if not loop.last }}\n{%- endif %}\n{%- endfor %}{{ ',' if not loop.last }}\n{% endfor %}\nFROM {{ ref('exp_geo_is') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "trifecta", "is_percentile"], "unique_id": "model.sdna_project.is_percentile", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/trifecta/is_percentile.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/trifecta/is_percentile.sql", "name": "is_percentile", "resource_type": "model", "alias": "is_percentile", "checksum": {"name": "sha256", "checksum": "9f3bdd959e0b9a664c7e00f4ff55030a6046908c88f46c2fa039afb1ff0b0dc2"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.trifecta_is_cap": {"raw_sql": "SELECT\n    fullmvh.cv_living_unit_id,\n    fullmvh.cv_address_id,\n    fullmvh.cv_short_city_name,\n    fullmvh.cv_city_name,\n    fullmvh.cv_county_name,\n    fullmvh.cv_state_abb,\n    fullmvh.cv_zipcode_5,\n    fullmvh.cv_zipcode_4,\n    fullmvh.cv_zipcode_9,\n    fullmvh.cv_zip_locality,\n    fullmvh.cv_delvy_pt_bar_cd,\n    fullmvh.cv_carr_route,\n    fullmvh.cv_state_cd,\n    fullmvh.cv_county_cd,\n    fullmvh.cv_cen2010_tract_block_grp,\n    fullmvh.cv_cen2010_blockid,\n    fullmvh.cv_latitude,\n    fullmvh.cv_longitude,\n    fullmvh.cv_mat_level_geodata,\n    fullmvh.cv_addr_qlty_ind,\n    fullmvh.cv_recp_reliable_cd,\n    fullmvh.cv_acty_dt,\n    fullmvh.cv_tme_zn,\n    fullmvh.cv_p1_pid,\n    fullmvh.cv_p1_ptyp,\n    fullmvh.cv_p1_etnc_etnc,\n    fullmvh.cv_p1_etnc_exp_grp,\n    fullmvh.cv_p1_etnc_religion,\n    fullmvh.cv_p1_etnc_lang_pref,\n    fullmvh.cv_p1_etnc_grp,\n    fullmvh.cv_p1_etnc_country_of_origin,\n    fullmvh.cv_p1_gender,\n    fullmvh.cv_p1_birth_dt,\n    fullmvh.cv_p1_est_age,\n    fullmvh.cv_p1_exact_age,\n    fullmvh.cv_p1_com_age,\n    fullmvh.cv_p1_edu_mdl,\n    fullmvh.cv_p1_marital_st,\n    fullmvh.cv_p1_occ_grp,\n    fullmvh.cv_p1_occ_cd,\n    fullmvh.cv_p1_bus_own,\n    fullmvh.cv_p2_pid,\n    fullmvh.cv_p2_ptyp,\n    fullmvh.cv_p2_etnc_etnc,\n    fullmvh.cv_p2_etnc_exp_grp,\n    fullmvh.cv_p2_etnc_religion,\n    fullmvh.cv_p2_etnc_lang_pref,\n    fullmvh.cv_p2_etnc_grp,\n    fullmvh.cv_p2_etnc_country_of_origin,\n    fullmvh.cv_p2_gender,\n    fullmvh.cv_p2_birth_dt,\n    fullmvh.cv_p2_est_age,\n    fullmvh.cv_p2_exact_age,\n    fullmvh.cv_p2_com_age,\n    fullmvh.cv_p2_edu_mdl,\n    fullmvh.cv_p2_marital_st,\n    fullmvh.cv_p2_occ_grp,\n    fullmvh.cv_p2_occ_cd,\n    fullmvh.cv_p2_bus_own,\n    fullmvh.cv_p3_pid,\n    fullmvh.cv_p3_ptyp,\n    fullmvh.cv_p3_etnc_etnc,\n    fullmvh.cv_p3_etnc_exp_grp,\n    fullmvh.cv_p3_etnc_religion,\n    fullmvh.cv_p3_etnc_lang_pref,\n    fullmvh.cv_p3_etnc_grp,\n    fullmvh.cv_p3_etnc_country_of_origin,\n    fullmvh.cv_p3_gender,\n    fullmvh.cv_p3_birth_dt,\n    fullmvh.cv_p3_est_age,\n    fullmvh.cv_p3_exact_age,\n    fullmvh.cv_p3_com_age,\n    fullmvh.cv_p3_edu_mdl,\n    fullmvh.cv_p3_marital_st,\n    fullmvh.cv_p3_occ_grp,\n    fullmvh.cv_p3_occ_cd,\n    fullmvh.cv_p3_bus_own,\n    fullmvh.cv_p4_pid,\n    fullmvh.cv_p4_ptyp,\n    fullmvh.cv_p4_etnc_etnc,\n    fullmvh.cv_p4_etnc_exp_grp,\n    fullmvh.cv_p4_etnc_religion,\n    fullmvh.cv_p4_etnc_lang_pref,\n    fullmvh.cv_p4_etnc_grp,\n    fullmvh.cv_p4_etnc_country_of_origin,\n    fullmvh.cv_p4_gender,\n    fullmvh.cv_p4_birth_dt,\n    fullmvh.cv_p4_est_age,\n    fullmvh.cv_p4_exact_age,\n    fullmvh.cv_p4_com_age,\n    fullmvh.cv_p4_edu_mdl,\n    fullmvh.cv_p4_marital_st,\n    fullmvh.cv_p4_occ_grp,\n    fullmvh.cv_p4_occ_cd,\n    fullmvh.cv_p4_bus_own,\n    fullmvh.cv_p5_pid,\n    fullmvh.cv_p5_ptyp,\n    fullmvh.cv_p5_etnc_etnc,\n    fullmvh.cv_p5_etnc_exp_grp,\n    fullmvh.cv_p5_etnc_religion,\n    fullmvh.cv_p5_etnc_lang_pref,\n    fullmvh.cv_p5_etnc_grp,\n    fullmvh.cv_p5_etnc_country_of_origin,\n    fullmvh.cv_p5_gender,\n    fullmvh.cv_p5_birth_dt,\n    fullmvh.cv_p5_est_age,\n    fullmvh.cv_p5_exact_age,\n    fullmvh.cv_p5_com_age,\n    fullmvh.cv_p5_edu_mdl,\n    fullmvh.cv_p5_marital_st,\n    fullmvh.cv_p5_occ_grp,\n    fullmvh.cv_p5_occ_cd,\n    fullmvh.cv_p5_bus_own,\n    fullmvh.cv_p6_pid,\n    fullmvh.cv_p6_ptyp,\n    fullmvh.cv_p6_etnc_etnc,\n    fullmvh.cv_p6_etnc_exp_grp,\n    fullmvh.cv_p6_etnc_religion,\n    fullmvh.cv_p6_etnc_lang_pref,\n    fullmvh.cv_p6_etnc_grp,\n    fullmvh.cv_p6_etnc_country_of_origin,\n    fullmvh.cv_p6_gender,\n    fullmvh.cv_p6_birth_dt,\n    fullmvh.cv_p6_est_age,\n    fullmvh.cv_p6_exact_age,\n    fullmvh.cv_p6_com_age,\n    fullmvh.cv_p6_edu_mdl,\n    fullmvh.cv_p6_marital_st,\n    fullmvh.cv_p6_occ_grp,\n    fullmvh.cv_p6_occ_cd,\n    fullmvh.cv_p6_bus_own,\n    fullmvh.cv_mor,\n    fullmvh.cv_mor_bank_book,\n    fullmvh.cv_mor_bank_spl_food,\n    fullmvh.cv_mor_bank_craft_merch,\n    fullmvh.cv_mor_bank_culinary_int,\n    fullmvh.cv_mor_bank_dedupe_hit,\n    fullmvh.cv_mor_bank_doit_yourself,\n    fullmvh.cv_mor_bank_famgen_mag,\n    fullmvh.cv_mor_bank_f_merch,\n    fullmvh.cv_mor_bank_f_orient_mag,\n    fullmvh.cv_mor_bank_gar_farm_buy,\n    fullmvh.cv_mor_bank_gar_farm_mag,\n    fullmvh.cv_mor_bank_gen_contrib,\n    fullmvh.cv_mor_bank_gen_merch,\n    fullmvh.cv_mor_bank_gift_gadgs,\n    fullmvh.cv_mor_bank_health_inst_contib,\n    fullmvh.cv_mor_bank_health_fit_mag,\n    fullmvh.cv_mor_bank_m_merch,\n    fullmvh.cv_mor_bank_m_sports_mag,\n    fullmvh.cv_mor_bank_misc,\n    fullmvh.cv_mor_bank_nondedupe_hit,\n    fullmvh.cv_mor_bank_odds_end,\n    fullmvh.cv_mor_bank_opp_seek_ce,\n    fullmvh.cv_mor_bank_photograph,\n    fullmvh.cv_mor_bank_political_cont,\n    fullmvh.cv_mor_bank_religious_cont,\n    fullmvh.cv_mor_bank_religious_mag,\n    fullmvh.cv_mor_bank_upscale_merch,\n    fullmvh.cv_mor_bank_news_finan,\n    fullmvh.cv_ncoa_cd,\n    fullmvh.cv_ncoa_dt,\n    fullmvh.cv_green_aware,\n    fullmvh.cv_green_aware_deciles,\n    fullmvh.cv_no_adults_unit,\n    fullmvh.cv_no_pers_unit,\n    fullmvh.cv_no_child_unit,\n    fullmvh.cv_child_age_0_3,\n    fullmvh.cv_child_age_4_6,\n    fullmvh.cv_child_age_7_9,\n    fullmvh.cv_child_age_10_12,\n    fullmvh.cv_child_age_13_15,\n    fullmvh.cv_child_age_16_18,\n    fullmvh.cv_mosaic_household,\n    fullmvh.cv_mosaic_zip4,\n    fullmvh.cv_home_bus,\n    fullmvh.cv_dwelling_type,\n    fullmvh.cv_dwelling_unit_size,\n    fullmvh.cv_length_of_residence,\n    fullmvh.cv_household_comp,\n    fullmvh.cv_hmeown_hmeown,\n    fullmvh.cv_hmeown_prob_hmeown,\n    fullmvh.cv_hmeown_comb_hmeown_renter,\n    fullmvh.cv_est_curr_hme_val,\n    fullmvh.cv_est_curr_hme_val_range,\n    fullmvh.cv_cons_vw_proft,\n    fullmvh.cv_incom_per_national,\n    fullmvh.cv_county_ehi_per,\n    fullmvh.cv_auto_in_market_new,\n    fullmvh.cv_aut_mark_used,\n    fullmvh.cv_aut_mark_used_0_5_vehicle,\n    fullmvh.cv_aut_mark_used_11_vehicle,\n    fullmvh.cv_aut_mark_used_6_10_vehicle,\n    fullmvh.cv_est_inc_amtv5,\n    fullmvh.cv_est_hh_incv5,\n    fullmvh.cv_county_echv_index,\n    fullmvh.cv_county_echv_per,\n    fullmvh.cv_state_ehi_index,\n    fullmvh.cv_county_ehi_index,\n    fullmvh.cv_cen_rur_urban_county_szcd,\n    fullmvh.cv_cbsa,\n    fullmvh.cv_cbsa_type,\n    fullmvh.cv_cape_edu_ispsa,\n    fullmvh.cv_cape_edu_ispsa_decile,\n    fullmvh.cv_cape_inc_fam_state_decile,\n    fullmvh.cv_cape_dens_per_per_pop,\n    fullmvh.cv_cape_age_pop_0_17,\n    fullmvh.cv_cape_age_pop_0_4,\n    fullmvh.cv_cape_age_pop_5_9,\n    fullmvh.cv_cape_age_pop_10_13,\n    fullmvh.cv_cape_age_pop_14_17,\n    fullmvh.cv_cape_age_pop_18_99,\n    fullmvh.cv_cape_age_pop_65_99,\n    fullmvh.cv_cape_age_pop_median_age,\n    fullmvh.cv_cape_built_median_hous_age,\n    fullmvh.cv_cape_child_couple_famw_lt18,\n    fullmvh.cv_cape_child_couple_famwo_lt18,\n    fullmvh.cv_cape_child_wper_lt18,\n    fullmvh.cv_cape_edu_pop25_med_edu_attain,\n    fullmvh.cv_cape_occ_empid_health_tech,\n    fullmvh.cv_cape_ethnic_pop_black_only,\n    fullmvh.cv_cape_ethnic_pop_asian_only,\n    fullmvh.cv_cape_ethnic_pop_hispanic,\n    fullmvh.cv_cape_ethnic_pop_white_only,\n    fullmvh.cv_cape_avg_hh_size,\n    fullmvh.cv_cape_oohu_med_hme_val,\n    fullmvh.cv_cape_hu_mob_hme,\n    fullmvh.cv_cape_med_fam_hh_inc,\n    fullmvh.cv_cape_lang_spanish_speak,\n    fullmvh.cv_cape_occhu_own_occu,\n    fullmvh.cv_cape_oochu_rent_occu,\n    fullmvh.cv_cape_marr_couple_fam,\n    fullmvh.cv_hh_int_read_bible_devo,\n    fullmvh.cv_hh_pc_use_net_service,\n    fullmvh.cv_hh_crafts,\n    fullmvh.cv_hh_finan_stks_bond,\n    fullmvh.cv_hh_finan_cds_money_mkt,\n    fullmvh.cv_hh_finan_iras_currently,\n    fullmvh.cv_hh_finan_mutual_funds,\n    fullmvh.cv_hh_finan_real_estate,\n    fullmvh.cv_act_amusement_park_visit,\n    fullmvh.cv_act_zoo_visit,\n    fullmvh.cv_act_coffee_connoisseurs,\n    fullmvh.cv_act_wine_lover,\n    fullmvh.cv_act_doit_yourself,\n    fullmvh.cv_act_hme_imp_spenders,\n    fullmvh.cv_act_hunt_enthus,\n    fullmvh.cv_act_digi_mag_buyer,\n    fullmvh.cv_act_attend_edu_pgm,\n    fullmvh.cv_act_video_gamer,\n    fullmvh.cv_act_mlb_enthus,\n    fullmvh.cv_act_nascar_enthus,\n    fullmvh.cv_act_nba_enthus,\n    fullmvh.cv_act_nfl_enthus,\n    fullmvh.cv_act_nhl_enthus,\n    fullmvh.cv_act_pga_tour_enthus,\n    fullmvh.cv_act_politics_viewing_tv_lib,\n    fullmvh.cv_act_politics_viewing_tv_libcom,\n    fullmvh.cv_act_politics_viewing_tv_conserv,\n    fullmvh.cv_act_eats_fam_restaurant,\n    fullmvh.cv_act_eats_ff_restaurant,\n    fullmvh.cv_act_canoeing_kayaking,\n    fullmvh.cv_act_play_golf,\n    fullmvh.cv_act_gourment_cooking,\n    fullmvh.cv_act_cat_owners,\n    fullmvh.cv_act_dog_owners,\n    fullmvh.cv_act_pet_enthus,\n    fullmvh.cv_act_arts_crafts,\n    fullmvh.cv_act_scrapbooking,\n    fullmvh.cv_act_cultural_arts,\n    fullmvh.cv_hobbies_gardening,\n    fullmvh.cv_act_photography,\n    fullmvh.cv_act_book_reader,\n    fullmvh.cv_act_ebook_reader,\n    fullmvh.cv_act_audiobook_reader,\n    fullmvh.cv_act_avid_runners,\n    fullmvh.cv_act_outdoor_enthus,\n    fullmvh.cv_act_fishing,\n    fullmvh.cv_act_snow_sport,\n    fullmvh.cv_act_boating,\n    fullmvh.cv_act_plays_hockey,\n    fullmvh.cv_act_plays_soccer,\n    fullmvh.cv_act_plays_tennis,\n    fullmvh.cv_act_sport_enthusiast,\n    fullmvh.cv_act_healthy_living,\n    fullmvh.cv_act_fitness_enthus,\n    fullmvh.cv_act_on_diet,\n    fullmvh.cv_act_weight_conscious,\n    fullmvh.cv_act_casino_gambling,\n    fullmvh.cv_act_sweepstakes_lottery,\n    fullmvh.cv_act_music_download,\n    fullmvh.cv_act_music_stream,\n    fullmvh.cv_act_listen_christian_music,\n    fullmvh.cv_act_listen_classical_music,\n    fullmvh.cv_act_listen_country_music,\n    fullmvh.cv_act_listen_music,\n    fullmvh.cv_act_listen_oldies_music,\n    fullmvh.cv_act_listen_rock_music,\n    fullmvh.cv_act_listen_80s_music,\n    fullmvh.cv_act_listen_hiphop_music,\n    fullmvh.cv_act_listen_alter_music,\n    fullmvh.cv_act_listen_jazz_music,\n    fullmvh.cv_act_listen_pop_music,\n    fullmvh.cv_buyer_lap_own,\n    fullmvh.cv_buyer_security_sys_own,\n    fullmvh.cv_buyer_tab_own,\n    fullmvh.cv_buyer_coupon_users,\n    fullmvh.cv_buyer_lux_store_shopp,\n    fullmvh.cv_buyer_lux_hme_goods_shopp,\n    fullmvh.cv_buyer_yng_adult_cloth_shopp,\n    fullmvh.cv_buyer_supercenter_shopp,\n    fullmvh.cv_buyer_warehouse_club_mem,\n    fullmvh.cv_buyer_loyalty_card_usr,\n    fullmvh.cv_buyer_presence_auto,\n    fullmvh.cv_buyer_nonpres_makeup_usr,\n    fullmvh.cv_buyer_pres_makeup_usr,\n    fullmvh.cv_buyer_highend_spirit_drinker,\n    fullmvh.cv_lfstyl_lf_insure_plcy_hldr,\n    fullmvh.cv_lfstyl_med_insure_plcy_hldrs,\n    fullmvh.cv_lfstyl_medicare_plcy_hldrs,\n    fullmvh.cv_lfstyl_have_grand_child,\n    fullmvh.cv_lfstyl_high_freq_business_trav,\n    fullmvh.cv_lfstyl_high_freq_cruise_enthus,\n    fullmvh.cv_lfstyl_high_freq_domes_vacationer,\n    fullmvh.cv_lfstyl_high_freq_forgn_vacationer,\n    fullmvh.cv_lfstyl_freq_fly_pgm_mem,\n    fullmvh.cv_lfstyl_hostel_guest_loyal_pgm,\n    fullmvh.cv_lfstyl_interest_religion,\n    fullmvh.cv_lfstyl_military_act,\n    fullmvh.cv_lfstyl_military_inact,\n    fullmvh.cv_donor_contrib_charities,\n    fullmvh.cv_donor_contrib_arts_charities,\n    fullmvh.cv_donor_contrib_edu_charities,\n    fullmvh.cv_donor_contrib_health_charities,\n    fullmvh.cv_donor_contrib_political_charities,\n    fullmvh.cv_donor_contrib_pvt_found,\n    fullmvh.cv_donor_contrib_volunteer,\n    fullmvh.cv_finan_debit_card_usr,\n    fullmvh.cv_finan_corp_credit_card_usr,\n    fullmvh.cv_finan_major_credit_card_usr,\n    fullmvh.cv_finan_premium_credit_card_usr,\n    fullmvh.cv_finan_credit_card_usr,\n    fullmvh.cv_finan_store_credit_card_usr,\n    fullmvh.cv_invest_retire_finan_plan,\n    fullmvh.cv_invest_part_online_trade,\n    fullmvh.cv_invest_brokerage_acct_own,\n    fullmvh.cv_invest_actv_investor,\n    fullmvh.cv_invest_mutual_fund_invest,\n    fullmvh.cv_memship_aarp_mem,\n    fullmvh.cv_memship_union_mem,\n    fullmvh.cv_tt_email,\n    -- Removed old cv_tt_* columns and added new cv_tt_* for MVH Q2 2020 refresh\n    --fullmvh.cv_tt_savvy_research,\n    --fullmvh.cv_tt_organic_natural,\n    --fullmvh.cv_tt_brand_loyal,\n    --fullmvh.cv_tt_trendsetter,\n    --fullmvh.cv_tt_deal_seeker,\n    --fullmvh.cv_tt_recreation_shopper,\n    --fullmvh.cv_tt_quality_matters,\n    --fullmvh.cv_tt_moment_shopper,\n    --fullmvh.cv_tt_mainstream_adapter,\n    --fullmvh.cv_tt_novelty_seek,\n    --fullmvh.cv_tt_conv_online_deal_vouch,\n    --fullmvh.cv_tt_conv_disc_supercenter,\n    --fullmvh.cv_tt_conv_ebid_sites,\n    --fullmvh.cv_tt_conv_etail_only,\n    --fullmvh.cv_tt_conv_mid_hi_end_store,\n    --fullmvh.cv_tt_conv_spclty_dept_store,\n    --fullmvh.cv_tt_conv_spclty_boutique,\n    --fullmvh.cv_tt_conv_wholesale,\n    --fullmvh.cv_tt_eng_broadcast_cabletv,\n    --fullmvh.cv_tt_eng_digit_display,\n    --fullmvh.cv_tt_eng_digit_newspaper,\n    --fullmvh.cv_tt_eng_digit_video,\n    --fullmvh.cv_tt_eng_direct_mail,\n    --fullmvh.cv_tt_eng_sms_mms,\n    --fullmvh.cv_tt_eng_radio,\n    --fullmvh.cv_tt_eng_stream_tv,\n    --fullmvh.cv_tt_eng_trad_newspaper,\n    fullmvh.cv_p1_retail_shopp,\n    fullmvh.cv_p2_retail_shopp,\n    fullmvh.cv_p3_retail_shopp,\n    fullmvh.cv_p4_retail_shopp,\n    fullmvh.cv_p5_retail_shopp,\n    fullmvh.cv_p6_retail_shopp,\n    fullmvh.cv_p1_health_well_being,\n    fullmvh.cv_p2_health_well_being,\n    fullmvh.cv_p3_health_well_being,\n    fullmvh.cv_p4_health_well_being,\n    fullmvh.cv_p5_health_well_being,\n    fullmvh.cv_p6_health_well_being,\n    fullmvh.cv_p1_mobile_usrs,\n    fullmvh.cv_p2_mobile_usrs,\n    fullmvh.cv_p3_mobile_usrs,\n    fullmvh.cv_p4_mobile_usrs,\n    fullmvh.cv_p5_mobile_usrs,\n    fullmvh.cv_p6_mobile_usrs,\n    fullmvh.cv_p1_tech_adoption,\n    fullmvh.cv_p2_tech_adoption,\n    fullmvh.cv_p3_tech_adoption,\n    fullmvh.cv_p4_tech_adoption,\n    fullmvh.cv_p5_tech_adoption,\n    fullmvh.cv_p6_tech_adoption,\n    fullmvh.cv_p1_mor,\n    fullmvh.cv_p2_mor,\n    fullmvh.cv_p3_mor,\n    fullmvh.cv_p4_mor,\n    fullmvh.cv_p5_mor,\n    fullmvh.cv_p6_mor,\n    fullmvh.cv_mosaic_glob_hh,\n    fullmvh.cv_mosaic_glob_zip4,\n    fullmvh.cv_child_pres_0_18,\n    fullmvh.cv_child_age_0_3_mdl,\n    fullmvh.cv_child_age_scor_0_3,\n    fullmvh.cv_child_age_4_6_mdl,\n    fullmvh.cv_child_age_scor_4_6,\n    fullmvh.cv_child_age_7_9_mdl,\n    fullmvh.cv_child_age_scor_7_9_,\n    fullmvh.cv_child_age_10_12_mdl,\n    fullmvh.cv_child_age_scor_10_12_,\n    fullmvh.cv_child_age_13_15_mdl,\n    fullmvh.cv_child_age_scor_13_15,\n    fullmvh.cv_child_age_16_18_mdl,\n    fullmvh.cv_child_age_scor_16_18_,\n    fullmvh.cv_hh_ail_meds_vis_ctnt_lenses,--populated with null value from Experian from Q4 2020\n    fullmvh.cv_bhvr_bank_cntct_lens_wearer,--populated with null value from Experian from Q4 2020\n    fullmvh.cv_bhvr_bnk_reg_pres_drug_users,--populated with null value from Experian from Q4 2020\n    fullmvh.cv_bhvr_bnk_intrst_vid_dvd,\n    fullmvh.cv_bhvr_bnk_intrst_golf,\n    fullmvh.cv_bhvr_bnk_contri_charities,\n    fullmvh.cv_bhvr_bnk_pet_enthusiast,\n    fullmvh.cv_bhvr_bnk_intrst_cultural_arts,\n    fullmvh.cv_bhvr_bnk_purchased_thu_mail,\n    fullmvh.cv_bhvr_bnk_intrst_fitness,\n    fullmvh.cv_bhvr_bnk_intrst_outdoors,\n    fullmvh.cv_bhvr_bnk_intrst_travel,\n    fullmvh.cv_bhvr_bnk_investors,\n    fullmvh.cv_bhvr_bnk_pres_of_automobile,\n    fullmvh.cv_bhvr_bnk_pres_of_credit_card,\n    fullmvh.cv_bhvr_bnk_intrst_gardening,\n    fullmvh.cv_bhvr_bnk_intrst_crafts,\n    fullmvh.cv_bhvr_bnk_collectors,\n    fullmvh.cv_bhvr_bnk_cruise_enthusiasts,\n    fullmvh.cv_bhvr_bnk_intrst_sports,\n    fullmvh.cv_bhvr_bnk_intrst_grmt_cooking,\n    fullmvh.cv_bhvr_bnk_sweepstakes_gambling,\n    fullmvh.cv_bhvr_bnk_intrst_politics,\n    fullmvh.cv_bhvr_bnk_intrst_music,\n    fullmvh.cv_bhvr_bnk_intrst_reading,\n    fullmvh.cv_bhvr_bnk_child_parenting_prod,\n    fullmvh.cv_bhvr_bnk_do_it_yourselfer,\n    fullmvh.cv_bhvr_bnk_self_improvement,\n    fullmvh.cv_bhvr_bnk_intrst_in_religion,\n    fullmvh.cv_bhvr_bnk_grandparent,\n    fullmvh.cv_bhvr_bnk_intrst_clothing,\n    fullmvh.cv_bhvr_bnk_donates_envrn_causes,\n    fullmvh.cv_bhvr_bnk_invests_mutual_funds,\n    fullmvh.cv_bhvr_bnk_wght_conscious,\n    fullmvh.cv_bhvr_bnk_mail_order_multibuyer,\n    fullmvh.cv_bhvr_bnk_dog_enthusiasts,\n    fullmvh.cv_bhvr_bnk_cat_enthusiasts,\n    fullmvh.cv_bhvr_bnk_hlthy_living,\n    fullmvh.cv_bhvr_bnk_intrst_automotive,\n    fullmvh.cv_bhvr_bnk_intrst_skiing,\n    fullmvh.cv_bhvr_bnk_intrst_boating,\n    fullmvh.cv_bhvr_bnk_pres_of_cell_phone,\n    fullmvh.cv_bhvr_bnk_commn_connectivity,\n    fullmvh.cv_bhvr_bnk_computers,\n    fullmvh.cv_bhvr_bnk_hi_tech_owner,\n    fullmvh.cv_bhvr_bnk_home_decor_furnish,\n    fullmvh.cv_bhvr_bnk_homeentmnt_video,\n    fullmvh.cv_bhvr_bnk_kitchen_aids_applns,\n    fullmvh.cv_bhvr_bnk_mo_buyer_music_video,\n    fullmvh.cv_bhvr_bnk_mob_books,\n    fullmvh.cv_bhvr_bnk_mo_buyer_cloth_shoe,\n    fullmvh.cv_bhvr_bnk_mob_ins_fin,\n    fullmvh.cv_bhvr_bnk_mail_order_buyer_gift,\n    fullmvh.cv_bhvr_bnk_mob_grdng,\n    fullmvh.cv_bhvr_bnk_mob_jewelry,\n    fullmvh.cv_bhvr_bnk_clas_opra_big_bnd_mus,\n    fullmvh.cv_bhvr_bnk_country_music,\n    fullmvh.cv_bhvr_bnk_christian_music,\n    fullmvh.cv_bhvr_bnk_rock_music,\n    fullmvh.cv_bhvr_bnk_internet_online_subs,\n    fullmvh.cv_bhvr_bnk_intrst_photo,\n    fullmvh.cv_bhvr_bnk_purchase_via_online,\n    fullmvh.cv_bhvr_bnk_intrst_affluence_ls,\n    fullmvh.cv_bhvr_bnk_domestic_traveler,\n    fullmvh.cv_bhvr_bnk_foreign_traveler,\n    fullmvh.cv_bhvr_bnk_pres_of_prem_cc,\n    fullmvh.cv_bhvr_bnk_active_military,\n    fullmvh.cv_bhvr_bnk_inactive_military,\n    fullmvh.cv_hh_acty_int_hob_photography,\n    fullmvh.cv_hh_acty_int_hobbies_gardening,\n    fullmvh.cv_hh_acty_int_hob_home_ws_diy,\n    fullmvh.cv_hh_acty_int_hob_cars_auto_rep,\n    fullmvh.cv_hh_acty_int_hob_bird_watching,\n    fullmvh.cv_hh_acty_int_hob_self_imprvmnt,\n    fullmvh.cv_hh_acty_int_music_chrstn_gosp,\n    fullmvh.cv_hh_acty_int_music_r_and_b,\n    fullmvh.cv_hh_acty_int_music_jazz_new_age,\n    fullmvh.cv_hh_acty_int_music_classical,\n    fullmvh.cv_hh_acty_int_music_rock_n_roll,\n    fullmvh.cv_hh_acty_int_music_country,\n    fullmvh.cv_hh_acty_int_music_in_gen,\n    fullmvh.cv_hh_acty_int_music_other_music,\n    fullmvh.cv_hh_acty_int_read_bs_fiction,\n    fullmvh.cv_hh_acty_int_childrens_reading,\n    fullmvh.cv_hh_acty_int_reading_computer,\n    fullmvh.cv_hh_acty_int_read_cook_culinary,\n    fullmvh.cv_hh_acty_int_reading_country_ls,\n    fullmvh.cv_hh_acty_int_read_entmnt_ppl,\n    fullmvh.cv_hh_acty_int_reading_fashion,\n    fullmvh.cv_hh_acty_int_reading_history,\n    fullmvh.cv_hh_acty_int_read_intr_decor,\n    fullmvh.cv_hh_acty_int_read_med_hlth,\n    fullmvh.cv_hh_acty_int_reading_military,\n    fullmvh.cv_hh_acty_int_reading_mystery,\n    fullmvh.cv_hh_acty_int_read_ntrl_hlth_rmd,\n    fullmvh.cv_hh_acty_int_reading_romance,\n    fullmvh.cv_hh_acty_int_read_sc_fiction,\n    fullmvh.cv_hh_acty_int_read_sc_tech,\n    fullmvh.cv_hh_acty_int_sports_read,\n    fullmvh.cv_hh_acty_int_read_wrld_news_pol,\n    fullmvh.cv_hh_acty_int_book_reader,\n    fullmvh.cv_hh_acty_int_soc_ani_wf_soc,\n    fullmvh.cv_hh_acty_int_soc_env_wildlife,\n    fullmvh.cv_hh_acty_int_soc_pol_cons,\n    fullmvh.cv_hh_acty_int_soc_pol_liberal,\n    fullmvh.cv_hh_acty_int_soc_religion,\n    fullmvh.cv_hh_acty_int_soc_child,\n    fullmvh.cv_hh_acty_int_soc_veterans,\n    fullmvh.cv_hh_acty_int_soc_hlth,\n    fullmvh.cv_hh_acty_int_soc_othr,\n    fullmvh.cv_hh_acty_int_sportsbaseball,\n    fullmvh.cv_hh_acty_int_sportsbasketball,\n    fullmvh.cv_hh_acty_int_sports_rec_hockey,\n    fullmvh.cv_hh_acty_int_sportscampng_hikng,\n    fullmvh.cv_hh_acty_int_sports_rec_hunting,\n    fullmvh.cv_hh_acty_int_sports_rec_fishing,\n    fullmvh.cv_hh_acty_int_sports_rec_nascar,\n    fullmvh.cv_hh_acty_int_sprt_fitness_exer,\n    fullmvh.cv_hh_acty_int_sportsscuba_diving,\n    fullmvh.cv_hh_acty_int_sportsfootball,\n    fullmvh.cv_hh_acty_int_sports_rec_golf,\n    fullmvh.cv_hh_acty_int_sportssnow_skng,\n    fullmvh.cv_hh_acty_int_boating_sailing,\n    fullmvh.cv_hh_acty_int_sports_rec_walking,\n    fullmvh.cv_hh_acty_int_sports_rec_cycling,\n    fullmvh.cv_hh_acty_int_sportsmotorcycles,\n    fullmvh.cv_hh_acty_int_running_jogging,\n    fullmvh.cv_hh_acty_int_sports_rec_soccer,\n    fullmvh.cv_hh_acty_int_sportsswimming,\n    fullmvh.cv_hh_acty_int_play_sprt_in_gen,\n    fullmvh.cv_hh_acty_int_sweepstakes,\n    fullmvh.cv_hh_acty_int_swpstakes_loteries,\n    fullmvh.cv_hh_acty_int_casino_gambling,\n    fullmvh.cv_hh_acty_int_travel_cruise,\n    fullmvh.cv_hh_acty_int_trvl_inter,\n    fullmvh.cv_hh_acty_int_travel_domestic,\n    fullmvh.cv_hh_acty_int_travel_time_share,\n    fullmvh.cv_hh_acty_int_trvl_rec_vehicle,\n    fullmvh.cv_hh_acty_int_rv_travel,\n    fullmvh.cv_hh_acty_int_trvl_bus_trvl,\n    fullmvh.cv_hh_acty_int_trvl_per_trvl,\n    fullmvh.cv_hh_acty_int_pc_i_own_computer,\n    fullmvh.cv_hh_acty_int_pc__i_usedsl_hispd,\n    fullmvh.cv_hh_acty_int_pc_i_plan_buy_comp,\n    fullmvh.cv_hh_acty_int_eg_cell_phone,\n    fullmvh.cv_hh_acty_int_eg_com_disc_player,\n    fullmvh.cv_hh_acty_int_eg_dvd_player,\n    fullmvh.cv_hh_acty_int_eg_satellite_dish,\n    fullmvh.cv_hh_acty_int_eg_dig_cam,\n    fullmvh.cv_hh_acty_int_eg_hdtv,\n    fullmvh.cv_hh_acty_int_eg__electronics,\n    fullmvh.cv_hh_acty_int_eg_pda_blackberry,\n    fullmvh.cv_hh_acty_int_eg_video_camera,\n    fullmvh.cv_hh_acty_int_eg_video_game_sys,\n    fullmvh.cv_hh_acty_int_eg_hom_theater_sys,\n    fullmvh.cv_hh_acty_int_eg_cellph_priphln,\n    fullmvh.cv_hh_acty_int_cltrl_arts,\n    fullmvh.cv_hh_acty_int_magzn_bus_fin,\n    fullmvh.cv_hh_acty_int_childrens_magzn,\n    fullmvh.cv_hh_acty_int_magzn_comp_elctrns,\n    fullmvh.cv_hh_acty_int_magzn_crft_gms_hob,\n    fullmvh.cv_hh_acty_int_magazines_fitness,\n    fullmvh.cv_hh_acty_int_mgzn_fd_wine_ckng,\n    fullmvh.cv_hh_acty_int_magzn_grdng_magzn,\n    fullmvh.cv_hh_acty_int_magzn_hntg_fshng,\n    fullmvh.cv_hh_acty_int_magazines_mens,\n    fullmvh.cv_hh_acty_int_magazines_music,\n    fullmvh.cv_hh_acty_int_mgzn_prtntg_babies,\n    fullmvh.cv_hh_acty_int_mgzn_sports_mgzn,\n    fullmvh.cv_hh_acty_int_magzn_subs,\n    fullmvh.cv_hh_acty_int_magazines_travel,\n    fullmvh.cv_hh_acty_int_magazines_womens,\n    fullmvh.cv_hh_acty_int_magzn_cur_evnt_nws,\n    fullmvh.cv_hh_ls_veh_hav_leased_a_veh,\n    fullmvh.cv_hh_ls_veh_hav_purchased_a_veh,\n    fullmvh.cv_hh_ls_afltn_mem_book_club,\n    fullmvh.cv_hh_ls_afltn_mem_music_club,\n    fullmvh.cv_hh_ls_cc_amer_exp_prem,\n    fullmvh.cv_hh_ls_cc_amer_exp_regular,\n    fullmvh.cv_hh_ls_cc_discover_premium,\n    fullmvh.cv_hh_ls_cc_discover_regular,\n    fullmvh.cv_hh_ls_cc_other_card_premium,\n    fullmvh.cv_hh_ls_cc_other_card_regular,\n    fullmvh.cv_hh_ls_cc_store_ret_reg,\n    fullmvh.cv_hh_ls_cc_visa_regular,\n    fullmvh.cv_hh_ls_cc_mastercard_regular,\n    fullmvh.cv_hh_ls_contri_hmntrn,\n    fullmvh.cv_hh_ls_entmnt_buy_prercrdvideo,\n    fullmvh.cv_hh_ls_entmnt_wtch_cabletv,\n    fullmvh.cv_hh_ls_entmnt_watch_videos,\n    fullmvh.cv_hh_ls_outdoor_lvng_entmnt,\n    fullmvh.cv_hh_ls_entmnt_season_hldy_prod,\n    fullmvh.cv_hh_ls_fin_iras_future_intrst,\n    fullmvh.cv_hh_ls_fin_life_insur_cur,\n    fullmvh.cv_hh_ls_fin_mutl_funds,\n    fullmvh.cv_hh_ls_fin_othr_invest_cur,\n    fullmvh.cv_hh_ls_fin_othr_invest_future,\n    fullmvh.cv_hh_ls_fin_real_estate_fut,\n    fullmvh.cv_hh_ls_fin_stks_bond_fut,\n    fullmvh.cv_hh_ls_grndkids_proud_grndprnt,\n    fullmvh.cv_hh_ls_info_byng_purc_by_intrnt,\n    fullmvh.cv_hh_ls_mil_gov_active_mil_mem,\n    fullmvh.cv_hh_ls_military_gov_vetern,\n    fullmvh.cv_hh_lifestyl_pets_own_a_cat,\n    fullmvh.cv_hh_lifestyl_pets_own_a_dog,\n    fullmvh.cv_hh_lifestyl_pets_own_a_pet,\n    fullmvh.cv_hh_ls_biy_internet,\n    fullmvh.cv_hh_ls_bib_mail,\n    fullmvh.cv_hh_ls_bib_catalog,\n    fullmvh.cv_hh_ls_buying_interest_apparel,\n    fullmvh.cv_hh_ls_buying_intrst_comp_elec,\n    fullmvh.cv_hh_ls_buying_intrst_book_music,\n    fullmvh.cv_hh_ls_bi_home_garden,\n    fullmvh.cv_hh_ls_bi_sports_related,\n    fullmvh.cv_hh_ls_buying_interest_big_tall,\n    fullmvh.cv_hh_ls_byng_intrst_moc,\n    fullmvh.cv_hh_ls_byng_intrst_mog,\n    fullmvh.cv_hh_ls_bi_mail_order_gift,\n    fullmvh.cv_hh_ls_byng_intrst_mjc,\n    fullmvh.cv_hh_ls_bi_mail_music_videos,\n    fullmvh.cv_hh_ls_byng_intrst_mcp,\n    fullmvh.cv_hh_ls_bi_mail_books_magzn,\n    fullmvh.cv_hh_ls_bi_food_and_beverage,\n    fullmvh.cv_hh_ls_bi_home_decorating,\n    fullmvh.cv_hh_ls_bi_furniture,\n    fullmvh.cv_hh_ls_bi_domestics,\n    fullmvh.cv_hh_ls_buying_interest_footwear,\n    fullmvh.cv_hh_ml_ordr_apprl_acsries,\n    fullmvh.cv_cape_age_pop_0_9,\n    fullmvh.cv_cape_age_pop_0_24,\n    fullmvh.cv_cape_age_pop_25_34,\n    fullmvh.cv_cape_age_pop_35_44,\n    fullmvh.cv_cape_age_pop_45_54,\n    fullmvh.cv_cape_age_pop_55_64,\n    fullmvh.cv_cape_age_pop_18_65,\n    fullmvh.cv_cape_age_pop_75_99,\n    fullmvh.cv_cape_pop_med_age_of_adults_18,\n    fullmvh.cv_cape_child_hh_fem_hh_fam_plt18,\n    fullmvh.cv_cape_child_hh_without_per_lt18,\n    fullmvh.cv_cape_cmte_com_travtowrk_60_89,\n    fullmvh.cv_cape_cmter_travtowork_90,\n    fullmvh.cv_cape_cmter_avg_trav_timetowork,\n    fullmvh.cv_cape_cmter_med_trav_timetowork,\n    fullmvh.cv_cape_cmte_wrkrs_carpld_to_work,\n    fullmvh.cv_cape_emply_fem16_lbr_frce,\n    fullmvh.cv_cape_etnc_hh_nonhisp_whte_only,\n    fullmvh.cv_cape_etnc_pop_black_only_hisp,\n    fullmvh.cv_cape_etnc_pop_non_hispanic,\n    fullmvh.cv_cape_etnc_pop_white_only_hisp,\n    fullmvh.cv_cape_inc_hh_inc_under_10k,\n    fullmvh.cv_cape_inc_hh_inc_10_14k,\n    fullmvh.cv_cape_inc_hh_inc_15_19k,\n    fullmvh.cv_cape_inc_hh_inc_20_24k,\n    fullmvh.cv_cape_inc_hh_inc_25_29k,\n    fullmvh.cv_cape_inc_hh_inc_30_34k,\n    fullmvh.cv_cape_inc_hh_inc_35_39k,\n    fullmvh.cv_cape_inc_hh_inc_40_44k,\n    fullmvh.cv_cape_inc_hh_inc_45_49k,\n    fullmvh.cv_cape_inc_hh_inc_50_59k,\n    fullmvh.cv_cape_inc_hh_inc_60_74k,\n    fullmvh.cv_cape_inc_hh_inc_75_99k,\n    fullmvh.cv_cape_inc_hh_inc_100_124k,\n    fullmvh.cv_cape_inc_hh_inc_125_149k,\n    fullmvh.cv_cape_inc_hh_inc_150_199k,\n    fullmvh.cv_cape_inc_hh_inc_200_249k,\n    fullmvh.cv_cape_inc_hh_inc_250_499k,\n    fullmvh.cv_cape_inc_hh_incm_500k_more,\n    fullmvh.cv_cape_inc_hh_med_hh_inc,\n    fullmvh.cv_cape_inc_hh_med_non_fam_hh_inc,\n    fullmvh.cv_cape_inc_pop_per_capita_income,\n    fullmvh.cv_cape_ind_empld_acmdn_food_svcs,\n    fullmvh.cv_cape_ind_empld_adm_supwstemgmt,\n    fullmvh.cv_cape_ind_empld_agr_fst_fsh_hnt,\n    fullmvh.cv_cape_ind_empld_arts_entmnt,\n    fullmvh.cv_cape_indus_empld_construction,\n    fullmvh.cv_cape_ind_empld_edu_srvs,\n    fullmvh.cv_cape_ind_empld_fin_and_ins,\n    fullmvh.cv_cape_indus_empld_hc_soc_ass,\n    fullmvh.cv_cape_indus_empld_information,\n    fullmvh.cv_cape_indus_empld_manufacturing,\n    fullmvh.cv_cape_ind_empld_mgmt_com_entrps,\n    fullmvh.cv_cape_indus_empld_mining,\n    fullmvh.cv_cape_ind_empld_oth_svcs,\n    fullmvh.cv_cape_ind_empld_public_admin,\n    fullmvh.cv_cape_ind_empld_rer_lsng,\n    fullmvh.cv_cape_indus_empld_retail_trade,\n    fullmvh.cv_cape_ind_empld_prof_sc_tch_scs,\n    fullmvh.cv_cape_ind_empld_trans_wh,\n    fullmvh.cv_cape_indus_empld_utilities,\n    fullmvh.cv_cape_ind_empld_wholesale_trade,\n    fullmvh.cv_cape_mrtg_oohu_first_mrtg_only,\n    fullmvh.cv_cape_move_occhu_med_len_res,\n    fullmvh.cv_cape_rent_rntl_median_rent,\n    fullmvh.cv_cape_tenancy_hu_occupied,\n    fullmvh.cv_cape_typ_pop_child_in_fam_hh,\n    fullmvh.cv_cape_typ_pop_in_family_hh,\n    fullmvh.cv_cape_typ_pop_in_non_family_hh,\n    fullmvh.cv_cape_pop_nat_adpt_child_fam_hh,\n    fullmvh.cv_cape_typ_pop_spouse_in_fam_hh,\n    fullmvh.cv_cape_urban_pop_rural_on_farms,\n    fullmvh.cv_cape_urban_pop_rur_not_on_frms,\n    fullmvh.cv_cape_urban_pop_in_urban_area,\n    fullmvh.cv_cape_urban_pop_in_urban_clstrs,\n    fullmvh.cv_cape_inc_fam_inc_state_indx,\n    fullmvh.cv_prop_rlty_home_year_built,\n    fullmvh.cv_mrtg_home_pur_mrtg_term,\n    fullmvh.cv_mrtg_home_pur_home_pur_date,\n    fullmvh.cv_mrtg_home_pur_mrtg_rate_type,\n    fullmvh.cv_mrtg_home_pur_mrtg_loan_type,\n    fullmvh.cv_mrtg_home_purc_type_of_purc,\n    fullmvh.cv_mrtg_home_pur_pur_amt_rng,\n    fullmvh.cv_mrtg_home_pur_mrtg_amt_rng,\n    fullmvh.cv_rlty_mdl_confdnce_cdv2,\n    fullmvh.cv_rlty_mdl_est_avl_equity_cd_v2,\n    fullmvh.cv_rlty_mdl_est_avl_equity_amt_v2,\n    fullmvh.cv_rlty_mdl_est_cur_lntoval_ratv2,\n    fullmvh.cv_rlty_mdl_est_cur_mrtg_pmtv21,\n    fullmvh.cv_rlty_mdl_est_cur_mrtg_pmtv22,\n    fullmvh.cv_rlty_mdl_est_cur_mrtg_amtcdv2,\n    fullmvh.cv_rlty_mdl_est_cur_mrtg_am_v2,\n    fullmvh.hh_size,\n    fullmvh.hoh_age,\n    fullmvh.hoh_lifestage,\n    fullmvh.hoh_ethnicity,\n    fullmvh.hoh_hispanic,\n    fullmvh.hh_income,\n    fullmvh.hh_per_cap_income,\n    fullmvh.hh_presence_of_child,\n    fullmvh.hh_presence_of_child_age_0_6,\n    fullmvh.hh_presence_of_child_age_7_12,\n    fullmvh.hh_presence_of_child_age_13_18,\n    fullmvh.hh_age_of_old_child,\n    fullmvh.hh_presence_of_gender,\n    fullmvh.hh_millennial_male,\n    fullmvh.hh_millennial_female,\n    fullmvh.hh_gen_x_male,\n    fullmvh.hh_gen_x_female,\n    fullmvh.hh_young_boomer_male,\n    fullmvh.hh_young_boomer_female,\n    fullmvh.hh_post_boomer_male,\n    fullmvh.hh_post_boomer_female,\n    fullmvh.hh_county_size,\n    fullmvh.hh_urban_suburban_rural,\n    fullmvh.hh_county,\n    fullmvh.hh_state,\n    fullmvh.hh_cbsa,\n    fullmvh.geo_zipcode,\n    fullmvh.geo_cvs,\n    fullmvh.geo_target,\n    fullmvh.geo_aldi,\n    fullmvh.geo_costco,\n    fullmvh.geo_sams_club,\n    fullmvh.geo_7_eleven,\n    fullmvh.geo_circle_k,\n    fullmvh.geo_kroger_banner,\n    fullmvh.geo_all_other_kroger,\n    fullmvh.geo_albertsons_safeway,\n    fullmvh.geo_publix,\n    fullmvh.geo_ahold_delhaize,\n    fullmvh.geo_wakefern,\n    fullmvh.geo_hy_vee,\n    fullmvh.geo_heb,\n    fullmvh.geo_bi_lo,\n    fullmvh.geo_trader_joes,\n    fullmvh.geo_whole_foods,\n    fullmvh.geo_walgreens,\n    fullmvh.geo_wm_neighborhood_market,\n    fullmvh.geo_all_other_walmart,\n    fullmvh.geo_bjs,\n    fullmvh.geo_speedway,\n    fullmvh.geo_dollar_general,\n    fullmvh.geo_family_dollar,\n    fullmvh.geo_all_other_grocery,\n    fullmvh.geo_all_other_drug,\n    fullmvh.geo_all_other_mass,\n    fullmvh.geo_all_other_club,\n    fullmvh.geo_total_c_and_g,\n    fullmvh.geo_all_other_c_and_g,\n    fullmvh.geo_all_other_dollar,\n    fullmvh.geo_amazon_com,\n    fullmvh.geo_walmart_com,\n    fullmvh.geo_all_other_ao,\n    fullmvh.geo_not_assigned,\n    fullmvh.is_all_other_ao,\n    fullmvh.is_not_assigned,\n    fullmvh.is_7_eleven,\n    fullmvh.is_ahold_delhaize,\n    fullmvh.is_albertsons,\n    fullmvh.is_aldi,\n    fullmvh.is_amazon_com,\n    fullmvh.is_bi_lo,\n    fullmvh.is_bjs,\n    fullmvh.is_circle_k,\n    fullmvh.is_costco,\n    fullmvh.is_cvs,\n    fullmvh.is_dollar_general,\n    fullmvh.is_family_dollar,\n    fullmvh.is_heb,\n    fullmvh.is_speedway,\n    fullmvh.is_hy_vee,\n    fullmvh.is_kroger_banner,\n    fullmvh.is_all_other_kroger,\n    fullmvh.is_all_other_club,\n    fullmvh.is_all_other_dollar,\n    fullmvh.is_all_other_drug,\n    fullmvh.is_all_other_c_and_g,\n    fullmvh.is_all_other_grocery,\n    fullmvh.is_all_other_mass,\n    fullmvh.is_publix,\n    fullmvh.is_sams_club,\n    fullmvh.is_target,\n    fullmvh.is_trader_joes,\n    fullmvh.is_wakefern,\n    fullmvh.is_walgreens,\n    fullmvh.is_walmart_com,\n    fullmvh.is_wm_neighborhood_market,\n    fullmvh.is_all_other_walmart,\n    fullmvh.is_whole_foods,\n    fullmvh.is_target_com,\n    fullmvh.is_kroger_com,\n    fullmvh.is_kmart_com,\n    fullmvh.is_walgreens_com,\n    fullmvh.is_samsclub_com,\n    fullmvh.is_costco_com,\n\n    IFF(fullmvh.is_7_eleven > perapp.is_7_eleven_99, perapp.is_7_eleven_99, fullmvh.is_7_eleven ) AS is_7_eleven_cap ,\n    IFF(fullmvh.is_ahold_delhaize > perapp.is_ahold_delhaize_99 , perapp.is_ahold_delhaize_99 , fullmvh.is_ahold_delhaize ) AS is_ahold_delhaize_cap ,\n    IFF(fullmvh.is_albertsons > perapp.is_albertsons_99 , perapp.is_albertsons_99 , fullmvh.is_albertsons ) AS is_albertsons_cap ,\n    IFF(fullmvh.is_aldi > perapp.is_aldi_99 , perapp.is_aldi_99 , fullmvh.is_aldi ) AS is_aldi_cap ,\n    IFF(fullmvh.is_amazon_com > perapp.is_amazon_com_99 , perapp.is_amazon_com_99 , fullmvh.is_amazon_com ) AS is_amazon_com_cap ,\n    IFF(fullmvh.is_bi_lo > perapp.is_bi_lo_99 , perapp.is_bi_lo_99 , fullmvh.is_bi_lo ) AS is_bi_lo_cap ,\n    IFF(fullmvh.is_bjs > perapp.is_bjs_99 , perapp.is_bjs_99 , fullmvh.is_bjs ) AS is_bjs_cap ,\n    IFF(fullmvh.is_circle_k > perapp.is_circle_k_99 , perapp.is_circle_k_99 , fullmvh.is_circle_k ) AS is_circle_k_cap ,\n    IFF(fullmvh.is_costco > perapp.is_costco_99 , perapp.is_costco_99 , fullmvh.is_costco ) AS is_costco_cap ,\n    IFF(fullmvh.is_cvs > perapp.is_cvs_99 , perapp.is_cvs_99 , fullmvh.is_cvs ) AS is_cvs_cap ,\n    IFF(fullmvh.is_dollar_general > perapp.is_dollar_general_99 , perapp.is_dollar_general_99 , fullmvh.is_dollar_general ) AS is_dollar_general_cap ,\n    IFF(fullmvh.is_family_dollar > perapp.is_family_dollar_99 , perapp.is_family_dollar_99 , fullmvh.is_family_dollar ) AS is_family_dollar_cap ,\n    IFF(fullmvh.is_heb > perapp.is_heb_99 , perapp.is_heb_99 , fullmvh.is_heb ) AS is_heb_cap ,\n    IFF(fullmvh.is_speedway > perapp.is_speedway_99 , perapp.is_speedway_99 , fullmvh.is_speedway ) AS is_speedway_cap ,\n    IFF(fullmvh.is_hy_vee > perapp.is_hy_vee_99 , perapp.is_hy_vee_99 , fullmvh.is_hy_vee ) AS is_hy_vee_cap ,\n    IFF(fullmvh.is_kroger_banner > perapp.is_kroger_banner_99 , perapp.is_kroger_banner_99 , fullmvh.is_kroger_banner ) AS is_kroger_banner_cap ,\n    IFF(fullmvh.is_all_other_kroger > perapp.is_all_other_kroger_99 , perapp.is_all_other_kroger_99 , fullmvh.is_all_other_kroger ) AS is_all_other_kroger_cap ,\n    IFF(fullmvh.is_all_other_club > perapp.is_all_other_club_99 , perapp.is_all_other_club_99 , fullmvh.is_all_other_club ) AS is_all_other_club_cap ,\n    IFF(fullmvh.is_all_other_dollar > perapp.is_all_other_dollar_99 , perapp.is_all_other_dollar_99 , fullmvh.is_all_other_dollar ) AS is_all_other_dollar_cap ,\n    IFF(fullmvh.is_all_other_drug > perapp.is_all_other_drug_99 , perapp.is_all_other_drug_99 , fullmvh.is_all_other_drug ) AS is_all_other_drug_cap ,\n    IFF(fullmvh.is_all_other_c_and_g > perapp.is_all_other_c_and_g_99 , perapp.is_all_other_c_and_g_99 , fullmvh.is_all_other_c_and_g ) AS is_all_other_c_and_g_cap ,\n    IFF(fullmvh.is_all_other_grocery > perapp.is_all_other_grocery_99 , perapp.is_all_other_grocery_99 , fullmvh.is_all_other_grocery ) AS is_all_other_grocery_cap ,\n    IFF(fullmvh.is_all_other_mass > perapp.is_all_other_mass_99 , perapp.is_all_other_mass_99 , fullmvh.is_all_other_mass ) AS is_all_other_mass_cap ,\n    IFF(fullmvh.is_publix > perapp.is_publix_99 , perapp.is_publix_99 , fullmvh.is_publix ) AS is_publix_cap ,\n    IFF(fullmvh.is_sams_club > perapp.is_sams_club_99 , perapp.is_sams_club_99 , fullmvh.is_sams_club ) AS is_sams_club_cap ,\n    IFF(fullmvh.is_target > perapp.is_target_99 , perapp.is_target_99 , fullmvh.is_target ) AS is_target_cap ,\n    IFF(fullmvh.is_trader_joes > perapp.is_trader_joes_99 , perapp.is_trader_joes_99 , fullmvh.is_trader_joes ) AS is_trader_joes_cap ,\n    IFF(fullmvh.is_wakefern > perapp.is_wakefern_99 , perapp.is_wakefern_99 , fullmvh.is_wakefern ) AS is_wakefern_cap ,\n    IFF(fullmvh.is_walgreens > perapp.is_walgreens_99 , perapp.is_walgreens_99 , fullmvh.is_walgreens ) AS is_walgreens_cap ,\n    IFF(fullmvh.is_walmart_com > perapp.is_walmart_com_99 , perapp.is_walmart_com_99 , fullmvh.is_walmart_com ) AS is_walmart_com_cap ,\n    IFF(fullmvh.is_wm_neighborhood_market > perapp.is_wm_neighborhood_market_99 , perapp.is_wm_neighborhood_market_99 , fullmvh.is_wm_neighborhood_market ) AS is_wm_neighborhood_market_cap ,\n    IFF(fullmvh.is_all_other_walmart > perapp.is_all_other_walmart_99 , perapp.is_all_other_walmart_99 , fullmvh.is_all_other_walmart ) AS is_all_other_walmart_cap ,\n    IFF(fullmvh.is_whole_foods > perapp.is_whole_foods_99 , perapp.is_whole_foods_99 , fullmvh.is_whole_foods ) AS is_whole_foods_cap ,\n\n\n    IFF(fullmvh.is_target_com > perapp.is_target_com_99 , perapp.is_target_com_99, fullmvh.is_target_com ) AS is_target_com_cap ,\n    IFF(fullmvh.is_kroger_com > perapp.is_kroger_com_99 , perapp.is_kroger_com_99, fullmvh.is_kroger_com ) AS is_kroger_com_cap ,\n    IFF(fullmvh.is_kmart_com > perapp.is_kmart_com_99 , perapp.is_kmart_com_99, fullmvh.is_kmart_com ) AS is_kmart_com_cap ,\n    IFF(fullmvh.is_walgreens_com > perapp.is_walgreens_com_99 , perapp.is_walgreens_com_99, fullmvh.is_walgreens_com ) AS is_walgreens_com_cap ,\n    IFF(fullmvh.is_samsclub_com > perapp.is_samsclub_com_99 , perapp.is_samsclub_com_99, fullmvh.is_samsclub_com ) AS is_samsclub_com_cap ,\n\n    IFF(fullmvh.is_costco_com > perapp.is_costco_com_99 , perapp.is_costco_com_99, fullmvh.is_costco_com ) AS is_costco_com_cap ,\n\n    fullmvh.fvh_cur_lifestage,\n    fullmvh.fvh_cur_pred_spend,\n    fullmvh.fvh_fut_pred_spend,\n    fullmvh.fvh_growth_rate,\n    fullmvh.smart_water,\n    fullmvh.smart_water_decile,\n    fullmvh.energy_csd_zero_calorie,\n    fullmvh.energy_csd_zero_calorie_decile,\n    fullmvh.csd_total,\n    fullmvh.csd_total_decile,\n    fullmvh.doritos,\n    fullmvh.doritos_decile,\n    fullmvh.energy_drinks,\n    fullmvh.energy_drinks_decile,\n    fullmvh.gatorade,\n    fullmvh.gatorade_decile,\n    fullmvh.lays,\n    fullmvh.lays_decile,\n    fullmvh.lipton_base,\n    fullmvh.lipton_base_decile,\n    fullmvh.lipton_brisk,\n    fullmvh.lipton_brisk_decile,\n    fullmvh.mt_dew,\n    fullmvh.mt_dew_decile,\n    fullmvh.mtn_dew_kickstart,\n    fullmvh.mtn_dew_kickstart_decile,\n    fullmvh.nuts,\n    fullmvh.nuts_decile,\n    fullmvh.pepsi_diet,\n    fullmvh.pepsi_diet_decile,\n    fullmvh.pepsi_regular,\n    fullmvh.pepsi_regular_decile,\n    fullmvh.performance_bars,\n    fullmvh.performance_bars_decile,\n    fullmvh.pepsico_protein_powder,\n    fullmvh.pepsico_protein_powder_decile,\n    fullmvh.propel,\n    fullmvh.propel_decile,\n    fullmvh.quaker_oatmeal,\n    fullmvh.quaker_oatmeal_decile,\n    fullmvh.rte_cereal,\n    fullmvh.rte_cereal_decile,\n    fullmvh.ruffles,\n    fullmvh.ruffles_decile,\n    fullmvh.bottled_water,\n    fullmvh.bottled_water_decile,\n    fullmvh.starbucks_tripleshot,\n    fullmvh.starbucks_tripleshot_decile,\n    fullmvh.funyuns,\n    fullmvh.funyuns_decile,\n    fullmvh.chilled_tea,\n    fullmvh.chilled_tea_decile,\n    fullmvh.coffee_rtd,\n    fullmvh.coffee_rtd_decile,\n    fullmvh.online_delivery,\n    fullmvh.online_delivery_decile,\n    fullmvh.csd_singles,\n    fullmvh.csd_singles_decile,\n    fullmvh.flv_csd_ex_dew_pepper,\n    fullmvh.flv_csd_ex_dew_pepper_decile,\n    fullmvh.rtd_protein,\n    fullmvh.rtd_protein_decile,\n    fullmvh.sodastream,\n    fullmvh.sodastream_decile,\n    fullmvh.gamefuel,\n    fullmvh.gamefuel_decile,\n    fullmvh.mainstream_kettle_chips,\n    fullmvh.mainstream_kettle_chips_decile,\n    fullmvh.lipton_pure_leaf,\n    fullmvh.lipton_pure_leaf_decile,\n    fullmvh.mainstream_juices,\n    fullmvh.mainstream_juices_decile,\n    fullmvh.mt_dew_flv_seek,\n    fullmvh.mt_dew_flv_seek_decile,\n    fullmvh.instant_quaker_oats,\n    fullmvh.instant_quaker_oats_decile,\n    fullmvh.naked_protein,\n    fullmvh.naked_protein_decile,\n    fullmvh.pepsi_zero_coke_zero,\n    fullmvh.pepsi_zero_coke_zero_decile,\n    fullmvh.prem_juice_drinks,\n    fullmvh.prem_juice_drinks_decile,\n    fullmvh.lightly_flavored_tortilla_chips,\n    fullmvh.lightly_flavored_tortilla_chips_decile,\n    fullmvh.doubleshot_javam,\n    fullmvh.doubleshot_javam_decile,\n    fullmvh.food_bev,\n    fullmvh.food_bev_decile,\n    fullmvh.ncb_innovation,\n    fullmvh.ncb_innovation_decile,\n    fullmvh.premium_csd,\n    fullmvh.premium_csd_decile,\n    fullmvh.premium_tea,\n    fullmvh.premium_tea_decile,\n    fullmvh.premium_water,\n    fullmvh.premium_water_decile,\n    fullmvh.probiotic_juices,\n    fullmvh.probiotic_juices_decile,\n    fullmvh.lays_poppables,\n    fullmvh.lays_poppables_decile,\n    fullmvh.alternative_tortilla_chips,\n    fullmvh.alternative_tortilla_chips_decile,\n    fullmvh.snack_bars,\n    fullmvh.snack_bars_decile,\n    fullmvh.sparkling_water,\n    fullmvh.sparkling_water_decile,\n    fullmvh.dips_as_meal_enhancers,\n    fullmvh.dips_as_meal_enhancers_decile,\n    fullmvh.stacys,\n    fullmvh.stacys_decile,\n    fullmvh.sunchips,\n    fullmvh.sunchips_decile,\n    fullmvh.super_premium_juices,\n    fullmvh.super_premium_juices_decile,\n    fullmvh.tostitos,\n    fullmvh.tostitos_decile,\n    fullmvh.flavor_camp_bbq,\n    fullmvh.flavor_camp_bbq_decile,\n    fullmvh.plant_based_rtd_protein,\n    fullmvh.plant_based_rtd_protein_decile,\n    fullmvh.veggie_chips,\n    fullmvh.veggie_chips_decile,\n    fullmvh.g_organic,\n    fullmvh.g_organic_decile,\n    fullmvh.mountain_dew_baja_blast,\n    fullmvh.mountain_dew_baja_blast_decile,\n    fullmvh.cold_brew,\n    fullmvh.cold_brew_decile,\n    fullmvh.bubly,\n    fullmvh.bubly_decile,\n    fullmvh.ultra_premium_juice,\n    fullmvh.ultra_premium_juice_decile,\n    fullmvh.lightly_salted_chips,\n    fullmvh.lightly_salted_chips_decile,\n    fullmvh.flavor_camp_cheese,\n    fullmvh.flavor_camp_cheese_decile,\n    fullmvh.sabra_hummus_tubs,\n    fullmvh.sabra_hummus_tubs_decile,\n    fullmvh.oj_category_switchers,\n    fullmvh.oj_category_switchers_decile,\n    fullmvh.standard_quaker_oats,\n    fullmvh.standard_quaker_oats_decile,\n    fullmvh.csd_multiserve,\n    fullmvh.csd_multiserve_decile,\n    fullmvh.dew_ice,\n    fullmvh.dew_ice_decile,\n    fullmvh.flavor_camp_dairy,\n    fullmvh.flavor_camp_dairy_decile,\n    fullmvh.online_curbside_pickup,\n    fullmvh.online_curbside_pickup_decile,\n    fullmvh.flavor_camp_herb_spice_veggie,\n    fullmvh.flavor_camp_herb_spice_veggie_decile,\n    fullmvh.flv_salty_snacks,\n    fullmvh.flv_salty_snacks_decile,\n    fullmvh.g2,\n    fullmvh.g2_decile,\n    fullmvh.flavor_camp_salted_plain,\n    fullmvh.flavor_camp_salted_plain_decile,\n    fullmvh.keto_cookies,\n    fullmvh.keto_cookies_decile,\n    fullmvh.low_fat_salty_snacks,\n    fullmvh.low_fat_salty_snacks_decile,\n    fullmvh.aha,\n    fullmvh.aha_decile,\n    fullmvh.plant_based_protein_powder,\n    fullmvh.plant_based_protein_powder_decile,\n    fullmvh.pretzel_category,\n    fullmvh.pretzel_category_decile,\n    fullmvh.flavor_camp_spicy_burn,\n    fullmvh.flavor_camp_spicy_burn_decile,\n    fullmvh.dots_pretzels,\n    fullmvh.dots_pretzels_decile,\n    fullmvh.santitas,\n    fullmvh.santitas_decile,\n    fullmvh.flavor_camp_tangy,\n    fullmvh.flavor_camp_tangy_decile,\n    fullmvh.tropicana_probiotics_purchasers,\n    fullmvh.tropicana_probiotics_purchasers_decile,\n    fullmvh.tropicana_pure_premium_purchasers,\n    fullmvh.tropicana_pure_premium_purchasers_decile,\n    fullmvh.rfg_yogurt_drinks,\n    fullmvh.rfg_yogurt_drinks_decile,\n    fullmvh.flavor_camp_aggregate_all_intense_bold,\n    fullmvh.flavor_camp_aggregate_all_intense_bold_decile,\n    fullmvh.total_regular_cola,\n    fullmvh.total_regular_cola_decile,\n    fullmvh.flavor_camp_meat,\n    fullmvh.flavor_camp_meat_decile,\n    fullmvh.fritos_original,\n    fullmvh.fritos_original_decile,\n    fullmvh.flavored_pretzels,\n    fullmvh.flavored_pretzels_decile,\n    fullmvh.nutrition_engaged,\n    fullmvh.nutrition_engaged_decile,\n    fullmvh.mainstream_engaged,\n    fullmvh.mainstream_engaged_decile,\n    fullmvh.oj_category,\n    fullmvh.oj_category_decile,\n    fullmvh.nutrition_bars,\n    fullmvh.nutrition_bars_decile,\n    fullmvh.oatmeal_category,\n    fullmvh.oatmeal_category_decile,\n    fullmvh.alt_dairy_category,\n    fullmvh.alt_dairy_category_decile,\n    fullmvh.kombucha_functional_juices,\n    fullmvh.kombucha_functional_juices_decile,\n    fullmvh.single_serve_mainstream_juice,\n    fullmvh.single_serve_mainstream_juice_decile,\n    fullmvh.quaker_grits,\n    fullmvh.quaker_grits_decile,\n    fullmvh.shelf_stable_dips_category,\n    fullmvh.shelf_stable_dips_category_decile,\n    fullmvh.fruit_snacks,\n    fullmvh.fruit_snacks_decile,\n    fullmvh.fritos_flavor,\n    fullmvh.fritos_flavor_decile,\n    fullmvh.kevita_purchasers,\n    fullmvh.kevita_purchasers_decile,\n    fullmvh.heart_claim,\n    fullmvh.heart_claim_decile,\n    fullmvh.starbucks_frappuccino,\n    fullmvh.starbucks_frappuccino_decile,\n    fullmvh.single_serve_salty_snacks,\n    fullmvh.single_serve_salty_snacks_decile,\n    fullmvh.cholesterol_claim,\n    fullmvh.cholesterol_claim_decile,\n    fullmvh.g_zero,\n    fullmvh.g_zero_decile,\n    fullmvh.diet_csds,\n    fullmvh.diet_csds_decile,\n    fullmvh.candy_category,\n    fullmvh.candy_category_decile,\n    fullmvh.frozen_fruit_category,\n    fullmvh.frozen_fruit_category_decile,\n    fullmvh.salty_snacks,\n    fullmvh.salty_snacks_decile,\n    fullmvh.premium_greek_yogurt,\n    fullmvh.premium_greek_yogurt_decile,\n    fullmvh.rice_pasta_ethnic_spclty,\n    fullmvh.rice_pasta_ethnic_spclty_decile,\n    fullmvh.pancake_mix_syrup,\n    fullmvh.pancake_mix_syrup_decile,\n    fullmvh.lite_snacks,\n    fullmvh.lite_snacks_decile,\n    fullmvh.herbal_tea,\n    fullmvh.herbal_tea_decile,\n    fullmvh.tazo,\n    fullmvh.tazo_decile,\n    fullmvh.mini_cans,\n    fullmvh.mini_cans_decile,\n    fullmvh.unflavored_pretzels,\n    fullmvh.unflavored_pretzels_decile,\n    fullmvh.bodyarmor,\n    fullmvh.bodyarmor_decile,\n    fullmvh.organic_food_bev_buyers,\n    fullmvh.organic_food_bev_buyers_decile,\n    fullmvh.fritos_scoops,\n    fullmvh.fritos_scoops_decile,\n    fullmvh.grain_claim,\n    fullmvh.grain_claim_decile,\n    fullmvh.diet_coke,\n    fullmvh.diet_coke_decile,\n    fullmvh.online_in_store_pickup,\n    fullmvh.online_in_store_pickup_decile,\n    fullmvh.bare,\n    fullmvh.bare_decile,\n    fullmvh.off_the_eaten_path,\n    fullmvh.off_the_eaten_path_decile,\n    fullmvh.rte_cereal_all_family,\n    fullmvh.rte_cereal_all_family_decile,\n    fullmvh.rte_cereal_kids,\n    fullmvh.rte_cereal_kids_decile,\n    fullmvh.instant_quaker_oats_light_lapsed,\n    fullmvh.instant_quaker_oats_light_lapsed_decile,\n    fullmvh.celsius_energy,\n    fullmvh.celsius_energy_decile,\n    fullmvh.doritos_h_and_s,\n    fullmvh.doritos_h_and_s_decile,\n    fullmvh.premium_kettle_chips,\n    fullmvh.premium_kettle_chips_decile,\n    fullmvh.chewy_kids_snacking,\n    fullmvh.chewy_kids_snacking_decile,\n    fullmvh.starbucks_nitro,\n    fullmvh.starbucks_nitro_decile,\n    fullmvh.premium_lrb,\n    fullmvh.premium_lrb_decile,\n    fullmvh.rte_popcorn_full_flavor,\n    fullmvh.rte_popcorn_full_flavor_decile,\n    fullmvh.rte_popcorn_light_flavor,\n    fullmvh.rte_popcorn_light_flavor_decile,\n    fullmvh.breakfast_cereal_snack_bars,\n    fullmvh.breakfast_cereal_snack_bars_decile,\n    fullmvh.sports_drinks,\n    fullmvh.sports_drinks_decile,\n    fullmvh.takis,\n    fullmvh.takis_decile,\n    fullmvh.lacroix,\n    fullmvh.lacroix_decile,\n    fullmvh.manzanita_sol,\n    fullmvh.manzanita_sol_decile,\n    fullmvh.unflavored_tortilla_chips,\n    fullmvh.unflavored_tortilla_chips_decile,\n    fullmvh.crush,\n    fullmvh.crush_decile,\n    fullmvh.chewy,\n    fullmvh.chewy_decile,\n    fullmvh.rockstar_energy,\n    fullmvh.rockstar_energy_decile,\n    fullmvh.light_holiday_salty_snack_buyers,\n    fullmvh.light_holiday_salty_snack_buyers_decile,\n    fullmvh.medium_holiday_salty_snack_buyers,\n    fullmvh.medium_holiday_salty_snack_buyers_decile,\n    fullmvh.xxvl_single_serve_snacks,\n    fullmvh.xxvl_single_serve_snacks_decile,\n    fullmvh.svlr_single_serve_snacks,\n    fullmvh.svlr_single_serve_snacks_decile,\n    fullmvh.lss_single_serve_snacks,\n    fullmvh.lss_single_serve_snacks_decile,\n    fullmvh.bolt_24,\n    fullmvh.bolt_24_decile,\n    fullmvh.lemonade,\n    fullmvh.lemonade_decile,\n    fullmvh.gamesa_cookies,\n    fullmvh.gamesa_cookies_decile,\n    fullmvh.kids_organic,\n    fullmvh.kids_organic_decile,\n    fullmvh.rice_crisps_cakes,\n    fullmvh.rice_crisps_cakes_decile,\n    fullmvh.health_warrior,\n    fullmvh.health_warrior_decile,\n    fullmvh.simple_nutrition,\n    fullmvh.simple_nutrition_decile,\n    fullmvh.naked,\n    fullmvh.naked_decile,\n    fullmvh.yogurt,\n    fullmvh.yogurt_decile,\n    fullmvh.online_edible,\n    fullmvh.online_edible_decile,\n    fullmvh.better_for_you_bagged_snacks,\n    fullmvh.better_for_you_bagged_snacks_decile,\n    fullmvh.vanilla_flavored_rtd_coffee,\n    fullmvh.vanilla_flavored_rtd_coffee_decile,\n    fullmvh.frozen_dips,\n    fullmvh.frozen_dips_decile,\n    fullmvh.caramel_flavored_rtd_coffee,\n    fullmvh.caramel_flavored_rtd_coffee_decile,\n    fullmvh.coffee_flavored_rtd_coffee,\n    fullmvh.coffee_flavored_rtd_coffee_decile,\n    fullmvh.lays_stax,\n    fullmvh.lays_stax_decile,\n    fullmvh.popcorners,\n    fullmvh.popcorners_decile,\n    fullmvh.shelf_stable_dairy_dips,\n    fullmvh.shelf_stable_dairy_dips_decile,\n    fullmvh.probiotic_attribute,\n    fullmvh.probiotic_attribute_decile,\n    fullmvh.essentia,\n    fullmvh.essentia_decile,\n    fullmvh.core,\n    fullmvh.core_decile,\n    fullmvh.dasani,\n    fullmvh.dasani_decile,\n    fullmvh.shelf_stable_salsa,\n    fullmvh.shelf_stable_salsa_decile,\n    fullmvh.shelf_stable_cheese_dips,\n    fullmvh.shelf_stable_cheese_dips_decile,\n    fullmvh.shelf_stable_bean_dips,\n    fullmvh.shelf_stable_bean_dips_decile,\n    fullmvh.cheetos_cheese_core,\n    fullmvh.cheetos_cheese_core_decile,\n    fullmvh.frito_lay_multipack,\n    fullmvh.frito_lay_multipack_decile,\n    fullmvh.cheetos_flamin_hot_core,\n    fullmvh.cheetos_flamin_hot_core_decile,\n    fullmvh.muscle_milk,\n    fullmvh.muscle_milk_decile,\n    fullmvh.kst_regular_coke_transitioner,\n    fullmvh.kst_regular_coke_transitioner_decile,\n    fullmvh.kst_frequent_diet_pepsi_transitioner,\n    fullmvh.kst_frequent_diet_pepsi_transitioner_decile,\n    fullmvh.kst_hispanic_pepsi_drinker,\n    fullmvh.kst_hispanic_pepsi_drinker_decile,\n    fullmvh.kst_light_cola_drinker,\n    fullmvh.kst_light_cola_drinker_decile,\n    fullmvh.kst_frequent_blue_pepsi_drinker,\n    fullmvh.kst_frequent_blue_pepsi_drinker_decile,\n    fullmvh.kst_non_cola_drinkers,\n    fullmvh.kst_non_cola_drinkers_decile,\n    fullmvh.macaroni_and_cheese,\n    fullmvh.macaroni_and_cheese_decile,\n    fullmvh.heat_and_eat,\n    fullmvh.heat_and_eat_decile,\n    fullmvh.instant_rice_pasta_grains,\n    fullmvh.instant_rice_pasta_grains_decile,\n    fullmvh.better_for_you_crackers,\n    fullmvh.better_for_you_crackers_decile,\n    fullmvh.zero_calorie_csd,\n    fullmvh.zero_calorie_csd_decile,\n    fullmvh.wavy_lays,\n    fullmvh.wavy_lays_decile,\n    fullmvh.multiserve_starbucks,\n    fullmvh.multiserve_starbucks_decile,\n    fullmvh.tea_bags,\n    fullmvh.tea_bags_decile,\n    fullmvh.rfg_dips,\n    fullmvh.rfg_dips_decile,\n    fullmvh.sleeping_remedies,\n    fullmvh.sleeping_remedies_decile,\n    fullmvh.adaptogens,\n    fullmvh.adaptogens_decile,\n    fullmvh.easy_wellness,\n    fullmvh.easy_wellness_decile,\n    fullmvh.bang,\n    fullmvh.bang_decile,\n    fullmvh.kevita_adjacencies,\n    fullmvh.kevita_adjacencies_decile,\n    fullmvh.caffeine_attribute,\n    fullmvh.caffeine_attribute_decile,\n    fullmvh.vitamin_c_attribute,\n    fullmvh.vitamin_c_attribute_decile,\n    fullmvh.antioxidant_attribute,\n    fullmvh.antioxidant_attribute_decile,\n    fullmvh.poland_spring,\n    fullmvh.poland_spring_decile,\n    fullmvh.polar,\n    fullmvh.polar_decile,\n    fullmvh.diet_coke_decliners,\n    fullmvh.diet_coke_decliners_decile,\n    fullmvh.sprite_and_fanta_decliners,\n    fullmvh.sprite_and_fanta_decliners_decile,\n    fullmvh.rap_snacks,\n    fullmvh.rap_snacks_decile,\n    fullmvh.cheetos_crunchy,\n    fullmvh.cheetos_crunchy_decile,\n    fullmvh.cheetos_puffs,\n    fullmvh.cheetos_puffs_decile,\n    fullmvh.lays_classic,\n    fullmvh.lays_classic_decile,\n    fullmvh.premium_cocktail_mixers,\n    fullmvh.premium_cocktail_mixers_decile,\n    fullmvh.baken_ets,\n    fullmvh.baken_ets_decile,\n    fullmvh.mainstream_mixers,\n    fullmvh.mainstream_mixers_decile,\n    fullmvh.quaker_hots_light_lapsed,\n    fullmvh.quaker_hots_light_lapsed_decile,\n    fullmvh.zone_in_shopper,\n    fullmvh.zone_in_shopper_decile,\n    fullmvh.root_beer,\n    fullmvh.root_beer_decile,\n    fullmvh.coke,\n    fullmvh.coke_decile,\n    fullmvh.premium_cheese_snacks,\n    fullmvh.premium_cheese_snacks_decile,\n    fullmvh.stacys_thins,\n    fullmvh.stacys_thins_decile,\n    fullmvh.stacys_core,\n    fullmvh.stacys_core_decile,\n    fullmvh.diet_mountain_dew,\n    fullmvh.diet_mountain_dew_decile,\n    fullmvh.sparkling_ice,\n    fullmvh.sparkling_ice_decile,\n    fullmvh.granola,\n    fullmvh.granola_decile,\n    fullmvh.aj_pancake_mix_and_syrup,\n    fullmvh.aj_pancake_mix_and_syrup_decile,\n    fullmvh.rte_cereal_adult,\n    fullmvh.rte_cereal_adult_decile,\n    fullmvh.kids_ambient_juices,\n    fullmvh.kids_ambient_juices_decile,\n    fullmvh.non_lemonade_juice_drinks,\n    fullmvh.non_lemonade_juice_drinks_decile,\n    fullmvh.cheetos_mac_n_cheese,\n    fullmvh.cheetos_mac_n_cheese_decile,\n    fullmvh.hispanic_cookies,\n    fullmvh.hispanic_cookies_decile,\n    fullmvh.gamesa_crackers,\n    fullmvh.gamesa_crackers_decile,\n    fullmvh.naked_juice_lapsed_buyers,\n    fullmvh.naked_juice_lapsed_buyers_decile,\n    fullmvh.natural_attribute,\n    fullmvh.natural_attribute_decile,\n    fullmvh.protein_attribute,\n    fullmvh.protein_attribute_decile,\n    fullmvh.calcium_attribute,\n    fullmvh.calcium_attribute_decile,\n    fullmvh.fiber,\n    fullmvh.fiber_decile,\n    fullmvh.gluten_free,\n    fullmvh.gluten_free_decile,\n    fullmvh.low_sodium,\n    fullmvh.low_sodium_decile,\n    fullmvh.no_added_sugar,\n    fullmvh.no_added_sugar_decile,\n    fullmvh.simply,\n    fullmvh.simply_decile,\n    fullmvh.baked,\n    fullmvh.baked_decile,\n    fullmvh.non_gmo,\n    fullmvh.non_gmo_decile,\n    fullmvh.mt_dew_total,\n    fullmvh.mt_dew_total_decile,\n    fullmvh.keto_dieters,\n    fullmvh.keto_dieters_decile,\n    fullmvh.party_people,\n    fullmvh.party_people_decile,\n    fullmvh.cold_and_flu_preppers,\n    fullmvh.cold_and_flu_preppers_decile,\n    fullmvh.condiments_and_sauces,\n    fullmvh.condiments_and_sauces_decile,\n    fullmvh.flavored_csds,\n    fullmvh.flavored_csds_decile,\n    fullmvh.holiday_hosts,\n    fullmvh.holiday_hosts_decile,\n    fullmvh.immunity_boosters,\n    fullmvh.immunity_boosters_decile,\n    fullmvh.new_years_dieters,\n    fullmvh.new_years_dieters_decile,\n    fullmvh.new_years_partiers,\n    fullmvh.new_years_partiers_decile,\n    fullmvh.plant_based_buyers,\n    fullmvh.plant_based_buyers_decile,\n    fullmvh.summer_grillers,\n    fullmvh.summer_grillers_decile,\n    fullmvh.super_bowl_hosts,\n    fullmvh.super_bowl_hosts_decile,\n    fullmvh.thanksgiving_hosts,\n    fullmvh.thanksgiving_hosts_decile,\n    fullmvh.hard_coffee,\n    fullmvh.hard_coffee_decile,\n    fullmvh.hard_flavored_bevs_xlemonade,\n    fullmvh.hard_flavored_bevs_xlemonade_decile,\n    fullmvh.hard_kombucha,\n    fullmvh.hard_kombucha_decile,\n    fullmvh.hard_lemonade,\n    fullmvh.hard_lemonade_decile,\n    fullmvh.hard_seltzer,\n    fullmvh.hard_seltzer_decile,\n    fullmvh.health_warrior_competitive_products,\n    fullmvh.health_warrior_competitive_products_decile,\n    fullmvh.other_hmb,\n    fullmvh.other_hmb_decile,\n    fullmvh.cookies,\n    fullmvh.cookies_decile,\n    fullmvh.crackers,\n    fullmvh.crackers_decile,\n    fullmvh.trop_premium_juice_drinks,\n    fullmvh.trop_premium_juice_drinks_decile,\n    fullmvh.wine,\n    fullmvh.wine_decile,\n    fullmvh.spirits_liquor,\n    fullmvh.spirits_liquor_decile,\n    fullmvh.premade_cocktails_coolers,\n    fullmvh.premade_cocktails_coolers_decile,\n    fullmvh.domestic_beer,\n    fullmvh.domestic_beer_decile,\n    fullmvh.imported_beer,\n    fullmvh.imported_beer_decile,\n    fullmvh.flavored_malt_beverages,\n    fullmvh.flavored_malt_beverages_decile,\n    fullmvh.ambient_juice,\n    fullmvh.ambient_juice_decile,\n    fullmvh.new_rtd_tea_buyers_buying_lipton,\n    fullmvh.new_rtd_tea_buyers_buying_lipton_decile,\n    fullmvh.rtd_tea_buyers_switching_to_lipton,\n    fullmvh.rtd_tea_buyers_switching_to_lipton_decile,\n    fullmvh.sabritas,\n    fullmvh.sabritas_decile,\n    fullmvh.cbd_product_purchasers,\n    fullmvh.cbd_product_purchasers_decile,\n    fullmvh.dr_pepper,\n    fullmvh.dr_pepper_decile,\n    fullmvh.coffee_beans,\n    fullmvh.coffee_beans_decile,\n    fullmvh.hispanic_aisle,\n    fullmvh.hispanic_aisle_decile,\n    fullmvh.functional_juice_kombucha_switchers,\n    fullmvh.functional_juice_kombucha_switchers_decile,\n    fullmvh.dole,\n    fullmvh.dole_decile,\n    fullmvh.twister,\n    fullmvh.twister_decile,\n    fullmvh.quaker_grits_new_buyers,\n    fullmvh.quaker_grits_new_buyers_decile,\n    fullmvh.macro_category_multi_pack_buyers,\n    fullmvh.macro_category_multi_pack_buyers_decile,\n    fullmvh.frutly,\n    fullmvh.frutly_decile,\n    fullmvh.flavored_enhanced_water,\n    fullmvh.flavored_enhanced_water_decile,\n    fullmvh.shelf_stable_juice_drinks,\n    fullmvh.shelf_stable_juice_drinks_decile,\n    --\n    fullmvh.smart_water_centile,\n    fullmvh.energy_csd_zero_calorie_centile,\n    fullmvh.csd_total_centile,\n    fullmvh.doritos_centile,\n    fullmvh.energy_drinks_centile,\n    fullmvh.gatorade_centile,\n    fullmvh.lays_centile,\n    fullmvh.lipton_base_centile,\n    fullmvh.lipton_brisk_centile,\n    fullmvh.mt_dew_centile,\n    fullmvh.mtn_dew_kickstart_centile,\n    fullmvh.nuts_centile,\n    fullmvh.pepsi_diet_centile,\n    fullmvh.pepsi_regular_centile,\n    fullmvh.performance_bars_centile,\n    fullmvh.pepsico_protein_powder_centile,\n    fullmvh.propel_centile,\n    fullmvh.quaker_oatmeal_centile,\n    fullmvh.rte_cereal_centile,\n    fullmvh.ruffles_centile,\n    fullmvh.bottled_water_centile,\n    fullmvh.starbucks_tripleshot_centile,\n    fullmvh.funyuns_centile,\n    fullmvh.chilled_tea_centile,\n    fullmvh.coffee_rtd_centile,\n    fullmvh.online_delivery_centile,\n    fullmvh.csd_singles_centile,\n    fullmvh.flv_csd_ex_dew_pepper_centile,\n    fullmvh.rtd_protein_centile,\n    fullmvh.sodastream_centile,\n    fullmvh.gamefuel_centile,\n    fullmvh.mainstream_kettle_chips_centile,\n    fullmvh.lipton_pure_leaf_centile,\n    fullmvh.mainstream_juices_centile,\n    fullmvh.mt_dew_flv_seek_centile,\n    fullmvh.instant_quaker_oats_centile,\n    fullmvh.naked_protein_centile,\n    fullmvh.pepsi_zero_coke_zero_centile,\n    fullmvh.prem_juice_drinks_centile,\n    fullmvh.lightly_flavored_tortilla_chips_centile,\n    fullmvh.doubleshot_javam_centile,\n    fullmvh.food_bev_centile,\n    fullmvh.ncb_innovation_centile,\n    fullmvh.premium_csd_centile,\n    fullmvh.premium_tea_centile,\n    fullmvh.premium_water_centile,\n    fullmvh.probiotic_juices_centile,\n    fullmvh.lays_poppables_centile,\n    fullmvh.alternative_tortilla_chips_centile,\n    fullmvh.snack_bars_centile,\n    fullmvh.sparkling_water_centile,\n    fullmvh.dips_as_meal_enhancers_centile,\n    fullmvh.stacys_centile,\n    fullmvh.sunchips_centile,\n    fullmvh.super_premium_juices_centile,\n    fullmvh.tostitos_centile,\n    fullmvh.flavor_camp_bbq_centile,\n    fullmvh.plant_based_rtd_protein_centile,\n    fullmvh.veggie_chips_centile,\n    fullmvh.g_organic_centile,\n    fullmvh.mountain_dew_baja_blast_centile,\n    fullmvh.cold_brew_centile,\n    fullmvh.bubly_centile,\n    fullmvh.ultra_premium_juice_centile,\n    fullmvh.lightly_salted_chips_centile,\n    fullmvh.flavor_camp_cheese_centile,\n    fullmvh.sabra_hummus_tubs_centile,\n    fullmvh.oj_category_switchers_centile,\n    fullmvh.standard_quaker_oats_centile,\n    fullmvh.csd_multiserve_centile,\n    fullmvh.dew_ice_centile,\n    fullmvh.flavor_camp_dairy_centile,\n    fullmvh.online_curbside_pickup_centile,\n    fullmvh.flavor_camp_herb_spice_veggie_centile,\n    fullmvh.flv_salty_snacks_centile,\n    fullmvh.g2_centile,\n    fullmvh.flavor_camp_salted_plain_centile,\n    fullmvh.keto_cookies_centile,\n    fullmvh.low_fat_salty_snacks_centile,\n    fullmvh.aha_centile,\n    fullmvh.plant_based_protein_powder_centile,\n    fullmvh.pretzel_category_centile,\n    fullmvh.flavor_camp_spicy_burn_centile,\n    fullmvh.dots_pretzels_centile,\n    fullmvh.santitas_centile,\n    fullmvh.flavor_camp_tangy_centile,\n    fullmvh.tropicana_probiotics_purchasers_centile,\n    fullmvh.tropicana_pure_premium_purchasers_centile,\n    fullmvh.rfg_yogurt_drinks_centile,\n    fullmvh.flavor_camp_aggregate_all_intense_bold_centile,\n    fullmvh.total_regular_cola_centile,\n    fullmvh.flavor_camp_meat_centile,\n    fullmvh.fritos_original_centile,\n    fullmvh.flavored_pretzels_centile,\n    fullmvh.nutrition_engaged_centile,\n    fullmvh.mainstream_engaged_centile,\n    fullmvh.oj_category_centile,\n    fullmvh.nutrition_bars_centile,\n    fullmvh.oatmeal_category_centile,\n    fullmvh.alt_dairy_category_centile,\n    fullmvh.kombucha_functional_juices_centile,\n    fullmvh.single_serve_mainstream_juice_centile,\n    fullmvh.quaker_grits_centile,\n    fullmvh.shelf_stable_dips_category_centile,\n    fullmvh.fruit_snacks_centile,\n    fullmvh.fritos_flavor_centile,\n    fullmvh.kevita_purchasers_centile,\n    fullmvh.heart_claim_centile,\n    fullmvh.starbucks_frappuccino_centile,\n    fullmvh.single_serve_salty_snacks_centile,\n    fullmvh.cholesterol_claim_centile,\n    fullmvh.g_zero_centile,\n    fullmvh.diet_csds_centile,\n    fullmvh.candy_category_centile,\n    fullmvh.frozen_fruit_category_centile,\n    fullmvh.salty_snacks_centile,\n    fullmvh.premium_greek_yogurt_centile,\n    fullmvh.rice_pasta_ethnic_spclty_centile,\n    fullmvh.pancake_mix_syrup_centile,\n    fullmvh.lite_snacks_centile,\n    fullmvh.herbal_tea_centile,\n    fullmvh.tazo_centile,\n    fullmvh.mini_cans_centile,\n    fullmvh.unflavored_pretzels_centile,\n    fullmvh.bodyarmor_centile,\n    fullmvh.organic_food_bev_buyers_centile,\n    fullmvh.fritos_scoops_centile,\n    fullmvh.grain_claim_centile,\n    fullmvh.diet_coke_centile,\n    fullmvh.online_in_store_pickup_centile,\n    fullmvh.bare_centile,\n    fullmvh.off_the_eaten_path_centile,\n    fullmvh.rte_cereal_all_family_centile,\n    fullmvh.rte_cereal_kids_centile,\n    fullmvh.instant_quaker_oats_light_lapsed_centile,\n    fullmvh.celsius_energy_centile,\n    fullmvh.doritos_h_and_s_centile,\n    fullmvh.premium_kettle_chips_centile,\n    fullmvh.chewy_kids_snacking_centile,\n    fullmvh.starbucks_nitro_centile,\n    fullmvh.premium_lrb_centile,\n    fullmvh.rte_popcorn_full_flavor_centile,\n    fullmvh.rte_popcorn_light_flavor_centile,\n    fullmvh.breakfast_cereal_snack_bars_centile,\n    fullmvh.sports_drinks_centile,\n    fullmvh.takis_centile,\n    fullmvh.lacroix_centile,\n    fullmvh.manzanita_sol_centile,\n    fullmvh.unflavored_tortilla_chips_centile,\n    fullmvh.crush_centile,\n    fullmvh.chewy_centile,\n    fullmvh.rockstar_energy_centile,\n    fullmvh.light_holiday_salty_snack_buyers_centile,\n    fullmvh.medium_holiday_salty_snack_buyers_centile,\n    fullmvh.xxvl_single_serve_snacks_centile,\n    fullmvh.svlr_single_serve_snacks_centile,\n    fullmvh.lss_single_serve_snacks_centile,\n    fullmvh.bolt_24_centile,\n    fullmvh.lemonade_centile,\n    fullmvh.gamesa_cookies_centile,\n    fullmvh.kids_organic_centile,\n    fullmvh.rice_crisps_cakes_centile,\n    fullmvh.health_warrior_centile,\n    fullmvh.simple_nutrition_centile,\n    fullmvh.naked_centile,\n    fullmvh.yogurt_centile,\n    fullmvh.online_edible_centile,\n    fullmvh.better_for_you_bagged_snacks_centile,\n    fullmvh.vanilla_flavored_rtd_coffee_centile,\n    fullmvh.frozen_dips_centile,\n    fullmvh.caramel_flavored_rtd_coffee_centile,\n    fullmvh.coffee_flavored_rtd_coffee_centile,\n    fullmvh.lays_stax_centile,\n    fullmvh.popcorners_centile,\n    fullmvh.shelf_stable_dairy_dips_centile,\n    fullmvh.probiotic_attribute_centile,\n    fullmvh.essentia_centile,\n    fullmvh.core_centile,\n    fullmvh.dasani_centile,\n    fullmvh.shelf_stable_salsa_centile,\n    fullmvh.shelf_stable_cheese_dips_centile,\n    fullmvh.shelf_stable_bean_dips_centile,\n    fullmvh.cheetos_cheese_core_centile,\n    fullmvh.frito_lay_multipack_centile,\n    fullmvh.cheetos_flamin_hot_core_centile,\n    fullmvh.muscle_milk_centile,\n    fullmvh.kst_regular_coke_transitioner_centile,\n    fullmvh.kst_frequent_diet_pepsi_transitioner_centile,\n    fullmvh.kst_hispanic_pepsi_drinker_centile,\n    fullmvh.kst_light_cola_drinker_centile,\n    fullmvh.kst_frequent_blue_pepsi_drinker_centile,\n    fullmvh.kst_non_cola_drinkers_centile,\n    fullmvh.macaroni_and_cheese_centile,\n    fullmvh.heat_and_eat_centile,\n    fullmvh.instant_rice_pasta_grains_centile,\n    fullmvh.better_for_you_crackers_centile,\n    fullmvh.zero_calorie_csd_centile,\n    fullmvh.wavy_lays_centile,\n    fullmvh.multiserve_starbucks_centile,\n    fullmvh.tea_bags_centile,\n    fullmvh.rfg_dips_centile,\n    fullmvh.sleeping_remedies_centile,\n    fullmvh.adaptogens_centile,\n    fullmvh.easy_wellness_centile,\n    fullmvh.bang_centile,\n    fullmvh.kevita_adjacencies_centile,\n    fullmvh.caffeine_attribute_centile,\n    fullmvh.vitamin_c_attribute_centile,\n    fullmvh.antioxidant_attribute_centile,\n    fullmvh.poland_spring_centile,\n    fullmvh.polar_centile,\n    fullmvh.diet_coke_decliners_centile,\n    fullmvh.sprite_and_fanta_decliners_centile,\n    fullmvh.rap_snacks_centile,\n    fullmvh.cheetos_crunchy_centile,\n    fullmvh.cheetos_puffs_centile,\n    fullmvh.lays_classic_centile,\n    fullmvh.premium_cocktail_mixers_centile,\n    fullmvh.baken_ets_centile,\n    fullmvh.mainstream_mixers_centile,\n    fullmvh.quaker_hots_light_lapsed_centile,\n    fullmvh.zone_in_shopper_centile,\n    fullmvh.root_beer_centile,\n    fullmvh.coke_centile,\n    fullmvh.premium_cheese_snacks_centile,\n    fullmvh.stacys_thins_centile,\n    fullmvh.stacys_core_centile,\n    fullmvh.diet_mountain_dew_centile,\n    fullmvh.sparkling_ice_centile,\n    fullmvh.granola_centile,\n    fullmvh.aj_pancake_mix_and_syrup_centile,\n    fullmvh.rte_cereal_adult_centile,\n    fullmvh.kids_ambient_juices_centile,\n    fullmvh.non_lemonade_juice_drinks_centile,\n    fullmvh.cheetos_mac_n_cheese_centile,\n    fullmvh.hispanic_cookies_centile,\n    fullmvh.gamesa_crackers_centile,\n    fullmvh.naked_juice_lapsed_buyers_centile,\n    fullmvh.natural_attribute_centile,\n    fullmvh.protein_attribute_centile,\n    fullmvh.calcium_attribute_centile,\n    fullmvh.fiber_centile,\n    fullmvh.gluten_free_centile,\n    fullmvh.low_sodium_centile,\n    fullmvh.no_added_sugar_centile,\n    fullmvh.simply_centile,\n    fullmvh.baked_centile,\n    fullmvh.non_gmo_centile,\n    fullmvh.mt_dew_total_centile,\n    fullmvh.keto_dieters_centile,\n    fullmvh.party_people_centile,\n    fullmvh.cold_and_flu_preppers_centile,\n    fullmvh.condiments_and_sauces_centile,\n    fullmvh.flavored_csds_centile,\n    fullmvh.holiday_hosts_centile,\n    fullmvh.immunity_boosters_centile,\n    fullmvh.new_years_dieters_centile,\n    fullmvh.new_years_partiers_centile,\n    fullmvh.plant_based_buyers_centile,\n    fullmvh.summer_grillers_centile,\n    fullmvh.super_bowl_hosts_centile,\n    fullmvh.thanksgiving_hosts_centile,\n    fullmvh.hard_coffee_centile,\n    fullmvh.hard_flavored_bevs_xlemonade_centile,\n    fullmvh.hard_kombucha_centile,\n    fullmvh.hard_lemonade_centile,\n    fullmvh.hard_seltzer_centile,\n    fullmvh.health_warrior_competitive_products_centile,\n    fullmvh.other_hmb_centile,\n    fullmvh.cookies_centile,\n    fullmvh.crackers_centile,\n    fullmvh.trop_premium_juice_drinks_centile,\n    fullmvh.wine_centile,\n    fullmvh.spirits_liquor_centile,\n    fullmvh.premade_cocktails_coolers_centile,\n    fullmvh.domestic_beer_centile,\n    fullmvh.imported_beer_centile,\n    fullmvh.flavored_malt_beverages_centile,\n    fullmvh.ambient_juice_centile,\n    fullmvh.new_rtd_tea_buyers_buying_lipton_centile,\n    fullmvh.rtd_tea_buyers_switching_to_lipton_centile,\n    fullmvh.sabritas_centile,\n    fullmvh.cbd_product_purchasers_centile,\n    fullmvh.dr_pepper_centile,\n    fullmvh.coffee_beans_centile,\n    fullmvh.hispanic_aisle_centile,\n    fullmvh.functional_juice_kombucha_switchers_centile,\n    fullmvh.dole_centile,\n    fullmvh.twister_centile,\n    fullmvh.quaker_grits_new_buyers_centile,\n    fullmvh.macro_category_multi_pack_buyers_centile,\n    fullmvh.frutly_centile,\n    fullmvh.flavored_enhanced_water_centile,\n    fullmvh.shelf_stable_juice_drinks_centile,\n    fullmvh.fb_dollars_hh,\n    fullmvh.fb_units_hh,\n    fullmvh.fb_trips_hh,\n    fullmvh.fb_dollar_index\nFROM {{ ref('exp_geo_is_cg_fvh_iri') }} fullmvh,\n     {{ ref('is_percentile') }} perapp", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "trifecta", "trifecta_is_cap"], "unique_id": "model.sdna_project.trifecta_is_cap", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/trifecta/trifecta_is_cap.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/trifecta/trifecta_is_cap.sql", "name": "trifecta_is_cap", "resource_type": "model", "alias": "trifecta_is_cap", "checksum": {"name": "sha256", "checksum": "4425be526e6d98f2dfceca129601754a8de8e38a41a121a43fafcc1134e70964"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["exp_geo_is_cg_fvh_iri"], ["is_percentile"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.exp_geo_is_cg_fvh_iri", "model.sdna_project.is_percentile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.trifecta_is_cap_iri_adjf_avbl": {"raw_sql": "SELECT\n    cv_living_unit_id,\n    cv_address_id,\n    cv_short_city_name,\n    cv_city_name,\n    cv_county_name,\n    cv_state_abb,\n    cv_zipcode_5,\n    cv_zipcode_4,\n    cv_zipcode_9,\n    cv_zip_locality,\n    cv_delvy_pt_bar_cd,\n    cv_carr_route,\n    cv_state_cd,\n    cv_county_cd,\n    cv_cen2010_tract_block_grp,\n    cv_cen2010_blockid,\n    cv_latitude,\n    cv_longitude,\n    cv_mat_level_geodata,\n    cv_addr_qlty_ind,\n    cv_recp_reliable_cd,\n    cv_acty_dt,\n    cv_tme_zn,\n    cv_p1_pid,\n    cv_p1_ptyp,\n    cv_p1_etnc_etnc,\n    cv_p1_etnc_exp_grp,\n    cv_p1_etnc_religion,\n    cv_p1_etnc_lang_pref,\n    cv_p1_etnc_grp,\n    cv_p1_etnc_country_of_origin,\n    cv_p1_gender,\n    cv_p1_birth_dt,\n    cv_p1_est_age,\n    cv_p1_exact_age,\n    cv_p1_com_age,\n    cv_p1_edu_mdl,\n    cv_p1_marital_st,\n    cv_p1_occ_grp,\n    cv_p1_occ_cd,\n    cv_p1_bus_own,\n    cv_p2_pid,\n    cv_p2_ptyp,\n    cv_p2_etnc_etnc,\n    cv_p2_etnc_exp_grp,\n    cv_p2_etnc_religion,\n    cv_p2_etnc_lang_pref,\n    cv_p2_etnc_grp,\n    cv_p2_etnc_country_of_origin,\n    cv_p2_gender,\n    cv_p2_birth_dt,\n    cv_p2_est_age,\n    cv_p2_exact_age,\n    cv_p2_com_age,\n    cv_p2_edu_mdl,\n    cv_p2_marital_st,\n    cv_p2_occ_grp,\n    cv_p2_occ_cd,\n    cv_p2_bus_own,\n    cv_p3_pid,\n    cv_p3_ptyp,\n    cv_p3_etnc_etnc,\n    cv_p3_etnc_exp_grp,\n    cv_p3_etnc_religion,\n    cv_p3_etnc_lang_pref,\n    cv_p3_etnc_grp,\n    cv_p3_etnc_country_of_origin,\n    cv_p3_gender,\n    cv_p3_birth_dt,\n    cv_p3_est_age,\n    cv_p3_exact_age,\n    cv_p3_com_age,\n    cv_p3_edu_mdl,\n    cv_p3_marital_st,\n    cv_p3_occ_grp,\n    cv_p3_occ_cd,\n    cv_p3_bus_own,\n    cv_p4_pid,\n    cv_p4_ptyp,\n    cv_p4_etnc_etnc,\n    cv_p4_etnc_exp_grp,\n    cv_p4_etnc_religion,\n    cv_p4_etnc_lang_pref,\n    cv_p4_etnc_grp,\n    cv_p4_etnc_country_of_origin,\n    cv_p4_gender,\n    cv_p4_birth_dt,\n    cv_p4_est_age,\n    cv_p4_exact_age,\n    cv_p4_com_age,\n    cv_p4_edu_mdl,\n    cv_p4_marital_st,\n    cv_p4_occ_grp,\n    cv_p4_occ_cd,\n    cv_p4_bus_own,\n    cv_p5_pid,\n    cv_p5_ptyp,\n    cv_p5_etnc_etnc,\n    cv_p5_etnc_exp_grp,\n    cv_p5_etnc_religion,\n    cv_p5_etnc_lang_pref,\n    cv_p5_etnc_grp,\n    cv_p5_etnc_country_of_origin,\n    cv_p5_gender,\n    cv_p5_birth_dt,\n    cv_p5_est_age,\n    cv_p5_exact_age,\n    cv_p5_com_age,\n    cv_p5_edu_mdl,\n    cv_p5_marital_st,\n    cv_p5_occ_grp,\n    cv_p5_occ_cd,\n    cv_p5_bus_own,\n    cv_p6_pid,\n    cv_p6_ptyp,\n    cv_p6_etnc_etnc,\n    cv_p6_etnc_exp_grp,\n    cv_p6_etnc_religion,\n    cv_p6_etnc_lang_pref,\n    cv_p6_etnc_grp,\n    cv_p6_etnc_country_of_origin,\n    cv_p6_gender,\n    cv_p6_birth_dt,\n    cv_p6_est_age,\n    cv_p6_exact_age,\n    cv_p6_com_age,\n    cv_p6_edu_mdl,\n    cv_p6_marital_st,\n    cv_p6_occ_grp,\n    cv_p6_occ_cd,\n    cv_p6_bus_own,\n    cv_mor,\n    cv_mor_bank_book,\n    cv_mor_bank_spl_food,\n    cv_mor_bank_craft_merch,\n    cv_mor_bank_culinary_int,\n    cv_mor_bank_dedupe_hit,\n    cv_mor_bank_doit_yourself,\n    cv_mor_bank_famgen_mag,\n    cv_mor_bank_f_merch,\n    cv_mor_bank_f_orient_mag,\n    cv_mor_bank_gar_farm_buy,\n    cv_mor_bank_gar_farm_mag,\n    cv_mor_bank_gen_contrib,\n    cv_mor_bank_gen_merch,\n    cv_mor_bank_gift_gadgs,\n    cv_mor_bank_health_inst_contib,\n    cv_mor_bank_health_fit_mag,\n    cv_mor_bank_m_merch,\n    cv_mor_bank_m_sports_mag,\n    cv_mor_bank_misc,\n    cv_mor_bank_nondedupe_hit,\n    cv_mor_bank_odds_end,\n    cv_mor_bank_opp_seek_ce,\n    cv_mor_bank_photograph,\n    cv_mor_bank_political_cont,\n    cv_mor_bank_religious_cont,\n    cv_mor_bank_religious_mag,\n    cv_mor_bank_upscale_merch,\n    cv_mor_bank_news_finan,\n    cv_ncoa_cd,\n    cv_ncoa_dt,\n    cv_green_aware,\n    cv_green_aware_deciles,\n    cv_no_adults_unit,\n    cv_no_pers_unit,\n    cv_no_child_unit,\n    cv_child_age_0_3,\n    cv_child_age_4_6,\n    cv_child_age_7_9,\n    cv_child_age_10_12,\n    cv_child_age_13_15,\n    cv_child_age_16_18,\n    cv_mosaic_household,\n    cv_mosaic_zip4,\n    cv_home_bus,\n    cv_dwelling_type,\n    cv_dwelling_unit_size,\n    cv_length_of_residence,\n    cv_household_comp,\n    cv_hmeown_hmeown,\n    cv_hmeown_prob_hmeown,\n    cv_hmeown_comb_hmeown_renter,\n    cv_est_curr_hme_val,\n    cv_est_curr_hme_val_range,\n    cv_cons_vw_proft,\n    cv_incom_per_national,\n    cv_county_ehi_per,\n    cv_auto_in_market_new,\n    cv_aut_mark_used,\n    cv_aut_mark_used_0_5_vehicle,\n    cv_aut_mark_used_11_vehicle,\n    cv_aut_mark_used_6_10_vehicle,\n    cv_est_inc_amtv5,\n    cv_est_hh_incv5,\n    cv_county_echv_index,\n    cv_county_echv_per,\n    cv_state_ehi_index,\n    cv_county_ehi_index,\n    cv_cen_rur_urban_county_szcd,\n    cv_cbsa,\n    cv_cbsa_type,\n    cv_cape_edu_ispsa,\n    cv_cape_edu_ispsa_decile,\n    cv_cape_inc_fam_state_decile,\n    cv_cape_dens_per_per_pop,\n    cv_cape_age_pop_0_17,\n    cv_cape_age_pop_0_4,\n    cv_cape_age_pop_5_9,\n    cv_cape_age_pop_10_13,\n    cv_cape_age_pop_14_17,\n    cv_cape_age_pop_18_99,\n    cv_cape_age_pop_65_99,\n    cv_cape_age_pop_median_age,\n    cv_cape_built_median_hous_age,\n    cv_cape_child_couple_famw_lt18,\n    cv_cape_child_couple_famwo_lt18,\n    cv_cape_child_wper_lt18,\n    cv_cape_edu_pop25_med_edu_attain,\n    cv_cape_occ_empid_health_tech,\n    cv_cape_ethnic_pop_black_only,\n    cv_cape_ethnic_pop_asian_only,\n    cv_cape_ethnic_pop_hispanic,\n    cv_cape_ethnic_pop_white_only,\n    cv_cape_avg_hh_size,\n    cv_cape_oohu_med_hme_val,\n    cv_cape_hu_mob_hme,\n    cv_cape_med_fam_hh_inc,\n    cv_cape_lang_spanish_speak,\n    cv_cape_occhu_own_occu,\n    cv_cape_oochu_rent_occu,\n    cv_cape_marr_couple_fam,\n    cv_hh_int_read_bible_devo,\n    cv_hh_pc_use_net_service,\n    cv_hh_crafts,\n    cv_hh_finan_stks_bond,\n    cv_hh_finan_cds_money_mkt,\n    cv_hh_finan_iras_currently,\n    cv_hh_finan_mutual_funds,\n    cv_hh_finan_real_estate,\n    cv_act_amusement_park_visit,\n    cv_act_zoo_visit,\n    cv_act_coffee_connoisseurs,\n    cv_act_wine_lover,\n    cv_act_doit_yourself,\n    cv_act_hme_imp_spenders,\n    cv_act_hunt_enthus,\n    cv_act_digi_mag_buyer,\n    cv_act_attend_edu_pgm,\n    cv_act_video_gamer,\n    cv_act_mlb_enthus,\n    cv_act_nascar_enthus,\n    cv_act_nba_enthus,\n    cv_act_nfl_enthus,\n    cv_act_nhl_enthus,\n    cv_act_pga_tour_enthus,\n    cv_act_politics_viewing_tv_lib,\n    cv_act_politics_viewing_tv_libcom,\n    cv_act_politics_viewing_tv_conserv,\n    cv_act_eats_fam_restaurant,\n    cv_act_eats_ff_restaurant,\n    cv_act_canoeing_kayaking,\n    cv_act_play_golf,\n    cv_act_gourment_cooking,\n    cv_act_cat_owners,\n    cv_act_dog_owners,\n    cv_act_pet_enthus,\n    cv_act_arts_crafts,\n    cv_act_scrapbooking,\n    cv_act_cultural_arts,\n    cv_hobbies_gardening,\n    cv_act_photography,\n    cv_act_book_reader,\n    cv_act_ebook_reader,\n    cv_act_audiobook_reader,\n    cv_act_avid_runners,\n    cv_act_outdoor_enthus,\n    cv_act_fishing,\n    cv_act_snow_sport,\n    cv_act_boating,\n    cv_act_plays_hockey,\n    cv_act_plays_soccer,\n    cv_act_plays_tennis,\n    cv_act_sport_enthusiast,\n    cv_act_healthy_living,\n    cv_act_fitness_enthus,\n    cv_act_on_diet,\n    cv_act_weight_conscious,\n    cv_act_casino_gambling,\n    cv_act_sweepstakes_lottery,\n    cv_act_music_download,\n    cv_act_music_stream,\n    cv_act_listen_christian_music,\n    cv_act_listen_classical_music,\n    cv_act_listen_country_music,\n    cv_act_listen_music,\n    cv_act_listen_oldies_music,\n    cv_act_listen_rock_music,\n    cv_act_listen_80s_music,\n    cv_act_listen_hiphop_music,\n    cv_act_listen_alter_music,\n    cv_act_listen_jazz_music,\n    cv_act_listen_pop_music,\n    cv_buyer_lap_own,\n    cv_buyer_security_sys_own,\n    cv_buyer_tab_own,\n    cv_buyer_coupon_users,\n    cv_buyer_lux_store_shopp,\n    cv_buyer_lux_hme_goods_shopp,\n    cv_buyer_yng_adult_cloth_shopp,\n    cv_buyer_supercenter_shopp,\n    cv_buyer_warehouse_club_mem,\n    cv_buyer_loyalty_card_usr,\n    cv_buyer_presence_auto,\n    cv_buyer_nonpres_makeup_usr,\n    cv_buyer_pres_makeup_usr,\n    cv_buyer_highend_spirit_drinker,\n    cv_lfstyl_lf_insure_plcy_hldr,\n    cv_lfstyl_med_insure_plcy_hldrs,\n    cv_lfstyl_medicare_plcy_hldrs,\n    cv_lfstyl_have_grand_child,\n    cv_lfstyl_high_freq_business_trav,\n    cv_lfstyl_high_freq_cruise_enthus,\n    cv_lfstyl_high_freq_domes_vacationer,\n    cv_lfstyl_high_freq_forgn_vacationer,\n    cv_lfstyl_freq_fly_pgm_mem,\n    cv_lfstyl_hostel_guest_loyal_pgm,\n    cv_lfstyl_interest_religion,\n    cv_lfstyl_military_act,\n    cv_lfstyl_military_inact,\n    cv_donor_contrib_charities,\n    cv_donor_contrib_arts_charities,\n    cv_donor_contrib_edu_charities,\n    cv_donor_contrib_health_charities,\n    cv_donor_contrib_political_charities,\n    cv_donor_contrib_pvt_found,\n    cv_donor_contrib_volunteer,\n    cv_finan_debit_card_usr,\n    cv_finan_corp_credit_card_usr,\n    cv_finan_major_credit_card_usr,\n    cv_finan_premium_credit_card_usr,\n    cv_finan_credit_card_usr,\n    cv_finan_store_credit_card_usr,\n    cv_invest_retire_finan_plan,\n    cv_invest_part_online_trade,\n    cv_invest_brokerage_acct_own,\n    cv_invest_actv_investor,\n    cv_invest_mutual_fund_invest,\n    cv_memship_aarp_mem,\n    cv_memship_union_mem,\n    cv_tt_email,\n    -- Removed old cv_tt_* columns and added new cv_tt_* for MVH Q2 2020 refresh\n     --cv_tt_savvy_research,\n    --cv_tt_organic_natural,\n    --cv_tt_brand_loyal,\n    --cv_tt_trendsetter,\n    --cv_tt_deal_seeker,\n    --cv_tt_recreation_shopper,\n    --cv_tt_quality_matters,\n    --cv_tt_moment_shopper,\n    --cv_tt_mainstream_adapter,\n    --cv_tt_novelty_seek,\n    --cv_tt_conv_online_deal_vouch,\n    --cv_tt_conv_disc_supercenter,\n    --cv_tt_conv_ebid_sites,\n    --cv_tt_conv_etail_only,\n    --cv_tt_conv_mid_hi_end_store,\n    --cv_tt_conv_spclty_dept_store,\n    --cv_tt_conv_spclty_boutique,\n    --cv_tt_conv_wholesale,\n    --cv_tt_eng_broadcast_cabletv,\n    --cv_tt_eng_digit_display,\n    --cv_tt_eng_digit_newspaper,\n    --cv_tt_eng_digit_video,\n    --cv_tt_eng_direct_mail,\n    --cv_tt_eng_sms_mms,\n    --cv_tt_eng_radio,\n    --cv_tt_eng_stream_tv,\n    --cv_tt_eng_trad_newspaper,\n    cv_p1_retail_shopp,\n    cv_p2_retail_shopp,\n    cv_p3_retail_shopp,\n    cv_p4_retail_shopp,\n    cv_p5_retail_shopp,\n    cv_p6_retail_shopp,\n    cv_p1_health_well_being,\n    cv_p2_health_well_being,\n    cv_p3_health_well_being,\n    cv_p4_health_well_being,\n    cv_p5_health_well_being,\n    cv_p6_health_well_being,\n    cv_p1_mobile_usrs,\n    cv_p2_mobile_usrs,\n    cv_p3_mobile_usrs,\n    cv_p4_mobile_usrs,\n    cv_p5_mobile_usrs,\n    cv_p6_mobile_usrs,\n    cv_p1_tech_adoption,\n    cv_p2_tech_adoption,\n    cv_p3_tech_adoption,\n    cv_p4_tech_adoption,\n    cv_p5_tech_adoption,\n    cv_p6_tech_adoption,\n    cv_p1_mor,\n    cv_p2_mor,\n    cv_p3_mor,\n    cv_p4_mor,\n    cv_p5_mor,\n    cv_p6_mor,\n    cv_mosaic_glob_hh,\n    cv_mosaic_glob_zip4,\n    cv_child_pres_0_18,\n    cv_child_age_0_3_mdl,\n    cv_child_age_scor_0_3,\n    cv_child_age_4_6_mdl,\n    cv_child_age_scor_4_6,\n    cv_child_age_7_9_mdl,\n    cv_child_age_scor_7_9_,\n    cv_child_age_10_12_mdl,\n    cv_child_age_scor_10_12_,\n    cv_child_age_13_15_mdl,\n    cv_child_age_scor_13_15,\n    cv_child_age_16_18_mdl,\n    cv_child_age_scor_16_18_,\n    cv_hh_ail_meds_vis_ctnt_lenses,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bank_cntct_lens_wearer,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bnk_reg_pres_drug_users,--populated with null value from Experian from Q4 2020\n    cv_bhvr_bnk_intrst_vid_dvd,\n    cv_bhvr_bnk_intrst_golf,\n    cv_bhvr_bnk_contri_charities,\n    cv_bhvr_bnk_pet_enthusiast,\n    cv_bhvr_bnk_intrst_cultural_arts,\n    cv_bhvr_bnk_purchased_thu_mail,\n    cv_bhvr_bnk_intrst_fitness,\n    cv_bhvr_bnk_intrst_outdoors,\n    cv_bhvr_bnk_intrst_travel,\n    cv_bhvr_bnk_investors,\n    cv_bhvr_bnk_pres_of_automobile,\n    cv_bhvr_bnk_pres_of_credit_card,\n    cv_bhvr_bnk_intrst_gardening,\n    cv_bhvr_bnk_intrst_crafts,\n    cv_bhvr_bnk_collectors,\n    cv_bhvr_bnk_cruise_enthusiasts,\n    cv_bhvr_bnk_intrst_sports,\n    cv_bhvr_bnk_intrst_grmt_cooking,\n    cv_bhvr_bnk_sweepstakes_gambling,\n    cv_bhvr_bnk_intrst_politics,\n    cv_bhvr_bnk_intrst_music,\n    cv_bhvr_bnk_intrst_reading,\n    cv_bhvr_bnk_child_parenting_prod,\n    cv_bhvr_bnk_do_it_yourselfer,\n    cv_bhvr_bnk_self_improvement,\n    cv_bhvr_bnk_intrst_in_religion,\n    cv_bhvr_bnk_grandparent,\n    cv_bhvr_bnk_intrst_clothing,\n    cv_bhvr_bnk_donates_envrn_causes,\n    cv_bhvr_bnk_invests_mutual_funds,\n    cv_bhvr_bnk_wght_conscious,\n    cv_bhvr_bnk_mail_order_multibuyer,\n    cv_bhvr_bnk_dog_enthusiasts,\n    cv_bhvr_bnk_cat_enthusiasts,\n    cv_bhvr_bnk_hlthy_living,\n    cv_bhvr_bnk_intrst_automotive,\n    cv_bhvr_bnk_intrst_skiing,\n    cv_bhvr_bnk_intrst_boating,\n    cv_bhvr_bnk_pres_of_cell_phone,\n    cv_bhvr_bnk_commn_connectivity,\n    cv_bhvr_bnk_computers,\n    cv_bhvr_bnk_hi_tech_owner,\n    cv_bhvr_bnk_home_decor_furnish,\n    cv_bhvr_bnk_homeentmnt_video,\n    cv_bhvr_bnk_kitchen_aids_applns,\n    cv_bhvr_bnk_mo_buyer_music_video,\n    cv_bhvr_bnk_mob_books,\n    cv_bhvr_bnk_mo_buyer_cloth_shoe,\n    cv_bhvr_bnk_mob_ins_fin,\n    cv_bhvr_bnk_mail_order_buyer_gift,\n    cv_bhvr_bnk_mob_grdng,\n    cv_bhvr_bnk_mob_jewelry,\n    cv_bhvr_bnk_clas_opra_big_bnd_mus,\n    cv_bhvr_bnk_country_music,\n    cv_bhvr_bnk_christian_music,\n    cv_bhvr_bnk_rock_music,\n    cv_bhvr_bnk_internet_online_subs,\n    cv_bhvr_bnk_intrst_photo,\n    cv_bhvr_bnk_purchase_via_online,\n    cv_bhvr_bnk_intrst_affluence_ls,\n    cv_bhvr_bnk_domestic_traveler,\n    cv_bhvr_bnk_foreign_traveler,\n    cv_bhvr_bnk_pres_of_prem_cc,\n    cv_bhvr_bnk_active_military,\n    cv_bhvr_bnk_inactive_military,\n    cv_hh_acty_int_hob_photography,\n    cv_hh_acty_int_hobbies_gardening,\n    cv_hh_acty_int_hob_home_ws_diy,\n    cv_hh_acty_int_hob_cars_auto_rep,\n    cv_hh_acty_int_hob_bird_watching,\n    cv_hh_acty_int_hob_self_imprvmnt,\n    cv_hh_acty_int_music_chrstn_gosp,\n    cv_hh_acty_int_music_r_and_b,\n    cv_hh_acty_int_music_jazz_new_age,\n    cv_hh_acty_int_music_classical,\n    cv_hh_acty_int_music_rock_n_roll,\n    cv_hh_acty_int_music_country,\n    cv_hh_acty_int_music_in_gen,\n    cv_hh_acty_int_music_other_music,\n    cv_hh_acty_int_read_bs_fiction,\n    cv_hh_acty_int_childrens_reading,\n    cv_hh_acty_int_reading_computer,\n    cv_hh_acty_int_read_cook_culinary,\n    cv_hh_acty_int_reading_country_ls,\n    cv_hh_acty_int_read_entmnt_ppl,\n    cv_hh_acty_int_reading_fashion,\n    cv_hh_acty_int_reading_history,\n    cv_hh_acty_int_read_intr_decor,\n    cv_hh_acty_int_read_med_hlth,\n    cv_hh_acty_int_reading_military,\n    cv_hh_acty_int_reading_mystery,\n    cv_hh_acty_int_read_ntrl_hlth_rmd,\n    cv_hh_acty_int_reading_romance,\n    cv_hh_acty_int_read_sc_fiction,\n    cv_hh_acty_int_read_sc_tech,\n    cv_hh_acty_int_sports_read,\n    cv_hh_acty_int_read_wrld_news_pol,\n    cv_hh_acty_int_book_reader,\n    cv_hh_acty_int_soc_ani_wf_soc,\n    cv_hh_acty_int_soc_env_wildlife,\n    cv_hh_acty_int_soc_pol_cons,\n    cv_hh_acty_int_soc_pol_liberal,\n    cv_hh_acty_int_soc_religion,\n    cv_hh_acty_int_soc_child,\n    cv_hh_acty_int_soc_veterans,\n    cv_hh_acty_int_soc_hlth,\n    cv_hh_acty_int_soc_othr,\n    cv_hh_acty_int_sportsbaseball,\n    cv_hh_acty_int_sportsbasketball,\n    cv_hh_acty_int_sports_rec_hockey,\n    cv_hh_acty_int_sportscampng_hikng,\n    cv_hh_acty_int_sports_rec_hunting,\n    cv_hh_acty_int_sports_rec_fishing,\n    cv_hh_acty_int_sports_rec_nascar,\n    cv_hh_acty_int_sprt_fitness_exer,\n    cv_hh_acty_int_sportsscuba_diving,\n    cv_hh_acty_int_sportsfootball,\n    cv_hh_acty_int_sports_rec_golf,\n    cv_hh_acty_int_sportssnow_skng,\n    cv_hh_acty_int_boating_sailing,\n    cv_hh_acty_int_sports_rec_walking,\n    cv_hh_acty_int_sports_rec_cycling,\n    cv_hh_acty_int_sportsmotorcycles,\n    cv_hh_acty_int_running_jogging,\n    cv_hh_acty_int_sports_rec_soccer,\n    cv_hh_acty_int_sportsswimming,\n    cv_hh_acty_int_play_sprt_in_gen,\n    cv_hh_acty_int_sweepstakes,\n    cv_hh_acty_int_swpstakes_loteries,\n    cv_hh_acty_int_casino_gambling,\n    cv_hh_acty_int_travel_cruise,\n    cv_hh_acty_int_trvl_inter,\n    cv_hh_acty_int_travel_domestic,\n    cv_hh_acty_int_travel_time_share,\n    cv_hh_acty_int_trvl_rec_vehicle,\n    cv_hh_acty_int_rv_travel,\n    cv_hh_acty_int_trvl_bus_trvl,\n    cv_hh_acty_int_trvl_per_trvl,\n    cv_hh_acty_int_pc_i_own_computer,\n    cv_hh_acty_int_pc__i_usedsl_hispd,\n    cv_hh_acty_int_pc_i_plan_buy_comp,\n    cv_hh_acty_int_eg_cell_phone,\n    cv_hh_acty_int_eg_com_disc_player,\n    cv_hh_acty_int_eg_dvd_player,\n    cv_hh_acty_int_eg_satellite_dish,\n    cv_hh_acty_int_eg_dig_cam,\n    cv_hh_acty_int_eg_hdtv,\n    cv_hh_acty_int_eg__electronics,\n    cv_hh_acty_int_eg_pda_blackberry,\n    cv_hh_acty_int_eg_video_camera,\n    cv_hh_acty_int_eg_video_game_sys,\n    cv_hh_acty_int_eg_hom_theater_sys,\n    cv_hh_acty_int_eg_cellph_priphln,\n    cv_hh_acty_int_cltrl_arts,\n    cv_hh_acty_int_magzn_bus_fin,\n    cv_hh_acty_int_childrens_magzn,\n    cv_hh_acty_int_magzn_comp_elctrns,\n    cv_hh_acty_int_magzn_crft_gms_hob,\n    cv_hh_acty_int_magazines_fitness,\n    cv_hh_acty_int_mgzn_fd_wine_ckng,\n    cv_hh_acty_int_magzn_grdng_magzn,\n    cv_hh_acty_int_magzn_hntg_fshng,\n    cv_hh_acty_int_magazines_mens,\n    cv_hh_acty_int_magazines_music,\n    cv_hh_acty_int_mgzn_prtntg_babies,\n    cv_hh_acty_int_mgzn_sports_mgzn,\n    cv_hh_acty_int_magzn_subs,\n    cv_hh_acty_int_magazines_travel,\n    cv_hh_acty_int_magazines_womens,\n    cv_hh_acty_int_magzn_cur_evnt_nws,\n    cv_hh_ls_veh_hav_leased_a_veh,\n    cv_hh_ls_veh_hav_purchased_a_veh,\n    cv_hh_ls_afltn_mem_book_club,\n    cv_hh_ls_afltn_mem_music_club,\n    cv_hh_ls_cc_amer_exp_prem,\n    cv_hh_ls_cc_amer_exp_regular,\n    cv_hh_ls_cc_discover_premium,\n    cv_hh_ls_cc_discover_regular,\n    cv_hh_ls_cc_other_card_premium,\n    cv_hh_ls_cc_other_card_regular,\n    cv_hh_ls_cc_store_ret_reg,\n    cv_hh_ls_cc_visa_regular,\n    cv_hh_ls_cc_mastercard_regular,\n    cv_hh_ls_contri_hmntrn,\n    cv_hh_ls_entmnt_buy_prercrdvideo,\n    cv_hh_ls_entmnt_wtch_cabletv,\n    cv_hh_ls_entmnt_watch_videos,\n    cv_hh_ls_outdoor_lvng_entmnt,\n    cv_hh_ls_entmnt_season_hldy_prod,\n    cv_hh_ls_fin_iras_future_intrst,\n    cv_hh_ls_fin_life_insur_cur,\n    cv_hh_ls_fin_mutl_funds,\n    cv_hh_ls_fin_othr_invest_cur,\n    cv_hh_ls_fin_othr_invest_future,\n    cv_hh_ls_fin_real_estate_fut,\n    cv_hh_ls_fin_stks_bond_fut,\n    cv_hh_ls_grndkids_proud_grndprnt,\n    cv_hh_ls_info_byng_purc_by_intrnt,\n    cv_hh_ls_mil_gov_active_mil_mem,\n    cv_hh_ls_military_gov_vetern,\n    cv_hh_lifestyl_pets_own_a_cat,\n    cv_hh_lifestyl_pets_own_a_dog,\n    cv_hh_lifestyl_pets_own_a_pet,\n    cv_hh_ls_biy_internet,\n    cv_hh_ls_bib_mail,\n    cv_hh_ls_bib_catalog,\n    cv_hh_ls_buying_interest_apparel,\n    cv_hh_ls_buying_intrst_comp_elec,\n    cv_hh_ls_buying_intrst_book_music,\n    cv_hh_ls_bi_home_garden,\n    cv_hh_ls_bi_sports_related,\n    cv_hh_ls_buying_interest_big_tall,\n    cv_hh_ls_byng_intrst_moc,\n    cv_hh_ls_byng_intrst_mog,\n    cv_hh_ls_bi_mail_order_gift,\n    cv_hh_ls_byng_intrst_mjc,\n    cv_hh_ls_bi_mail_music_videos,\n    cv_hh_ls_byng_intrst_mcp,\n    cv_hh_ls_bi_mail_books_magzn,\n    cv_hh_ls_bi_food_and_beverage,\n    cv_hh_ls_bi_home_decorating,\n    cv_hh_ls_bi_furniture,\n    cv_hh_ls_bi_domestics,\n    cv_hh_ls_buying_interest_footwear,\n    cv_hh_ml_ordr_apprl_acsries,\n    cv_cape_age_pop_0_9,\n    cv_cape_age_pop_0_24,\n    cv_cape_age_pop_25_34,\n    cv_cape_age_pop_35_44,\n    cv_cape_age_pop_45_54,\n    cv_cape_age_pop_55_64,\n    cv_cape_age_pop_18_65,\n    cv_cape_age_pop_75_99,\n    cv_cape_pop_med_age_of_adults_18,\n    cv_cape_child_hh_fem_hh_fam_plt18,\n    cv_cape_child_hh_without_per_lt18,\n    cv_cape_cmte_com_travtowrk_60_89,\n    cv_cape_cmter_travtowork_90,\n    cv_cape_cmter_avg_trav_timetowork,\n    cv_cape_cmter_med_trav_timetowork,\n    cv_cape_cmte_wrkrs_carpld_to_work,\n    cv_cape_emply_fem16_lbr_frce,\n    cv_cape_etnc_hh_nonhisp_whte_only,\n    cv_cape_etnc_pop_black_only_hisp,\n    cv_cape_etnc_pop_non_hispanic,\n    cv_cape_etnc_pop_white_only_hisp,\n    cv_cape_inc_hh_inc_under_10k,\n    cv_cape_inc_hh_inc_10_14k,\n    cv_cape_inc_hh_inc_15_19k,\n    cv_cape_inc_hh_inc_20_24k,\n    cv_cape_inc_hh_inc_25_29k,\n    cv_cape_inc_hh_inc_30_34k,\n    cv_cape_inc_hh_inc_35_39k,\n    cv_cape_inc_hh_inc_40_44k,\n    cv_cape_inc_hh_inc_45_49k,\n    cv_cape_inc_hh_inc_50_59k,\n    cv_cape_inc_hh_inc_60_74k,\n    cv_cape_inc_hh_inc_75_99k,\n    cv_cape_inc_hh_inc_100_124k,\n    cv_cape_inc_hh_inc_125_149k,\n    cv_cape_inc_hh_inc_150_199k,\n    cv_cape_inc_hh_inc_200_249k,\n    cv_cape_inc_hh_inc_250_499k,\n    cv_cape_inc_hh_incm_500k_more,\n    cv_cape_inc_hh_med_hh_inc,\n    cv_cape_inc_hh_med_non_fam_hh_inc,\n    cv_cape_inc_pop_per_capita_income,\n    cv_cape_ind_empld_acmdn_food_svcs,\n    cv_cape_ind_empld_adm_supwstemgmt,\n    cv_cape_ind_empld_agr_fst_fsh_hnt,\n    cv_cape_ind_empld_arts_entmnt,\n    cv_cape_indus_empld_construction,\n    cv_cape_ind_empld_edu_srvs,\n    cv_cape_ind_empld_fin_and_ins,\n    cv_cape_indus_empld_hc_soc_ass,\n    cv_cape_indus_empld_information,\n    cv_cape_indus_empld_manufacturing,\n    cv_cape_ind_empld_mgmt_com_entrps,\n    cv_cape_indus_empld_mining,\n    cv_cape_ind_empld_oth_svcs,\n    cv_cape_ind_empld_public_admin,\n    cv_cape_ind_empld_rer_lsng,\n    cv_cape_indus_empld_retail_trade,\n    cv_cape_ind_empld_prof_sc_tch_scs,\n    cv_cape_ind_empld_trans_wh,\n    cv_cape_indus_empld_utilities,\n    cv_cape_ind_empld_wholesale_trade,\n    cv_cape_mrtg_oohu_first_mrtg_only,\n    cv_cape_move_occhu_med_len_res,\n    cv_cape_rent_rntl_median_rent,\n    cv_cape_tenancy_hu_occupied,\n    cv_cape_typ_pop_child_in_fam_hh,\n    cv_cape_typ_pop_in_family_hh,\n    cv_cape_typ_pop_in_non_family_hh,\n    cv_cape_pop_nat_adpt_child_fam_hh,\n    cv_cape_typ_pop_spouse_in_fam_hh,\n    cv_cape_urban_pop_rural_on_farms,\n    cv_cape_urban_pop_rur_not_on_frms,\n    cv_cape_urban_pop_in_urban_area,\n    cv_cape_urban_pop_in_urban_clstrs,\n    cv_cape_inc_fam_inc_state_indx,\n    cv_prop_rlty_home_year_built,\n    cv_mrtg_home_pur_mrtg_term,\n    cv_mrtg_home_pur_home_pur_date,\n    cv_mrtg_home_pur_mrtg_rate_type,\n    cv_mrtg_home_pur_mrtg_loan_type,\n    cv_mrtg_home_purc_type_of_purc,\n    cv_mrtg_home_pur_pur_amt_rng,\n    cv_mrtg_home_pur_mrtg_amt_rng,\n    cv_rlty_mdl_confdnce_cdv2,\n    cv_rlty_mdl_est_avl_equity_cd_v2,\n    cv_rlty_mdl_est_avl_equity_amt_v2,\n    cv_rlty_mdl_est_cur_lntoval_ratv2,\n    cv_rlty_mdl_est_cur_mrtg_pmtv21,\n    cv_rlty_mdl_est_cur_mrtg_pmtv22,\n    cv_rlty_mdl_est_cur_mrtg_amtcdv2,\n    cv_rlty_mdl_est_cur_mrtg_am_v2,\n\n    hh_size,\n    hoh_age,\n    hoh_lifestage,\n    hoh_ethnicity,\n    hoh_hispanic,\n    hh_income,\n    hh_per_cap_income,\n    hh_presence_of_child,\n    hh_presence_of_child_age_0_6,\n    hh_presence_of_child_age_7_12,\n    hh_presence_of_child_age_13_18,\n    hh_age_of_old_child,\n    hh_presence_of_gender,\n    hh_millennial_male,\n    hh_millennial_female,\n    hh_gen_x_male,\n    hh_gen_x_female,\n    hh_young_boomer_male,\n    hh_young_boomer_female,\n    hh_post_boomer_male,\n    hh_post_boomer_female,\n    hh_county_size,\n    hh_urban_suburban_rural,\n    hh_county,\n    hh_state,\n    hh_cbsa,\n    geo_zipcode,\n    geo_cvs,\n    geo_target,\n    geo_aldi,\n    geo_costco,\n    geo_sams_club,\n    geo_7_eleven,\n    geo_circle_k,\n    geo_kroger_banner,\n    geo_all_other_kroger,\n    geo_albertsons_safeway,\n    geo_publix,\n    geo_ahold_delhaize,\n    geo_wakefern,\n    geo_hy_vee,\n    geo_heb,\n    geo_bi_lo,\n    geo_trader_joes,\n    geo_whole_foods,\n    geo_walgreens,\n    geo_wm_neighborhood_market,\n    geo_all_other_walmart,\n    geo_bjs,\n    geo_speedway,\n    geo_dollar_general,\n    geo_family_dollar,\n    geo_all_other_grocery,\n    geo_all_other_drug,\n    geo_all_other_mass,\n    geo_all_other_club,\n    geo_total_c_and_g,\n    geo_all_other_c_and_g,\n    geo_all_other_dollar,\n    geo_amazon_com,\n    geo_walmart_com,\n\n    geo_all_other_ao,\n    geo_not_assigned,\n    --Original IS Values\n    is_all_other_ao,\n    is_not_assigned,\n\n    is_7_eleven,\n    is_ahold_delhaize,\n    is_albertsons,\n    is_aldi,\n    is_amazon_com,\n    is_bi_lo,\n    is_bjs,\n    is_circle_k,\n    is_costco,\n    is_cvs,\n    is_dollar_general,\n    is_family_dollar,\n    is_heb,\n    is_speedway,\n    is_hy_vee,\n    is_kroger_banner,\n    is_all_other_kroger,\n    is_all_other_club,\n    is_all_other_dollar,\n    is_all_other_drug,\n    is_all_other_c_and_g,\n    is_all_other_grocery,\n    is_all_other_mass,\n    is_publix,\n    is_sams_club,\n    is_target,\n    is_trader_joes,\n    is_wakefern,\n    is_walgreens,\n    is_walmart_com,\n    is_wm_neighborhood_market,\n    is_all_other_walmart,\n    is_whole_foods,\n\n    is_target_com          ,\n    is_kroger_com          ,\n    is_kmart_com           ,\n    is_walgreens_com       ,\n    is_samsclub_com        ,\n    is_costco_com          ,\n    --  IS CAPPED Values\n    is_7_eleven_cap,\n    is_ahold_delhaize_cap,\n    is_albertsons_cap,\n    is_aldi_cap,\n    is_amazon_com_cap,\n    is_bi_lo_cap,\n    is_bjs_cap,\n    is_circle_k_cap,\n    is_costco_cap,\n    is_cvs_cap,\n    is_dollar_general_cap,\n    is_family_dollar_cap,\n    is_heb_cap,\n    is_speedway_cap,\n    is_hy_vee_cap,\n    is_kroger_banner_cap,\n    is_all_other_kroger_cap,\n    is_all_other_club_cap,\n    is_all_other_dollar_cap,\n    is_all_other_drug_cap,\n    is_all_other_c_and_g_cap,\n    is_all_other_grocery_cap,\n    is_all_other_mass_cap,\n    is_publix_cap,\n    is_sams_club_cap,\n    is_target_cap,\n    is_trader_joes_cap,\n    is_wakefern_cap,\n    is_walgreens_cap,\n    is_walmart_com_cap,\n    is_wm_neighborhood_market_cap,\n    is_all_other_walmart_cap,\n    is_whole_foods_cap,\n\n    is_target_com_cap          ,\n    is_kroger_com_cap          ,\n    is_kmart_com_cap           ,\n    is_walgreens_com_cap       ,\n    is_samsclub_com_cap        ,\n    is_costco_com_cap          ,\n\n    --  Repeat the IS Capped values used for iri_adj - since business decided not to adjust values from Q1-2019\n    --  These columns to be eventually removed from the process entirely\n    -- REMOVED BEFORE Q2 2020 RUN\n    --             is_iri_adj_7_eleven,\n\n\n    --               Availability of 34 RETAILERS - modified to use IS Capped column instead of Adj column\n    -- REMOVED CODE PERTAINING TO is_iri_adj_{RETAILER} COLUMNS; ONE LINE LEFT FOR REFERENCE\n    --             IFF(geo_7_eleven  > 0,is_iri_adj_7_eleven ,0)   AS is_avbl_adj_7_eleven,\n\n\n    IFF(geo_7_eleven  > 0,is_7_eleven_cap ,0)   AS is_avbl_adj_7_eleven,\n    IFF(geo_ahold_delhaize  > 0,is_ahold_delhaize_cap ,0)   AS is_avbl_adj_ahold_delhaize,\n    IFF(geo_albertsons_safeway  > 0,is_albertsons_cap ,0)   AS is_avbl_adj_albertsons,\n    IFF(geo_aldi  > 0,is_aldi_cap ,0)   AS is_avbl_adj_aldi,\n    is_amazon_com_cap   AS is_avbl_adj_amazon_com,\n    IFF(geo_bi_lo  > 0,is_bi_lo_cap ,0)   AS is_avbl_adj_bi_lo,\n    IFF(geo_bjs  > 0,is_bjs_cap ,0)   AS is_avbl_adj_bjs,\n    IFF(geo_circle_k  > 0,is_circle_k_cap ,0)   AS is_avbl_adj_circle_k,\n    IFF(geo_costco  > 0,is_costco_cap ,0)   AS is_avbl_adj_costco,\n    IFF(geo_cvs  > 0,is_cvs_cap ,0)   AS is_avbl_adj_cvs,\n    IFF(geo_dollar_general  > 0,is_dollar_general_cap ,0)   AS is_avbl_adj_dollar_general,\n    IFF(geo_family_dollar  > 0,is_family_dollar_cap ,0)   AS is_avbl_adj_family_dollar,\n    IFF(geo_heb  > 0,is_heb_cap ,0)   AS is_avbl_adj_heb,\n    IFF(geo_speedway  > 0,is_speedway_cap ,0)   AS is_avbl_adj_speedway,\n    IFF(geo_hy_vee  > 0,is_hy_vee_cap ,0)   AS is_avbl_adj_hy_vee,\n    IFF(geo_kroger_banner  > 0,is_kroger_banner_cap ,0)   AS is_avbl_adj_kroger_banner,\n    IFF(geo_all_other_kroger  > 0,is_all_other_kroger_cap ,0)   AS is_avbl_adj_all_other_kroger,\n    IFF(geo_all_other_club  > 0,is_all_other_club_cap ,0)   AS is_avbl_adj_all_other_club,\n    IFF(geo_all_other_dollar  > 0,is_all_other_dollar_cap ,0)   AS is_avbl_adj_all_other_dollar,\n    IFF(geo_all_other_drug  > 0,is_all_other_drug_cap ,0)   AS is_avbl_adj_all_other_drug,\n    IFF(geo_all_other_c_and_g  > 0,is_all_other_c_and_g_cap ,0)   AS is_avbl_adj_all_other_c_and_g,\n    IFF(geo_all_other_grocery  > 0,is_all_other_grocery_cap ,0)   AS is_avbl_adj_all_other_grocery,\n    IFF(geo_all_other_mass  > 0,is_all_other_mass_cap ,0)   AS is_avbl_adj_all_other_mass,\n    IFF(geo_publix  > 0,is_publix_cap ,0)   AS is_avbl_adj_publix,\n    IFF(geo_sams_club  > 0,is_sams_club_cap ,0)   AS is_avbl_adj_sams_club,\n    IFF(geo_target  > 0,is_target_cap ,0)   AS is_avbl_adj_target,\n    IFF(geo_trader_joes  > 0,is_trader_joes_cap ,0)   AS is_avbl_adj_trader_joes,\n    IFF(geo_wakefern  > 0,is_wakefern_cap ,0)   AS is_avbl_adj_wakefern,\n    IFF(geo_walgreens  > 0,is_walgreens_cap ,0)   AS is_avbl_adj_walgreens,\n    is_walmart_com_cap  AS is_avbl_adj_walmart_com,\n    IFF(geo_wm_neighborhood_market  > 0,is_wm_neighborhood_market_cap ,0)   AS is_avbl_adj_wm_neighborhood_market,\n    IFF(geo_all_other_walmart  > 0,is_all_other_walmart_cap ,0)   AS is_avbl_adj_all_other_walmart,\n    IFF(geo_whole_foods  > 0,is_whole_foods_cap,0)   AS is_avbl_adj_whole_foods,\n\n    is_target_com_cap     AS is_avbl_adj_target_com,\n    is_kroger_com_cap     AS is_avbl_adj_kroger_com,\n    is_kmart_com_cap      AS is_avbl_adj_kmart_com,\n    is_walgreens_com_cap  AS is_avbl_adj_walgreens_com,\n    is_samsclub_com_cap   AS is_avbl_adj_samsclub_com,\n    is_costco_com_cap     AS is_avbl_adj_costco_com,\n\n    fvh_cur_lifestage,\n    fvh_cur_pred_spend,\n    fvh_fut_pred_spend,\n    fvh_growth_rate,\n\n    smart_water,\n    smart_water_decile,\n    energy_csd_zero_calorie,\n    energy_csd_zero_calorie_decile,\n    csd_total,\n    csd_total_decile,\n    doritos,\n    doritos_decile,\n    energy_drinks,\n    energy_drinks_decile,\n    gatorade,\n    gatorade_decile,\n    lays,\n    lays_decile,\n    lipton_base,\n    lipton_base_decile,\n    lipton_brisk,\n    lipton_brisk_decile,\n    mt_dew,\n    mt_dew_decile,\n    mtn_dew_kickstart,\n    mtn_dew_kickstart_decile,\n    nuts,\n    nuts_decile,\n    pepsi_diet,\n    pepsi_diet_decile,\n    pepsi_regular,\n    pepsi_regular_decile,\n    performance_bars,\n    performance_bars_decile,\n    pepsico_protein_powder,\n    pepsico_protein_powder_decile,\n    propel,\n    propel_decile,\n    quaker_oatmeal,\n    quaker_oatmeal_decile,\n    rte_cereal,\n    rte_cereal_decile,\n    ruffles,\n    ruffles_decile,\n    bottled_water,\n    bottled_water_decile,\n    starbucks_tripleshot,\n    starbucks_tripleshot_decile,\n    funyuns,\n    funyuns_decile,\n    chilled_tea,\n    chilled_tea_decile,\n    coffee_rtd,\n    coffee_rtd_decile,\n    online_delivery,\n    online_delivery_decile,\n    csd_singles,\n    csd_singles_decile,\n    flv_csd_ex_dew_pepper,\n    flv_csd_ex_dew_pepper_decile,\n    rtd_protein,\n    rtd_protein_decile,\n    sodastream,\n    sodastream_decile,\n    gamefuel,\n    gamefuel_decile,\n    mainstream_kettle_chips,\n    mainstream_kettle_chips_decile,\n    lipton_pure_leaf,\n    lipton_pure_leaf_decile,\n    mainstream_juices,\n    mainstream_juices_decile,\n    mt_dew_flv_seek,\n    mt_dew_flv_seek_decile,\n    instant_quaker_oats,\n    instant_quaker_oats_decile,\n    naked_protein,\n    naked_protein_decile,\n    pepsi_zero_coke_zero,\n    pepsi_zero_coke_zero_decile,\n    prem_juice_drinks,\n    prem_juice_drinks_decile,\n    lightly_flavored_tortilla_chips,\n    lightly_flavored_tortilla_chips_decile,\n    doubleshot_javam,\n    doubleshot_javam_decile,\n    food_bev,\n    food_bev_decile,\n    ncb_innovation,\n    ncb_innovation_decile,\n    premium_csd,\n    premium_csd_decile,\n    premium_tea,\n    premium_tea_decile,\n    premium_water,\n    premium_water_decile,\n    probiotic_juices,\n    probiotic_juices_decile,\n    lays_poppables,\n    lays_poppables_decile,\n    alternative_tortilla_chips,\n    alternative_tortilla_chips_decile,\n    snack_bars,\n    snack_bars_decile,\n    sparkling_water,\n    sparkling_water_decile,\n    dips_as_meal_enhancers,\n    dips_as_meal_enhancers_decile,\n    stacys,\n    stacys_decile,\n    sunchips,\n    sunchips_decile,\n    super_premium_juices,\n    super_premium_juices_decile,\n    tostitos,\n    tostitos_decile,\n    flavor_camp_bbq,\n    flavor_camp_bbq_decile,\n    plant_based_rtd_protein,\n    plant_based_rtd_protein_decile,\n    veggie_chips,\n    veggie_chips_decile,\n    g_organic,\n    g_organic_decile,\n    mountain_dew_baja_blast,\n    mountain_dew_baja_blast_decile,\n    cold_brew,\n    cold_brew_decile,\n    bubly,\n    bubly_decile,\n    ultra_premium_juice,\n    ultra_premium_juice_decile,\n    lightly_salted_chips,\n    lightly_salted_chips_decile,\n    flavor_camp_cheese,\n    flavor_camp_cheese_decile,\n    sabra_hummus_tubs,\n    sabra_hummus_tubs_decile,\n    oj_category_switchers,\n    oj_category_switchers_decile,\n    standard_quaker_oats,\n    standard_quaker_oats_decile,\n    csd_multiserve,\n    csd_multiserve_decile,\n    dew_ice,\n    dew_ice_decile,\n    flavor_camp_dairy,\n    flavor_camp_dairy_decile,\n    online_curbside_pickup,\n    online_curbside_pickup_decile,\n    flavor_camp_herb_spice_veggie,\n    flavor_camp_herb_spice_veggie_decile,\n    flv_salty_snacks,\n    flv_salty_snacks_decile,\n    g2,\n    g2_decile,\n    flavor_camp_salted_plain,\n    flavor_camp_salted_plain_decile,\n    keto_cookies,\n    keto_cookies_decile,\n    low_fat_salty_snacks,\n    low_fat_salty_snacks_decile,\n    aha,\n    aha_decile,\n    plant_based_protein_powder,\n    plant_based_protein_powder_decile,\n    pretzel_category,\n    pretzel_category_decile,\n    flavor_camp_spicy_burn,\n    flavor_camp_spicy_burn_decile,\n    dots_pretzels,\n    dots_pretzels_decile,\n    santitas,\n    santitas_decile,\n    flavor_camp_tangy,\n    flavor_camp_tangy_decile,\n    tropicana_probiotics_purchasers,\n    tropicana_probiotics_purchasers_decile,\n    tropicana_pure_premium_purchasers,\n    tropicana_pure_premium_purchasers_decile,\n    rfg_yogurt_drinks,\n    rfg_yogurt_drinks_decile,\n    flavor_camp_aggregate_all_intense_bold,\n    flavor_camp_aggregate_all_intense_bold_decile,\n    total_regular_cola,\n    total_regular_cola_decile,\n    flavor_camp_meat,\n    flavor_camp_meat_decile,\n    fritos_original,\n    fritos_original_decile,\n    flavored_pretzels,\n    flavored_pretzels_decile,\n    nutrition_engaged,\n    nutrition_engaged_decile,\n    mainstream_engaged,\n    mainstream_engaged_decile,\n    oj_category,\n    oj_category_decile,\n    nutrition_bars,\n    nutrition_bars_decile,\n    oatmeal_category,\n    oatmeal_category_decile,\n    alt_dairy_category,\n    alt_dairy_category_decile,\n    kombucha_functional_juices,\n    kombucha_functional_juices_decile,\n    single_serve_mainstream_juice,\n    single_serve_mainstream_juice_decile,\n    quaker_grits,\n    quaker_grits_decile,\n    shelf_stable_dips_category,\n    shelf_stable_dips_category_decile,\n    fruit_snacks,\n    fruit_snacks_decile,\n    fritos_flavor,\n    fritos_flavor_decile,\n    kevita_purchasers,\n    kevita_purchasers_decile,\n    heart_claim,\n    heart_claim_decile,\n    starbucks_frappuccino,\n    starbucks_frappuccino_decile,\n    single_serve_salty_snacks,\n    single_serve_salty_snacks_decile,\n    cholesterol_claim,\n    cholesterol_claim_decile,\n    g_zero,\n    g_zero_decile,\n    diet_csds,\n    diet_csds_decile,\n    candy_category,\n    candy_category_decile,\n    frozen_fruit_category,\n    frozen_fruit_category_decile,\n    salty_snacks,\n    salty_snacks_decile,\n    premium_greek_yogurt,\n    premium_greek_yogurt_decile,\n    rice_pasta_ethnic_spclty,\n    rice_pasta_ethnic_spclty_decile,\n    pancake_mix_syrup,\n    pancake_mix_syrup_decile,\n    lite_snacks,\n    lite_snacks_decile,\n    herbal_tea,\n    herbal_tea_decile,\n    tazo,\n    tazo_decile,\n    mini_cans,\n    mini_cans_decile,\n    unflavored_pretzels,\n    unflavored_pretzels_decile,\n    bodyarmor,\n    bodyarmor_decile,\n    organic_food_bev_buyers,\n    organic_food_bev_buyers_decile,\n    fritos_scoops,\n    fritos_scoops_decile,\n    grain_claim,\n    grain_claim_decile,\n    diet_coke,\n    diet_coke_decile,\n    online_in_store_pickup,\n    online_in_store_pickup_decile,\n    bare,\n    bare_decile,\n    off_the_eaten_path,\n    off_the_eaten_path_decile,\n    rte_cereal_all_family,\n    rte_cereal_all_family_decile,\n    rte_cereal_kids,\n    rte_cereal_kids_decile,\n    instant_quaker_oats_light_lapsed,\n    instant_quaker_oats_light_lapsed_decile,\n    celsius_energy,\n    celsius_energy_decile,\n    doritos_h_and_s,\n    doritos_h_and_s_decile,\n    premium_kettle_chips,\n    premium_kettle_chips_decile,\n    chewy_kids_snacking,\n    chewy_kids_snacking_decile,\n    starbucks_nitro,\n    starbucks_nitro_decile,\n    premium_lrb,\n    premium_lrb_decile,\n    rte_popcorn_full_flavor,\n    rte_popcorn_full_flavor_decile,\n    rte_popcorn_light_flavor,\n    rte_popcorn_light_flavor_decile,\n    breakfast_cereal_snack_bars,\n    breakfast_cereal_snack_bars_decile,\n    sports_drinks,\n    sports_drinks_decile,\n    takis,\n    takis_decile,\n    lacroix,\n    lacroix_decile,\n    manzanita_sol,\n    manzanita_sol_decile,\n    unflavored_tortilla_chips,\n    unflavored_tortilla_chips_decile,\n    crush,\n    crush_decile,\n    chewy,\n    chewy_decile,\n    rockstar_energy,\n    rockstar_energy_decile,\n    light_holiday_salty_snack_buyers,\n    light_holiday_salty_snack_buyers_decile,\n    medium_holiday_salty_snack_buyers,\n    medium_holiday_salty_snack_buyers_decile,\n    xxvl_single_serve_snacks,\n    xxvl_single_serve_snacks_decile,\n    svlr_single_serve_snacks,\n    svlr_single_serve_snacks_decile,\n    lss_single_serve_snacks,\n    lss_single_serve_snacks_decile,\n    bolt_24,\n    bolt_24_decile,\n    lemonade,\n    lemonade_decile,\n    gamesa_cookies,\n    gamesa_cookies_decile,\n    kids_organic,\n    kids_organic_decile,\n    rice_crisps_cakes,\n    rice_crisps_cakes_decile,\n    health_warrior,\n    health_warrior_decile,\n    simple_nutrition,\n    simple_nutrition_decile,\n    naked,\n    naked_decile,\n    yogurt,\n    yogurt_decile,\n    online_edible,\n    online_edible_decile,\n    better_for_you_bagged_snacks,\n    better_for_you_bagged_snacks_decile,\n    vanilla_flavored_rtd_coffee,\n    vanilla_flavored_rtd_coffee_decile,\n    frozen_dips,\n    frozen_dips_decile,\n    caramel_flavored_rtd_coffee,\n    caramel_flavored_rtd_coffee_decile,\n    coffee_flavored_rtd_coffee,\n    coffee_flavored_rtd_coffee_decile,\n    lays_stax,\n    lays_stax_decile,\n    popcorners,\n    popcorners_decile,\n    shelf_stable_dairy_dips,\n    shelf_stable_dairy_dips_decile,\n    probiotic_attribute,\n    probiotic_attribute_decile,\n    essentia,\n    essentia_decile,\n    core,\n    core_decile,\n    dasani,\n    dasani_decile,\n    shelf_stable_salsa,\n    shelf_stable_salsa_decile,\n    shelf_stable_cheese_dips,\n    shelf_stable_cheese_dips_decile,\n    shelf_stable_bean_dips,\n    shelf_stable_bean_dips_decile,\n    cheetos_cheese_core,\n    cheetos_cheese_core_decile,\n    frito_lay_multipack,\n    frito_lay_multipack_decile,\n    cheetos_flamin_hot_core,\n    cheetos_flamin_hot_core_decile,\n    muscle_milk,\n    muscle_milk_decile,\n    kst_regular_coke_transitioner,\n    kst_regular_coke_transitioner_decile,\n    kst_frequent_diet_pepsi_transitioner,\n    kst_frequent_diet_pepsi_transitioner_decile,\n    kst_hispanic_pepsi_drinker,\n    kst_hispanic_pepsi_drinker_decile,\n    kst_light_cola_drinker,\n    kst_light_cola_drinker_decile,\n    kst_frequent_blue_pepsi_drinker,\n    kst_frequent_blue_pepsi_drinker_decile,\n    kst_non_cola_drinkers,\n    kst_non_cola_drinkers_decile,\n    macaroni_and_cheese,\n    macaroni_and_cheese_decile,\n    heat_and_eat,\n    heat_and_eat_decile,\n    instant_rice_pasta_grains,\n    instant_rice_pasta_grains_decile,\n    better_for_you_crackers,\n    better_for_you_crackers_decile,\n    zero_calorie_csd,\n    zero_calorie_csd_decile,\n    wavy_lays,\n    wavy_lays_decile,\n    multiserve_starbucks,\n    multiserve_starbucks_decile,\n    tea_bags,\n    tea_bags_decile,\n    rfg_dips,\n    rfg_dips_decile,\n    sleeping_remedies,\n    sleeping_remedies_decile,\n    adaptogens,\n    adaptogens_decile,\n    easy_wellness,\n    easy_wellness_decile,\n    bang,\n    bang_decile,\n    kevita_adjacencies,\n    kevita_adjacencies_decile,\n    caffeine_attribute,\n    caffeine_attribute_decile,\n    vitamin_c_attribute,\n    vitamin_c_attribute_decile,\n    antioxidant_attribute,\n    antioxidant_attribute_decile,\n    poland_spring,\n    poland_spring_decile,\n    polar,\n    polar_decile,\n    diet_coke_decliners,\n    diet_coke_decliners_decile,\n    sprite_and_fanta_decliners,\n    sprite_and_fanta_decliners_decile,\n    rap_snacks,\n    rap_snacks_decile,\n    cheetos_crunchy,\n    cheetos_crunchy_decile,\n    cheetos_puffs,\n    cheetos_puffs_decile,\n    lays_classic,\n    lays_classic_decile,\n    premium_cocktail_mixers,\n    premium_cocktail_mixers_decile,\n    baken_ets,\n    baken_ets_decile,\n    mainstream_mixers,\n    mainstream_mixers_decile,\n    quaker_hots_light_lapsed,\n    quaker_hots_light_lapsed_decile,\n    zone_in_shopper,\n    zone_in_shopper_decile,\n    root_beer,\n    root_beer_decile,\n    coke,\n    coke_decile,\n    premium_cheese_snacks,\n    premium_cheese_snacks_decile,\n    stacys_thins,\n    stacys_thins_decile,\n    stacys_core,\n    stacys_core_decile,\n    diet_mountain_dew,\n    diet_mountain_dew_decile,\n    sparkling_ice,\n    sparkling_ice_decile,\n    granola,\n    granola_decile,\n    aj_pancake_mix_and_syrup,\n    aj_pancake_mix_and_syrup_decile,\n    rte_cereal_adult,\n    rte_cereal_adult_decile,\n    kids_ambient_juices,\n    kids_ambient_juices_decile,\n    non_lemonade_juice_drinks,\n    non_lemonade_juice_drinks_decile,\n    cheetos_mac_n_cheese,\n    cheetos_mac_n_cheese_decile,\n    hispanic_cookies,\n    hispanic_cookies_decile,\n    gamesa_crackers,\n    gamesa_crackers_decile,\n    naked_juice_lapsed_buyers,\n    naked_juice_lapsed_buyers_decile,\n    natural_attribute,\n    natural_attribute_decile,\n    protein_attribute,\n    protein_attribute_decile,\n    calcium_attribute,\n    calcium_attribute_decile,\n    fiber,\n    fiber_decile,\n    gluten_free,\n    gluten_free_decile,\n    low_sodium,\n    low_sodium_decile,\n    no_added_sugar,\n    no_added_sugar_decile,\n    simply,\n    simply_decile,\n    baked,\n    baked_decile,\n    non_gmo,\n    non_gmo_decile,\n    mt_dew_total,\n    mt_dew_total_decile,\n    keto_dieters,\n    keto_dieters_decile,\n    party_people,\n    party_people_decile,\n    cold_and_flu_preppers,\n    cold_and_flu_preppers_decile,\n    condiments_and_sauces,\n    condiments_and_sauces_decile,\n    flavored_csds,\n    flavored_csds_decile,\n    holiday_hosts,\n    holiday_hosts_decile,\n    immunity_boosters,\n    immunity_boosters_decile,\n    new_years_dieters,\n    new_years_dieters_decile,\n    new_years_partiers,\n    new_years_partiers_decile,\n    plant_based_buyers,\n    plant_based_buyers_decile,\n    summer_grillers,\n    summer_grillers_decile,\n    super_bowl_hosts,\n    super_bowl_hosts_decile,\n    thanksgiving_hosts,\n    thanksgiving_hosts_decile,\n    hard_coffee,\n    hard_coffee_decile,\n    hard_flavored_bevs_xlemonade,\n    hard_flavored_bevs_xlemonade_decile,\n    hard_kombucha,\n    hard_kombucha_decile,\n    hard_lemonade,\n    hard_lemonade_decile,\n    hard_seltzer,\n    hard_seltzer_decile,\n    health_warrior_competitive_products,\n    health_warrior_competitive_products_decile,\n    other_hmb,\n    other_hmb_decile,\n    cookies,\n    cookies_decile,\n    crackers,\n    crackers_decile,\n    trop_premium_juice_drinks,\n    trop_premium_juice_drinks_decile,\n    wine,\n    wine_decile,\n    spirits_liquor,\n    spirits_liquor_decile,\n    premade_cocktails_coolers,\n    premade_cocktails_coolers_decile,\n    domestic_beer,\n    domestic_beer_decile,\n    imported_beer,\n    imported_beer_decile,\n    flavored_malt_beverages,\n    flavored_malt_beverages_decile,\n    ambient_juice,\n    ambient_juice_decile,\n    new_rtd_tea_buyers_buying_lipton,\n    new_rtd_tea_buyers_buying_lipton_decile,\n    rtd_tea_buyers_switching_to_lipton,\n    rtd_tea_buyers_switching_to_lipton_decile,\n    sabritas,\n    sabritas_decile,\n    cbd_product_purchasers,\n    cbd_product_purchasers_decile,\n    dr_pepper,\n    dr_pepper_decile,\n    coffee_beans,\n    coffee_beans_decile,\n    hispanic_aisle,\n    hispanic_aisle_decile,\n    functional_juice_kombucha_switchers,\n    functional_juice_kombucha_switchers_decile,\n    dole,\n    dole_decile,\n    twister,\n    twister_decile,\n    quaker_grits_new_buyers,\n    quaker_grits_new_buyers_decile,\n    macro_category_multi_pack_buyers,\n    macro_category_multi_pack_buyers_decile,\n    frutly,\n    frutly_decile,\n    flavored_enhanced_water,\n    flavored_enhanced_water_decile,\n    shelf_stable_juice_drinks,\n    shelf_stable_juice_drinks_decile,\n    --\n    smart_water_centile,\n    energy_csd_zero_calorie_centile,\n    csd_total_centile,\n    doritos_centile,\n    energy_drinks_centile,\n    gatorade_centile,\n    lays_centile,\n    lipton_base_centile,\n    lipton_brisk_centile,\n    mt_dew_centile,\n    mtn_dew_kickstart_centile,\n    nuts_centile,\n    pepsi_diet_centile,\n    pepsi_regular_centile,\n    performance_bars_centile,\n    pepsico_protein_powder_centile,\n    propel_centile,\n    quaker_oatmeal_centile,\n    rte_cereal_centile,\n    ruffles_centile,\n    bottled_water_centile,\n    starbucks_tripleshot_centile,\n    funyuns_centile,\n    chilled_tea_centile,\n    coffee_rtd_centile,\n    online_delivery_centile,\n    csd_singles_centile,\n    flv_csd_ex_dew_pepper_centile,\n    rtd_protein_centile,\n    sodastream_centile,\n    gamefuel_centile,\n    mainstream_kettle_chips_centile,\n    lipton_pure_leaf_centile,\n    mainstream_juices_centile,\n    mt_dew_flv_seek_centile,\n    instant_quaker_oats_centile,\n    naked_protein_centile,\n    pepsi_zero_coke_zero_centile,\n    prem_juice_drinks_centile,\n    lightly_flavored_tortilla_chips_centile,\n    doubleshot_javam_centile,\n    food_bev_centile,\n    ncb_innovation_centile,\n    premium_csd_centile,\n    premium_tea_centile,\n    premium_water_centile,\n    probiotic_juices_centile,\n    lays_poppables_centile,\n    alternative_tortilla_chips_centile,\n    snack_bars_centile,\n    sparkling_water_centile,\n    dips_as_meal_enhancers_centile,\n    stacys_centile,\n    sunchips_centile,\n    super_premium_juices_centile,\n    tostitos_centile,\n    flavor_camp_bbq_centile,\n    plant_based_rtd_protein_centile,\n    veggie_chips_centile,\n    g_organic_centile,\n    mountain_dew_baja_blast_centile,\n    cold_brew_centile,\n    bubly_centile,\n    ultra_premium_juice_centile,\n    lightly_salted_chips_centile,\n    flavor_camp_cheese_centile,\n    sabra_hummus_tubs_centile,\n    oj_category_switchers_centile,\n    standard_quaker_oats_centile,\n    csd_multiserve_centile,\n    dew_ice_centile,\n    flavor_camp_dairy_centile,\n    online_curbside_pickup_centile,\n    flavor_camp_herb_spice_veggie_centile,\n    flv_salty_snacks_centile,\n    g2_centile,\n    flavor_camp_salted_plain_centile,\n    keto_cookies_centile,\n    low_fat_salty_snacks_centile,\n    aha_centile,\n    plant_based_protein_powder_centile,\n    pretzel_category_centile,\n    flavor_camp_spicy_burn_centile,\n    dots_pretzels_centile,\n    santitas_centile,\n    flavor_camp_tangy_centile,\n    tropicana_probiotics_purchasers_centile,\n    tropicana_pure_premium_purchasers_centile,\n    rfg_yogurt_drinks_centile,\n    flavor_camp_aggregate_all_intense_bold_centile,\n    total_regular_cola_centile,\n    flavor_camp_meat_centile,\n    fritos_original_centile,\n    flavored_pretzels_centile,\n    nutrition_engaged_centile,\n    mainstream_engaged_centile,\n    oj_category_centile,\n    nutrition_bars_centile,\n    oatmeal_category_centile,\n    alt_dairy_category_centile,\n    kombucha_functional_juices_centile,\n    single_serve_mainstream_juice_centile,\n    quaker_grits_centile,\n    shelf_stable_dips_category_centile,\n    fruit_snacks_centile,\n    fritos_flavor_centile,\n    kevita_purchasers_centile,\n    heart_claim_centile,\n    starbucks_frappuccino_centile,\n    single_serve_salty_snacks_centile,\n    cholesterol_claim_centile,\n    g_zero_centile,\n    diet_csds_centile,\n    candy_category_centile,\n    frozen_fruit_category_centile,\n    salty_snacks_centile,\n    premium_greek_yogurt_centile,\n    rice_pasta_ethnic_spclty_centile,\n    pancake_mix_syrup_centile,\n    lite_snacks_centile,\n    herbal_tea_centile,\n    tazo_centile,\n    mini_cans_centile,\n    unflavored_pretzels_centile,\n    bodyarmor_centile,\n    organic_food_bev_buyers_centile,\n    fritos_scoops_centile,\n    grain_claim_centile,\n    diet_coke_centile,\n    online_in_store_pickup_centile,\n    bare_centile,\n    off_the_eaten_path_centile,\n    rte_cereal_all_family_centile,\n    rte_cereal_kids_centile,\n    instant_quaker_oats_light_lapsed_centile,\n    celsius_energy_centile,\n    doritos_h_and_s_centile,\n    premium_kettle_chips_centile,\n    chewy_kids_snacking_centile,\n    starbucks_nitro_centile,\n    premium_lrb_centile,\n    rte_popcorn_full_flavor_centile,\n    rte_popcorn_light_flavor_centile,\n    breakfast_cereal_snack_bars_centile,\n    sports_drinks_centile,\n    takis_centile,\n    lacroix_centile,\n    manzanita_sol_centile,\n    unflavored_tortilla_chips_centile,\n    crush_centile,\n    chewy_centile,\n    rockstar_energy_centile,\n    light_holiday_salty_snack_buyers_centile,\n    medium_holiday_salty_snack_buyers_centile,\n    xxvl_single_serve_snacks_centile,\n    svlr_single_serve_snacks_centile,\n    lss_single_serve_snacks_centile,\n    bolt_24_centile,\n    lemonade_centile,\n    gamesa_cookies_centile,\n    kids_organic_centile,\n    rice_crisps_cakes_centile,\n    health_warrior_centile,\n    simple_nutrition_centile,\n    naked_centile,\n    yogurt_centile,\n    online_edible_centile,\n    better_for_you_bagged_snacks_centile,\n    vanilla_flavored_rtd_coffee_centile,\n    frozen_dips_centile,\n    caramel_flavored_rtd_coffee_centile,\n    coffee_flavored_rtd_coffee_centile,\n    lays_stax_centile,\n    popcorners_centile,\n    shelf_stable_dairy_dips_centile,\n    probiotic_attribute_centile,\n    essentia_centile,\n    core_centile,\n    dasani_centile,\n    shelf_stable_salsa_centile,\n    shelf_stable_cheese_dips_centile,\n    shelf_stable_bean_dips_centile,\n    cheetos_cheese_core_centile,\n    frito_lay_multipack_centile,\n    cheetos_flamin_hot_core_centile,\n    muscle_milk_centile,\n    kst_regular_coke_transitioner_centile,\n    kst_frequent_diet_pepsi_transitioner_centile,\n    kst_hispanic_pepsi_drinker_centile,\n    kst_light_cola_drinker_centile,\n    kst_frequent_blue_pepsi_drinker_centile,\n    kst_non_cola_drinkers_centile,\n    macaroni_and_cheese_centile,\n    heat_and_eat_centile,\n    instant_rice_pasta_grains_centile,\n    better_for_you_crackers_centile,\n    zero_calorie_csd_centile,\n    wavy_lays_centile,\n    multiserve_starbucks_centile,\n    tea_bags_centile,\n    rfg_dips_centile,\n    sleeping_remedies_centile,\n    adaptogens_centile,\n    easy_wellness_centile,\n    bang_centile,\n    kevita_adjacencies_centile,\n    caffeine_attribute_centile,\n    vitamin_c_attribute_centile,\n    antioxidant_attribute_centile,\n    poland_spring_centile,\n    polar_centile,\n    diet_coke_decliners_centile,\n    sprite_and_fanta_decliners_centile,\n    rap_snacks_centile,\n    cheetos_crunchy_centile,\n    cheetos_puffs_centile,\n    lays_classic_centile,\n    premium_cocktail_mixers_centile,\n    baken_ets_centile,\n    mainstream_mixers_centile,\n    quaker_hots_light_lapsed_centile,\n    zone_in_shopper_centile,\n    root_beer_centile,\n    coke_centile,\n    premium_cheese_snacks_centile,\n    stacys_thins_centile,\n    stacys_core_centile,\n    diet_mountain_dew_centile,\n    sparkling_ice_centile,\n    granola_centile,\n    aj_pancake_mix_and_syrup_centile,\n    rte_cereal_adult_centile,\n    kids_ambient_juices_centile,\n    non_lemonade_juice_drinks_centile,\n    cheetos_mac_n_cheese_centile,\n    hispanic_cookies_centile,\n    gamesa_crackers_centile,\n    naked_juice_lapsed_buyers_centile,\n    natural_attribute_centile,\n    protein_attribute_centile,\n    calcium_attribute_centile,\n    fiber_centile,\n    gluten_free_centile,\n    low_sodium_centile,\n    no_added_sugar_centile,\n    simply_centile,\n    baked_centile,\n    non_gmo_centile,\n    mt_dew_total_centile,\n    keto_dieters_centile,\n    party_people_centile,\n    cold_and_flu_preppers_centile,\n    condiments_and_sauces_centile,\n    flavored_csds_centile,\n    holiday_hosts_centile,\n    immunity_boosters_centile,\n    new_years_dieters_centile,\n    new_years_partiers_centile,\n    plant_based_buyers_centile,\n    summer_grillers_centile,\n    super_bowl_hosts_centile,\n    thanksgiving_hosts_centile,\n    hard_coffee_centile,\n    hard_flavored_bevs_xlemonade_centile,\n    hard_kombucha_centile,\n    hard_lemonade_centile,\n    hard_seltzer_centile,\n    health_warrior_competitive_products_centile,\n    other_hmb_centile,\n    cookies_centile,\n    crackers_centile,\n    trop_premium_juice_drinks_centile,\n    wine_centile,\n    spirits_liquor_centile,\n    premade_cocktails_coolers_centile,\n    domestic_beer_centile,\n    imported_beer_centile,\n    flavored_malt_beverages_centile,\n    ambient_juice_centile,\n    new_rtd_tea_buyers_buying_lipton_centile,\n    rtd_tea_buyers_switching_to_lipton_centile,\n    sabritas_centile,\n    cbd_product_purchasers_centile,\n    dr_pepper_centile,\n    coffee_beans_centile,\n    hispanic_aisle_centile,\n    functional_juice_kombucha_switchers_centile,\n    dole_centile,\n    twister_centile,\n    quaker_grits_new_buyers_centile,\n    macro_category_multi_pack_buyers_centile,\n    frutly_centile,\n    flavored_enhanced_water_centile,\n    shelf_stable_juice_drinks_centile,\n    fb_dollars_hh,\n    fb_units_hh,\n    fb_trips_hh,\n    fb_dollar_index\nFROM {{ ref('trifecta_is_cap') }}", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_DEV", "fqn": ["sdna_project", "sdna_us", "household", "transformations", "mvh", "trifecta", "trifecta_is_cap_iri_adjf_avbl"], "unique_id": "model.sdna_project.trifecta_is_cap_iri_adjf_avbl", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/household/transformations/mvh/trifecta/trifecta_is_cap_iri_adjf_avbl.sql", "original_file_path": "models/sdna_us/household/transformations/mvh/trifecta/trifecta_is_cap_iri_adjf_avbl.sql", "name": "trifecta_is_cap_iri_adjf_avbl", "resource_type": "model", "alias": "trifecta_is_cap_iri_adjf_avbl", "checksum": {"name": "sha256", "checksum": "58ef1633b9f183b065fd7e6d6aee9abb3255a467ad7789a35e8146c7ed89d198"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "HOUSEHOLD_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["trifecta_is_cap"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.trifecta_is_cap"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "HOUSEHOLD_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_fl_cust": {"raw_sql": "WITH cust AS (\n\nSELECT\n    cust_nbr,\n    ctry_code,\n    ctry_descp,\n    co_code,\n    co_descp,\n    rt_nbr,\n    chain_node_sys_nbr,\n    cust_loc_nbr,\n    bus_loc_str_addr1,\n    bus_loc_str_addr2,\n    bus_loc_city,\n    bus_loc_cnty_sburb,\n    bus_loc_st_prov,\n    bus_loc_ctry,\n    bus_loc_post_code,\n    bus_loc_post_code_zip5,\n    contc_persn_nm,\n    cust_phone_nbr,\n    cust_fax_nbr,\n    contr_id,\n    prmy_cust_nbr,\n    first_sale_dt,\n    most_rcnt_sale_dt,\n    avg_wkly_sale_amt,\n    bus_type_code,\n    bus_type_descp,\n    facil_use_code,\n    facil_use_descp,\n    alt_cust_nbr,\n    alt_cust_nm,\n    cust_nm,\n    store_nbr,\n    dept_code,\n    cust_legal_nm,\n    cust_stat_code,\n    trade_seg_code,\n    trade_seg_descp,\n    trade_chanl_code,\n    trade_chanl_descp,\n    prstg_cust_flg,\n    cod_reasn_code,\n    cod_reasn_descp,\n    paymt_type_code,\n    paymt_type_descp,\n    bill_loc_nbr,\n    cr_risk_code,\n    cr_risk_descp,\n    cr_appv_stat_code,\n    cr_appv_stat_descp,\n    contr_disc_pct,\n    auth_prod_list_nbr,\n    promo_lock_in_flg,\n    alowb_promo_code,\n    serv_freq_code,\n    serv_freq_descp,\n    serv_wk_nbr,\n    serv_day_nbr,\n    indep_cust_flg,\n    prmy_qty_type_code,\n    own_code,\n    frhse_flg,\n    temp_cust_flg,\n    distrib_flg,\n    co_prmy_ft_qty,\n    co_fem_qty,\n    co_max_qty,\n    co_other_qty,\n    cmpet_prmy_ft_qty,\n    cmpet_fem_qty,\n    cmpet_max_qty,\n    cmpet_other_qty,\n    dspla_acct_flg,\n    store_dspla_txt,\n    scan_pay_flg,\n    dex_flg,\n    duns_nbr,\n    cust_bus_seg_code,\n    cust_bus_seg_descp,\n    clr_dir_deliv_flg,\n    mltry_cust_flg,\n    accpt_dflt_ck_flg,\n    are_class_code,\n    comm_type,\n    comm_type_descp,\n    unit_case_flg,\n    tdlinx_id,\n    tdlinx_trade_chanl,\n    prmy_equip_code,\n    cust_type_categ,\n    phy_loc_str_addr1,\n    phy_loc_str_addr2,\n    phy_loc_city,\n    phy_loc_cnty_sburb,\n    phy_loc_st_prov,\n    phy_loc_ctry,\n    phy_loc_post_code,\n    phy_loc_post_code_zip5,\n    close_cross_str,\n    lat_code,\n    lon_code,\n    deliv_freq_code,\n    deliv_wk_nbr,\n    deliv_day_nbr,\n    cust_end_date,\n    serv_incl_no_sale_freq_code,\n    serv_incl_no_sale_freq_descp,\n    serv_incl_no_sale_wk_nbr,\n    serv_incl_no_sale_day_nbr,\n    prod_deliv_freq_code,\n    prod_deliv_freq_descp,\n    prod_deliv_wk_nbr,\n    prod_deliv_day_nbr,\n    ship_note,\n    chain_lvl1_node_nbr,\n    chain_lvl1_node_nm,\n    chain_lvl2_key,\n    chain_lvl2_node_nbr,\n    chain_lvl2_node_nm,\n    chain_lvl3_key,\n    chain_lvl3_node_nbr,\n    chain_lvl3_node_nm,\n    chain_lvl4_key,\n    chain_lvl4_node_nbr,\n    chain_lvl4_node_nm,\n    chain_lvl5_key,\n    chain_lvl5_node_nbr,\n    chain_lvl5_node_nm,\n    chain_lvl6_key,\n    chain_lvl6_node_nbr,\n    chain_lvl6_node_nm,\n    cost_ctr,\n    geo_type_code,\n    geo_lvl4_contc_nm,\n    geo_lvl4_key,\n    geo_lvl4_node_nbr,\n    geo_lvl4_node_nm,\n    geo_lvl3_key,\n    geo_lvl3_node_nbr,\n    geo_lvl3_node_nm,\n    geo_lvl2_key,\n    geo_lvl2_node_nbr,\n    geo_lvl2_node_nm,\n    geo_lvl1_node_nbr,\n    geo_lvl1_node_nm\nFROM {{ ref('btg_fl_cust_v') }}\n)\n\nSELECT * FROM cust", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_fl_cust"], "unique_id": "model.sdna_project.stg_fl_cust", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_fl_cust.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_fl_cust.sql", "name": "stg_fl_cust", "resource_type": "model", "alias": "stg_fl_cust", "checksum": {"name": "sha256", "checksum": "23600dffef1802291b79a93d355bf8f8925564f5e3cbdea01243b73d44ea01b5"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_cust_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_cust_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_fl_prod_sales": {"raw_sql": "WITH prod_sales AS (\n\nSELECT xref.msa_id,\n       p.prod_upc,\n       p.prod_slbl,\n       s.SALE_TKT_WK_END_DT           AS FSCL_WK_END_DTE,\n       CAST(s.SALE_TKT_YR AS INT)     AS FSCL_YR_NUM,\n       CAST(s.SALE_TKT_PD AS INT)     AS FSCL_PD_NUM,\n       CAST(s.SALE_TKT_WK AS INT)     AS FSCL_WK_IN_PD_NUM,\n       SUM(TKT_SALE_AMT)              AS TKT_SALE_AMT,\n       SUM(TKT_SALE_QTY)              AS TKT_SALE_QTY,\n       SUM(TKT_SALE_WT)               AS TKT_SALE_WT,\n       SUM(GROSS_TKT_SALE_AMT)        AS GROSS_TKT_SALE_AMT,\n       SUM(GROSS_TKT_SALE_QTY)        AS GROSS_TKT_SALE_QTY,\n       SUM(GROSS_TKT_SALE_WT)         AS GROSS_TKT_SALE_WT,\n       SUM(NET_TKT_SALE_AMT)          AS NET_TKT_SALE_AMT,\n       SUM(NET_TKT_SALE_QTY)          AS NET_TKT_SALE_QTY,\n       SUM(NET_TKT_SALE_WT)           AS NET_TKT_SALE_WT,\n       SUM(AM_PROMO_ALLOW_AMT)        AS AM_PROMO_ALLOW_AMT,\n       SUM(AM_PROMO_SALE_AMT)         AS AM_PROMO_SALE_AMT,\n       SUM(AM_PROMO_SALE_QTY)         AS AM_PROMO_SALE_QTY,\n       SUM(FULL_REVNU_SALE_AMT)       AS FULL_REVNU_SALE_AMT,\n       SUM(FULL_REVNU_SALE_QTY)       AS FULL_REVNU_SALE_QTY\nFROM {{ ref('btg_fl_cust_v') }} c\nJOIN {{ ref('fl_sales') }} s ON c.cust_nbr = s.cust_nbr\nJOIN {{ ref('btg_fl_prod_v') }} p ON p.PROD_UPC = s.prod_upc AND p.PROD_SLBL = s.prod_slbl\nJOIN {{ ref('btg_msa_fl_xref') }} xref ON xref.fl_cust_id = s.cust_nbr\nGROUP BY xref.msa_id, p.prod_upc, p.prod_slbl,\n         s.SALE_TKT_WK_END_DT, s.SALE_TKT_YR,\n         s.SALE_TKT_PD, s.SALE_TKT_WK\n)\n\nSELECT * FROM prod_sales", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_fl_prod_sales"], "unique_id": "model.sdna_project.stg_fl_prod_sales", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_fl_prod_sales.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_fl_prod_sales.sql", "name": "stg_fl_prod_sales", "resource_type": "model", "alias": "stg_fl_prod_sales", "checksum": {"name": "sha256", "checksum": "e33761baef4c402c4c7e8e447123c94c5b79865f800043a449f839c58b4fda67"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_cust_v"], ["fl_sales"], ["btg_fl_prod_v"], ["btg_msa_fl_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.fl_sales", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_msa_fl_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_fl_sales": {"raw_sql": "WITH sales AS (\n\nSELECT\n    xref.msa_id,\n    SUM(s.tkt_sale_amt_cy_ytd)          AS tkt_sale_amt_cy_ytd,\n    SUM(s.tkt_sale_amt_py)              AS tkt_sale_amt_py,\n    SUM(s.tkt_sale_amt_2py)             AS tkt_sale_amt_2py,\n    SUM(s.tkt_sale_amt_py_ytd)          AS tkt_sale_amt_py_ytd,\n    SUM(s.tkt_sale_amt_2py_ytd)         AS tkt_sale_amt_2py_ytd,\n    SUM(s.tkt_sale_amt_cy_l13p)         AS tkt_sale_amt_cy_l13p,\n    SUM(s.tkt_sale_amt_py_l13p)         AS tkt_sale_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.tkt_sale_amt_cy_l4wk)        AS tkt_sale_amt_cy_l4wk,\n    SUM(s.tkt_sale_amt_py_l4wk)        AS tkt_sale_amt_py_l4wk,\n    SUM(s.tkt_sale_amt_cy_l12wk)        AS tkt_sale_amt_cy_l12wk,\n    SUM(s.tkt_sale_amt_py_l12wk)        AS tkt_sale_amt_py_l12wk,\n    SUM(s.tkt_sale_amt_cy_l26wk)        AS tkt_sale_amt_cy_l26wk,\n    SUM(s.tkt_sale_amt_py_l26wk)        AS tkt_sale_amt_py_l26wk,\n    --added code end\n    SUM(s.tkt_sale_amt_cy_l52wk)        AS tkt_sale_amt_cy_l52wk,\n    SUM(s.tkt_sale_amt_py_l52wk)        AS tkt_sale_amt_py_l52wk,\n    SUM(s.tkt_sale_qty_cy_ytd)          AS tkt_sale_qty_cy_ytd,\n    SUM(s.tkt_sale_qty_py)              AS tkt_sale_qty_py,\n    SUM(s.tkt_sale_qty_2py)             AS tkt_sale_qty_2py,\n    SUM(s.tkt_sale_qty_py_ytd)          AS tkt_sale_qty_py_ytd,\n    SUM(s.tkt_sale_qty_2py_ytd)         AS tkt_sale_qty_2py_ytd,\n    SUM(s.tkt_sale_qty_cy_l13p)         AS tkt_sale_qty_cy_l13p,\n    SUM(s.tkt_sale_qty_py_l13p)         AS tkt_sale_qty_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.tkt_sale_qty_cy_l4wk)        AS tkt_sale_qty_cy_l4wk,\n    SUM(s.tkt_sale_qty_py_l4wk)        AS tkt_sale_qty_py_l4wk,\n    SUM(s.tkt_sale_qty_cy_l12wk)        AS tkt_sale_qty_cy_l12wk,\n    SUM(s.tkt_sale_qty_py_l12wk)        AS tkt_sale_qty_py_l12wk,\n    SUM(s.tkt_sale_qty_cy_l26wk)        AS tkt_sale_qty_cy_l26wk,\n    SUM(s.tkt_sale_qty_py_l26wk)        AS tkt_sale_qty_py_l26wk,\n    --added code end\n    SUM(s.tkt_sale_qty_cy_l52wk)        AS tkt_sale_qty_cy_l52wk,\n    SUM(s.tkt_sale_qty_py_l52wk)        AS tkt_sale_qty_py_l52wk,\n    SUM(s.tkt_sale_wt_cy_ytd)           AS tkt_sale_wt_cy_ytd,\n    SUM(s.tkt_sale_wt_py)               AS tkt_sale_wt_py,\n    SUM(s.tkt_sale_wt_2py)              AS tkt_sale_wt_2py,\n    SUM(s.tkt_sale_wt_py_ytd)           AS tkt_sale_wt_py_ytd,\n    SUM(s.tkt_sale_wt_2py_ytd)          AS tkt_sale_wt_2py_ytd,\n    SUM(s.tkt_sale_wt_cy_l13p)          AS tkt_sale_wt_cy_l13p,\n    SUM(s.tkt_sale_wt_py_l13p)          AS tkt_sale_wt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.tkt_sale_wt_cy_l4wk)         AS tkt_sale_wt_cy_l4wk,\n    SUM(s.tkt_sale_wt_py_l4wk)         AS tkt_sale_wt_py_l4wk,\n    SUM(s.tkt_sale_wt_cy_l12wk)         AS tkt_sale_wt_cy_l12wk,\n    SUM(s.tkt_sale_wt_py_l12wk)         AS tkt_sale_wt_py_l12wk,\n    SUM(s.tkt_sale_wt_cy_l26wk)         AS tkt_sale_wt_cy_l26wk,\n    SUM(s.tkt_sale_wt_py_l26wk)         AS tkt_sale_wt_py_l26wk,\n    -- added code end\n    SUM(s.tkt_sale_wt_cy_l52wk)         AS tkt_sale_wt_cy_l52wk,\n    SUM(s.tkt_sale_wt_py_l52wk)         AS tkt_sale_wt_py_l52wk,\n    SUM(s.gross_tkt_sale_amt_cy_ytd)    AS gross_tkt_sale_amt_cy_ytd,\n    SUM(s.gross_tkt_sale_amt_py)        AS gross_tkt_sale_amt_py,\n    SUM(s.gross_tkt_sale_amt_2py)       AS gross_tkt_sale_amt_2py,\n    SUM(s.gross_tkt_sale_amt_py_ytd)    AS gross_tkt_sale_amt_py_ytd,\n    SUM(s.gross_tkt_sale_amt_2py_ytd)   AS gross_tkt_sale_amt_2py_ytd,\n    SUM(s.gross_tkt_sale_amt_cy_l13p)   AS gross_tkt_sale_amt_cy_l13p,\n    SUM(s.gross_tkt_sale_amt_py_l13p)   AS gross_tkt_sale_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.gross_tkt_sale_amt_cy_l4wk)  \tAS gross_tkt_sale_amt_cy_l4wk,\n    SUM(s.gross_tkt_sale_amt_py_l4wk)   AS gross_tkt_sale_amt_py_l4wk,\n    SUM(s.gross_tkt_sale_amt_cy_l12wk)  AS gross_tkt_sale_amt_cy_l12wk,\n    SUM(s.gross_tkt_sale_amt_py_l12wk)  AS gross_tkt_sale_amt_py_l12wk,\n    SUM(s.gross_tkt_sale_amt_cy_l26wk)  AS gross_tkt_sale_amt_cy_l26wk,\n    SUM(s.gross_tkt_sale_amt_py_l26wk)  AS gross_tkt_sale_amt_py_l26wk,\n    -- added code end\n    SUM(s.gross_tkt_sale_amt_cy_l52wk)  AS gross_tkt_sale_amt_cy_l52wk,\n    SUM(s.gross_tkt_sale_amt_py_l52wk)  AS gross_tkt_sale_amt_py_l52wk,\n    SUM(s.gross_tkt_sale_qty_cy_ytd)    AS gross_tkt_sale_qty_cy_ytd,\n    SUM(s.gross_tkt_sale_qty_py)        AS gross_tkt_sale_qty_py,\n    SUM(s.gross_tkt_sale_qty_2py)       AS gross_tkt_sale_qty_2py,\n    SUM(s.gross_tkt_sale_qty_py_ytd)    AS gross_tkt_sale_qty_py_ytd,\n    SUM(s.gross_tkt_sale_qty_2py_ytd)   AS gross_tkt_sale_qty_2py_ytd,\n    SUM(s.gross_tkt_sale_qty_cy_l13p)   AS gross_tkt_sale_qty_cy_l13p,\n    SUM(s.gross_tkt_sale_qty_py_l13p)   AS gross_tkt_sale_qty_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.gross_tkt_sale_qty_cy_l4wk)   AS gross_tkt_sale_qty_cy_l4wk,\n    SUM(s.gross_tkt_sale_qty_py_l4wk)   AS gross_tkt_sale_qty_py_l4wk,\n    SUM(s.gross_tkt_sale_qty_cy_l12wk)  AS gross_tkt_sale_qty_cy_l12wk,\n    SUM(s.gross_tkt_sale_qty_py_l12wk)  AS gross_tkt_sale_qty_py_l12wk,\n    SUM(s.gross_tkt_sale_qty_cy_l26wk)  AS gross_tkt_sale_qty_cy_l26wk,\n    SUM(s.gross_tkt_sale_qty_py_l26wk)  AS gross_tkt_sale_qty_py_l26wk,\n    -- added code end\n    SUM(s.gross_tkt_sale_qty_cy_l52wk)  AS gross_tkt_sale_qty_cy_l52wk,\n    SUM(s.gross_tkt_sale_qty_py_l52wk)  AS gross_tkt_sale_qty_py_l52wk,\n    SUM(s.gross_tkt_sale_wt_cy_ytd)     AS gross_tkt_sale_wt_cy_ytd,\n    SUM(s.gross_tkt_sale_wt_py)         AS gross_tkt_sale_wt_py,\n    SUM(s.gross_tkt_sale_wt_2py)        AS gross_tkt_sale_wt_2py,\n    SUM(s.gross_tkt_sale_wt_py_ytd)     AS gross_tkt_sale_wt_py_ytd,\n    SUM(s.gross_tkt_sale_wt_2py_ytd)    AS gross_tkt_sale_wt_2py_ytd,\n    SUM(s.gross_tkt_sale_wt_cy_l13p)    AS gross_tkt_sale_wt_cy_l13p,\n    SUM(s.gross_tkt_sale_wt_py_l13p)    AS gross_tkt_sale_wt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.gross_tkt_sale_wt_cy_l4wk)   AS gross_tkt_sale_wt_cy_l4wk,\n    SUM(s.gross_tkt_sale_wt_py_l4wk)   AS gross_tkt_sale_wt_py_l4wk,\n    SUM(s.gross_tkt_sale_wt_cy_l12wk)   AS gross_tkt_sale_wt_cy_l12wk,\n    SUM(s.gross_tkt_sale_wt_py_l12wk)   AS gross_tkt_sale_wt_py_l12wk,\n    SUM(s.gross_tkt_sale_wt_cy_l26wk)   AS gross_tkt_sale_wt_cy_l26wk,\n    SUM(s.gross_tkt_sale_wt_py_l26wk)   AS gross_tkt_sale_wt_py_l26wk,\n    -- added code end\n    SUM(s.gross_tkt_sale_wt_cy_l52wk)   AS gross_tkt_sale_wt_cy_l52wk,\n    SUM(s.gross_tkt_sale_wt_py_l52wk)   AS gross_tkt_sale_wt_py_l52wk,\n    SUM(s.net_tkt_sale_amt_cy_ytd)      AS net_tkt_sale_amt_cy_ytd,\n    SUM(s.net_tkt_sale_amt_py)          AS net_tkt_sale_amt_py,\n    SUM(s.net_tkt_sale_amt_2py)         AS net_tkt_sale_amt_2py,\n    SUM(s.net_tkt_sale_amt_py_ytd)      AS net_tkt_sale_amt_py_ytd,\n    SUM(s.net_tkt_sale_amt_2py_ytd)     AS net_tkt_sale_amt_2py_ytd,\n    SUM(s.net_tkt_sale_amt_cy_l13p)     AS net_tkt_sale_amt_cy_l13p,\n    SUM(s.net_tkt_sale_amt_py_l13p)     AS net_tkt_sale_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.net_tkt_sale_amt_cy_l4wk)    AS net_tkt_sale_amt_cy_l4wk,\n    SUM(s.net_tkt_sale_amt_py_l4wk)    AS net_tkt_sale_amt_py_l4wk,\n    SUM(s.net_tkt_sale_amt_cy_l12wk)    AS net_tkt_sale_amt_cy_l12wk,\n    SUM(s.net_tkt_sale_amt_py_l12wk)    AS net_tkt_sale_amt_py_l12wk,\n    SUM(s.net_tkt_sale_amt_cy_l26wk)    AS net_tkt_sale_amt_cy_l26wk,\n    SUM(s.net_tkt_sale_amt_py_l26wk)    AS net_tkt_sale_amt_py_l26wk,\n    -- added code end\n    SUM(s.net_tkt_sale_amt_cy_l52wk)    AS net_tkt_sale_amt_cy_l52wk,\n    SUM(s.net_tkt_sale_amt_py_l52wk)    AS net_tkt_sale_amt_py_l52wk,\n    SUM(s.net_tkt_sale_qty_cy_ytd)      AS net_tkt_sale_qty_cy_ytd,\n    SUM(s.net_tkt_sale_qty_py)          AS net_tkt_sale_qty_py,\n    SUM(s.net_tkt_sale_qty_2py)         AS net_tkt_sale_qty_2py,\n    SUM(s.net_tkt_sale_qty_py_ytd)      AS net_tkt_sale_qty_py_ytd,\n    SUM(s.net_tkt_sale_qty_2py_ytd)     AS net_tkt_sale_qty_2py_ytd,\n    SUM(s.net_tkt_sale_qty_cy_l13p)     AS net_tkt_sale_qty_cy_l13p,\n    SUM(s.net_tkt_sale_qty_py_l13p)     AS net_tkt_sale_qty_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.net_tkt_sale_qty_cy_l4wk)     AS net_tkt_sale_qty_cy_l4wk,\n    SUM(s.net_tkt_sale_qty_py_l4wk)     AS net_tkt_sale_qty_py_l4wk,\n    SUM(s.net_tkt_sale_qty_cy_l12wk)    AS net_tkt_sale_qty_cy_l12wk,\n    SUM(s.net_tkt_sale_qty_py_l12wk)    AS net_tkt_sale_qty_py_l12wk,\n    SUM(s.net_tkt_sale_qty_cy_l26wk)    AS net_tkt_sale_qty_cy_l26wk,\n    SUM(s.net_tkt_sale_qty_py_l26wk)    AS net_tkt_sale_qty_py_l26wk,\n    -- added code end\n    SUM(s.net_tkt_sale_qty_cy_l52wk)    AS net_tkt_sale_qty_cy_l52wk,\n    SUM(s.net_tkt_sale_qty_py_l52wk)    AS net_tkt_sale_qty_py_l52wk,\n    SUM(s.net_tkt_sale_wt_cy_ytd)       AS net_tkt_sale_wt_cy_ytd,\n    SUM(s.net_tkt_sale_wt_py)           AS net_tkt_sale_wt_py,\n    SUM(s.net_tkt_sale_wt_2py)          AS net_tkt_sale_wt_2py,\n    SUM(s.net_tkt_sale_wt_py_ytd)       AS net_tkt_sale_wt_py_ytd,\n    SUM(s.net_tkt_sale_wt_2py_ytd)      AS net_tkt_sale_wt_2py_ytd,\n    SUM(s.net_tkt_sale_wt_cy_l13p)      AS net_tkt_sale_wt_cy_l13p,\n    SUM(s.net_tkt_sale_wt_py_l13p)      AS net_tkt_sale_wt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.net_tkt_sale_wt_cy_l4wk)      AS net_tkt_sale_wt_cy_l4wk,\n    SUM(s.net_tkt_sale_wt_py_l4wk)      AS net_tkt_sale_wt_py_l4wk,\n    SUM(s.net_tkt_sale_wt_cy_l12wk)     AS net_tkt_sale_wt_cy_l12wk,\n    SUM(s.net_tkt_sale_wt_py_l12wk)     AS net_tkt_sale_wt_py_l12wk,\n    SUM(s.net_tkt_sale_wt_cy_l26wk)     AS net_tkt_sale_wt_cy_l26wk,\n    SUM(s.net_tkt_sale_wt_py_l26wk)     AS net_tkt_sale_wt_py_l26wk,\n    -- added code end\n    SUM(s.net_tkt_sale_wt_cy_l52wk)     AS net_tkt_sale_wt_cy_l52wk,\n    SUM(s.net_tkt_sale_wt_py_l52wk)     AS net_tkt_sale_wt_py_l52wk,\n    SUM(s.am_promo_allow_amt_cy_ytd)    AS am_promo_allow_amt_cy_ytd,\n    SUM(s.am_promo_allow_amt_py)        AS am_promo_allow_amt_py,\n    SUM(s.am_promo_allow_amt_2py)       AS am_promo_allow_amt_2py,\n    SUM(s.am_promo_allow_amt_py_ytd)    AS am_promo_allow_amt_py_ytd,\n    SUM(s.am_promo_allow_amt_2py_ytd)   AS am_promo_allow_amt_2py_ytd,\n    SUM(s.am_promo_allow_amt_cy_l13p)   AS am_promo_allow_amt_cy_l13p,\n    SUM(s.am_promo_allow_amt_py_l13p)   AS am_promo_allow_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.am_promo_allow_amt_cy_l4wk)   AS am_promo_allow_amt_cy_l4wk,\n    SUM(s.am_promo_allow_amt_py_l4wk)   AS am_promo_allow_amt_py_l4wk,\n    SUM(s.am_promo_allow_amt_cy_l12wk)  AS am_promo_allow_amt_cy_l12wk,\n    SUM(s.am_promo_allow_amt_py_l12wk)  AS am_promo_allow_amt_py_l12wk,\n    SUM(s.am_promo_allow_amt_cy_l26wk)  AS am_promo_allow_amt_cy_l26wk,\n    SUM(s.am_promo_allow_amt_py_l26wk)  AS am_promo_allow_amt_py_l26wk,\n    -- added code end\n    SUM(s.am_promo_allow_amt_cy_l52wk)  AS am_promo_allow_amt_cy_l52wk,\n    SUM(s.am_promo_allow_amt_py_l52wk)  AS am_promo_allow_amt_py_l52wk,\n    SUM(s.am_promo_sale_amt_cy_ytd)     AS am_promo_sale_amt_cy_ytd,\n    SUM(s.am_promo_sale_amt_py)         AS am_promo_sale_amt_py,\n    SUM(s.am_promo_sale_amt_2py)        AS am_promo_sale_amt_2py,\n    SUM(s.am_promo_sale_amt_py_ytd)     AS am_promo_sale_amt_py_ytd,\n    SUM(s.am_promo_sale_amt_2py_ytd)    AS am_promo_sale_amt_2py_ytd,\n    SUM(s.am_promo_sale_amt_cy_l13p)    AS am_promo_sale_amt_cy_l13p,\n    SUM(s.am_promo_sale_amt_py_l13p)    AS am_promo_sale_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.am_promo_sale_amt_cy_l4wk)    AS am_promo_sale_amt_cy_l4wk,\n    SUM(s.am_promo_sale_amt_py_l4wk)    AS am_promo_sale_amt_py_l4wk,\n    SUM(s.am_promo_sale_amt_cy_l12wk)   AS am_promo_sale_amt_cy_l12wk,\n    SUM(s.am_promo_sale_amt_py_l12wk)   AS am_promo_sale_amt_py_l12wk,\n    SUM(s.am_promo_sale_amt_cy_l26wk)   AS am_promo_sale_amt_cy_l26wk,\n    SUM(s.am_promo_sale_amt_py_l26wk)   AS am_promo_sale_amt_py_l26wk,\n    -- added code end\n    SUM(s.am_promo_sale_amt_cy_l52wk)   AS am_promo_sale_amt_cy_l52wk,\n    SUM(s.am_promo_sale_amt_py_l52wk)   AS am_promo_sale_amt_py_l52wk,\n    SUM(s.am_promo_sale_qty_cy_ytd)     AS am_promo_sale_qty_cy_ytd,\n    SUM(s.am_promo_sale_qty_py)         AS am_promo_sale_qty_py,\n    SUM(s.am_promo_sale_qty_2py)        AS am_promo_sale_qty_2py,\n    SUM(s.am_promo_sale_qty_py_ytd)     AS am_promo_sale_qty_py_ytd,\n    SUM(s.am_promo_sale_qty_2py_ytd)    AS am_promo_sale_qty_2py_ytd,\n    SUM(s.am_promo_sale_qty_cy_l13p)    AS am_promo_sale_qty_cy_l13p,\n    SUM(s.am_promo_sale_qty_py_l13p)    AS am_promo_sale_qty_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.am_promo_sale_qty_cy_l4wk)    AS am_promo_sale_qty_cy_l4wk,\n    SUM(s.am_promo_sale_qty_py_l4wk)    AS am_promo_sale_qty_py_l4wk,\n    SUM(s.am_promo_sale_qty_cy_l12wk)   AS am_promo_sale_qty_cy_l12wk,\n    SUM(s.am_promo_sale_qty_py_l12wk)   AS am_promo_sale_qty_py_l12wk,\n    SUM(s.am_promo_sale_qty_cy_l26wk)   AS am_promo_sale_qty_cy_l26wk,\n    SUM(s.am_promo_sale_qty_py_l26wk)   AS am_promo_sale_qty_py_l26wk,\n    -- added code end\n    SUM(s.am_promo_sale_qty_cy_l52wk)   AS am_promo_sale_qty_cy_l52wk,\n    SUM(s.am_promo_sale_qty_py_l52wk)   AS am_promo_sale_qty_py_l52wk,\n    SUM(s.full_revnu_sale_amt_cy_ytd)   AS full_revnu_sale_amt_cy_ytd,\n    SUM(s.full_revnu_sale_amt_py)       AS full_revnu_sale_amt_py,\n    SUM(s.full_revnu_sale_amt_2py)      AS full_revnu_sale_amt_2py,\n    SUM(s.full_revnu_sale_amt_py_ytd)   AS full_revnu_sale_amt_py_ytd,\n    SUM(s.full_revnu_sale_amt_2py_ytd)  AS full_revnu_sale_amt_2py_ytd,\n    SUM(s.full_revnu_sale_amt_cy_l13p)  AS full_revnu_sale_amt_cy_l13p,\n    SUM(s.full_revnu_sale_amt_py_l13p)  AS full_revnu_sale_amt_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.full_revnu_sale_amt_cy_l4wk)  AS full_revnu_sale_amt_cy_l4wk,\n    SUM(s.full_revnu_sale_amt_py_l4wk)  AS full_revnu_sale_amt_py_l4wk,\n    SUM(s.full_revnu_sale_amt_cy_l12wk) AS full_revnu_sale_amt_cy_l12wk,\n    SUM(s.full_revnu_sale_amt_py_l12wk) AS full_revnu_sale_amt_py_l12wk,\n    SUM(s.full_revnu_sale_amt_cy_l26wk) AS full_revnu_sale_amt_cy_l26wk,\n    SUM(s.full_revnu_sale_amt_py_l26wk) AS full_revnu_sale_amt_py_l26wk,\n    -- added code end\n    SUM(s.full_revnu_sale_amt_cy_l52wk) AS full_revnu_sale_amt_cy_l52wk,\n    SUM(s.full_revnu_sale_amt_py_l52wk) AS full_revnu_sale_amt_py_l52wk,\n    SUM(s.full_revnu_sale_qty_cy_ytd)   AS full_revnu_sale_qty_cy_ytd,\n    SUM(s.full_revnu_sale_qty_py)       AS full_revnu_sale_qty_py,\n    SUM(s.full_revnu_sale_qty_2py)      AS full_revnu_sale_qty_2py,\n    SUM(s.full_revnu_sale_qty_py_ytd)   AS full_revnu_sale_qty_py_ytd,\n    SUM(s.full_revnu_sale_qty_2py_ytd)  AS full_revnu_sale_qty_2py_ytd,\n    SUM(s.full_revnu_sale_qty_cy_l13p)  AS full_revnu_sale_qty_cy_l13p,\n    SUM(s.full_revnu_sale_qty_py_l13p)  AS full_revnu_sale_qty_py_l13p,\n    -- added code for 4,12,26 week levels cols\n    SUM(s.full_revnu_sale_qty_cy_l4wk)  AS full_revnu_sale_qty_cy_l4wk,\n    SUM(s.full_revnu_sale_qty_py_l4wk)  AS full_revnu_sale_qty_py_l4wk,\n    SUM(s.full_revnu_sale_qty_cy_l12wk) AS full_revnu_sale_qty_cy_l12wk,\n    SUM(s.full_revnu_sale_qty_py_l12wk) AS full_revnu_sale_qty_py_l12wk,\n    SUM(s.full_revnu_sale_qty_cy_l26wk) AS full_revnu_sale_qty_cy_l26wk,\n    SUM(s.full_revnu_sale_qty_py_l26wk) AS full_revnu_sale_qty_py_l26wk,\n    -- added code end\n    SUM(s.full_revnu_sale_qty_cy_l52wk) AS full_revnu_sale_qty_cy_l52wk,\n    SUM(s.full_revnu_sale_qty_py_l52wk) AS full_revnu_sale_qty_py_l52wk\nFROM {{ ref('fl_sales_cust_agg') }} s\nJOIN {{ ref('btg_msa_fl_xref') }} xref ON xref.fl_cust_id = s.cust_nbr\nGROUP BY xref.msa_id\n)\n\nSELECT * FROM sales", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_fl_sales"], "unique_id": "model.sdna_project.stg_fl_sales", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_fl_sales.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_fl_sales.sql", "name": "stg_fl_sales", "resource_type": "model", "alias": "stg_fl_sales", "checksum": {"name": "sha256", "checksum": "09c11a13ce1d8906f0f235122f00273206ae4fdc70d2e031c063ebf5bed3acd9"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_sales_cust_agg"], ["btg_msa_fl_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_sales_cust_agg", "model.sdna_project.btg_msa_fl_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_fl_xref_unique": {"raw_sql": "WITH xref_unique AS (\n    -- stg_fl_xref_unique\nSELECT\n    xref.msa_id,\n    xref.fl_cust_id,\n    xrefagg.cust_cnt\nFROM {{ ref('btg_msa_fl_xref') }} xref\nJOIN (\n    SELECT msa_id,\n           COUNT(1) AS cust_cnt\n    FROM {{ ref('btg_msa_fl_xref') }}\n    GROUP BY msa_id\n) xrefagg\nON xref.msa_id = xrefagg.msa_id\nWHERE xref.sale_seq = 1\n)\n\nSELECT * FROM xref_unique", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_fl_xref_unique"], "unique_id": "model.sdna_project.stg_fl_xref_unique", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_fl_xref_unique.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_fl_xref_unique.sql", "name": "stg_fl_xref_unique", "resource_type": "model", "alias": "stg_fl_xref_unique", "checksum": {"name": "sha256", "checksum": "3c36346188f2fd0540ad47c9c35a75b4a72bb7d336a522bcbeeb447546f7cf92"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_msa_fl_xref"], ["btg_msa_fl_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_fl_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_pbc_cust": {"raw_sql": "WITH cust AS (\nSELECT\n    cust_id,\n    bulk_dely_flg,\n    chain_flg,\n    chain_owner_cde,\n    chain_owner_desc,\n    cur_stat_cde,\n    cur_stat_desc,\n    cur_stat_dte,\n    cust_prod_flg,\n    cust_serv_flg,\n    cust_org_flg,\n    cust_blg_flg,\n    cust_misc_flg,\n    cust_added_dte,\n    cust_lglnme,\n    lang_cde,\n    lang_desc,\n    loc_prod_id,\n    loc_serv_id,\n    nme,\n    natl_acct_flg,\n    po_reqd_flg,\n    pymt_term_beg_dte,\n    pymt_term_cde,\n    pymt_term_desc,\n    sep_inv_flg,\n    tax_exempt_num,\n    tin_num,\n    tin_type_cde,\n    tin_type_desc,\n    empl_tac_id,\n    cust_equip_flg,\n    udf_num,\n    vrtx_geo_cde,\n    bus_type_cde,\n    bus_type_desc,\n    tme_zone_cde,\n    tme_zone_desc,\n    cust_fobo_btlr_flg,\n    cust_fobo_cust_flg,\n    cust_fsv_flg,\n    prc_zone_id,\n    ethnic_cde,\n    ethnic_desc,\n    cust_ucs_cmctn_id,\n    cust_dab_num,\n    cust_dex_beg_dte,\n    leg_chain_num,\n    seas_clsd_beg_dte,\n    seas_clsd_end_dte,\n    cust_lgtud_num,\n    cust_latud_num,\n    bus_type_aggr_cde,\n    bus_type_aggr_desc,\n    outside_city_lmt_ind,\n    cust_last_actvty_dte,\n    grp1_type_desc,\n    grp1_ownr_id,\n    grp1_ownr_desc,\n    grp1_lvl_1_id,\n    grp1_lvl_1_desc,\n    grp1_lvl_2_id,\n    grp1_lvl_2_desc,\n    grp2_type_desc,\n    grp2_ownr_id,\n    grp2_ownr_desc,\n    grp2_lvl_1_ancstr_id,\n    grp2_lvl_1_ancstr_nme,\n    grp2_lvl_1_ancstr_prev_nme,\n    grp2_lvl_1_id,\n    grp2_lvl_1_desc,\n    grp2_lvl_2_id,\n    grp2_lvl_2_desc,\n    grp3_type_desc,\n    grp3_ownr_id,\n    grp3_ownr_desc,\n    grp3_lvl_1_id,\n    grp3_lvl_1_desc,\n    grp3_lvl_2_id,\n    grp3_lvl_2_desc,\n    loc_prod_nme,\n    loc_prod_mu_id,\n    loc_prod_mu_nme,\n    loc_prod_bu_id,\n    loc_prod_bu_nme,\n    loc_prod_area_rpt_id,\n    loc_prod_area_rpt_nme,\n    loc_prod_mu_rpt_id,\n    loc_prod_mu_rpt_nme,\n    loc_prod_bu_rpt_id,\n    loc_prod_bu_rpt_nme,\n    loc_serv_nme,\n    loc_serv_mu_id,\n    loc_serv_mu_nme,\n    loc_serv_bu_id,\n    loc_serv_bu_nme,\n    loc_serv_area_rpt_id,\n    loc_serv_area_rpt_nme,\n    loc_serv_mu_rpt_id,\n    loc_serv_mu_rpt_nme,\n    loc_serv_bu_rpt_id,\n    loc_serv_bu_rpt_nme,\n    bus_type_ctgy_cde,\n    bus_type_ctgy_desc,\n    grp4_type_desc,\n    grp4_ownr_id,\n    grp4_ownr_desc,\n    grp4_lvl_1_id,\n    grp4_lvl_1_desc,\n    grp4_lvl_2_id,\n    grp4_lvl_2_desc,\n    dex_vers_num,\n    dely_adr_city,\n    dely_adr_cntry_cde,\n    dely_adr_cnty,\n    dely_adr_state,\n    dely_adr_strt1,\n    dely_adr_strt2,\n    dely_adr_strt3,\n    dely_adr_zip,\n    dely_adr_zip5,\n    blg_adr_city,\n    blg_adr_cntry_cde,\n    blg_adr_cnty,\n    blg_adr_state,\n    blg_adr_strt1,\n    blg_adr_strt2,\n    blg_adr_strt3,\n    blg_adr_zip,\n    blg_adr_zip5,\n    mlg_adr_city,\n    mlg_adr_cntry_cde,\n    mlg_adr_cnty,\n    mlg_adr_state,\n    mlg_adr_strt1,\n    mlg_adr_strt2,\n    mlg_adr_strt3,\n    mlg_adr_zip,\n    mlg_adr_zip5,\n    sls_cnct_first_nme,\n    sls_cnct_last_nme,\n    sls_cnct_phone_acd_num,\n    sls_cnct_phone_num,\n    sls_cnct_phone_ext_num,\n    rpr_cnct_first_nme,\n    rpr_cnct_last_nme,\n    rpr_cnct_phone_acd_num,\n    rpr_cnct_phone_num,\n    rpr_cnct_phone_ext_num,\n    ts_cnct_first_nme,\n    ts_cnct_last_nme,\n    ts_cnct_phone_acd_num,\n    ts_cnct_phone_num,\n    ts_cnct_phone_ext_num,\n    fsv_cnct_first_nme,\n    fsv_cnct_last_nme,\n    fsv_cnct_phone_acd_num,\n    fsv_cnct_phone_num,\n    fsv_cnct_phone_ext_num,\n    merch_acct_flg,\n    min_ord_qty,\n    chrg_to_frnch,\n    inv_udf_num_cde,\n    inv_udf_num_desc,\n    dw_srce_id,\n    dw_updt_dte,\n    actv_dely_loc_id,\n    cust_cmnt_txt,\n    cust_origtn_cde\nFROM {{ ref('btg_pbc_cust_v') }}\n)\n\nSELECT * FROM cust", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_pbc_cust"], "unique_id": "model.sdna_project.stg_pbc_cust", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_pbc_cust.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_pbc_cust.sql", "name": "stg_pbc_cust", "resource_type": "model", "alias": "stg_pbc_cust", "checksum": {"name": "sha256", "checksum": "559c57068f15ea13011468f3048063de59df2a9c0d0389349506a33d6f4d1c49"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_cust_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_cust_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_pbc_sales": {"raw_sql": "WITH sales AS (\nSELECT\n    xref.msa_id,\n    SUM(s.dely_lne_qty_cy_ytd) AS dely_lne_qty_cy_ytd,\n    SUM(s.dely_lne_qty_py) AS dely_lne_qty_py,\n    SUM(s.dely_lne_qty_2py) AS dely_lne_qty_2py,\n    SUM(s.dely_lne_qty_py_ytd) AS dely_lne_qty_py_ytd,\n    SUM(s.dely_lne_qty_2py_ytd) AS dely_lne_qty_2py_ytd,\n    SUM(s.dely_lne_qty_cy_l13p) AS dely_lne_qty_cy_l13p,\n    SUM(s.dely_lne_qty_py_l13p) AS dely_lne_qty_py_l13p,\n    SUM(s.dely_lne_qty_cy_l4wk) AS dely_lne_qty_cy_l4wk,\n    SUM(s.dely_lne_qty_py_l4wk) AS dely_lne_qty_py_l4wk,\n    SUM(s.dely_lne_qty_cy_l12wk) AS dely_lne_qty_cy_l12wk,\n    SUM(s.dely_lne_qty_py_l12wk) AS dely_lne_qty_py_l12wk,\n    SUM(s.dely_lne_qty_cy_l26wk) AS dely_lne_qty_cy_l26wk,\n    SUM(s.dely_lne_qty_py_l26wk) AS dely_lne_qty_py_l26wk,\n    SUM(s.dely_lne_qty_cy_l52wk) AS dely_lne_qty_cy_l52wk,\n    SUM(s.dely_lne_qty_py_l52wk) AS dely_lne_qty_py_l52wk,\n    SUM(s.raw_vol_cy_ytd) AS raw_vol_cy_ytd,\n    SUM(s.raw_vol_py) AS raw_vol_py,\n    SUM(s.raw_vol_2py) AS raw_vol_2py,\n    SUM(s.raw_vol_py_ytd) AS raw_vol_py_ytd,\n    SUM(s.raw_vol_2py_ytd) AS raw_vol_2py_ytd,\n    SUM(s.raw_vol_cy_l13p) AS raw_vol_cy_l13p,\n    SUM(s.raw_vol_py_l13p) AS raw_vol_py_l13p,\n    SUM(s.raw_vol_cy_l4wk) AS raw_vol_cy_l4wk,\n    SUM(s.raw_vol_py_l4wk) AS raw_vol_py_l4wk,\n    SUM(s.raw_vol_cy_l12wk) AS raw_vol_cy_l12wk,\n    SUM(s.raw_vol_py_l12wk) AS raw_vol_py_l12wk,\n    SUM(s.raw_vol_cy_l26wk) AS raw_vol_cy_l26wk,\n    SUM(s.raw_vol_py_l26wk) AS raw_vol_py_l26wk,\n    SUM(s.raw_vol_cy_l52wk) AS raw_vol_cy_l52wk,\n    SUM(s.raw_vol_py_l52wk) AS raw_vol_py_l52wk,\n    SUM(s.eght_oz_vol_cy_ytd) AS eght_oz_vol_cy_ytd,\n    SUM(s.eght_oz_vol_py) AS eght_oz_vol_py,\n    SUM(s.eght_oz_vol_2py) AS eght_oz_vol_2py,\n    SUM(s.eght_oz_vol_py_ytd) AS eght_oz_vol_py_ytd,\n    SUM(s.eght_oz_vol_2py_ytd) AS eght_oz_vol_2py_ytd,\n    SUM(s.eght_oz_vol_cy_l13p) AS eght_oz_vol_cy_l13p,\n    SUM(s.eght_oz_vol_py_l13p) AS eght_oz_vol_py_l13p,\n    SUM(s.eght_oz_vol_cy_l4wk) AS eght_oz_vol_cy_l4wk,\n    SUM(s.eght_oz_vol_py_l4wk) AS eght_oz_vol_py_l4wk,\n    SUM(s.eght_oz_vol_cy_l12wk) AS eght_oz_vol_cy_l12wk,\n    SUM(s.eght_oz_vol_py_l12wk) AS eght_oz_vol_py_l12wk,\n    SUM(s.eght_oz_vol_cy_l26wk) AS eght_oz_vol_cy_l26wk,\n    SUM(s.eght_oz_vol_py_l26wk) AS eght_oz_vol_py_l26wk,\n    SUM(s.eght_oz_vol_cy_l52wk) AS eght_oz_vol_cy_l52wk,\n    SUM(s.eght_oz_vol_py_l52wk) AS eght_oz_vol_py_l52wk,\n    SUM(s.net_rev_cy_ytd) AS net_rev_cy_ytd,\n    SUM(s.net_rev_py) AS net_rev_py,\n    SUM(s.net_rev_2py) AS net_rev_2py,\n    SUM(s.net_rev_py_ytd) AS net_rev_py_ytd,\n    SUM(s.net_rev_2py_ytd) AS net_rev_2py_ytd,\n    SUM(s.net_rev_cy_l13p) AS net_rev_cy_l13p,\n    SUM(s.net_rev_py_l13p) AS net_rev_py_l13p,\n    SUM(s.net_rev_cy_l4wk) AS net_rev_cy_l4wk,\n    SUM(s.net_rev_py_l4wk) AS net_rev_py_l4wk,\n    SUM(s.net_rev_cy_l12wk) AS net_rev_cy_l12wk,\n    SUM(s.net_rev_py_l12wk) AS net_rev_py_l12wk,\n    SUM(s.net_rev_cy_l26wk) AS net_rev_cy_l26wk,\n    SUM(s.net_rev_py_l26wk) AS net_rev_py_l26wk,\n    SUM(s.net_rev_cy_l52wk) AS net_rev_cy_l52wk,\n    SUM(s.net_rev_py_l52wk) AS net_rev_py_l52wk\nFROM {{ ref('pbc_sales_cust_agg_no_allied') }} AS s\nJOIN {{ ref('btg_msa_pbc_xref') }} AS xref ON xref.pbc_cust_id = s.cust_id\nGROUP BY xref.msa_id\n)\n\nSELECT * FROM sales", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_pbc_sales"], "unique_id": "model.sdna_project.stg_pbc_sales", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_pbc_sales.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_pbc_sales.sql", "name": "stg_pbc_sales", "resource_type": "model", "alias": "stg_pbc_sales", "checksum": {"name": "sha256", "checksum": "137ad2b04ccd7a0dd29e3390dd3846215237a13e48bad18d499cce2ab2b48b3a"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales_cust_agg_no_allied"], ["btg_msa_pbc_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales_cust_agg_no_allied", "model.sdna_project.btg_msa_pbc_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.stg_pbc_xref_unique": {"raw_sql": "WITH xref_unique AS (\n\nSELECT\n    xref.msa_id,\n    xref.pbc_cust_id,\n    xrefagg.cust_cnt\nFROM\n    {{ ref('btg_msa_pbc_xref') }} AS xref\n    JOIN (\n        SELECT\n            msa_id,\n            COUNT(1) AS cust_cnt\n        FROM\n            {{ ref('btg_msa_pbc_xref') }}\n        GROUP BY\n            msa_id\n    ) xrefagg ON xref.msa_id = xrefagg.msa_id\nWHERE\n    xref.sale_seq = 1\n)\n\nSELECT * FROM xref_unique", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "btg", "stg_pbc_xref_unique"], "unique_id": "model.sdna_project.stg_pbc_xref_unique", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/btg/stg_pbc_xref_unique.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/btg/stg_pbc_xref_unique.sql", "name": "stg_pbc_xref_unique", "resource_type": "model", "alias": "stg_pbc_xref_unique", "checksum": {"name": "sha256", "checksum": "dd8059c683f4f41736fed67919eafe0caf55e6fb2acff58ae6e88aa9c595c46c"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_msa_pbc_xref"], ["btg_msa_pbc_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.btg_msa_pbc_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_tdlinx1": {"raw_sql": "-- cm_btg_fl_sales_tdlinx1\n-- CTE for cm_btg_fl_sales_cust_wk_prod_v and cm_btg_fl_sales_cust_pd_prod_v\n\nSELECT\n\t\tUPPER(td.AULNAME) AS AULNAME,\n\t\tUPPER(td.SGRPNM) AS SGRPNM,\n\t\tUPPER(td.SNAME) AS SNAME,\n\t\tNULL AS SNO, --UPPER(SNO) AS SNO,\n\t\tUPPER(td.SSTREETADD) AS SSTREETADD,\n\t\tUPPER(td.SCITY) AS SCITY,\n\t\tUPPER(td.SST) AS SST,\n\t\tSUBSTR(td.SZIP, 1, 5) AS SZIP,\n\t\tUPPER(td.MCOUNTYNM) AS MCOUNTYNM,\n\t\ttd.FIPS,\n\t\tUPPER(td.STRADECLCD) AS STRADECLCD,\n\t\tUPPER(td.SFORMATCD) AS SFORMATCD,\n\t\tUPPER(td.STRADECLDESC) AS STRADECLDESC,\n\t\tUPPER(td.SFORMATDESC) AS SFORMATDESC,\n\t\tUPPER(td.SSTATUSIND) AS SSTATUSIND,\n\t\tUPPER(td.STDLINXSCD) AS STDLINXSCD,\n\t\ttd.SLAT,\n\t\ttd.SLONG,\n\t\ttd.msa_id AS tdl_msa_id,\n\t\tUPPER(rma.iri_retailer) AS iri_retailer,\n\t\tUPPER(rma.iri_rma1) AS iri_rma1,\n\t\tUPPER(rma.iri_rma2) AS iri_rma2,\n\t\tUPPER(rma.iri_rma3) AS iri_rma3,\n\t\tUPPER(rma.iri_rma4) AS iri_rma4,\n\t\tUPPER(rma.iri_rma5) AS iri_rma5,\n\t\tUPPER(rma.iri_rma6) AS iri_rma6,\n\t\tUPPER(rma.iri_rma7) AS iri_rma7,\n\t\tUPPER(rma.iri_rma8) AS iri_rma8,\n\t\tUPPER(rma.iri_rma9) AS iri_rma9,\n        CASE WHEN UPPER(rma.iri_rma1) LIKE '%-RMA%' THEN 'RMA' WHEN UPPER(rma.iri_rma1) LIKE '%-SRMA%' THEN 'SRMA' END AS RMA_SRMA,\n\t\tCASE WHEN srma.tdlinx_id IS NULL THEN 'N' ELSE 'Y' END AS corporate_srma,\n\t\tUPPER(fi.iri_pbc_div) AS iri_pbc_div,\n\t\tUPPER(fi.iri_pbc_mkt) AS iri_pbc_mkt,\n\t\tUPPER(zip.pbc_fbu_flg) AS pbc_fbu_flg\n    FROM\n        {{ ref('msa_tdlinx_xref_final') }} AS td\n        LEFT JOIN {{ ref('iri_rma_store_list') }} AS rma ON (td.stdlinxscd = rma.tdlinx_id)\n\t\tLEFT JOIN {{ ref('iri_srma_sample_stores') }} AS srma ON (td.stdlinxscd = srma.tdlinx_id)\n\t\tLEFT JOIN {{ ref('iri_pbc_markets_divs_by_fips') }} AS fi ON (fi.fips = td.fips)\n\t\tLEFT JOIN {{ ref('zip_code_priority_report') }} AS zip\n\t\t    ON (SUBSTR(TRIM(zip.zip_code), 0, 5) = SUBSTR(TRIM(td.SZIP), 0, 5))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_btg_fl_sales_tdlinx1"], "unique_id": "model.sdna_project.cm_btg_fl_sales_tdlinx1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_btg_fl_sales_tdlinx1.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_btg_fl_sales_tdlinx1.sql", "name": "cm_btg_fl_sales_tdlinx1", "resource_type": "model", "alias": "cm_btg_fl_sales_tdlinx1", "checksum": {"name": "sha256", "checksum": "273cdd4bf482464923f96d52715ed1a0038441b52148dcb28ed8271ee6896717"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_tdlinx1": {"raw_sql": "-- cm_btg_pbc_sales_tdlinx1\n-- CTE for cm_btg_pbc_sales_cust_wk_prod_v and cm_btg_pbc_sales_cust_pd_prod_v\n\nSELECT\n\t\tUPPER(td.AULNAME) AS AULNAME,\n\t\tUPPER(td.SGRPNM) AS SGRPNM,\n\t\tUPPER(td.SNAME) AS SNAME,\n\t\tNULL AS SNO, --UPPER(SNO) AS SNO,\n\t\tUPPER(td.SSTREETADD) AS SSTREETADD,\n\t\tUPPER(td.SCITY) AS SCITY,\n\t\tUPPER(td.SST) AS SST,\n\t\tSUBSTR(td.SZIP, 1, 5) AS SZIP,\n\t\tUPPER(td.MCOUNTYNM) AS MCOUNTYNM,\n\t\ttd.FIPS,\n\t\tUPPER(td.STRADECLCD) AS STRADECLCD,\n\t\tUPPER(td.SFORMATCD) AS SFORMATCD,\n\t\tUPPER(td.STRADECLDESC) AS STRADECLDESC,\n\t\tUPPER(td.SFORMATDESC) AS SFORMATDESC,\n\t\tUPPER(td.SSTATUSIND) AS SSTATUSIND,\n\t\tUPPER(td.STDLINXSCD) AS STDLINXSCD,\n\t\ttd.SLAT,\n\t\ttd.SLONG,\n\t\ttd.msa_id AS tdl_msa_id,\n\t\tUPPER(rma.iri_retailer) AS iri_retailer,\n\t\tUPPER(rma.iri_rma1) AS iri_rma1,\n\t\tUPPER(rma.iri_rma2) AS iri_rma2,\n\t\tUPPER(rma.iri_rma3) AS iri_rma3,\n\t\tUPPER(rma.iri_rma4) AS iri_rma4,\n\t\tUPPER(rma.iri_rma5) AS iri_rma5,\n\t\tUPPER(rma.iri_rma6) AS iri_rma6,\n\t\tUPPER(rma.iri_rma7) AS iri_rma7,\n\t\tUPPER(rma.iri_rma8) AS iri_rma8,\n\t\tUPPER(rma.iri_rma9) AS iri_rma9,\n\t\tCASE WHEN UPPER(rma.iri_rma1) LIKE '%-RMA%' THEN 'RMA' WHEN UPPER(rma.iri_rma1) LIKE '%-SRMA%' THEN 'SRMA' END AS RMA_SRMA,\n\t\tCASE WHEN srma.tdlinx_id IS NULL THEN 'N' ELSE 'Y' END AS corporate_srma,\n\t\tUPPER(fi.iri_pbc_div) AS iri_pbc_div,\n\t\tUPPER(fi.iri_pbc_mkt) AS iri_pbc_mkt,\n\t\tUPPER(zip.division) AS division_zipfile,\n\t\tUPPER(zip.pbc_fbu_flg) AS pbc_fbu_flg,\n\t\tUPPER(zip.market) AS market_zipfile\n\tFROM\n\t\t{{ ref('msa_tdlinx_xref_final') }} AS td\n\t\tLEFT JOIN {{ ref('iri_rma_store_list') }} AS rma ON (td.stdlinxscd = rma.tdlinx_id)\n\t\tLEFT JOIN {{ ref('iri_srma_sample_stores') }} AS srma ON (td.stdlinxscd = srma.tdlinx_id)\n\t\tLEFT JOIN {{ ref('iri_pbc_markets_divs_by_fips') }} AS fi ON (fi.fips = td.fips)\n\t\tLEFT JOIN {{ ref('zip_code_priority_report') }} AS zip\n\t\t    ON (SUBSTR(TRIM(zip.zip_code), 0, 5) = SUBSTR(TRIM(td.SZIP), 0, 5))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_btg_pbc_sales_tdlinx1"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_tdlinx1", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_btg_pbc_sales_tdlinx1.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_btg_pbc_sales_tdlinx1.sql", "name": "cm_btg_pbc_sales_tdlinx1", "resource_type": "model", "alias": "cm_btg_pbc_sales_tdlinx1", "checksum": {"name": "sha256", "checksum": "84e47ac190e18bd42ffbbe914cd362d09545733f31264d0b46e02d838a028c01"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc": {"raw_sql": "select\n    sls.msa_id\n    ,sls.fl_cust_id\n    ,sls.prod_upc\n    ,sls.prod_slbl\n    ,sls.upc_10\n    --cust attributes\n    ,sls.cust_name\n    ,sls.address\n    ,sls.city\n    ,sls.state\n    ,sls.zip5\n    ,sls.zip9\n    ,sls.county\n    ,sls.latitude\n    ,sls.longitude\n    ,sls.division_id\n    ,sls.division\n    ,sls.region_id\n    ,sls.region\n    ,sls.zone_id\n    ,sls.zone\n    ,sls.district_id\n    ,sls.district\n    ,sls.rt_nbr\n    ,sls.trade_chanl_code\n    ,sls.trade_chanl_descp\n    ,sls.chain_lvl1_node_nbr\n    ,sls.chain_lvl1_node_nm\n    ,sls.chain_lvl2_node_nbr\n    ,sls.chain_lvl2_node_nm\n    ,sls.chain_lvl3_node_nbr\n    ,sls.chain_lvl3_node_nm\n    ,sls.chain_lvl4_node_nbr\n    ,sls.chain_lvl4_node_nm\n    ,seq.categ_code\n    ,seq.categ_descp\n    ,seq.bus_unit_code\n    ,seq.bus_unit_descp\n    ,seq.brand_code\n    ,seq.brand_descp\n    ,seq.prod_tkt_descp_txt\n    ,seq.bdc_descp\n    ,seq.sale_class_code\n    ,seq.sale_class_descp\n    ,seq.size_code\n    ,seq.size_descp\n    ,seq.flvr_code\n    ,seq.flvr_descp\n    ,seq.bus_unit_code_new\n    ,seq.bus_unit_descp_new\n    ,seq.major_cat\n    ,seq.major_cat_size\n    ,sls.tkt_sale_amt_cy_ytd\n    ,sls.tkt_sale_amt_py\n    ,sls.tkt_sale_amt_2py\n    ,sls.tkt_sale_amt_py_ytd\n    ,sls.tkt_sale_amt_2py_ytd\n    ,sls.tkt_sale_amt_cy_l13p\n    ,sls.tkt_sale_amt_py_l13p\n    ,sls.tkt_sale_amt_cy_l4wk\n    ,sls.tkt_sale_amt_py_l4wk\n    ,sls.tkt_sale_amt_cy_l12wk\n    ,sls.tkt_sale_amt_py_l12wk\n    ,sls.tkt_sale_amt_cy_l26wk\n    ,sls.tkt_sale_amt_py_l26wk\n    ,sls.tkt_sale_amt_cy_l52wk\n    ,sls.tkt_sale_amt_py_l52wk\n    ,sls.tkt_sale_qty_cy_ytd\n    ,sls.tkt_sale_qty_py\n    ,sls.tkt_sale_qty_2py\n    ,sls.tkt_sale_qty_py_ytd\n    ,sls.tkt_sale_qty_2py_ytd\n    ,sls.tkt_sale_qty_cy_l13p\n    ,sls.tkt_sale_qty_py_l13p\n    ,sls.tkt_sale_qty_cy_l4wk\n    ,sls.tkt_sale_qty_py_l4wk\n    ,sls.tkt_sale_qty_cy_l12wk\n    ,sls.tkt_sale_qty_py_l12wk\n    ,sls.tkt_sale_qty_cy_l26wk\n    ,sls.tkt_sale_qty_py_l26wk\n    ,sls.tkt_sale_qty_cy_l52wk\n    ,sls.tkt_sale_qty_py_l52wk\n    ,sls.tkt_sale_wt_cy_ytd\n    ,sls.tkt_sale_wt_py\n    ,sls.tkt_sale_wt_2py\n    ,sls.tkt_sale_wt_py_ytd\n    ,sls.tkt_sale_wt_2py_ytd\n    ,sls.tkt_sale_wt_cy_l13p\n    ,sls.tkt_sale_wt_py_l13p\n    ,sls.tkt_sale_wt_cy_l4wk\n    ,sls.tkt_sale_wt_py_l4wk\n    ,sls.tkt_sale_wt_cy_l12wk\n    ,sls.tkt_sale_wt_py_l12wk\n    ,sls.tkt_sale_wt_cy_l26wk\n    ,sls.tkt_sale_wt_py_l26wk\n    ,sls.tkt_sale_wt_cy_l52wk\n    ,sls.tkt_sale_wt_py_l52wk\n    ,sls.gross_tkt_sale_amt_cy_ytd\n    ,sls.gross_tkt_sale_amt_py\n    ,sls.gross_tkt_sale_amt_2py\n    ,sls.gross_tkt_sale_amt_py_ytd\n    ,sls.gross_tkt_sale_amt_2py_ytd\n    ,sls.gross_tkt_sale_amt_cy_l13p\n    ,sls.gross_tkt_sale_amt_py_l13p\n    ,sls.gross_tkt_sale_amt_cy_l4wk\n    ,sls.gross_tkt_sale_amt_py_l4wk\n    ,sls.gross_tkt_sale_amt_cy_l12wk\n    ,sls.gross_tkt_sale_amt_py_l12wk\n    ,sls.gross_tkt_sale_amt_cy_l26wk\n    ,sls.gross_tkt_sale_amt_py_l26wk\n    ,sls.gross_tkt_sale_amt_cy_l52wk\n    ,sls.gross_tkt_sale_amt_py_l52wk\n    ,sls.gross_tkt_sale_qty_cy_ytd\n    ,sls.gross_tkt_sale_qty_py\n    ,sls.gross_tkt_sale_qty_2py\n    ,sls.gross_tkt_sale_qty_py_ytd\n    ,sls.gross_tkt_sale_qty_2py_ytd\n    ,sls.gross_tkt_sale_qty_cy_l13p\n    ,sls.gross_tkt_sale_qty_py_l13p\n    ,sls.gross_tkt_sale_qty_cy_l4wk\n    ,sls.gross_tkt_sale_qty_py_l4wk\n    ,sls.gross_tkt_sale_qty_cy_l12wk\n    ,sls.gross_tkt_sale_qty_py_l12wk\n    ,sls.gross_tkt_sale_qty_cy_l26wk\n    ,sls.gross_tkt_sale_qty_py_l26wk\n    ,sls.gross_tkt_sale_qty_cy_l52wk\n    ,sls.gross_tkt_sale_qty_py_l52wk\n    ,sls.gross_tkt_sale_wt_cy_ytd\n    ,sls.gross_tkt_sale_wt_py\n    ,sls.gross_tkt_sale_wt_2py\n    ,sls.gross_tkt_sale_wt_py_ytd\n    ,sls.gross_tkt_sale_wt_2py_ytd\n    ,sls.gross_tkt_sale_wt_cy_l13p\n    ,sls.gross_tkt_sale_wt_py_l13p\n    ,sls.gross_tkt_sale_wt_cy_l4wk\n    ,sls.gross_tkt_sale_wt_py_l4wk\n    ,sls.gross_tkt_sale_wt_cy_l12wk\n    ,sls.gross_tkt_sale_wt_py_l12wk\n    ,sls.gross_tkt_sale_wt_cy_l26wk\n    ,sls.gross_tkt_sale_wt_py_l26wk\n    ,sls.gross_tkt_sale_wt_cy_l52wk\n    ,sls.gross_tkt_sale_wt_py_l52wk\n    ,sls.net_tkt_sale_amt_cy_ytd\n    ,sls.net_tkt_sale_amt_py\n    ,sls.net_tkt_sale_amt_2py\n    ,sls.net_tkt_sale_amt_py_ytd\n    ,sls.net_tkt_sale_amt_2py_ytd\n    ,sls.net_tkt_sale_amt_cy_l13p\n    ,sls.net_tkt_sale_amt_py_l13p\n    ,sls.net_tkt_sale_amt_cy_l4wk\n    ,sls.net_tkt_sale_amt_py_l4wk\n    ,sls.net_tkt_sale_amt_cy_l12wk\n    ,sls.net_tkt_sale_amt_py_l12wk\n    ,sls.net_tkt_sale_amt_cy_l26wk\n    ,sls.net_tkt_sale_amt_py_l26wk\n    ,sls.net_tkt_sale_amt_cy_l52wk\n    ,sls.net_tkt_sale_amt_py_l52wk\n    ,sls.net_tkt_sale_qty_cy_ytd\n    ,sls.net_tkt_sale_qty_py\n    ,sls.net_tkt_sale_qty_2py\n    ,sls.net_tkt_sale_qty_py_ytd\n    ,sls.net_tkt_sale_qty_2py_ytd\n    ,sls.net_tkt_sale_qty_cy_l13p\n    ,sls.net_tkt_sale_qty_py_l13p\n    ,sls.net_tkt_sale_qty_cy_l4wk\n    ,sls.net_tkt_sale_qty_py_l4wk\n    ,sls.net_tkt_sale_qty_cy_l12wk\n    ,sls.net_tkt_sale_qty_py_l12wk\n    ,sls.net_tkt_sale_qty_cy_l26wk\n    ,sls.net_tkt_sale_qty_py_l26wk\n    ,sls.net_tkt_sale_qty_cy_l52wk\n    ,sls.net_tkt_sale_qty_py_l52wk\n    ,sls.net_tkt_sale_wt_cy_ytd\n    ,sls.net_tkt_sale_wt_py\n    ,sls.net_tkt_sale_wt_2py\n    ,sls.net_tkt_sale_wt_py_ytd\n    ,sls.net_tkt_sale_wt_2py_ytd\n    ,sls.net_tkt_sale_wt_cy_l13p\n    ,sls.net_tkt_sale_wt_py_l13p\n    ,sls.net_tkt_sale_wt_cy_l4wk\n    ,sls.net_tkt_sale_wt_py_l4wk\n    ,sls.net_tkt_sale_wt_cy_l12wk\n    ,sls.net_tkt_sale_wt_py_l12wk\n    ,sls.net_tkt_sale_wt_cy_l26wk\n    ,sls.net_tkt_sale_wt_py_l26wk\n    ,sls.net_tkt_sale_wt_cy_l52wk\n    ,sls.net_tkt_sale_wt_py_l52wk\n    ,sls.am_promo_allow_amt_cy_ytd\n    ,sls.am_promo_allow_amt_py\n    ,sls.am_promo_allow_amt_2py\n    ,sls.am_promo_allow_amt_py_ytd\n    ,sls.am_promo_allow_amt_2py_ytd\n    ,sls.am_promo_allow_amt_cy_l13p\n    ,sls.am_promo_allow_amt_py_l13p\n    ,sls.am_promo_allow_amt_cy_l4wk\n    ,sls.am_promo_allow_amt_py_l4wk\n    ,sls.am_promo_allow_amt_cy_l12wk\n    ,sls.am_promo_allow_amt_py_l12wk\n    ,sls.am_promo_allow_amt_cy_l26wk\n    ,sls.am_promo_allow_amt_py_l26wk\n    ,sls.am_promo_allow_amt_cy_l52wk\n    ,sls.am_promo_allow_amt_py_l52wk\n    ,sls.am_promo_sale_amt_cy_ytd\n    ,sls.am_promo_sale_amt_py\n    ,sls.am_promo_sale_amt_2py\n    ,sls.am_promo_sale_amt_py_ytd\n    ,sls.am_promo_sale_amt_2py_ytd\n    ,sls.am_promo_sale_amt_cy_l13p\n    ,sls.am_promo_sale_amt_py_l13p\n    ,sls.am_promo_sale_amt_cy_l4wk\n    ,sls.am_promo_sale_amt_py_l4wk\n    ,sls.am_promo_sale_amt_cy_l12wk\n    ,sls.am_promo_sale_amt_py_l12wk\n    ,sls.am_promo_sale_amt_cy_l26wk\n    ,sls.am_promo_sale_amt_py_l26wk\n    ,sls.am_promo_sale_amt_cy_l52wk\n    ,sls.am_promo_sale_amt_py_l52wk\n    ,sls.am_promo_sale_qty_cy_ytd\n    ,sls.am_promo_sale_qty_py\n    ,sls.am_promo_sale_qty_2py\n    ,sls.am_promo_sale_qty_py_ytd\n    ,sls.am_promo_sale_qty_2py_ytd\n    ,sls.am_promo_sale_qty_cy_l13p\n    ,sls.am_promo_sale_qty_py_l13p\n    ,sls.am_promo_sale_qty_cy_l4wk\n    ,sls.am_promo_sale_qty_py_l4wk\n    ,sls.am_promo_sale_qty_cy_l12wk\n    ,sls.am_promo_sale_qty_py_l12wk\n    ,sls.am_promo_sale_qty_cy_l26wk\n    ,sls.am_promo_sale_qty_py_l26wk\n    ,sls.am_promo_sale_qty_cy_l52wk\n    ,sls.am_promo_sale_qty_py_l52wk\n    ,sls.full_revnu_sale_amt_cy_ytd\n    ,sls.full_revnu_sale_amt_py\n    ,sls.full_revnu_sale_amt_2py\n    ,sls.full_revnu_sale_amt_py_ytd\n    ,sls.full_revnu_sale_amt_2py_ytd\n    ,sls.full_revnu_sale_amt_cy_l13p\n    ,sls.full_revnu_sale_amt_py_l13p\n    ,sls.full_revnu_sale_amt_cy_l4wk\n    ,sls.full_revnu_sale_amt_py_l4wk\n    ,sls.full_revnu_sale_amt_cy_l12wk\n    ,sls.full_revnu_sale_amt_py_l12wk\n    ,sls.full_revnu_sale_amt_cy_l26wk\n    ,sls.full_revnu_sale_amt_py_l26wk\n    ,sls.full_revnu_sale_amt_cy_l52wk\n    ,sls.full_revnu_sale_amt_py_l52wk\n    ,sls.full_revnu_sale_qty_cy_ytd\n    ,sls.full_revnu_sale_qty_py\n    ,sls.full_revnu_sale_qty_2py\n    ,sls.full_revnu_sale_qty_py_ytd\n    ,sls.full_revnu_sale_qty_2py_ytd\n    ,sls.full_revnu_sale_qty_cy_l13p\n    ,sls.full_revnu_sale_qty_py_l13p\n    ,sls.full_revnu_sale_qty_cy_l4wk\n    ,sls.full_revnu_sale_qty_py_l4wk\n    ,sls.full_revnu_sale_qty_cy_l12wk\n    ,sls.full_revnu_sale_qty_py_l12wk\n    ,sls.full_revnu_sale_qty_cy_l26wk\n    ,sls.full_revnu_sale_qty_py_l26wk\n    ,sls.full_revnu_sale_qty_cy_l52wk\n    ,sls.full_revnu_sale_qty_py_l52wk\nfrom {{ ref('cm_btg_fl_sales_cust_prod_invenid') }} sls\nleft join {{ ref('btg_fl_prod_upc_sale_seq') }} seq on seq.upc_10 = sls.upc_10 and seq.sale_seq = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_stage_btg_fl_sales_cust_prod_upc"], "unique_id": "model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_fl_sales_cust_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_fl_sales_cust_prod_upc.sql", "name": "cm_stage_btg_fl_sales_cust_prod_upc", "resource_type": "model", "alias": "cm_stage_btg_fl_sales_cust_prod_upc", "checksum": {"name": "sha256", "checksum": "af3e5a71a9107603073a31d11e6581ccde17d04fbd424fa0e2af828e63ed0609"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_btg_fl_sales_cust_prod_invenid"], ["btg_fl_prod_upc_sale_seq"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_btg_fl_sales_cust_prod_invenid", "model.sdna_project.btg_fl_prod_upc_sale_seq"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc": {"raw_sql": "-- Load cm_stage_btg_fl_sales_cust_wk_prod_upc\n\n-- {{ ref('cm_btg_fl_sales_cust_wk_prod_invenid') }}\n-- {{ ref('btg_fl_prod_upc_sale_seq') }}\n\nSELECT\n    sl.msa_id,\n\tsl.fl_cust_id,\n\tsl.prod_upc,\n\tsl.prod_slbl,\n\tsl.UPC_10,\n\tsl.fscl_wk_end_dte,\n\tsl.fscl_yr_num,\n\tsl.fscl_pd_num,\n\tsl.fscl_wk_in_pd_num --cust attributes\n\t,\n\tsl.cust_Name,\n\tsl.Address,\n\tsl.City,\n\tsl.State,\n\tsl.Zip5,\n\tsl.Zip9,\n\tsl.County,\n\tsl.Latitude,\n\tsl.Longitude,\n\tsl.Division_ID,\n\tsl.Division,\n\tsl.Region_ID,\n\tsl.Region,\n\tsl.Zone_ID,\n\tsl.Zone,\n\tsl.District_ID,\n\tsl.District,\n\tsl.rt_nbr,\n\tsl.trade_chanl_code,\n\tsl.trade_chanl_descp,\n\tsl.chain_lvl1_node_nbr,\n\tsl.chain_lvl1_node_nm,\n\tsl.chain_lvl2_node_nbr,\n\tsl.chain_lvl2_node_nm,\n\tsl.chain_lvl3_node_nbr,\n\tsl.chain_lvl3_node_nm,\n\tsl.chain_lvl4_node_nbr,\n\tsl.chain_lvl4_node_nm,\n\tseq.categ_code,\n\tseq.categ_descp,\n\tseq.bus_unit_code,\n\tseq.bus_unit_descp,\n\tseq.brand_code,\n\tseq.brand_descp,\n\tseq.prod_tkt_descp_txt,\n\tseq.bdc_descp,\n\tseq.sale_class_code,\n\tseq.sale_class_descp,\n\tseq.size_code,\n\tseq.size_descp,\n\tseq.flvr_code,\n\tseq.flvr_descp,\n\tseq.BUS_UNIT_CODE_NEW,\n\tseq.BUS_UNIT_DESCP_NEW,\n\tseq.MAJOR_CAT,\n\tseq.MAJOR_CAT_SIZE,\n\tsl.tkt_sale_amt,\n\tsl.tkt_sale_qty,\n\tsl.tkt_sale_wt,\n\tsl.gross_tkt_sale_amt,\n\tsl.gross_tkt_sale_qty,\n\tsl.gross_tkt_sale_wt,\n\tsl.net_tkt_sale_amt,\n\tsl.net_tkt_sale_qty,\n\tsl.net_tkt_sale_wt,\n\tsl.am_promo_allow_amt,\n\tsl.am_promo_sale_amt,\n\tsl.am_promo_sale_qty,\n\tsl.full_revnu_sale_amt,\n\tsl.full_revnu_sale_qty\nFROM\n    {{ ref('cm_btg_fl_sales_cust_wk_prod_invenid') }} AS sl\n\tLEFT JOIN {{ ref('btg_fl_prod_upc_sale_seq') }} AS seq\n        ON  seq.UPC_10 = sl.UPC_10 AND seq.sale_seq = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_stage_btg_fl_sales_cust_wk_prod_upc"], "unique_id": "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_fl_sales_cust_wk_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_fl_sales_cust_wk_prod_upc.sql", "name": "cm_stage_btg_fl_sales_cust_wk_prod_upc", "resource_type": "model", "alias": "cm_stage_btg_fl_sales_cust_wk_prod_upc", "checksum": {"name": "sha256", "checksum": "7bf885c73e6254e988d420f02e87120f7f1685c99d1baed56f21575a0f7ddb28"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_btg_fl_sales_cust_wk_prod_invenid"], ["btg_fl_prod_upc_sale_seq"], ["cm_btg_fl_sales_cust_wk_prod_invenid"], ["btg_fl_prod_upc_sale_seq"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.btg_fl_prod_upc_sale_seq"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc": {"raw_sql": "select\n    sls.msa_id\n    ,sls.pbc_cust_id\n    ,sls.inven_id\n    ,sls.upc_cde\n    ,seq.upc_descp\n    --cust attributes\n    ,sls.cust_name\n    ,sls.address\n    ,sls.city\n    ,sls.state\n    ,sls.zip5\n    ,sls.zip9\n    ,sls.county\n    --lat-long table attributes\n    ,sls.lat_qty\n    ,sls.lngtd_qty\n    ,sls.cur_stat_desc\n    --division hierarchy atributes\n    ,sls.division_id\n    ,sls.division\n    ,sls.region_id\n    ,sls.region\n    ,sls.market_id\n    ,sls.market\n    ,sls.location\n    --rte attributes\n    ,sls.terr_id\n    ,sls.terr_nme\n    ,sls.route_id\n    --some more cust attributes\n    ,sls.sub_channel_desc\n    ,sls.grp1_lvl_1_desc\n    ,sls.grp1_lvl_2_desc\n    ,sls.grp2_lvl_1_desc\n    ,sls.grp2_lvl_2_desc\n    ,sls.channel_cde\n    ,sls.channel_desc\n    ,sls.format_cde\n    ,sls.format_desc\n    --product attributes\n    ,seq.ctgy_type_cde\n    ,seq.ctgy_type_desc\n    ,seq.mkt_trdmrk_id\n    ,seq.mkt_trdmrk_desc\n    ,seq.trdmrk_cde\n    ,seq.trdmrk_desc\n    ,seq.brnd_id as brand_cde\n    ,seq.brnd_nme\n    ,seq.flvr_cde\n    ,seq.flvr_desc\n    ,seq.hrzn_prod_ctgy_desc\n    ,seq.hrzn_pkg_aggr_desc\n    ,seq.cont_desc\n    ,seq.pkg_cont_mtrl_desc\n    ,seq.pkg_clstr_mtrl_desc\n    ,seq.prod_grp_desc\n    ,seq.cont_uom_desc\n    ,seq.cont_uom_qty\n    ,seq.clust_cde\n    ,seq.clust_desc\n    ,seq.clust_qty\n    ,seq.ss_mp_ms\n    ,seq.ss_th\n    ,sls.dely_lne_qty_cy_ytd\n    ,sls.eaches_cy_ytd\n    ,sls.dely_lne_qty_py\n    ,sls.eaches_py\n    ,sls.dely_lne_qty_2py\n    ,sls.eaches_2py\n    ,sls.dely_lne_qty_py_ytd\n    ,sls.eaches_py_ytd\n    ,sls.dely_lne_qty_2py_ytd\n    ,sls.eaches_2py_ytd\n    ,sls.dely_lne_qty_cy_l13p\n    ,sls.eaches_cy_l13p\n    ,sls.dely_lne_qty_py_l13p\n    ,sls.eaches_py_l13p\n    ,sls.dely_lne_qty_cy_l4wk\n    ,sls.eaches_cy_l4wk\n    ,sls.dely_lne_qty_py_l4wk\n    ,sls.eaches_py_l4wk\n    ,sls.dely_lne_qty_cy_l12wk\n    ,sls.eaches_cy_l12wk\n    ,sls.dely_lne_qty_py_l12wk\n    ,sls.eaches_py_l12wk\n    ,sls.dely_lne_qty_cy_l26wk\n    ,sls.eaches_cy_l26wk\n    ,sls.dely_lne_qty_py_l26wk\n    ,sls.eaches_py_l26wk\n    ,sls.dely_lne_qty_cy_l52wk\n    ,sls.eaches_cy_l52wk\n    ,sls.dely_lne_qty_py_l52wk\n    ,sls.eaches_py_l52wk\n    ,sls.raw_vol_cy_ytd\n    ,sls.raw_vol_py\n    ,sls.raw_vol_2py\n    ,sls.raw_vol_py_ytd\n    ,sls.raw_vol_2py_ytd\n    ,sls.raw_vol_cy_l13p\n    ,sls.raw_vol_py_l13p\n    ,sls.raw_vol_cy_l4wk\n    ,sls.raw_vol_py_l4wk\n    ,sls.raw_vol_cy_l12wk\n    ,sls.raw_vol_py_l12wk\n    ,sls.raw_vol_cy_l26wk\n    ,sls.raw_vol_py_l26wk\n    ,sls.raw_vol_cy_l52wk\n    ,sls.raw_vol_py_l52wk\n    ,sls.eght_oz_vol_cy_ytd\n    ,sls.eght_oz_vol_py\n    ,sls.eght_oz_vol_2py\n    ,sls.eght_oz_vol_py_ytd\n    ,sls.eght_oz_vol_2py_ytd\n    ,sls.eght_oz_vol_cy_l13p\n    ,sls.eght_oz_vol_py_l13p\n    ,sls.eght_oz_vol_cy_l4wk\n    ,sls.eght_oz_vol_py_l4wk\n    ,sls.eght_oz_vol_cy_l12wk\n    ,sls.eght_oz_vol_py_l12wk\n    ,sls.eght_oz_vol_cy_l26wk\n    ,sls.eght_oz_vol_py_l26wk\n    ,sls.eght_oz_vol_cy_l52wk\n    ,sls.eght_oz_vol_py_l52wk\n    ,sls.net_rev_cy_ytd\n    ,sls.net_rev_py\n    ,sls.net_rev_2py\n    ,sls.net_rev_py_ytd\n    ,sls.net_rev_2py_ytd\n    ,sls.net_rev_cy_l13p\n    ,sls.net_rev_py_l13p\n    ,sls.net_rev_cy_l4wk\n    ,sls.net_rev_py_l4wk\n    ,sls.net_rev_cy_l12wk\n    ,sls.net_rev_py_l12wk\n    ,sls.net_rev_cy_l26wk\n    ,sls.net_rev_py_l26wk\n    ,sls.net_rev_cy_l52wk\n    ,sls.net_rev_py_l52wk\n    ,sls.last_updt_dt\nfrom {{ ref('cm_btg_pbc_sales_cust_prod_invenid') }} sls\nleft join {{ ref('btg_pbc_prod_upc_sale_seq') }} seq\n    on seq.upc_cde = sls.upc_cde\n    and seq.upc_sale_seq = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_stage_btg_pbc_sales_cust_prod_upc"], "unique_id": "model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_pbc_sales_cust_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_pbc_sales_cust_prod_upc.sql", "name": "cm_stage_btg_pbc_sales_cust_prod_upc", "resource_type": "model", "alias": "cm_stage_btg_pbc_sales_cust_prod_upc", "checksum": {"name": "sha256", "checksum": "fd103229cdea2027aca70f6deda0df262e1162b3ee8052b94896cea4eaf74bf5"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_btg_pbc_sales_cust_prod_invenid"], ["btg_pbc_prod_upc_sale_seq"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.btg_pbc_prod_upc_sale_seq"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc": {"raw_sql": "-- Load cm_stage_btg_pbc_sales_cust_wk_prod_upc\n\n-- {{ ref('cm_btg_pbc_sales_cust_wk_prod_invenid') }}\n-- {{ ref('btg_pbc_prod_upc_sale_seq') }}\n\nSELECT\n    msa_id,\n\tpbc_cust_id,\n\tinven_id,\n\tsl.upc_cde,\n\tseq.upc_descp,\n\tcust_name,\n\taddress,\n\tcity,\n\tstate,\n\tzip5,\n\tzip9,\n\tcounty,\n\tlat_qty,\n\tlngtd_qty,\n\tcur_stat_desc,\n\tdivision_id,\n\tdivision,\n\tregion_id,\n\tregion,\n\tmarket_id,\n\tmarket,\n\tlocation,\n\tterr_id,\n\tterr_nme,\n\troute_id,\n\tsub_channel_desc,\n\tgrp1_lvl_1_desc,\n\tgrp1_lvl_2_desc,\n\tgrp2_lvl_1_desc,\n\tgrp2_lvl_2_desc,\n\tchannel_cde,\n\tchannel_desc,\n\tformat_cde,\n\tformat_desc,\n\tseq.ctgy_type_cde,\n\tseq.ctgy_type_desc,\n\tseq.mkt_trdmrk_id,\n\tseq.mkt_trdmrk_desc,\n\tseq.trdmrk_cde,\n\tseq.trdmrk_desc,\n\tseq.brnd_id AS brand_cde,\n\tseq.brnd_nme,\n\tseq.flvr_cde,\n\tseq.flvr_desc,\n\tseq.hrzn_prod_ctgy_desc,\n\tseq.hrzn_pkg_aggr_desc,\n\tseq.cont_desc,\n\tseq.pkg_cont_mtrl_desc,\n\tseq.pkg_clstr_mtrl_desc,\n\tseq.prod_grp_desc,\n\tseq.cont_uom_desc,\n\tseq.cont_uom_qty,\n\tseq.clust_cde,\n\tseq.clust_desc,\n\tseq.clust_qty,\n\tseq.ss_mp_ms,\n\tseq.ss_th,\n\tsl.fscl_wk_end_dte,\n\tsl.fscl_yr_num,\n\tsl.fscl_pd_num,\n\tsl.fscl_wk_in_pd_num,\n\tsl.cases,\n\tsl.eaches,\n\tsl.raw_vol,\n\tsl.eght_oz_vol,\n\tsl.net_rev\nFROM\n    {{ ref('cm_btg_pbc_sales_cust_wk_prod_invenid') }} AS sl\n\tLEFT JOIN {{ ref('btg_pbc_prod_upc_sale_seq') }} AS seq ON seq.upc_cde = sl.upc_cde AND seq.upc_sale_seq = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "intermediate", "catmgmt", "cm_stage_btg_pbc_sales_cust_wk_prod_upc"], "unique_id": "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_pbc_sales_cust_wk_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/intermediate/catmgmt/cm_stage_btg_pbc_sales_cust_wk_prod_upc.sql", "name": "cm_stage_btg_pbc_sales_cust_wk_prod_upc", "resource_type": "model", "alias": "cm_stage_btg_pbc_sales_cust_wk_prod_upc", "checksum": {"name": "sha256", "checksum": "d7f0573a91da1088e2bb7f6dbf456fe7a83623a5d637ea15c3bb2c9d5193ce00"}, "config": {"enabled": true, "materialized": "ephemeral", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_btg_pbc_sales_cust_wk_prod_invenid"], ["btg_pbc_prod_upc_sale_seq"], ["cm_btg_pbc_sales_cust_wk_prod_invenid"], ["btg_pbc_prod_upc_sale_seq"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.btg_pbc_prod_upc_sale_seq"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "ephemeral", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_retailer_assgnt": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/btg_fl_retailer_assgnt.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_fl_retailer_assgnt"], "unique_id": "model.sdna_project.btg_fl_retailer_assgnt", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_fl_retailer_assgnt.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_fl_retailer_assgnt.sql", "name": "btg_fl_retailer_assgnt", "resource_type": "model", "alias": "btg_fl_retailer_assgnt", "checksum": {"name": "sha256", "checksum": "14e102b99a098a3d12265ae3f15664ce16886dd11f61ee0fae68ade0e7535362"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.btg_pbc_new_mkt_loc": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/new_pbc_mkt_loc_struct.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_pbc_new_mkt_loc"], "unique_id": "model.sdna_project.btg_pbc_new_mkt_loc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_pbc_new_mkt_loc.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_pbc_new_mkt_loc.sql", "name": "btg_pbc_new_mkt_loc", "resource_type": "model", "alias": "btg_pbc_new_mkt_loc", "checksum": {"name": "sha256", "checksum": "fd0c18ee1bb609a98b42298f8faba73de638279a5984caa767f733ec844d8739"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.btg_pbc_retailer_assgnt": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/btg_pbc_retailer_assgnt.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_pbc_retailer_assgnt"], "unique_id": "model.sdna_project.btg_pbc_retailer_assgnt", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_pbc_retailer_assgnt.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_pbc_retailer_assgnt.sql", "name": "btg_pbc_retailer_assgnt", "resource_type": "model", "alias": "btg_pbc_retailer_assgnt", "checksum": {"name": "sha256", "checksum": "145133c3e27732725fbfbe45707cd8453ae60f9792187e62bfcf1472b3a4c69f"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_PARSER"}}, "model.sdna_project.btg_pbc_route_data": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/btg_pbc_route_data.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_pbc_route_data"], "unique_id": "model.sdna_project.btg_pbc_route_data", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_pbc_route_data.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_pbc_route_data.sql", "name": "btg_pbc_route_data", "resource_type": "model", "alias": "btg_pbc_route_data", "checksum": {"name": "sha256", "checksum": "085c76d0a11719da222241c9b6d1d1cd79418272decae256fd08c8e1ded5b05c"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.btg_pep_calendar": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/btg_pep_calendar.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_pep_calendar"], "unique_id": "model.sdna_project.btg_pep_calendar", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_pep_calendar.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_pep_calendar.sql", "name": "btg_pep_calendar", "resource_type": "model", "alias": "btg_pep_calendar", "checksum": {"name": "sha256", "checksum": "94ba9e54af5993dbe887608feec4f56cb37be78192a7da0abce49ae5ef98dd79"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.btg_ref_calendar": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/btg_ref_calendar.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "btg_ref_calendar"], "unique_id": "model.sdna_project.btg_ref_calendar", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/btg_ref_calendar.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/btg_ref_calendar.sql", "name": "btg_ref_calendar", "resource_type": "model", "alias": "btg_ref_calendar", "checksum": {"name": "sha256", "checksum": "c0f79ae4e90a4a45b788f716007b094b733e738f12e20f0f8469e9b28a6ee479"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_cust": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_cust.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_cust"], "unique_id": "model.sdna_project.fl_cust", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_cust.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_cust.sql", "name": "fl_cust", "resource_type": "model", "alias": "fl_cust", "checksum": {"name": "sha256", "checksum": "2b90f8a87ccc9010af6a99f54a2f2aa75dec484c8fa2271d1b82f01a90bb8c52"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_prod": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_prod.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_prod"], "unique_id": "model.sdna_project.fl_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_prod.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_prod.sql", "name": "fl_prod", "resource_type": "model", "alias": "fl_prod", "checksum": {"name": "sha256", "checksum": "14f6d434b5b60b6d14dbf459b7d33300e0608ead062c530b9cbf86122c38bb29"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_sales_2018": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_sales_2018.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_sales_2018"], "unique_id": "model.sdna_project.fl_sales_2018", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_sales_2018.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_sales_2018.sql", "name": "fl_sales_2018", "resource_type": "model", "alias": "fl_sales_2018", "checksum": {"name": "sha256", "checksum": "6a8455abb3acb518a5b895ea8a43f59b2f31c99f1ce31c93e064fd1fd234d64c"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_sales_2019": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_sales_2019.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_sales_2019"], "unique_id": "model.sdna_project.fl_sales_2019", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_sales_2019.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_sales_2019.sql", "name": "fl_sales_2019", "resource_type": "model", "alias": "fl_sales_2019", "checksum": {"name": "sha256", "checksum": "aa1b5540cfd3806e2e4c128f73a3b8d39be764a7665dc3390b60a6852a1d8f34"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_sales_2020": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_sales_2020.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_sales_2020"], "unique_id": "model.sdna_project.fl_sales_2020", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_sales_2020.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_sales_2020.sql", "name": "fl_sales_2020", "resource_type": "model", "alias": "fl_sales_2020", "checksum": {"name": "sha256", "checksum": "6fb5b2dd56ec99fc85b2761aed088e011d759b2f939af7c6210bfae1b0aeaacf"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.fl_sales_2021": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/fl_sales_2021.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "fl_sales_2021"], "unique_id": "model.sdna_project.fl_sales_2021", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/fl_sales_2021.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/fl_sales_2021.sql", "name": "fl_sales_2021", "resource_type": "model", "alias": "fl_sales_2021", "checksum": {"name": "sha256", "checksum": "b8c31311f88f143e8d15e3d8ef94ee848e9c6235b4b4eff2022c0a1719d31cbd"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.mdm_msa_fl_xref": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/mdm_msa_fl_xref.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "mdm_msa_fl_xref"], "unique_id": "model.sdna_project.mdm_msa_fl_xref", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/mdm_msa_fl_xref.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/mdm_msa_fl_xref.sql", "name": "mdm_msa_fl_xref", "resource_type": "model", "alias": "mdm_msa_fl_xref", "checksum": {"name": "sha256", "checksum": "09b89c87ec0ab014e7a7c16351fe0c7d3c68d308b780caeea68177f5c82b2adf"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.mdm_msa_pbc_xref": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/mdm_msa_pbc_xref.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "mdm_msa_pbc_xref"], "unique_id": "model.sdna_project.mdm_msa_pbc_xref", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/mdm_msa_pbc_xref.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/mdm_msa_pbc_xref.sql", "name": "mdm_msa_pbc_xref", "resource_type": "model", "alias": "mdm_msa_pbc_xref", "checksum": {"name": "sha256", "checksum": "4b37bdf37bfe15f72dfef268fee008a30ebed88e543a39109d6a76c4e17ce318"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_cust": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_cust.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_cust"], "unique_id": "model.sdna_project.pbc_cust", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_cust.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_cust.sql", "name": "pbc_cust", "resource_type": "model", "alias": "pbc_cust", "checksum": {"name": "sha256", "checksum": "85df0f64f8591d91540adda1d5607a320370241d10fee56253b6cbedd2a94d3d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_prod": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_prod.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_prod"], "unique_id": "model.sdna_project.pbc_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_prod.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_prod.sql", "name": "pbc_prod", "resource_type": "model", "alias": "pbc_prod", "checksum": {"name": "sha256", "checksum": "901d4a56c3bc09aa9f2436a6dbce4339ac82b554d5a58b5874e8d459923352a1"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_sales_2018": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_sales_2018.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_sales_2018"], "unique_id": "model.sdna_project.pbc_sales_2018", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_sales_2018.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_sales_2018.sql", "name": "pbc_sales_2018", "resource_type": "model", "alias": "pbc_sales_2018", "checksum": {"name": "sha256", "checksum": "6176f55a897cdf9151df2cd22d9153e9ba92a72f9d66dd337b6b2d494570c97d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_sales_2019": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_sales_2019.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_sales_2019"], "unique_id": "model.sdna_project.pbc_sales_2019", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_sales_2019.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_sales_2019.sql", "name": "pbc_sales_2019", "resource_type": "model", "alias": "pbc_sales_2019", "checksum": {"name": "sha256", "checksum": "d03c9ce58c93938927b45789787813101619bca76339b67a0192bdd77b8708ed"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_sales_2020": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_sales_2020.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_sales_2020"], "unique_id": "model.sdna_project.pbc_sales_2020", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_sales_2020.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_sales_2020.sql", "name": "pbc_sales_2020", "resource_type": "model", "alias": "pbc_sales_2020", "checksum": {"name": "sha256", "checksum": "36ccb1cbf6c9697fe76c3959968cfca70da708a0418298c1e23afd15389e8df5"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.pbc_sales_2021": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_PIPE_NO_HEADER_PARSER'\n  )\n}}\n{{ external_stage('/sDNA/teradata_tpt_extracts/pbc_sales_2021.txt') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "btg", "pbc_sales_2021"], "unique_id": "model.sdna_project.pbc_sales_2021", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/btg/pbc_sales_2021.sql", "original_file_path": "models/sdna_us/store_sales/loads/btg/pbc_sales_2021.sql", "name": "pbc_sales_2021", "resource_type": "model", "alias": "pbc_sales_2021", "checksum": {"name": "sha256", "checksum": "5d5849cefec206f3bb89712c0b2b617a2e74ab7d3669ea224974318942c0eb80"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_PIPE_NO_HEADER_PARSER"}}, "model.sdna_project.iri_pbc_markets_divs_by_fips": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/raw_inputs/iri_pbc_markets_divisions_by_fips') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "iri_pbc_markets_divs_by_fips"], "unique_id": "model.sdna_project.iri_pbc_markets_divs_by_fips", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/iri_pbc_markets_divs_by_fips.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/iri_pbc_markets_divs_by_fips.sql", "name": "iri_pbc_markets_divs_by_fips", "resource_type": "model", "alias": "iri_pbc_markets_divs_by_fips", "checksum": {"name": "sha256", "checksum": "71023ae868ab521b65fb3c93faa8b1a0d6cd42eb019690bf580b6339f473615d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.iri_rma_store_list": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n    pattern='.*[.]csv'\n  )\n}}\n{{ external_stage('/sDNA/mvh/raw_inputs/iri_rma_store_list') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "iri_rma_store_list"], "unique_id": "model.sdna_project.iri_rma_store_list", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/iri_rma_store_list.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/iri_rma_store_list.sql", "name": "iri_rma_store_list", "resource_type": "model", "alias": "iri_rma_store_list", "checksum": {"name": "sha256", "checksum": "3e47fea8ef679c3a127873340d6dd67ce7d3a66fe407ca2f0a11476333d13d16"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER", "pattern": ".*[.]csv"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER", "pattern": ".*[.]csv"}}, "model.sdna_project.iri_srma_sample_stores": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/raw_inputs/iri_srma_sample_stores') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "iri_srma_sample_stores"], "unique_id": "model.sdna_project.iri_srma_sample_stores", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/iri_srma_sample_stores.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/iri_srma_sample_stores.sql", "name": "iri_srma_sample_stores", "resource_type": "model", "alias": "iri_srma_sample_stores", "checksum": {"name": "sha256", "checksum": "14aeeab2008fb0ac2dfa6c186f5e46669c524f5a639ce4adfd7019284a2aa978"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.msa_tdlinx_xref_final": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/tdlinx/msa_tdlinx_xref_final') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "msa_tdlinx_xref_final"], "unique_id": "model.sdna_project.msa_tdlinx_xref_final", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/msa_tdlinx_xref_final.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/msa_tdlinx_xref_final.sql", "name": "msa_tdlinx_xref_final", "resource_type": "model", "alias": "msa_tdlinx_xref_final", "checksum": {"name": "sha256", "checksum": "5df5b21e13c811622cb2cd352f69c21fc78b88c11aa52162cdc62fa4507aa6a3"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}}, "model.sdna_project.p_msa_cust_xref_tdlinx": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/tdlinx/P_MSA_CUST_XREF_TDLINX') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "p_msa_cust_xref_tdlinx"], "unique_id": "model.sdna_project.p_msa_cust_xref_tdlinx", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/p_msa_cust_xref_tdlinx.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/p_msa_cust_xref_tdlinx.sql", "name": "p_msa_cust_xref_tdlinx", "resource_type": "model", "alias": "p_msa_cust_xref_tdlinx", "checksum": {"name": "sha256", "checksum": "caaba037f8051bf403f4dd93f0d9edcfec9536fd11985d2f3f2492e0537ae114"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET_PARSER"}}, "model.sdna_project.zip_code_priority_report": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='CSV_COMMA_PARSER',\n  )\n}}\n{{ external_stage('/sDNA/mvh/raw_inputs/Zip_Code_Priority_Report') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "loads", "catmgmt", "zip_code_priority_report"], "unique_id": "model.sdna_project.zip_code_priority_report", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/loads/catmgmt/zip_code_priority_report.sql", "original_file_path": "models/sdna_us/store_sales/loads/catmgmt/zip_code_priority_report.sql", "name": "zip_code_priority_report", "resource_type": "model", "alias": "zip_code_priority_report", "checksum": {"name": "sha256", "checksum": "beee0037f6f6aa66159e3689fbf3d51a4e1af06cc19336ecc45a6955e68cb9fa"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "from_external_stage", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "CSV_COMMA_PARSER"}}, "model.sdna_project.btg_fl_cust_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_v\n\nSELECT\n    cust_nbr,\n    ctry_code,\n    ctry_descp,\n    co_code,\n    co_descp,\n    rt_nbr,\n    chain_node_sys_nbr,\n    cust_loc_nbr,\n    bus_loc_str_addr1,\n    bus_loc_str_addr2,\n    bus_loc_city,\n    bus_loc_cnty_sburb,\n    bus_loc_st_prov,\n    bus_loc_ctry,\n    bus_loc_post_code,\n    SUBSTRING(bus_loc_post_code, 1, 5) AS bus_loc_post_code_zip5,\n    contc_persn_nm,\n    cust_phone_nbr,\n    cust_fax_nbr,\n    contr_id,\n    prmy_cust_nbr,\n    first_sale_dt,\n    most_rcnt_sale_dt,\n    avg_wkly_sale_amt,\n    bus_type_code,\n    bus_type_descp,\n    facil_use_code,\n    facil_use_descp,\n    alt_cust_nbr,\n    alt_cust_nm,\n    cust_nm,\n    store_nbr,\n    dept_code,\n    cust_legal_nm,\n    cust_stat_code,\n    trade_seg_code,\n    trade_seg_descp,\n    trade_chanl_code,\n    trade_chanl_descp,\n    prstg_cust_flg,\n    cod_reasn_code,\n    cod_reasn_descp,\n    paymt_type_code,\n    paymt_type_descp,\n    bill_loc_nbr,\n    cr_risk_code,\n    cr_risk_descp,\n    cr_appv_stat_code,\n    cr_appv_stat_descp,\n    contr_disc_pct,\n    auth_prod_list_nbr,\n    promo_lock_in_flg,\n    alowb_promo_code,\n    serv_freq_code,\n    serv_freq_descp,\n    serv_wk_nbr,\n    serv_day_nbr,\n    indep_cust_flg,\n    prmy_qty_type_code,\n    own_code,\n    frhse_flg,\n    temp_cust_flg,\n    distrib_flg,\n    co_prmy_ft_qty,\n    co_fem_qty,\n    co_max_qty,\n    co_other_qty,\n    cmpet_prmy_ft_qty,\n    cmpet_fem_qty,\n    cmpet_max_qty,\n    cmpet_other_qty,\n    dspla_acct_flg,\n    store_dspla_txt,\n    scan_pay_flg,\n    dex_flg,\n    duns_nbr,\n    cust_bus_seg_code,\n    cust_bus_seg_descp,\n    clr_dir_deliv_flg,\n    mltry_cust_flg,\n    accpt_dflt_ck_flg,\n    are_class_code,\n    comm_type,\n    comm_type_descp,\n    unit_case_flg,\n    tdlinx_id,\n    tdlinx_trade_chanl,\n    prmy_equip_code,\n    cust_type_categ,\n    phy_loc_str_addr1,\n    phy_loc_str_addr2,\n    phy_loc_city,\n    phy_loc_cnty_sburb,\n    phy_loc_st_prov,\n    phy_loc_ctry,\n    phy_loc_post_code,\n    SUBSTRING(phy_loc_post_code, 1, 5) AS phy_loc_post_code_zip5,\n    close_cross_str,\n    lat_code,\n    lon_code,\n    deliv_freq_code,\n    deliv_wk_nbr,\n    deliv_day_nbr,\n    cust_end_date,\n    serv_incl_no_sale_freq_code,\n    serv_incl_no_sale_freq_descp,\n    serv_incl_no_sale_wk_nbr,\n    serv_incl_no_sale_day_nbr,\n    prod_deliv_freq_code,\n    prod_deliv_freq_descp,\n    prod_deliv_wk_nbr,\n    prod_deliv_day_nbr,\n    ship_note,\n    chain_lvl1_node_nbr,\n    chain_lvl1_node_nm,\n    chain_lvl2_key,\n    chain_lvl2_node_nbr,\n    chain_lvl2_node_nm,\n    chain_lvl3_key,\n    chain_lvl3_node_nbr,\n    chain_lvl3_node_nm,\n    chain_lvl4_key,\n    chain_lvl4_node_nbr,\n    chain_lvl4_node_nm,\n    chain_lvl5_key,\n    chain_lvl5_node_nbr,\n    chain_lvl5_node_nm,\n    chain_lvl6_key,\n    chain_lvl6_node_nbr,\n    chain_lvl6_node_nm,\n    cost_ctr,\n    geo_type_code,\n    geo_lvl4_contc_nm,\n    geo_lvl4_key,\n    geo_lvl4_node_nbr,\n    geo_lvl4_node_nm,\n    geo_lvl3_key,\n    geo_lvl3_node_nbr,\n    geo_lvl3_node_nm,\n    geo_lvl2_key,\n    geo_lvl2_node_nbr,\n    geo_lvl2_node_nm,\n    geo_lvl1_node_nbr,\n    geo_lvl1_node_nm,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('fl_cust') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_cust_v"], "unique_id": "model.sdna_project.btg_fl_cust_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_cust_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_cust_v.sql", "name": "btg_fl_cust_v", "resource_type": "model", "alias": "btg_fl_cust_v", "checksum": {"name": "sha256", "checksum": "55a11c635e87e5504a4dc3cfdbfd39ab6dda0f3bc761627e02df4e243c699602"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_cust"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_cust"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_fl_prod_v\n\nSELECT\n    ctry_code,\n    co_code,\n    prod_upc,\n    prod_slbl,\n    prod_tkt_descp_txt,\n    prt_wt,\n    sale_um_code,\n    sale_um_descp,\n    prod_type_code,\n    upc_mfg_id,\n    sale_class_code,\n    sale_class_descp,\n    size_code,\n    size_descp,\n    flvr_code,\n    flvr_descp,\n    bdc_descp,\n    bus_unit_code,\n    bus_unit_descp,\n    bus_unit_seq_nbr,\n    sub_categ_code,\n    sub_categ_descp,\n    sub_categ_seq_nbr,\n    categ_code,\n    categ_descp,\n    categ_seq_nbr,\n    mfg_class_code,\n    mfg_class_descp,\n    case_nbr,\n    case_qty,\n    brand_code,\n    brand_descp,\n    distr_chanl,\n    cdsd_item_tempr,\n    cdsd_prmy_sell_um,\n    cdsd_serv_type_code,\n    cdsd_purch_type_code,\n    bdc_code,\n    pkg_type_code,\n    pkg_type_desc,\n    pkg_indic,\n    ck_digit,\n    mfg_id_len,\n    upc_len,\n    gtin,\n    CONCAT(SUBSTRING(upc_mfg_id, -5), SUBSTRING(CONCAT('0000', prod_upc),-5)) AS upc_10,\n    last_updt_dt\nFROM {{ ref('fl_prod') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_prod_v"], "unique_id": "model.sdna_project.btg_fl_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_prod_v.sql", "name": "btg_fl_prod_v", "resource_type": "model", "alias": "btg_fl_prod_v", "checksum": {"name": "sha256", "checksum": "85fcf5ed305602377cf49ab2b867cf036885c3a8f9d87e123cd396be8193784f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_retailer_assgnt_excptn_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load btg_fl_retailer_assgnt_excptn_v\n\n-- {{ ref('btg_fl_retailer_xref_v') }}\n-- {{ ref('btg_fl_sales_cust_v') }}\n\nSELECT DISTINCT\n    chain_lvl1_node_nm,\n\tchain_lvl2_node_nm,\n\tchain_lvl3_node_nm,\n\ttrade_chanl_descp,\n\tfl_retailer,\n\tassgnt_descp,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('btg_fl_retailer_xref_v') }} AS a\n\tINNER JOIN {{ ref('btg_fl_sales_cust_v') }} AS cust ON cust.msa_id = a.msa_id\nWHERE\n\ta.fl_retailer = 'NOT ASSIGNED'", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_retailer_assgnt_excptn_v"], "unique_id": "model.sdna_project.btg_fl_retailer_assgnt_excptn_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_retailer_assgnt_excptn_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_retailer_assgnt_excptn_v.sql", "name": "btg_fl_retailer_assgnt_excptn_v", "resource_type": "model", "alias": "btg_fl_retailer_assgnt_excptn_v", "checksum": {"name": "sha256", "checksum": "e8aca2c4ac0461e59569c7079bbc703383e463f031bf282e9be11302d2470b5a"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_retailer_xref_v"], ["btg_fl_sales_cust_v"], ["btg_fl_retailer_xref_v"], ["btg_fl_sales_cust_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_sales_cust_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_retailer_xref_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load btg_fl_retailer_xref_v\n\n-- {{ ref('btg_fl_retailer_assgnt') }}\n-- {{ ref('btg_fl_sales_cust_v') }}\n\nWITH fl_ret1 AS\n(\n    SELECT DISTINCT\n        a.chain_lvl1_node_nm,\n\t\ta.chain_lvl2_node_nm,\n\t\ta.trade_chanl_desc,\n\t\tCASE WHEN b.ct_chk > 1 THEN 'NOT ASSIGNED' ELSE a.fl_retailer END AS fl_retailer\n\tFROM\n\t\t{{ ref('btg_fl_retailer_assgnt') }} AS a\n\t\tJOIN (\n\t\t\tSELECT\n\t\t\t\tchain_lvl1_node_nm,\n\t\t\t\tchain_lvl2_node_nm,\n\t\t\t\ttrade_chanl_desc,\n\t\t\t\tCOUNT(DISTINCT fl_retailer) AS ct_chk\n\t\t\tFROM\n\t\t\t\t{{ ref('btg_fl_retailer_assgnt') }}\n\t\t\tGROUP BY\n\t\t\t\tchain_lvl1_node_nm,\n\t\t\t\tchain_lvl2_node_nm,\n\t\t\t\ttrade_chanl_desc\n\t\t) b ON CONCAT(\n            TRIM(UPPER(COALESCE(a.chain_lvl1_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(a.chain_lvl2_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(a.trade_chanl_desc, ' ')))\n        ) = CONCAT(\n            TRIM(UPPER(COALESCE(b.chain_lvl1_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(b.chain_lvl2_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(b.trade_chanl_desc, ' ')))\n        )\n),\nfl_ret2 AS\n(\n\tSELECT DISTINCT\n        a.chain_lvl1_node_nm,\n\t\ta.trade_chanl_desc,\n\t\tCASE WHEN b.ct_chk > 1 THEN 'NOT ASSIGNED' ELSE a.fl_retailer END AS fl_retailer\n\tFROM\n\t\t{{ ref('btg_fl_retailer_assgnt') }} AS a\n\t\tJOIN (\n\t\t\tSELECT\n\t\t\t\tchain_lvl1_node_nm,\n\t\t\t\ttrade_chanl_desc,\n\t\t\t\tCOUNT(DISTINCT fl_retailer) as ct_chk\n\t\t\tFROM\n\t\t\t\t{{ ref('btg_fl_retailer_assgnt') }}\n\t\t\tGROUP BY\n\t\t\t\tchain_lvl1_node_nm,\n\t\t\t\ttrade_chanl_desc\n\t\t) b ON CONCAT(\n            TRIM(UPPER(COALESCE(a.chain_lvl1_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(a.trade_chanl_desc, ' ')))\n        ) = CONCAT(\n            TRIM(UPPER(COALESCE(b.chain_lvl1_node_nm, ' '))),\n            TRIM(UPPER(COALESCE(b.trade_chanl_desc, ' ')))\n        )\n),\nfl_round_1_match AS\n(\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.chain_lvl1_node_nm,\n        cust.chain_lvl2_node_nm,\n        cust.chain_lvl3_node_nm,\n        cust.trade_chanl_descp,\n        (\n            CASE\n                WHEN (\n                    CONCAT(\n                        TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.chain_lvl2_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.chain_lvl3_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' ')))\n                    ) = CONCAT(\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl2_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl3_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' '))))\n                    )\n                THEN fl_ret.fl_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS fl_retailer_old,\n        1 AS Round_number\n    FROM\n         {{ ref('btg_fl_sales_cust_v') }} AS cust\n    JOIN\n         {{ ref('btg_fl_retailer_assgnt') }} AS fl_ret ON\n            CONCAT(\n                TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm,' '))),\n                TRIM(UPPER(COALESCE(cust.chain_lvl2_node_nm,' '))),\n                TRIM(UPPER(COALESCE(cust.chain_lvl3_node_nm,' '))),\n                TRIM(UPPER(COALESCE(cust.trade_chanl_descp,' ')))\n            ) = CONCAT(\n                TRIM(UPPER(COALESCE(fl_ret.chain_lvl1_node_nm,' '))),\n                TRIM(UPPER(COALESCE(fl_ret.chain_lvl2_node_nm,' '))),\n                TRIM(UPPER(COALESCE(fl_ret.chain_lvl3_node_nm,' '))),\n                TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc,' ')))\n            )\n),\nfl_round_2_match AS\n(\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.chain_lvl1_node_nm,\n        cust.chain_lvl2_node_nm,\n        cust.chain_lvl3_node_nm,\n        cust.trade_chanl_descp,\n        (\n            CASE\n                WHEN (\n                    CONCAT(\n                        TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.chain_lvl2_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' ')))\n                    ) = CONCAT(\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl2_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' '))))\n                    )\n                THEN fl_ret.fl_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS fl_retailer_old,\n        2 AS Round_number\n    FROM\n         {{ ref('btg_fl_sales_cust_v') }} cust\n    JOIN\n        fl_ret1 AS fl_ret\n    ON\n        (\n            CONCAT(\n                TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(cust.chain_lvl2_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' ')))\n            ) = CONCAT(\n                TRIM(UPPER(COALESCE(fl_ret.chain_lvl1_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(fl_ret.chain_lvl2_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' '))))\n            )\n),\nfl_round_3_match as\n   (\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.chain_lvl1_node_nm,\n        cust.chain_lvl2_node_nm,\n        cust.chain_lvl3_node_nm,\n        cust.trade_chanl_descp,\n        (\n            CASE\n                WHEN (\n                    CONCAT(\n                        TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' ')))\n                ) = CONCAT(\n                        TRIM(UPPER(COALESCE(fl_ret.chain_lvl1_node_nm, ' '))),\n                        TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' '))))\n                )\n                THEN fl_ret.fl_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS fl_retailer_old,\n        3 AS Round_number\n    FROM\n         {{ ref('btg_fl_sales_cust_v') }} AS cust\n    JOIN\n        fl_ret2 AS fl_ret\n    ON\n        (\n            CONCAT(\n                TRIM(UPPER(COALESCE(cust.chain_lvl1_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' ')))\n        ) = CONCAT(\n                TRIM(UPPER (COALESCE(fl_ret.chain_lvl1_node_nm, ' '))),\n                TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' '))))\n        )\n),\nfl_round_4_match as\n(\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.chain_lvl1_node_nm,\n        cust.chain_lvl2_node_nm,\n        cust.chain_lvl3_node_nm,\n        cust.trade_chanl_descp,\n        (\n            CASE\n                WHEN (\n                    TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' '))) =\n                    TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' ')))\n                )\n                THEN fl_ret.fl_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS fl_retailer_old,\n        4 AS Round_number\n    FROM\n         {{ ref('btg_fl_sales_cust_v') }} AS cust\n    LEFT JOIN\n        (\n            SELECT DISTINCT\n                trade_chanl_desc,\n                fl_retailer\n            FROM\n                 {{ ref('btg_fl_retailer_assgnt') }}\n            WHERE\n                IFNULL(chain_lvl1_node_nm, '') = ''\n        ) AS fl_ret\n    ON\n        TRIM(UPPER(COALESCE(cust.trade_chanl_descp, ' '))) =\n        TRIM(UPPER(COALESCE(fl_ret.trade_chanl_desc, ' ')))\n),\nfl_all_rounds AS\n(\n    SELECT * FROM fl_round_1_match\n    UNION ALL\n    SELECT * FROM fl_round_2_match\n    UNION ALL\n    SELECT * FROM fl_round_3_match\n    UNION ALL\n    SELECT * FROM fl_round_4_match\n)\nSELECT\n\tmsa_id,\n\tfl_retailer_old AS fl_retailer,\n\tCASE WHEN round_number = 1 THEN 'Business Assigned' ELSE 'IT assigned' END AS assgnt_descp,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t(\n\t\tSELECT\n\t\t\tmsa_id,\n\t\t\tfl_retailer_old,\n\t\t\tround_number,\n\t\t\tROW_NUMBER() OVER(\n\t\t\t\tPARTITION BY msa_id,\n\t\t\t\tchain_lvl1_node_nm,\n\t\t\t\tchain_lvl2_node_nm,\n\t\t\t\tchain_lvl3_node_nm,\n\t\t\t\ttrade_chanl_descp\n\t\t\t\tORDER BY\n\t\t\t\t\tround_number ASC\n\t\t\t) AS seq_num\n\t\tFROM\n\t\t\tfl_all_rounds\n\t) AS a\nWHERE\n\tseq_num = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_retailer_xref_v"], "unique_id": "model.sdna_project.btg_fl_retailer_xref_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_retailer_xref_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_retailer_xref_v.sql", "name": "btg_fl_retailer_xref_v", "resource_type": "model", "alias": "btg_fl_retailer_xref_v", "checksum": {"name": "sha256", "checksum": "7629a8091ce66fb7c5e5ea73c5325945167fd1dabf2e1b283d4819021546b20f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_retailer_assgnt"], ["btg_fl_sales_cust_v"], ["btg_fl_retailer_assgnt"], ["btg_fl_retailer_assgnt"], ["btg_fl_retailer_assgnt"], ["btg_fl_retailer_assgnt"], ["btg_fl_sales_cust_v"], ["btg_fl_retailer_assgnt"], ["btg_fl_sales_cust_v"], ["btg_fl_sales_cust_v"], ["btg_fl_sales_cust_v"], ["btg_fl_retailer_assgnt"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_retailer_assgnt"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_fl_sales_cust_prod_v\n\n-- {{ ref('fl_sales_cust_prod_agg') }}\n-- {{ ref('btg_msa_fl_xref') }}\n-- {{ ref('stg_fl_xref_unique') }}\n\nSELECT\n\txref_uniq.msa_id,\n    xref_uniq.fl_cust_id,\n    xref_uniq.cust_cnt,\n\tsales.prod_slbl,\n\tsales.prod_upc,\n\ttkt_sale_amt_cy_ytd,\n\ttkt_sale_amt_py,\n\ttkt_sale_amt_2py,\n\ttkt_sale_amt_py_ytd,\n\ttkt_sale_amt_2py_ytd,\n\ttkt_sale_amt_cy_l13p,\n\ttkt_sale_amt_py_l13p,\n\ttkt_sale_amt_cy_l4wk,\n\ttkt_sale_amt_py_l4wk,\n\ttkt_sale_amt_cy_l12wk,\n\ttkt_sale_amt_py_l12wk,\n\ttkt_sale_amt_cy_l26wk,\n\ttkt_sale_amt_py_l26wk,\n\ttkt_sale_amt_cy_l52wk,\n\ttkt_sale_amt_py_l52wk,\n\ttkt_sale_qty_cy_ytd,\n\ttkt_sale_qty_py,\n\ttkt_sale_qty_2py,\n\ttkt_sale_qty_py_ytd,\n\ttkt_sale_qty_2py_ytd,\n\ttkt_sale_qty_cy_l13p,\n\ttkt_sale_qty_py_l13p,\n\ttkt_sale_qty_cy_l4wk,\n\ttkt_sale_qty_py_l4wk,\n\ttkt_sale_qty_cy_l12wk,\n\ttkt_sale_qty_py_l12wk,\n\ttkt_sale_qty_cy_l26wk,\n\ttkt_sale_qty_py_l26wk,\n\ttkt_sale_qty_cy_l52wk,\n\ttkt_sale_qty_py_l52wk,\n\ttkt_sale_wt_cy_ytd,\n\ttkt_sale_wt_py,\n\ttkt_sale_wt_2py,\n\ttkt_sale_wt_py_ytd,\n\ttkt_sale_wt_2py_ytd,\n\ttkt_sale_wt_cy_l13p,\n\ttkt_sale_wt_py_l13p,\n\ttkt_sale_wt_cy_l4wk,\n\ttkt_sale_wt_py_l4wk,\n\ttkt_sale_wt_cy_l12wk,\n\ttkt_sale_wt_py_l12wk,\n\ttkt_sale_wt_cy_l26wk,\n\ttkt_sale_wt_py_l26wk,\n\ttkt_sale_wt_cy_l52wk,\n\ttkt_sale_wt_py_l52wk,\n\tgross_tkt_sale_amt_cy_ytd,\n\tgross_tkt_sale_amt_py,\n\tgross_tkt_sale_amt_2py,\n\tgross_tkt_sale_amt_py_ytd,\n\tgross_tkt_sale_amt_2py_ytd,\n\tgross_tkt_sale_amt_cy_l13p,\n\tgross_tkt_sale_amt_py_l13p,\n\tgross_tkt_sale_amt_cy_l4wk,\n\tgross_tkt_sale_amt_py_l4wk,\n\tgross_tkt_sale_amt_cy_l12wk,\n\tgross_tkt_sale_amt_py_l12wk,\n\tgross_tkt_sale_amt_cy_l26wk,\n\tgross_tkt_sale_amt_py_l26wk,\n\tgross_tkt_sale_amt_cy_l52wk,\n\tgross_tkt_sale_amt_py_l52wk,\n\tgross_tkt_sale_qty_cy_ytd,\n\tgross_tkt_sale_qty_py,\n\tgross_tkt_sale_qty_2py,\n\tgross_tkt_sale_qty_py_ytd,\n\tgross_tkt_sale_qty_2py_ytd,\n\tgross_tkt_sale_qty_cy_l13p,\n\tgross_tkt_sale_qty_py_l13p,\n\tgross_tkt_sale_qty_cy_l4wk,\n\tgross_tkt_sale_qty_py_l4wk,\n\tgross_tkt_sale_qty_cy_l12wk,\n\tgross_tkt_sale_qty_py_l12wk,\n\tgross_tkt_sale_qty_cy_l26wk,\n\tgross_tkt_sale_qty_py_l26wk,\n\tgross_tkt_sale_qty_cy_l52wk,\n\tgross_tkt_sale_qty_py_l52wk,\n\tgross_tkt_sale_wt_cy_ytd,\n\tgross_tkt_sale_wt_py,\n\tgross_tkt_sale_wt_2py,\n\tgross_tkt_sale_wt_py_ytd,\n\tgross_tkt_sale_wt_2py_ytd,\n\tgross_tkt_sale_wt_cy_l13p,\n\tgross_tkt_sale_wt_py_l13p,\n\tgross_tkt_sale_wt_cy_l4wk,\n\tgross_tkt_sale_wt_py_l4wk,\n\tgross_tkt_sale_wt_cy_l12wk,\n\tgross_tkt_sale_wt_py_l12wk,\n\tgross_tkt_sale_wt_cy_l26wk,\n\tgross_tkt_sale_wt_py_l26wk,\n\tgross_tkt_sale_wt_cy_l52wk,\n\tgross_tkt_sale_wt_py_l52wk,\n\tnet_tkt_sale_amt_cy_ytd,\n\tnet_tkt_sale_amt_py,\n\tnet_tkt_sale_amt_2py,\n\tnet_tkt_sale_amt_py_ytd,\n\tnet_tkt_sale_amt_2py_ytd,\n\tnet_tkt_sale_amt_cy_l13p,\n\tnet_tkt_sale_amt_py_l13p,\n\tnet_tkt_sale_amt_cy_l4wk,\n\tnet_tkt_sale_amt_py_l4wk,\n\tnet_tkt_sale_amt_cy_l12wk,\n\tnet_tkt_sale_amt_py_l12wk,\n\tnet_tkt_sale_amt_cy_l26wk,\n\tnet_tkt_sale_amt_py_l26wk,\n\tnet_tkt_sale_amt_cy_l52wk,\n\tnet_tkt_sale_amt_py_l52wk,\n\tnet_tkt_sale_qty_cy_ytd,\n\tnet_tkt_sale_qty_py,\n\tnet_tkt_sale_qty_2py,\n\tnet_tkt_sale_qty_py_ytd,\n\tnet_tkt_sale_qty_2py_ytd,\n\tnet_tkt_sale_qty_cy_l13p,\n\tnet_tkt_sale_qty_py_l13p,\n\tnet_tkt_sale_qty_cy_l4wk,\n\tnet_tkt_sale_qty_py_l4wk,\n\tnet_tkt_sale_qty_cy_l12wk,\n\tnet_tkt_sale_qty_py_l12wk,\n\tnet_tkt_sale_qty_cy_l26wk,\n\tnet_tkt_sale_qty_py_l26wk,\n\tnet_tkt_sale_qty_cy_l52wk,\n\tnet_tkt_sale_qty_py_l52wk,\n\tnet_tkt_sale_wt_cy_ytd,\n\tnet_tkt_sale_wt_py,\n\tnet_tkt_sale_wt_2py,\n\tnet_tkt_sale_wt_py_ytd,\n\tnet_tkt_sale_wt_2py_ytd,\n\tnet_tkt_sale_wt_cy_l13p,\n\tnet_tkt_sale_wt_py_l13p,\n\tnet_tkt_sale_wt_cy_l4wk,\n\tnet_tkt_sale_wt_py_l4wk,\n\tnet_tkt_sale_wt_cy_l12wk,\n\tnet_tkt_sale_wt_py_l12wk,\n\tnet_tkt_sale_wt_cy_l26wk,\n\tnet_tkt_sale_wt_py_l26wk,\n\tnet_tkt_sale_wt_cy_l52wk,\n\tnet_tkt_sale_wt_py_l52wk,\n\tam_promo_allow_amt_cy_ytd,\n\tam_promo_allow_amt_py,\n\tam_promo_allow_amt_2py,\n\tam_promo_allow_amt_py_ytd,\n\tam_promo_allow_amt_2py_ytd,\n\tam_promo_allow_amt_cy_l13p,\n\tam_promo_allow_amt_py_l13p,\n\tam_promo_allow_amt_cy_l4wk,\n\tam_promo_allow_amt_py_l4wk,\n\tam_promo_allow_amt_cy_l12wk,\n\tam_promo_allow_amt_py_l12wk,\n\tam_promo_allow_amt_cy_l26wk,\n\tam_promo_allow_amt_py_l26wk,\n\tam_promo_allow_amt_cy_l52wk,\n\tam_promo_allow_amt_py_l52wk,\n\tam_promo_sale_amt_cy_ytd,\n\tam_promo_sale_amt_py,\n\tam_promo_sale_amt_2py,\n\tam_promo_sale_amt_py_ytd,\n\tam_promo_sale_amt_2py_ytd,\n\tam_promo_sale_amt_cy_l13p,\n\tam_promo_sale_amt_py_l13p,\n\tam_promo_sale_amt_cy_l4wk,\n\tam_promo_sale_amt_py_l4wk,\n\tam_promo_sale_amt_cy_l12wk,\n\tam_promo_sale_amt_py_l12wk,\n\tam_promo_sale_amt_cy_l26wk,\n\tam_promo_sale_amt_py_l26wk,\n\tam_promo_sale_amt_cy_l52wk,\n\tam_promo_sale_amt_py_l52wk,\n\tam_promo_sale_qty_cy_ytd,\n\tam_promo_sale_qty_py,\n\tam_promo_sale_qty_2py,\n\tam_promo_sale_qty_py_ytd,\n\tam_promo_sale_qty_2py_ytd,\n\tam_promo_sale_qty_cy_l13p,\n\tam_promo_sale_qty_py_l13p,\n\tam_promo_sale_qty_cy_l4wk,\n\tam_promo_sale_qty_py_l4wk,\n\tam_promo_sale_qty_cy_l12wk,\n\tam_promo_sale_qty_py_l12wk,\n\tam_promo_sale_qty_cy_l26wk,\n\tam_promo_sale_qty_py_l26wk,\n\tam_promo_sale_qty_cy_l52wk,\n\tam_promo_sale_qty_py_l52wk,\n\tfull_revnu_sale_amt_cy_ytd,\n\tfull_revnu_sale_amt_py,\n\tfull_revnu_sale_amt_2py,\n\tfull_revnu_sale_amt_py_ytd,\n\tfull_revnu_sale_amt_2py_ytd,\n\tfull_revnu_sale_amt_cy_l13p,\n\tfull_revnu_sale_amt_py_l13p,\n\tfull_revnu_sale_amt_cy_l4wk,\n\tfull_revnu_sale_amt_py_l4wk,\n\tfull_revnu_sale_amt_cy_l12wk,\n\tfull_revnu_sale_amt_py_l12wk,\n\tfull_revnu_sale_amt_cy_l26wk,\n\tfull_revnu_sale_amt_py_l26wk,\n\tfull_revnu_sale_amt_cy_l52wk,\n\tfull_revnu_sale_amt_py_l52wk,\n\tfull_revnu_sale_qty_cy_ytd,\n\tfull_revnu_sale_qty_py,\n\tfull_revnu_sale_qty_2py,\n\tfull_revnu_sale_qty_py_ytd,\n\tfull_revnu_sale_qty_2py_ytd,\n\tfull_revnu_sale_qty_cy_l13p,\n\tfull_revnu_sale_qty_py_l13p,\n\tfull_revnu_sale_qty_cy_l4wk,\n\tfull_revnu_sale_qty_py_l4wk,\n\tfull_revnu_sale_qty_cy_l12wk,\n\tfull_revnu_sale_qty_py_l12wk,\n\tfull_revnu_sale_qty_cy_l26wk,\n\tfull_revnu_sale_qty_py_l26wk,\n\tfull_revnu_sale_qty_cy_l52wk,\n\tfull_revnu_sale_qty_py_l52wk,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t(\n\t\tSELECT\n\t\t\txref.msa_id,\n\t\t\ts.prod_slbl,\n\t\t\ts.prod_upc,\n\t\t\tSUM(tkt_sale_amt_cy_ytd) AS tkt_sale_amt_cy_ytd,\n\t\t\tSUM(tkt_sale_amt_py) AS tkt_sale_amt_py,\n\t\t\tSUM(tkt_sale_amt_2py) AS tkt_sale_amt_2py,\n\t\t\tSUM(tkt_sale_amt_py_ytd) AS tkt_sale_amt_py_ytd,\n\t\t\tSUM(tkt_sale_amt_2py_ytd) AS tkt_sale_amt_2py_ytd,\n\t\t\tSUM(tkt_sale_amt_cy_l13p) AS tkt_sale_amt_cy_l13p,\n\t\t\tSUM(tkt_sale_amt_py_l13p) AS tkt_sale_amt_py_l13p,\n\t\t\tSUM(tkt_sale_amt_cy_l4wk) AS tkt_sale_amt_cy_l4wk,\n\t\t\tSUM(tkt_sale_amt_py_l4wk) AS tkt_sale_amt_py_l4wk,\n\t\t\tSUM(tkt_sale_amt_cy_l12wk) AS tkt_sale_amt_cy_l12wk,\n\t\t\tSUM(tkt_sale_amt_py_l12wk) AS tkt_sale_amt_py_l12wk,\n\t\t\tSUM(tkt_sale_amt_cy_l26wk) AS tkt_sale_amt_cy_l26wk,\n\t\t\tSUM(tkt_sale_amt_py_l26wk) AS tkt_sale_amt_py_l26wk,\n\t\t\tSUM(tkt_sale_amt_cy_l52wk) AS tkt_sale_amt_cy_l52wk,\n\t\t\tSUM(tkt_sale_amt_py_l52wk) AS tkt_sale_amt_py_l52wk,\n\t\t\tSUM(tkt_sale_qty_cy_ytd) AS tkt_sale_qty_cy_ytd,\n\t\t\tSUM(tkt_sale_qty_py) AS tkt_sale_qty_py,\n\t\t\tSUM(tkt_sale_qty_2py) AS tkt_sale_qty_2py,\n\t\t\tSUM(tkt_sale_qty_py_ytd) AS tkt_sale_qty_py_ytd,\n\t\t\tSUM(tkt_sale_qty_2py_ytd) AS tkt_sale_qty_2py_ytd,\n\t\t\tSUM(tkt_sale_qty_cy_l13p) AS tkt_sale_qty_cy_l13p,\n\t\t\tSUM(tkt_sale_qty_py_l13p) AS tkt_sale_qty_py_l13p,\n\t\t\tSUM(tkt_sale_qty_cy_l4wk) AS tkt_sale_qty_cy_l4wk,\n\t\t\tSUM(tkt_sale_qty_py_l4wk) AS tkt_sale_qty_py_l4wk,\n\t\t\tSUM(tkt_sale_qty_cy_l12wk) AS tkt_sale_qty_cy_l12wk,\n\t\t\tSUM(tkt_sale_qty_py_l12wk) AS tkt_sale_qty_py_l12wk,\n\t\t\tSUM(tkt_sale_qty_cy_l26wk) AS tkt_sale_qty_cy_l26wk,\n\t\t\tSUM(tkt_sale_qty_py_l26wk) AS tkt_sale_qty_py_l26wk,\n\t\t\tSUM(tkt_sale_qty_cy_l52wk) AS tkt_sale_qty_cy_l52wk,\n\t\t\tSUM(tkt_sale_qty_py_l52wk) AS tkt_sale_qty_py_l52wk,\n\t\t\tSUM(tkt_sale_wt_cy_ytd) AS tkt_sale_wt_cy_ytd,\n\t\t\tSUM(tkt_sale_wt_py) AS tkt_sale_wt_py,\n\t\t\tSUM(tkt_sale_wt_2py) AS tkt_sale_wt_2py,\n\t\t\tSUM(tkt_sale_wt_py_ytd) AS tkt_sale_wt_py_ytd,\n\t\t\tSUM(tkt_sale_wt_2py_ytd) AS tkt_sale_wt_2py_ytd,\n\t\t\tSUM(tkt_sale_wt_cy_l13p) AS tkt_sale_wt_cy_l13p,\n\t\t\tSUM(tkt_sale_wt_py_l13p) AS tkt_sale_wt_py_l13p,\n\t\t\tSUM(tkt_sale_wt_cy_l4wk) AS tkt_sale_wt_cy_l4wk,\n\t\t\tSUM(tkt_sale_wt_py_l4wk) AS tkt_sale_wt_py_l4wk,\n\t\t\tSUM(tkt_sale_wt_cy_l12wk) AS tkt_sale_wt_cy_l12wk,\n\t\t\tSUM(tkt_sale_wt_py_l12wk) AS tkt_sale_wt_py_l12wk,\n\t\t\tSUM(tkt_sale_wt_cy_l26wk) AS tkt_sale_wt_cy_l26wk,\n\t\t\tSUM(tkt_sale_wt_py_l26wk) AS tkt_sale_wt_py_l26wk,\n\t\t\tSUM(tkt_sale_wt_cy_l52wk) AS tkt_sale_wt_cy_l52wk,\n\t\t\tSUM(tkt_sale_wt_py_l52wk) AS tkt_sale_wt_py_l52wk,\n\t\t\tSUM(gross_tkt_sale_amt_cy_ytd) AS gross_tkt_sale_amt_cy_ytd,\n\t\t\tSUM(gross_tkt_sale_amt_py) AS gross_tkt_sale_amt_py,\n\t\t\tSUM(gross_tkt_sale_amt_2py) AS gross_tkt_sale_amt_2py,\n\t\t\tSUM(gross_tkt_sale_amt_py_ytd) AS gross_tkt_sale_amt_py_ytd,\n\t\t\tSUM(gross_tkt_sale_amt_2py_ytd) AS gross_tkt_sale_amt_2py_ytd,\n\t\t\tSUM(gross_tkt_sale_amt_cy_l13p) AS gross_tkt_sale_amt_cy_l13p,\n\t\t\tSUM(gross_tkt_sale_amt_py_l13p) AS gross_tkt_sale_amt_py_l13p,\n\t\t\tSUM(gross_tkt_sale_amt_cy_l4wk) AS gross_tkt_sale_amt_cy_l4wk,\n\t\t\tSUM(gross_tkt_sale_amt_py_l4wk) AS gross_tkt_sale_amt_py_l4wk,\n\t\t\tSUM(gross_tkt_sale_amt_cy_l12wk) AS gross_tkt_sale_amt_cy_l12wk,\n\t\t\tSUM(gross_tkt_sale_amt_py_l12wk) AS gross_tkt_sale_amt_py_l12wk,\n\t\t\tSUM(gross_tkt_sale_amt_cy_l26wk) AS gross_tkt_sale_amt_cy_l26wk,\n\t\t\tSUM(gross_tkt_sale_amt_py_l26wk) AS gross_tkt_sale_amt_py_l26wk,\n\t\t\tSUM(gross_tkt_sale_amt_cy_l52wk) AS gross_tkt_sale_amt_cy_l52wk,\n\t\t\tSUM(gross_tkt_sale_amt_py_l52wk) AS gross_tkt_sale_amt_py_l52wk,\n\t\t\tSUM(gross_tkt_sale_qty_cy_ytd) AS gross_tkt_sale_qty_cy_ytd,\n\t\t\tSUM(gross_tkt_sale_qty_py) AS gross_tkt_sale_qty_py,\n\t\t\tSUM(gross_tkt_sale_qty_2py) AS gross_tkt_sale_qty_2py,\n\t\t\tSUM(gross_tkt_sale_qty_py_ytd) AS gross_tkt_sale_qty_py_ytd,\n\t\t\tSUM(gross_tkt_sale_qty_2py_ytd) AS gross_tkt_sale_qty_2py_ytd,\n\t\t\tSUM(gross_tkt_sale_qty_cy_l13p) AS gross_tkt_sale_qty_cy_l13p,\n\t\t\tSUM(gross_tkt_sale_qty_py_l13p) AS gross_tkt_sale_qty_py_l13p,\n\t\t\tSUM(gross_tkt_sale_qty_cy_l4wk) AS gross_tkt_sale_qty_cy_l4wk,\n\t\t\tSUM(gross_tkt_sale_qty_py_l4wk) AS gross_tkt_sale_qty_py_l4wk,\n\t\t\tSUM(gross_tkt_sale_qty_cy_l12wk) AS gross_tkt_sale_qty_cy_l12wk,\n\t\t\tSUM(gross_tkt_sale_qty_py_l12wk) AS gross_tkt_sale_qty_py_l12wk,\n\t\t\tSUM(gross_tkt_sale_qty_cy_l26wk) AS gross_tkt_sale_qty_cy_l26wk,\n\t\t\tSUM(gross_tkt_sale_qty_py_l26wk) AS gross_tkt_sale_qty_py_l26wk,\n\t\t\tSUM(gross_tkt_sale_qty_cy_l52wk) AS gross_tkt_sale_qty_cy_l52wk,\n\t\t\tSUM(gross_tkt_sale_qty_py_l52wk) AS gross_tkt_sale_qty_py_l52wk,\n\t\t\tSUM(gross_tkt_sale_wt_cy_ytd) AS gross_tkt_sale_wt_cy_ytd,\n\t\t\tSUM(gross_tkt_sale_wt_py) AS gross_tkt_sale_wt_py,\n\t\t\tSUM(gross_tkt_sale_wt_2py) AS gross_tkt_sale_wt_2py,\n\t\t\tSUM(gross_tkt_sale_wt_py_ytd) AS gross_tkt_sale_wt_py_ytd,\n\t\t\tSUM(gross_tkt_sale_wt_2py_ytd) AS gross_tkt_sale_wt_2py_ytd,\n\t\t\tSUM(gross_tkt_sale_wt_cy_l13p) AS gross_tkt_sale_wt_cy_l13p,\n\t\t\tSUM(gross_tkt_sale_wt_py_l13p) AS gross_tkt_sale_wt_py_l13p,\n\t\t\tSUM(gross_tkt_sale_wt_cy_l4wk) AS gross_tkt_sale_wt_cy_l4wk,\n\t\t\tSUM(gross_tkt_sale_wt_py_l4wk) AS gross_tkt_sale_wt_py_l4wk,\n\t\t\tSUM(gross_tkt_sale_wt_cy_l12wk) AS gross_tkt_sale_wt_cy_l12wk,\n\t\t\tSUM(gross_tkt_sale_wt_py_l12wk) AS gross_tkt_sale_wt_py_l12wk,\n\t\t\tSUM(gross_tkt_sale_wt_cy_l26wk) AS gross_tkt_sale_wt_cy_l26wk,\n\t\t\tSUM(gross_tkt_sale_wt_py_l26wk) AS gross_tkt_sale_wt_py_l26wk,\n\t\t\tSUM(gross_tkt_sale_wt_cy_l52wk) AS gross_tkt_sale_wt_cy_l52wk,\n\t\t\tSUM(gross_tkt_sale_wt_py_l52wk) AS gross_tkt_sale_wt_py_l52wk,\n\t\t\tSUM(net_tkt_sale_amt_cy_ytd) AS net_tkt_sale_amt_cy_ytd,\n\t\t\tSUM(net_tkt_sale_amt_py) AS net_tkt_sale_amt_py,\n\t\t\tSUM(net_tkt_sale_amt_2py) AS net_tkt_sale_amt_2py,\n\t\t\tSUM(net_tkt_sale_amt_py_ytd) AS net_tkt_sale_amt_py_ytd,\n\t\t\tSUM(net_tkt_sale_amt_2py_ytd) AS net_tkt_sale_amt_2py_ytd,\n\t\t\tSUM(net_tkt_sale_amt_cy_l13p) AS net_tkt_sale_amt_cy_l13p,\n\t\t\tSUM(net_tkt_sale_amt_py_l13p) AS net_tkt_sale_amt_py_l13p,\n\t\t\tSUM(net_tkt_sale_amt_cy_l4wk) AS net_tkt_sale_amt_cy_l4wk,\n\t\t\tSUM(net_tkt_sale_amt_py_l4wk) AS net_tkt_sale_amt_py_l4wk,\n\t\t\tSUM(net_tkt_sale_amt_cy_l12wk) AS net_tkt_sale_amt_cy_l12wk,\n\t\t\tSUM(net_tkt_sale_amt_py_l12wk) AS net_tkt_sale_amt_py_l12wk,\n\t\t\tSUM(net_tkt_sale_amt_cy_l26wk) AS net_tkt_sale_amt_cy_l26wk,\n\t\t\tSUM(net_tkt_sale_amt_py_l26wk) AS net_tkt_sale_amt_py_l26wk,\n\t\t\tSUM(net_tkt_sale_amt_cy_l52wk) AS net_tkt_sale_amt_cy_l52wk,\n\t\t\tSUM(net_tkt_sale_amt_py_l52wk) AS net_tkt_sale_amt_py_l52wk,\n\t\t\tSUM(net_tkt_sale_qty_cy_ytd) AS net_tkt_sale_qty_cy_ytd,\n\t\t\tSUM(net_tkt_sale_qty_py) AS net_tkt_sale_qty_py,\n\t\t\tSUM(net_tkt_sale_qty_2py) AS net_tkt_sale_qty_2py,\n\t\t\tSUM(net_tkt_sale_qty_py_ytd) AS net_tkt_sale_qty_py_ytd,\n\t\t\tSUM(net_tkt_sale_qty_2py_ytd) AS net_tkt_sale_qty_2py_ytd,\n\t\t\tSUM(net_tkt_sale_qty_cy_l13p) AS net_tkt_sale_qty_cy_l13p,\n\t\t\tSUM(net_tkt_sale_qty_py_l13p) AS net_tkt_sale_qty_py_l13p,\n\t\t\tSUM(net_tkt_sale_qty_cy_l4wk) AS net_tkt_sale_qty_cy_l4wk,\n\t\t\tSUM(net_tkt_sale_qty_py_l4wk) AS net_tkt_sale_qty_py_l4wk,\n\t\t\tSUM(net_tkt_sale_qty_cy_l12wk) AS net_tkt_sale_qty_cy_l12wk,\n\t\t\tSUM(net_tkt_sale_qty_py_l12wk) AS net_tkt_sale_qty_py_l12wk,\n\t\t\tSUM(net_tkt_sale_qty_cy_l26wk) AS net_tkt_sale_qty_cy_l26wk,\n\t\t\tSUM(net_tkt_sale_qty_py_l26wk) AS net_tkt_sale_qty_py_l26wk,\n\t\t\tSUM(net_tkt_sale_qty_cy_l52wk) AS net_tkt_sale_qty_cy_l52wk,\n\t\t\tSUM(net_tkt_sale_qty_py_l52wk) AS net_tkt_sale_qty_py_l52wk,\n\t\t\tSUM(net_tkt_sale_wt_cy_ytd) AS net_tkt_sale_wt_cy_ytd,\n\t\t\tSUM(net_tkt_sale_wt_py) AS net_tkt_sale_wt_py,\n\t\t\tSUM(net_tkt_sale_wt_2py) AS net_tkt_sale_wt_2py,\n\t\t\tSUM(net_tkt_sale_wt_py_ytd) AS net_tkt_sale_wt_py_ytd,\n\t\t\tSUM(net_tkt_sale_wt_2py_ytd) AS net_tkt_sale_wt_2py_ytd,\n\t\t\tSUM(net_tkt_sale_wt_cy_l13p) AS net_tkt_sale_wt_cy_l13p,\n\t\t\tSUM(net_tkt_sale_wt_py_l13p) AS net_tkt_sale_wt_py_l13p,\n\t\t\tSUM(net_tkt_sale_wt_cy_l4wk) AS net_tkt_sale_wt_cy_l4wk,\n\t\t\tSUM(net_tkt_sale_wt_py_l4wk) AS net_tkt_sale_wt_py_l4wk,\n\t\t\tSUM(net_tkt_sale_wt_cy_l12wk) AS net_tkt_sale_wt_cy_l12wk,\n\t\t\tSUM(net_tkt_sale_wt_py_l12wk) AS net_tkt_sale_wt_py_l12wk,\n\t\t\tSUM(net_tkt_sale_wt_cy_l26wk) AS net_tkt_sale_wt_cy_l26wk,\n\t\t\tSUM(net_tkt_sale_wt_py_l26wk) AS net_tkt_sale_wt_py_l26wk,\n\t\t\tSUM(net_tkt_sale_wt_cy_l52wk) AS net_tkt_sale_wt_cy_l52wk,\n\t\t\tSUM(net_tkt_sale_wt_py_l52wk) AS net_tkt_sale_wt_py_l52wk,\n\t\t\tSUM(am_promo_allow_amt_cy_ytd) AS am_promo_allow_amt_cy_ytd,\n\t\t\tSUM(am_promo_allow_amt_py) AS am_promo_allow_amt_py,\n\t\t\tSUM(am_promo_allow_amt_2py) AS am_promo_allow_amt_2py,\n\t\t\tSUM(am_promo_allow_amt_py_ytd) AS am_promo_allow_amt_py_ytd,\n\t\t\tSUM(am_promo_allow_amt_2py_ytd) AS am_promo_allow_amt_2py_ytd,\n\t\t\tSUM(am_promo_allow_amt_cy_l13p) AS am_promo_allow_amt_cy_l13p,\n\t\t\tSUM(am_promo_allow_amt_py_l13p) AS am_promo_allow_amt_py_l13p,\n\t\t\tSUM(am_promo_allow_amt_cy_l4wk) AS am_promo_allow_amt_cy_l4wk,\n\t\t\tSUM(am_promo_allow_amt_py_l4wk) AS am_promo_allow_amt_py_l4wk,\n\t\t\tSUM(am_promo_allow_amt_cy_l12wk) AS am_promo_allow_amt_cy_l12wk,\n\t\t\tSUM(am_promo_allow_amt_py_l12wk) AS am_promo_allow_amt_py_l12wk,\n\t\t\tSUM(am_promo_allow_amt_cy_l26wk) AS am_promo_allow_amt_cy_l26wk,\n\t\t\tSUM(am_promo_allow_amt_py_l26wk) AS am_promo_allow_amt_py_l26wk,\n\t\t\tSUM(am_promo_allow_amt_cy_l52wk) AS am_promo_allow_amt_cy_l52wk,\n\t\t\tSUM(am_promo_allow_amt_py_l52wk) AS am_promo_allow_amt_py_l52wk,\n\t\t\tSUM(am_promo_sale_amt_cy_ytd) AS am_promo_sale_amt_cy_ytd,\n\t\t\tSUM(am_promo_sale_amt_py) AS am_promo_sale_amt_py,\n\t\t\tSUM(am_promo_sale_amt_2py) AS am_promo_sale_amt_2py,\n\t\t\tSUM(am_promo_sale_amt_py_ytd) AS am_promo_sale_amt_py_ytd,\n\t\t\tSUM(am_promo_sale_amt_2py_ytd) AS am_promo_sale_amt_2py_ytd,\n\t\t\tSUM(am_promo_sale_amt_cy_l13p) AS am_promo_sale_amt_cy_l13p,\n\t\t\tSUM(am_promo_sale_amt_py_l13p) AS am_promo_sale_amt_py_l13p,\n\t\t\tSUM(am_promo_sale_amt_cy_l4wk) AS am_promo_sale_amt_cy_l4wk,\n\t\t\tSUM(am_promo_sale_amt_py_l4wk) AS am_promo_sale_amt_py_l4wk,\n\t\t\tSUM(am_promo_sale_amt_cy_l12wk) AS am_promo_sale_amt_cy_l12wk,\n\t\t\tSUM(am_promo_sale_amt_py_l12wk) AS am_promo_sale_amt_py_l12wk,\n\t\t\tSUM(am_promo_sale_amt_cy_l26wk) AS am_promo_sale_amt_cy_l26wk,\n\t\t\tSUM(am_promo_sale_amt_py_l26wk) AS am_promo_sale_amt_py_l26wk,\n\t\t\tSUM(am_promo_sale_amt_cy_l52wk) AS am_promo_sale_amt_cy_l52wk,\n\t\t\tSUM(am_promo_sale_amt_py_l52wk) AS am_promo_sale_amt_py_l52wk,\n\t\t\tSUM(am_promo_sale_qty_cy_ytd) AS am_promo_sale_qty_cy_ytd,\n\t\t\tSUM(am_promo_sale_qty_py) AS am_promo_sale_qty_py,\n\t\t\tSUM(am_promo_sale_qty_2py) AS am_promo_sale_qty_2py,\n\t\t\tSUM(am_promo_sale_qty_py_ytd) AS am_promo_sale_qty_py_ytd,\n\t\t\tSUM(am_promo_sale_qty_2py_ytd) AS am_promo_sale_qty_2py_ytd,\n\t\t\tSUM(am_promo_sale_qty_cy_l13p) AS am_promo_sale_qty_cy_l13p,\n\t\t\tSUM(am_promo_sale_qty_py_l13p) AS am_promo_sale_qty_py_l13p,\n\t\t\tSUM(am_promo_sale_qty_cy_l4wk) AS am_promo_sale_qty_cy_l4wk,\n\t\t\tSUM(am_promo_sale_qty_py_l4wk) AS am_promo_sale_qty_py_l4wk,\n\t\t\tSUM(am_promo_sale_qty_cy_l12wk) AS am_promo_sale_qty_cy_l12wk,\n\t\t\tSUM(am_promo_sale_qty_py_l12wk) AS am_promo_sale_qty_py_l12wk,\n\t\t\tSUM(am_promo_sale_qty_cy_l26wk) AS am_promo_sale_qty_cy_l26wk,\n\t\t\tSUM(am_promo_sale_qty_py_l26wk) AS am_promo_sale_qty_py_l26wk,\n\t\t\tSUM(am_promo_sale_qty_cy_l52wk) AS am_promo_sale_qty_cy_l52wk,\n\t\t\tSUM(am_promo_sale_qty_py_l52wk) AS am_promo_sale_qty_py_l52wk,\n\t\t\tSUM(full_revnu_sale_amt_cy_ytd) AS full_revnu_sale_amt_cy_ytd,\n\t\t\tSUM(full_revnu_sale_amt_py) AS full_revnu_sale_amt_py,\n\t\t\tSUM(full_revnu_sale_amt_2py) AS full_revnu_sale_amt_2py,\n\t\t\tSUM(full_revnu_sale_amt_py_ytd) AS full_revnu_sale_amt_py_ytd,\n\t\t\tSUM(full_revnu_sale_amt_2py_ytd) AS full_revnu_sale_amt_2py_ytd,\n\t\t\tSUM(full_revnu_sale_amt_cy_l13p) AS full_revnu_sale_amt_cy_l13p,\n\t\t\tSUM(full_revnu_sale_amt_py_l13p) AS full_revnu_sale_amt_py_l13p,\n\t\t\tSUM(full_revnu_sale_amt_cy_l4wk) AS full_revnu_sale_amt_cy_l4wk,\n\t\t\tSUM(full_revnu_sale_amt_py_l4wk) AS full_revnu_sale_amt_py_l4wk,\n\t\t\tSUM(full_revnu_sale_amt_cy_l12wk) AS full_revnu_sale_amt_cy_l12wk,\n\t\t\tSUM(full_revnu_sale_amt_py_l12wk) AS full_revnu_sale_amt_py_l12wk,\n\t\t\tSUM(full_revnu_sale_amt_cy_l26wk) AS full_revnu_sale_amt_cy_l26wk,\n\t\t\tSUM(full_revnu_sale_amt_py_l26wk) AS full_revnu_sale_amt_py_l26wk,\n\t\t\tSUM(full_revnu_sale_amt_cy_l52wk) AS full_revnu_sale_amt_cy_l52wk,\n\t\t\tSUM(full_revnu_sale_amt_py_l52wk) AS full_revnu_sale_amt_py_l52wk,\n\t\t\tSUM(full_revnu_sale_qty_cy_ytd) AS full_revnu_sale_qty_cy_ytd,\n\t\t\tSUM(full_revnu_sale_qty_py) AS full_revnu_sale_qty_py,\n\t\t\tSUM(full_revnu_sale_qty_2py) AS full_revnu_sale_qty_2py,\n\t\t\tSUM(full_revnu_sale_qty_py_ytd) AS full_revnu_sale_qty_py_ytd,\n\t\t\tSUM(full_revnu_sale_qty_2py_ytd) AS full_revnu_sale_qty_2py_ytd,\n\t\t\tSUM(full_revnu_sale_qty_cy_l13p) AS full_revnu_sale_qty_cy_l13p,\n\t\t\tSUM(full_revnu_sale_qty_py_l13p) AS full_revnu_sale_qty_py_l13p,\n\t\t\tSUM(full_revnu_sale_qty_cy_l4wk) AS full_revnu_sale_qty_cy_l4wk,\n\t\t\tSUM(full_revnu_sale_qty_py_l4wk) AS full_revnu_sale_qty_py_l4wk,\n\t\t\tSUM(full_revnu_sale_qty_cy_l12wk) AS full_revnu_sale_qty_cy_l12wk,\n\t\t\tSUM(full_revnu_sale_qty_py_l12wk) AS full_revnu_sale_qty_py_l12wk,\n\t\t\tSUM(full_revnu_sale_qty_cy_l26wk) AS full_revnu_sale_qty_cy_l26wk,\n\t\t\tSUM(full_revnu_sale_qty_py_l26wk) AS full_revnu_sale_qty_py_l26wk,\n\t\t\tSUM(full_revnu_sale_qty_cy_l52wk) AS full_revnu_sale_qty_cy_l52wk,\n\t\t\tSUM(full_revnu_sale_qty_py_l52wk) AS full_revnu_sale_qty_py_l52wk\n\t\tFROM {{ ref('fl_sales_cust_prod_agg') }} AS s\n\t\tJOIN {{ ref('btg_msa_fl_xref') }} AS xref ON xref.fl_cust_id = s.cust_nbr\n\t\tGROUP BY\n\t\t\txref.msa_id,\n\t\t\ts.prod_slbl,\n\t\t\ts.prod_upc\n\t) sales\n\tJOIN {{ ref('stg_fl_xref_unique') }} AS xref_uniq ON sales.msa_id = xref_uniq.msa_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_sales_cust_prod_v"], "unique_id": "model.sdna_project.btg_fl_sales_cust_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_prod_v.sql", "name": "btg_fl_sales_cust_prod_v", "resource_type": "model", "alias": "btg_fl_sales_cust_prod_v", "checksum": {"name": "sha256", "checksum": "b0e64eb2b11b4a27f103f41e2070649c44b20f4f0301f31df8fb5199c8868c0f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_sales_cust_prod_agg"], ["btg_msa_fl_xref"], ["stg_fl_xref_unique"], ["fl_sales_cust_prod_agg"], ["btg_msa_fl_xref"], ["stg_fl_xref_unique"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.stg_fl_xref_unique"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_fl_sales_cust_v\nWITH sales AS (\n    SELECT * FROM {{ ref('stg_fl_sales') }}\n),\n\ncust AS (\n SELECT * FROM {{ ref('stg_fl_cust' )}}\n),\n\nxref_uniq AS (\n    SELECT * FROM {{ ref('stg_fl_xref_unique') }}\n)\n\nSELECT\n    xref_uniq.msa_id,\n    xref_uniq.fl_cust_id,\n    xref_uniq.cust_cnt,\n    cust.cust_nbr,\n    cust.ctry_code,\n    cust.ctry_descp,\n    cust.co_code,\n    cust.co_descp,\n    cust.rt_nbr,\n    cust.chain_node_sys_nbr,\n    cust.cust_loc_nbr,\n    cust.bus_loc_str_addr1,\n    cust.bus_loc_str_addr2,\n    cust.bus_loc_city,\n    cust.bus_loc_cnty_sburb,\n    cust.bus_loc_st_prov,\n    cust.bus_loc_ctry,\n    cust.bus_loc_post_code,\n    cust.bus_loc_post_code_zip5,\n    cust.contc_persn_nm,\n    cust.cust_phone_nbr,\n    cust.cust_fax_nbr,\n    cust.contr_id,\n    cust.prmy_cust_nbr,\n    cust.first_sale_dt,\n    cust.most_rcnt_sale_dt,\n    cust.avg_wkly_sale_amt,\n    cust.bus_type_code,\n    cust.bus_type_descp,\n    cust.facil_use_code,\n    cust.facil_use_descp,\n    cust.alt_cust_nbr,\n    cust.alt_cust_nm,\n    cust.cust_nm,\n    cust.store_nbr,\n    cust.dept_code,\n    cust.cust_legal_nm,\n    cust.cust_stat_code,\n    cust.trade_seg_code,\n    cust.trade_seg_descp,\n    cust.trade_chanl_code,\n    cust.trade_chanl_descp,\n    cust.prstg_cust_flg,\n    cust.cod_reasn_code,\n    cust.cod_reasn_descp,\n    cust.paymt_type_code,\n    cust.paymt_type_descp,\n    cust.bill_loc_nbr,\n    cust.cr_risk_code,\n    cust.cr_risk_descp,\n    cust.cr_appv_stat_code,\n    cust.cr_appv_stat_descp,\n    cust.contr_disc_pct,\n    cust.auth_prod_list_nbr,\n    cust.promo_lock_in_flg,\n    cust.alowb_promo_code,\n    cust.serv_freq_code,\n    cust.serv_freq_descp,\n    cust.serv_wk_nbr,\n    cust.serv_day_nbr,\n    cust.indep_cust_flg,\n    cust.prmy_qty_type_code,\n    cust.own_code,\n    cust.frhse_flg,\n    cust.temp_cust_flg,\n    cust.distrib_flg,\n    cust.co_prmy_ft_qty,\n    cust.co_fem_qty,\n    cust.co_max_qty,\n    cust.co_other_qty,\n    cust.cmpet_prmy_ft_qty,\n    cust.cmpet_fem_qty,\n    cust.cmpet_max_qty,\n    cust.cmpet_other_qty,\n    cust.dspla_acct_flg,\n    cust.store_dspla_txt,\n    cust.scan_pay_flg,\n    cust.dex_flg,\n    cust.duns_nbr,\n    cust.cust_bus_seg_code,\n    cust.cust_bus_seg_descp,\n    cust.clr_dir_deliv_flg,\n    cust.mltry_cust_flg,\n    cust.accpt_dflt_ck_flg,\n    cust.are_class_code,\n    cust.comm_type,\n    cust.comm_type_descp,\n    cust.unit_case_flg,\n    cust.tdlinx_id,\n    cust.tdlinx_trade_chanl,\n    cust.prmy_equip_code,\n    cust.cust_type_categ,\n    cust.phy_loc_str_addr1,\n    cust.phy_loc_str_addr2,\n    cust.phy_loc_city,\n    cust.phy_loc_cnty_sburb,\n    cust.phy_loc_st_prov,\n    cust.phy_loc_ctry,\n    cust.phy_loc_post_code,\n    cust.phy_loc_post_code_zip5,\n    cust.close_cross_str,\n    cust.lat_code,\n    cust.lon_code,\n    cust.deliv_freq_code,\n    cust.deliv_wk_nbr,\n    cust.deliv_day_nbr,\n    cust.cust_end_date,\n    cust.serv_incl_no_sale_freq_code,\n    cust.serv_incl_no_sale_freq_descp,\n    cust.serv_incl_no_sale_wk_nbr,\n    cust.serv_incl_no_sale_day_nbr,\n    cust.prod_deliv_freq_code,\n    cust.prod_deliv_freq_descp,\n    cust.prod_deliv_wk_nbr,\n    cust.prod_deliv_day_nbr,\n    cust.ship_note,\n    cust.chain_lvl1_node_nbr,\n    cust.chain_lvl1_node_nm,\n    cust.chain_lvl2_key,\n    cust.chain_lvl2_node_nbr,\n    cust.chain_lvl2_node_nm,\n    cust.chain_lvl3_key,\n    cust.chain_lvl3_node_nbr,\n    cust.chain_lvl3_node_nm,\n    cust.chain_lvl4_key,\n    cust.chain_lvl4_node_nbr,\n    cust.chain_lvl4_node_nm,\n    cust.chain_lvl5_key,\n    cust.chain_lvl5_node_nbr,\n    cust.chain_lvl5_node_nm,\n    cust.chain_lvl6_key,\n    cust.chain_lvl6_node_nbr,\n    cust.chain_lvl6_node_nm,\n    cust.cost_ctr,\n    cust.geo_type_code,\n    cust.geo_lvl4_contc_nm,\n    cust.geo_lvl4_key,\n    cust.geo_lvl4_node_nbr,\n    cust.geo_lvl4_node_nm,\n    cust.geo_lvl3_key,\n    cust.geo_lvl3_node_nbr,\n    cust.geo_lvl3_node_nm,\n    cust.geo_lvl2_key,\n    cust.geo_lvl2_node_nbr,\n    cust.geo_lvl2_node_nm,\n    cust.geo_lvl1_node_nbr,\n    cust.geo_lvl1_node_nm,\n    sales.tkt_sale_amt_cy_ytd,\n    sales.tkt_sale_amt_py,\n    sales.tkt_sale_amt_2py,\n    sales.tkt_sale_amt_py_ytd,\n    sales.tkt_sale_amt_2py_ytd,\n    sales.tkt_sale_amt_cy_l13p,\n    sales.tkt_sale_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.tkt_sale_amt_cy_l4wk,\n    sales.tkt_sale_amt_py_l4wk,\n\tsales.tkt_sale_amt_cy_l12wk,\n    sales.tkt_sale_amt_py_l12wk,\n\tsales.tkt_sale_amt_cy_l26wk,\n    sales.tkt_sale_amt_py_l26wk,\n\t-- new code end\n    sales.tkt_sale_amt_cy_l52wk,\n    sales.tkt_sale_amt_py_l52wk,\n    sales.tkt_sale_qty_cy_ytd,\n    sales.tkt_sale_qty_py,\n    sales.tkt_sale_qty_2py,\n    sales.tkt_sale_qty_py_ytd,\n    sales.tkt_sale_qty_2py_ytd,\n    sales.tkt_sale_qty_cy_l13p,\n    sales.tkt_sale_qty_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.tkt_sale_qty_cy_l4wk,\n    sales.tkt_sale_qty_py_l4wk,\n\tsales.tkt_sale_qty_cy_l12wk,\n    sales.tkt_sale_qty_py_l12wk,\n\tsales.tkt_sale_qty_cy_l26wk,\n    sales.tkt_sale_qty_py_l26wk,\n\t-- new code end\n    sales.tkt_sale_qty_cy_l52wk,\n    sales.tkt_sale_qty_py_l52wk,\n    sales.tkt_sale_wt_cy_ytd,\n    sales.tkt_sale_wt_py,\n    sales.tkt_sale_wt_2py,\n    sales.tkt_sale_wt_py_ytd,\n    sales.tkt_sale_wt_2py_ytd,\n    sales.tkt_sale_wt_cy_l13p,\n    sales.tkt_sale_wt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.tkt_sale_wt_cy_l4wk,\n    sales.tkt_sale_wt_py_l4wk,\n\tsales.tkt_sale_wt_cy_l12wk,\n    sales.tkt_sale_wt_py_l12wk,\n\tsales.tkt_sale_wt_cy_l26wk,\n    sales.tkt_sale_wt_py_l26wk,\n\t-- new code end\n    sales.tkt_sale_wt_cy_l52wk,\n    sales.tkt_sale_wt_py_l52wk,\n    sales.gross_tkt_sale_amt_cy_ytd,\n    sales.gross_tkt_sale_amt_py,\n    sales.gross_tkt_sale_amt_2py,\n    sales.gross_tkt_sale_amt_py_ytd,\n    sales.gross_tkt_sale_amt_2py_ytd,\n    sales.gross_tkt_sale_amt_cy_l13p,\n    sales.gross_tkt_sale_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.gross_tkt_sale_amt_cy_l4wk,\n    sales.gross_tkt_sale_amt_py_l4wk,\n\tsales.gross_tkt_sale_amt_cy_l12wk,\n    sales.gross_tkt_sale_amt_py_l12wk,\n\tsales.gross_tkt_sale_amt_cy_l26wk,\n    sales.gross_tkt_sale_amt_py_l26wk,\n\t-- new code end\n    sales.gross_tkt_sale_amt_cy_l52wk,\n    sales.gross_tkt_sale_amt_py_l52wk,\n    sales.gross_tkt_sale_qty_cy_ytd,\n    sales.gross_tkt_sale_qty_py,\n    sales.gross_tkt_sale_qty_2py,\n    sales.gross_tkt_sale_qty_py_ytd,\n    sales.gross_tkt_sale_qty_2py_ytd,\n    sales.gross_tkt_sale_qty_cy_l13p,\n    sales.gross_tkt_sale_qty_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.gross_tkt_sale_qty_cy_l4wk,\n    sales.gross_tkt_sale_qty_py_l4wk,\n\tsales.gross_tkt_sale_qty_cy_l12wk,\n    sales.gross_tkt_sale_qty_py_l12wk,\n\tsales.gross_tkt_sale_qty_cy_l26wk,\n    sales.gross_tkt_sale_qty_py_l26wk,\n\t-- new code end\n    sales.gross_tkt_sale_qty_cy_l52wk,\n    sales.gross_tkt_sale_qty_py_l52wk,\n    sales.gross_tkt_sale_wt_cy_ytd,\n    sales.gross_tkt_sale_wt_py,\n    sales.gross_tkt_sale_wt_2py,\n    sales.gross_tkt_sale_wt_py_ytd,\n    sales.gross_tkt_sale_wt_2py_ytd,\n    sales.gross_tkt_sale_wt_cy_l13p,\n    sales.gross_tkt_sale_wt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.gross_tkt_sale_wt_cy_l4wk,\n    sales.gross_tkt_sale_wt_py_l4wk,\n\tsales.gross_tkt_sale_wt_cy_l12wk,\n    sales.gross_tkt_sale_wt_py_l12wk,\n\tsales.gross_tkt_sale_wt_cy_l26wk,\n    sales.gross_tkt_sale_wt_py_l26wk,\n\t-- new code end\n    sales.gross_tkt_sale_wt_cy_l52wk,\n    sales.gross_tkt_sale_wt_py_l52wk,\n    sales.net_tkt_sale_amt_cy_ytd,\n    sales.net_tkt_sale_amt_py,\n    sales.net_tkt_sale_amt_2py,\n    sales.net_tkt_sale_amt_py_ytd,\n    sales.net_tkt_sale_amt_2py_ytd,\n    sales.net_tkt_sale_amt_cy_l13p,\n    sales.net_tkt_sale_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.net_tkt_sale_amt_cy_l4wk,\n    sales.net_tkt_sale_amt_py_l4wk,\n\tsales.net_tkt_sale_amt_cy_l12wk,\n    sales.net_tkt_sale_amt_py_l12wk,\n\tsales.net_tkt_sale_amt_cy_l26wk,\n    sales.net_tkt_sale_amt_py_l26wk,\n\t-- new code end\n    sales.net_tkt_sale_amt_cy_l52wk,\n    sales.net_tkt_sale_amt_py_l52wk,\n    sales.net_tkt_sale_qty_cy_ytd,\n    sales.net_tkt_sale_qty_py,\n    sales.net_tkt_sale_qty_2py,\n    sales.net_tkt_sale_qty_py_ytd,\n    sales.net_tkt_sale_qty_2py_ytd,\n    sales.net_tkt_sale_qty_cy_l13p,\n    sales.net_tkt_sale_qty_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.net_tkt_sale_qty_cy_l4wk,\n    sales.net_tkt_sale_qty_py_l4wk,\n\tsales.net_tkt_sale_qty_cy_l12wk,\n    sales.net_tkt_sale_qty_py_l12wk,\n\tsales.net_tkt_sale_qty_cy_l26wk,\n    sales.net_tkt_sale_qty_py_l26wk,\n\t-- new code end\n    sales.net_tkt_sale_qty_cy_l52wk,\n    sales.net_tkt_sale_qty_py_l52wk,\n    sales.net_tkt_sale_wt_cy_ytd,\n    sales.net_tkt_sale_wt_py,\n    sales.net_tkt_sale_wt_2py,\n    sales.net_tkt_sale_wt_py_ytd,\n    sales.net_tkt_sale_wt_2py_ytd,\n    sales.net_tkt_sale_wt_cy_l13p,\n    sales.net_tkt_sale_wt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.net_tkt_sale_wt_cy_l4wk,\n    sales.net_tkt_sale_wt_py_l4wk,\n\tsales.net_tkt_sale_wt_cy_l12wk,\n    sales.net_tkt_sale_wt_py_l12wk,\n\tsales.net_tkt_sale_wt_cy_l26wk,\n    sales.net_tkt_sale_wt_py_l26wk,\n\t-- new code end\n    sales.net_tkt_sale_wt_cy_l52wk,\n    sales.net_tkt_sale_wt_py_l52wk,\n    sales.am_promo_allow_amt_cy_ytd,\n    sales.am_promo_allow_amt_py,\n    sales.am_promo_allow_amt_2py,\n    sales.am_promo_allow_amt_py_ytd,\n    sales.am_promo_allow_amt_2py_ytd,\n    sales.am_promo_allow_amt_cy_l13p,\n    sales.am_promo_allow_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.am_promo_allow_amt_cy_l4wk,\n    sales.am_promo_allow_amt_py_l4wk,\n\tsales.am_promo_allow_amt_cy_l12wk,\n    sales.am_promo_allow_amt_py_l12wk,\n\tsales.am_promo_allow_amt_cy_l26wk,\n    sales.am_promo_allow_amt_py_l26wk,\n\t-- new code end\n\tsales.am_promo_allow_amt_cy_l52wk,\n    sales.am_promo_allow_amt_py_l52wk,\n    sales.am_promo_sale_amt_cy_ytd,\n    sales.am_promo_sale_amt_py,\n    sales.am_promo_sale_amt_2py,\n    sales.am_promo_sale_amt_py_ytd,\n    sales.am_promo_sale_amt_2py_ytd,\n    sales.am_promo_sale_amt_cy_l13p,\n    sales.am_promo_sale_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.am_promo_sale_amt_cy_l4wk,\n    sales.am_promo_sale_amt_py_l4wk,\n\tsales.am_promo_sale_amt_cy_l12wk,\n    sales.am_promo_sale_amt_py_l12wk,\n\tsales.am_promo_sale_amt_cy_l26wk,\n    sales.am_promo_sale_amt_py_l26wk,\n\t-- new code end\n    sales.am_promo_sale_amt_cy_l52wk,\n    sales.am_promo_sale_amt_py_l52wk,\n    sales.am_promo_sale_qty_cy_ytd,\n    sales.am_promo_sale_qty_py,\n    sales.am_promo_sale_qty_2py,\n    sales.am_promo_sale_qty_py_ytd,\n    sales.am_promo_sale_qty_2py_ytd,\n    sales.am_promo_sale_qty_cy_l13p,\n    sales.am_promo_sale_qty_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.am_promo_sale_qty_cy_l4wk,\n    sales.am_promo_sale_qty_py_l4wk,\n\tsales.am_promo_sale_qty_cy_l12wk,\n    sales.am_promo_sale_qty_py_l12wk,\n\tsales.am_promo_sale_qty_cy_l26wk,\n    sales.am_promo_sale_qty_py_l26wk,\n\t-- new code end\n    sales.am_promo_sale_qty_cy_l52wk,\n    sales.am_promo_sale_qty_py_l52wk,\n    sales.full_revnu_sale_amt_cy_ytd,\n    sales.full_revnu_sale_amt_py,\n    sales.full_revnu_sale_amt_2py,\n    sales.full_revnu_sale_amt_py_ytd,\n    sales.full_revnu_sale_amt_2py_ytd,\n    sales.full_revnu_sale_amt_cy_l13p,\n    sales.full_revnu_sale_amt_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.full_revnu_sale_amt_cy_l4wk,\n    sales.full_revnu_sale_amt_py_l4wk,\n\tsales.full_revnu_sale_amt_cy_l12wk,\n    sales.full_revnu_sale_amt_py_l12wk,\n\tsales.full_revnu_sale_amt_cy_l26wk,\n    sales.full_revnu_sale_amt_py_l26wk,\n\t-- new code end\n    sales.full_revnu_sale_amt_cy_l52wk,\n    sales.full_revnu_sale_amt_py_l52wk,\n    sales.full_revnu_sale_qty_cy_ytd,\n    sales.full_revnu_sale_qty_py,\n    sales.full_revnu_sale_qty_2py,\n    sales.full_revnu_sale_qty_py_ytd,\n    sales.full_revnu_sale_qty_2py_ytd,\n    sales.full_revnu_sale_qty_cy_l13p,\n    sales.full_revnu_sale_qty_py_l13p,\n\t-- added 4, 12 and 26 week level columns\n\tsales.full_revnu_sale_qty_cy_l4wk,\n    sales.full_revnu_sale_qty_py_l4wk,\n\tsales.full_revnu_sale_qty_cy_l12wk,\n    sales.full_revnu_sale_qty_py_l12wk,\n\tsales.full_revnu_sale_qty_cy_l26wk,\n    sales.full_revnu_sale_qty_py_l26wk,\n\t-- new code end\n    sales.full_revnu_sale_qty_cy_l52wk,\n    sales.full_revnu_sale_qty_py_l52wk,\n    current_timestamp() as last_updt_dt\nFROM sales\nJOIN xref_uniq ON sales.msa_id = xref_uniq.msa_id\nJOIN cust ON cust.cust_nbr = xref_uniq.fl_cust_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_sales_cust_v"], "unique_id": "model.sdna_project.btg_fl_sales_cust_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_v.sql", "name": "btg_fl_sales_cust_v", "resource_type": "model", "alias": "btg_fl_sales_cust_v", "checksum": {"name": "sha256", "checksum": "b8689d21bf8c545412a6be59300622cb2c225cff54075c3fee5990689de8b671"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["stg_fl_sales"], ["stg_fl_cust"], ["stg_fl_xref_unique"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.stg_fl_sales", "model.sdna_project.stg_fl_cust", "model.sdna_project.stg_fl_xref_unique"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_wk_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- load btg_fl_sales_cust_wk_prod_v\nWITH sales AS (\n    SELECT * FROM {{ ref('stg_fl_prod_sales') }}\n),\n\nxref_uniq AS (\n    SELECT * FROM {{ ref('stg_fl_xref_unique') }}\n)\n\nSELECT\n    xref_uniq.msa_id,\n    xref_uniq.fl_cust_id,\n    sales.PROD_UPC,\n    sales.PROD_SLBL,\n    sales.FSCL_WK_END_DTE,\n    sales.FSCL_YR_NUM,\n    sales.FSCL_PD_NUM,\n    sales.FSCL_WK_IN_PD_NUM,\n    sales.TKT_SALE_AMT,\n    sales.TKT_SALE_QTY,\n    sales.TKT_SALE_WT,\n    sales.GROSS_TKT_SALE_AMT,\n    sales.GROSS_TKT_SALE_QTY,\n    sales.GROSS_TKT_SALE_WT,\n    sales.NET_TKT_SALE_AMT,\n    sales.NET_TKT_SALE_QTY,\n    sales.NET_TKT_SALE_WT,\n    sales.AM_PROMO_ALLOW_AMT,\n    sales.AM_PROMO_SALE_AMT,\n    sales.AM_PROMO_SALE_QTY,\n    sales.FULL_REVNU_SALE_AMT,\n    sales.FULL_REVNU_SALE_QTY,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM sales\nJOIN xref_uniq\nON sales.msa_id = xref_uniq.msa_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_sales_cust_wk_prod_v"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_wk_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_wk_prod_v.sql", "name": "btg_fl_sales_cust_wk_prod_v", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_prod_v", "checksum": {"name": "sha256", "checksum": "c91dd5bd001f5e19c2f916b35d4c21d0c088023c0bde0ffcd4f1c12b2b7eccc5"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["stg_fl_prod_sales"], ["stg_fl_xref_unique"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.stg_fl_prod_sales", "model.sdna_project.stg_fl_xref_unique"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_wk_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_fl_sales_cust_wk_v\n\n-- {{ ref('btg_msa_fl_xref') }}\n-- {{ ref('stg_fl_xref_unique') }}\n-- {{ ref('stg_fl_cust') }}\n-- {{ ref('fl_sales_cust_wk_agg') }}\n\nSELECT\n\txref_uniq.msa_id,\n\txref_uniq.fl_cust_id,\n\txref_uniq.cust_cnt,\n\tcust.cust_nbr,\n\tcust.ctry_code,\n\tcust.ctry_descp,\n\tcust.co_code,\n\tcust.co_descp,\n\tcust.rt_nbr,\n\tcust.chain_node_sys_nbr,\n\tcust.cust_loc_nbr,\n\tcust.bus_loc_str_addr1,\n\tcust.bus_loc_str_addr2,\n\tcust.bus_loc_city,\n\tcust.bus_loc_cnty_sburb,\n\tcust.bus_loc_st_prov,\n\tcust.bus_loc_ctry,\n\tcust.bus_loc_post_code,\n\tcust.bus_loc_post_code_zip5,\n\tcust.contc_persn_nm,\n\tcust.cust_phone_nbr,\n\tcust.cust_fax_nbr,\n\tcust.contr_id,\n\tcust.prmy_cust_nbr,\n\tcust.first_sale_dt,\n\tcust.most_rcnt_sale_dt,\n\tcust.avg_wkly_sale_amt,\n\tcust.bus_type_code,\n\tcust.bus_type_descp,\n\tcust.facil_use_code,\n\tcust.facil_use_descp,\n\tcust.alt_cust_nbr,\n\tcust.alt_cust_nm,\n\tcust.cust_nm,\n\tcust.store_nbr,\n\tcust.dept_code,\n\tcust.cust_legal_nm,\n\tcust.cust_stat_code,\n\tcust.trade_seg_code,\n\tcust.trade_seg_descp,\n\tcust.trade_chanl_code,\n\tcust.trade_chanl_descp,\n\tcust.prstg_cust_flg,\n\tcust.cod_reasn_code,\n\tcust.cod_reasn_descp,\n\tcust.paymt_type_code,\n\tcust.paymt_type_descp,\n\tcust.bill_loc_nbr,\n\tcust.cr_risk_code,\n\tcust.cr_risk_descp,\n\tcust.cr_appv_stat_code,\n\tcust.cr_appv_stat_descp,\n\tcust.contr_disc_pct,\n\tcust.auth_prod_list_nbr,\n\tcust.promo_lock_in_flg,\n\tcust.alowb_promo_code,\n\tcust.serv_freq_code,\n\tcust.serv_freq_descp,\n\tcust.serv_wk_nbr,\n\tcust.serv_day_nbr,\n\tcust.indep_cust_flg,\n\tcust.prmy_qty_type_code,\n\tcust.own_code,\n\tcust.frhse_flg,\n\tcust.temp_cust_flg,\n\tcust.distrib_flg,\n\tcust.co_prmy_ft_qty,\n\tcust.co_fem_qty,\n\tcust.co_max_qty,\n\tcust.co_other_qty,\n\tcust.cmpet_prmy_ft_qty,\n\tcust.cmpet_fem_qty,\n\tcust.cmpet_max_qty,\n\tcust.cmpet_other_qty,\n\tcust.dspla_acct_flg,\n\tcust.store_dspla_txt,\n\tcust.scan_pay_flg,\n\tcust.dex_flg,\n\tcust.duns_nbr,\n\tcust.cust_bus_seg_code,\n\tcust.cust_bus_seg_descp,\n\tcust.clr_dir_deliv_flg,\n\tcust.mltry_cust_flg,\n\tcust.accpt_dflt_ck_flg,\n\tcust.are_class_code,\n\tcust.comm_type,\n\tcust.comm_type_descp,\n\tcust.unit_case_flg,\n\tcust.tdlinx_id,\n\tcust.tdlinx_trade_chanl,\n\tcust.prmy_equip_code,\n\tcust.cust_type_categ,\n\tcust.phy_loc_str_addr1,\n\tcust.phy_loc_str_addr2,\n\tcust.phy_loc_city,\n\tcust.phy_loc_cnty_sburb,\n\tcust.phy_loc_st_prov,\n\tcust.phy_loc_ctry,\n\tcust.phy_loc_post_code,\n\tcust.phy_loc_post_code_zip5,\n\tcust.close_cross_str,\n\tcust.lat_code,\n\tcust.lon_code,\n\tcust.deliv_freq_code,\n\tcust.deliv_wk_nbr,\n\tcust.deliv_day_nbr,\n\tcust.cust_end_date,\n\tcust.serv_incl_no_sale_freq_code,\n\tcust.serv_incl_no_sale_freq_descp,\n\tcust.serv_incl_no_sale_wk_nbr,\n\tcust.serv_incl_no_sale_day_nbr,\n\tcust.prod_deliv_freq_code,\n\tcust.prod_deliv_freq_descp,\n\tcust.prod_deliv_wk_nbr,\n\tcust.prod_deliv_day_nbr,\n\tcust.ship_note,\n\tcust.chain_lvl1_node_nbr,\n\tcust.chain_lvl1_node_nm,\n\tcust.chain_lvl2_key,\n\tcust.chain_lvl2_node_nbr,\n\tcust.chain_lvl2_node_nm,\n\tcust.chain_lvl3_key,\n\tcust.chain_lvl3_node_nbr,\n\tcust.chain_lvl3_node_nm,\n\tcust.chain_lvl4_key,\n\tcust.chain_lvl4_node_nbr,\n\tcust.chain_lvl4_node_nm,\n\tcust.chain_lvl5_key,\n\tcust.chain_lvl5_node_nbr,\n\tcust.chain_lvl5_node_nm,\n\tcust.chain_lvl6_key,\n\tcust.chain_lvl6_node_nbr,\n\tcust.chain_lvl6_node_nm,\n\tcust.cost_ctr,\n\tcust.geo_type_code,\n\tcust.geo_lvl4_contc_nm,\n\tcust.geo_lvl4_key,\n\tcust.geo_lvl4_node_nbr,\n\tcust.geo_lvl4_node_nm,\n\tcust.geo_lvl3_key,\n\tcust.geo_lvl3_node_nbr,\n\tcust.geo_lvl3_node_nm,\n\tcust.geo_lvl2_key,\n\tcust.geo_lvl2_node_nbr,\n\tcust.geo_lvl2_node_nm,\n\tcust.geo_lvl1_node_nbr,\n\tcust.geo_lvl1_node_nm,\n\tsales.fscl_wk_end_dte,\n\tsales.fscl_yr_num,\n\tsales.fscl_pd_num,\n\tsales.fscl_wk_in_pd_num,\n\tsales.tkt_sale_amt,\n\tsales.tkt_sale_qty,\n\tsales.tkt_sale_wt,\n\tsales.gross_tkt_sale_amt,\n\tsales.gross_tkt_sale_qty,\n\tsales.gross_tkt_sale_wt,\n\tsales.net_tkt_sale_amt,\n\tsales.net_tkt_sale_qty,\n\tsales.net_tkt_sale_wt AS am_promo_allow_amt,\n\tsales.am_promo_sale_amt,\n\tsales.am_promo_sale_qty,\n\tsales.full_revnu_sale_amt,\n\tsales.full_revnu_sale_qty\nFROM\n\t(\n\t\tSELECT\n\t\t\txref.msa_id,\n\t\t\ts.sale_tkt_wk_end_dt AS fscl_wk_end_dte,\n\t\t\tCAST(s.sale_tkt_yr AS INT) AS fscl_yr_num,\n\t\t\tCAST(s.sale_tkt_pd AS INT) AS fscl_pd_num,\n\t\t\tCAST(s.sale_tkt_wk AS INT) AS fscl_wk_in_pd_num,\n\t\t\tSUM(s.tkt_sale_amt) AS tkt_sale_amt,\n\t\t\tSUM(s.tkt_sale_qty) AS tkt_sale_qty,\n\t\t\tSUM(s.tkt_sale_wt) AS tkt_sale_wt,\n\t\t\tSUM(s.gross_tkt_sale_amt) AS gross_tkt_sale_amt,\n\t\t\tSUM(s.gross_tkt_sale_qty) AS gross_tkt_sale_qty,\n\t\t\tSUM(s.gross_tkt_sale_wt) AS gross_tkt_sale_wt,\n\t\t\tSUM(s.net_tkt_sale_amt) AS net_tkt_sale_amt,\n\t\t\tSUM(s.net_tkt_sale_qty) AS net_tkt_sale_qty,\n\t\t\tSUM(s.net_tkt_sale_wt) AS net_tkt_sale_wt,\n\t\t\tSUM(s.am_promo_allow_amt) AS am_promo_allow_amt,\n\t\t\tSUM(s.am_promo_sale_amt) AS am_promo_sale_amt,\n\t\t\tSUM(s.am_promo_sale_qty) AS am_promo_sale_qty,\n\t\t\tSUM(s.full_revnu_sale_amt) AS full_revnu_sale_amt,\n\t\t\tSUM(s.full_revnu_sale_qty) AS full_revnu_sale_qty\n\t\tFROM\n\t\t\t{{ ref('fl_sales_cust_wk_agg') }} AS s\n\t\t\tJOIN {{ ref('btg_msa_fl_xref') }} AS xref ON xref.fl_cust_id = s.cust_nbr\n\t\tGROUP BY\n\t\t\txref.msa_id,\n\t\t\ts.sale_tkt_wk_end_dt,\n\t\t\ts.sale_tkt_yr,\n\t\t\ts.sale_tkt_pd,\n\t\t\ts.sale_tkt_wk\n\t) sales\n\tJOIN {{ ref('stg_fl_xref_unique') }} AS xref_uniq ON sales.msa_id = xref_uniq.msa_id\n\tJOIN {{ ref('stg_fl_cust') }} AS cust ON cust.cust_nbr = xref_uniq.fl_cust_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_sales_cust_wk_v"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_wk_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_sales_cust_wk_v.sql", "name": "btg_fl_sales_cust_wk_v", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_v", "checksum": {"name": "sha256", "checksum": "d6b450894aa47f2ae70bb2cc4e356e94b80ddfe392ba53a5678b245cedd5d2b3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_msa_fl_xref"], ["stg_fl_xref_unique"], ["stg_fl_cust"], ["fl_sales_cust_wk_agg"], ["fl_sales_cust_wk_agg"], ["btg_msa_fl_xref"], ["stg_fl_xref_unique"], ["stg_fl_cust"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.stg_fl_cust", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.stg_fl_cust"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\nSELECT\n    cust.cust_nbr,\n    fl_sales.prod_upc,\n    fl_sales.prod_slbl,\n    cust.ctry_code,\n    cust.ctry_descp,\n    cust.co_code,\n    cust.co_descp,\n    cust.rt_nbr,\n    cust.chain_node_sys_nbr,\n    cust.cust_loc_nbr,\n    cust.bus_loc_str_addr1,\n    cust.bus_loc_str_addr2,\n    cust.bus_loc_city,\n    cust.bus_loc_cnty_sburb,\n    cust.bus_loc_st_prov,\n    cust.bus_loc_ctry,\n    cust.bus_loc_post_code,\n    cust.bus_loc_post_code_zip5,\n    cust.contr_id,\n    cust.prmy_cust_nbr,\n    cust.most_rcnt_sale_dt,\n    cust.avg_wkly_sale_amt,\n    cust.bus_type_code,\n    cust.bus_type_descp,\n    cust.alt_cust_nbr,\n    cust.alt_cust_nm,\n    cust.cust_nm,\n    cust.store_nbr,\n    cust.dept_code,\n    cust.cust_legal_nm,\n    fl_prod.sub_categ_code,\n    fl_prod.sub_categ_descp,\n    fl_prod.sub_categ_seq_nbr,\n    fl_prod.categ_code,\n    fl_prod.categ_descp,\n    fl_prod.categ_seq_nbr,\n    fl_prod.brand_code,\n    fl_prod.brand_descp,\n    fl_sales.sale_tkt_yr,\n    SUM(fl_sales.tkt_sale_amt) AS tkt_sale_amt,\n    SUM(fl_sales.tkt_sale_qty) AS tkt_sale_qty,\n    SUM(fl_sales.tkt_sale_wt) AS tkt_sale_wt\nFROM {{ ref('btg_fl_cust_v') }} cust\nJOIN {{ ref('fl_sales') }} fl_sales ON cust.cust_nbr = fl_sales.cust_nbr\nJOIN {{ ref('fl_prod') }} fl_prod ON fl_sales.prod_upc = fl_prod.prod_upc AND fl_sales.prod_slbl = fl_prod.prod_slbl\nGROUP BY\n    cust.cust_nbr,\n    fl_sales.prod_upc,\n    fl_sales.prod_slbl,\n    cust.ctry_code,\n    cust.ctry_descp,\n    cust.co_code,\n    cust.co_descp,\n    cust.rt_nbr,\n    cust.chain_node_sys_nbr,\n    cust.cust_loc_nbr,\n    cust.bus_loc_str_addr1,\n    cust.bus_loc_str_addr2,\n    cust.bus_loc_city,\n    cust.bus_loc_cnty_sburb,\n    cust.bus_loc_st_prov,\n    cust.bus_loc_ctry,\n    cust.bus_loc_post_code,\n    cust.bus_loc_post_code_zip5,\n    cust.contr_id,\n    cust.prmy_cust_nbr,\n    cust.most_rcnt_sale_dt,\n    cust.avg_wkly_sale_amt,\n    cust.bus_type_code,\n    cust.bus_type_descp,\n    cust.alt_cust_nbr,\n    cust.alt_cust_nm,\n    cust.cust_nm,\n    cust.store_nbr,\n    cust.dept_code,\n    cust.cust_legal_nm,\n    fl_prod.sub_categ_code,\n    fl_prod.sub_categ_descp,\n    fl_prod.sub_categ_seq_nbr,\n    fl_prod.categ_code,\n    fl_prod.categ_descp,\n    fl_prod.categ_seq_nbr,\n    fl_prod.brand_code,\n    fl_prod.brand_descp,\n    fl_sales.sale_tkt_yr", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_fl_sales_v"], "unique_id": "model.sdna_project.btg_fl_sales_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_fl_sales_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_fl_sales_v.sql", "name": "btg_fl_sales_v", "resource_type": "model", "alias": "btg_fl_sales_v", "checksum": {"name": "sha256", "checksum": "080dbe3761db53306be3e60f54483e0a72e4fc35dd3891f0a0e534bb4b3b8a2e"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_cust_v"], ["fl_sales"], ["fl_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.fl_sales", "model.sdna_project.fl_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_load_stat": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load btg_load_stat\n\n{% set curr_date = modules.datetime.datetime.strftime(modules.datetime.datetime.today(), '%Y-%m-%d') %}\n\nWITH btg_ref_join AS (\n  SELECT\n    fl_yyyy,\n    max(fl_wk) fl_wk\n  FROM {{ ref('btg_ref_calendar') }}\n  WHERE fl_pd=13 AND fl_yyyy BETWEEN 2014 AND YEAR(CAST('{{ curr_date }}' AS DATE))\n  GROUP BY fl_yyyy\n),\n\nCY AS (\n  SELECT\n      (CASE\n          WHEN year(b.run_date)=year(greg_dt)\n          THEN fl_pd\n          ELSE 13\n      END) AS fl_pd,\n      max(fl_wk) AS fl_wk,\n      max(greg_dt) AS greg_dt,\n      fl_yyyy,\n      max(a.fl_dd) AS fl_dd\n  FROM {{ ref('btg_ref_calendar') }} a,\n  (\n    SELECT fl_dd, CAST('{{ curr_date }}' AS DATE) AS run_date\n    FROM {{ ref('btg_ref_calendar') }}\n    WHERE greg_dt=CAST('{{ curr_date }}' AS DATE)\n  ) b\nWHERE (greg_dt=DATEADD(day, -b.fl_dd, b.run_date))\nGROUP BY fl_yyyy,\n(CASE WHEN year(b.run_date)=year(greg_dt)\n      THEN fl_pd\n      ELSE 13\nEND)\n)\n\n-- INSERT OVERWRITE TABLE btg_load_stat\nSELECT DISTINCT\n    CY.fl_pd AS curr_btg_load_pd_num,\n    CY.fl_wk AS curr_btg_load_wk_in_pd_num,\n    CY.greg_dt AS curr_btg_load_pd_wk_end_dte,\n    PYFTM.greg_dt AS py_ytd_frm_wk_dt,\n    (CASE WHEN CY.fl_pd<13 THEN PYTO.greg_dt ELSE PYTOP13.greg_dt END) AS py_ytd_to_wk_dt,\n    PY2FTM.greg_dt AS py2_ytd_frm_wk_dt,\n    (CASE WHEN CY.fl_pd<13 THEN PY2TO.greg_dt ELSE PY2TOP13.greg_dt END) AS py2_ytd_to_wk_dt,\n    --L13p for 53 weeks\n    (CASE\n         WHEN (CY.fl_pd=13 AND CYL13P.fl_wk=5 AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         WHEN (CY.fl_pd=13 AND CYL13P.fl_wk=4 AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, 7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         WHEN (CY.fl_pd<13 AND (CYL13P.fl_wk=4 AND PYL13P.fl_wk=4) AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, 7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         WHEN (CY.fl_pd<13 AND (CYL13P.fl_wk=4 AND PYL13P.fl_wk=5) AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         WHEN (CY.fl_pd<13 AND PYL13P.fl_wk=5 AND PYL13P.fl_yyyy=year(DATEADD(DAY, -1, CY.greg_dt)))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         WHEN (CY.fl_pd<13 AND PYL13P.fl_wk=4 AND PYL13P.fl_yyyy=year(DATEADD(DAY, -1, CY.greg_dt)))\n            THEN DATEADD(DAY, 7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         ELSE\n            DATEADD(DAY, -(13*28), CY.greg_dt)\n     END) AS cy_l13p_frm_wk_dt,\n    CY.greg_dt AS cy_l13p_to_wk_dt,\n    DATEADD(DAY, 7, DATEADD(DAY, -(13*28), DATEADD(DAY, -7, DATEADD(DAY, -(13*28), CY.greg_dt)))) AS py_l13p_frm_wk_dt,\n    --PY L13p To Date for 53 weeks\n    (CASE\n         WHEN (CY.fl_pd=13 AND CYL13P.fl_wk=5 AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         WHEN (CY.fl_pd=13 AND CYL13P.fl_wk=4 AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         WHEN (CY.fl_pd<13 AND (CYL13P.fl_wk=4 AND PYL13P.fl_wk=5) AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         WHEN (CY.fl_pd<13 AND (CYL13P.fl_wk=4 AND PYL13P.fl_wk=4) AND CYL13P.fl_yyyy=year(CY.greg_dt))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         WHEN (CY.fl_pd<13 AND PYL13P.fl_wk=5 AND PYL13P.fl_yyyy=year(DATEADD(DAY, -1, CY.greg_dt)))\n            THEN DATEADD(DAY, -7, DATEADD(DAY, -(13*28), CY.greg_dt))\n         WHEN (CY.fl_pd<13 AND PYL13P.fl_wk=4 AND PYL13P.fl_yyyy=year(DATEADD(DAY, -1, CY.greg_dt)))\n            THEN DATEADD(DAY, -(13*28), CY.greg_dt)\n         ELSE\n            DATEADD(DAY, -7, DATEADD(DAY, -(13*28), CY.greg_dt))\n    END) AS py_l13p_to_wk_dt,\n    DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt)) AS cy_l52wk_frm_wk_dt,\n    CY.greg_dt AS cy_l52wk_to_wk_dt,\n    --------------- Newly added code for 4  12 AND 26 weeks -----------------------\n    DATEADD(DAY, 7, DATEADD(DAY, -(4*7), CY.greg_dt)) AS cy_l4wk_frm_wk_dt,\n    CY.greg_dt AS cy_l4wk_to_wk_dt,\n\n    DATEADD(DAY, 7, DATEADD(DAY, -(12*7), CY.greg_dt)) AS cy_l12wk_frm_wk_dt,\n    CY.greg_dt AS cy_l12wk_to_wk_dt,\n\n    DATEADD(DAY, 7, DATEADD(DAY, -(26*7), CY.greg_dt)) AS cy_l26wk_frm_wk_dt,\n    CY.greg_dt AS cy_l26wk_to_wk_dt,\n\n    ---------------------------- Newly added code End ----------------------\n\n    DATEADD(DAY, 7, DATEADD(DAY, -(52*7), DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))))) as py_l52wk_frm_wk_dt,\n    DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))) AS py_l52wk_to_wk_dt,\n\n    ------------------------------ Newly added code for py 4,12 AND 26 wk --------------\n    DATEADD(DAY, 7, DATEADD(DAY, -(4*7), DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))))) AS py_l4wk_frm_wk_dt,\n    DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))) AS py_l4wk_to_wk_dt,\n\n    DATEADD(DAY, 7, DATEADD(DAY, -(12*7), DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))))) AS py_l12wk_frm_wk_dt,\n    DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))) as py_l12wk_to_wk_dt,\n\n    DATEADD(DAY, 7, DATEADD(DAY, -(26*7), DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))))) AS py_l26wk_frm_wk_dt,\n    DATEADD(DAY, -7, DATEADD(DAY, 7, DATEADD(DAY, -(52*7), CY.greg_dt))) AS py_l26wk_to_wk_dt,\n\n    -------------------------------- New ly added code end  ------------------\n    CY.fl_yyyy as curr_btg_load_year,\n    CURRENT_TIMESTAMP() as last_updt_dt\nFROM CY AS CY\nJOIN btg_ref_join CYL13P ON CYL13P.fl_yyyy = CY.fl_yyyy\nJOIN btg_ref_join PYL13P ON PYL13P.fl_yyyy = CY.fl_yyyy - 1\n--JOIN (SELECT fl_yyyy, max(fl_wk) fl_wk FROM {{ ref('btg_ref_calendar') }} WHERE fl_pd=13 AND fl_yyyy IN (2014,2015,2016,2017,2018,2019,2020,2021) GROUP BY fl_yyyy) CYL13P ON CYL13P.fl_yyyy=CY.fl_yyyy\n--JOIN (SELECT fl_yyyy, max(fl_wk) fl_wk FROM {{ ref('btg_ref_calendar') }} WHERE fl_pd=13 AND fl_yyyy IN (2014,2015,2016,2017,2018,2019,2020,2021) GROUP BY fl_yyyy) PYL13P ON PYL13P.fl_yyyy=CY.fl_yyyy-1\n\nJOIN {{ ref('btg_ref_calendar') }} PYFTM ON (PYFTM.fl_yyyy=CY.fl_yyyy -1 AND PYFTM.fl_pd=1 AND PYFTM.fl_wk=1 AND PYFTM.fl_dd=7)\nJOIN {{ ref('btg_ref_calendar') }} PY2FTM ON (PY2FTM.fl_yyyy=CY.fl_yyyy -2 AND PY2FTM.fl_pd=1 AND PY2FTM.fl_wk=1 AND PY2FTM.fl_dd=7)\n\n--for PY & PY2 non P13\nLEFT OUTER JOIN {{ ref('btg_ref_calendar') }} PYTO ON (CY.fl_pd=PYTO.fl_pd AND CY.fl_wk=PYTO.fl_wk AND CY.fl_dd=PYTO.fl_dd AND PYTO.fl_yyyy=CY.fl_yyyy -1)\nLEFT OUTER JOIN {{ ref('btg_ref_calendar') }} PY2TO ON (CY.fl_pd=PY2TO.fl_pd AND CY.fl_wk=PY2TO.fl_wk AND CY.fl_dd=PY2TO.fl_dd AND PY2TO.fl_yyyy=CY.fl_yyyy - 2)\n\n--for PY & PY2 P13\nLEFT OUTER JOIN btg_ref_join PY2L13P ON PY2L13P.fl_yyyy = CY.fl_yyyy - 2 AND PY2L13P.fl_yyyy BETWEEN 2017 AND YEAR(CAST('{{ curr_date }}' AS DATE))\n--LEFT OUTER JOIN (SELECT fl_yyyy, max(fl_wk) fl_wk FROM {{ ref('btg_ref_calendar') }} WHERE fl_pd=13 AND fl_yyyy in (2017,2018,2019,2020,2021) GROUP BY fl_yyyy) PY2L13P ON PY2L13P.fl_yyyy=CY.fl_yyyy-2\nLEFT OUTER JOIN {{ ref('btg_ref_calendar') }} PYTOP13 ON (CY.fl_pd=PYTOP13.fl_pd AND PYTOP13.fl_yyyy=PYL13P.fl_yyyy AND PYL13P.fl_wk=PYTOP13.fl_wk AND CY.fl_dd=PYTOP13.fl_dd)\nLEFT OUTER JOIN {{ ref('btg_ref_calendar') }} PY2TOP13 ON (CY.fl_pd=PY2TOP13.fl_pd AND PY2TOP13.fl_yyyy=PY2L13P.fl_yyyy AND PY2L13P.fl_wk=PY2TOP13.fl_wk AND CY.fl_dd=PY2TOP13.fl_dd)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_load_stat"], "unique_id": "model.sdna_project.btg_load_stat", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_load_stat.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_load_stat.sql", "name": "btg_load_stat", "resource_type": "model", "alias": "btg_load_stat", "checksum": {"name": "sha256", "checksum": "af6f4aadbe7f67a6a0d1d657055f1b95b91b518d18a4fbe551b76ee61c06c6e5"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"], ["btg_ref_calendar"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_msa_fl_xref": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- load btg_msa_fl_xref\nWITH t AS (\n    SELECT xref.grpng_val AS msa_id,\n           s.cust_nbr AS fl_cust_id,\n           MAX(s.SALE_TKT_WK_END_DT) AS latest_sale_dt,\n           SUM(s.tkt_sale_amt) as tkt_sale_amt\n    FROM {{ ref('btg_load_stat') }} st, {{ ref('fl_sales_cust_wk_agg') }} s\n    JOIN {{ ref('mdm_msa_fl_xref') }} xref ON s.cust_nbr = xref.cis_id\n    WHERE 1 = 1 AND xref.grpng_val <> '' AND xref.sap_sls_org_cd = '1100'\n    GROUP BY xref.grpng_val, s.cust_nbr\n)\n\nSELECT\n    t.msa_id,\n    t.fl_cust_id,\n    t.latest_sale_dt,\n    ROW_NUMBER() OVER (PARTITION BY t.msa_id ORDER BY t.latest_sale_dt DESC,t.tkt_sale_amt desc) AS sale_seq,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM t", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_msa_fl_xref"], "unique_id": "model.sdna_project.btg_msa_fl_xref", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_msa_fl_xref.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_msa_fl_xref.sql", "name": "btg_msa_fl_xref", "resource_type": "model", "alias": "btg_msa_fl_xref", "checksum": {"name": "sha256", "checksum": "323bead5e14997b1ebdc606581966c02dbbb96aa1b3e8c96b1f3bc4667b7b2d1"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_load_stat"], ["fl_sales_cust_wk_agg"], ["mdm_msa_fl_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_load_stat", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.mdm_msa_fl_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_msa_fl_xref_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\nSELECT * FROM {{ ref('btg_msa_fl_xref') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_msa_fl_xref_v"], "unique_id": "model.sdna_project.btg_msa_fl_xref_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_msa_fl_xref_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_msa_fl_xref_v.sql", "name": "btg_msa_fl_xref_v", "resource_type": "model", "alias": "btg_msa_fl_xref_v", "checksum": {"name": "sha256", "checksum": "8ca36690293d389cd8938c9130f0aa58082b21b9aed1630ff8d967e3022ddc75"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_msa_fl_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_msa_fl_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_msa_lat_lon_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_msa_lat_lon_v\n\nWITH inner_t AS (\n    SELECT\n        grpng_val,\n        lat_qty,\n        lngtd_qty,\n        'FL ' AS src\n    FROM\n        {{ ref('mdm_msa_fl_xref') }}\n    WHERE grpng_val IS NOT NULL\n        AND lat_qty IS NOT NULL\n        AND lngtd_qty IS NOT NULL\n\n    UNION\n\n    SELECT\n        grpng_val,\n        lat_qty,\n        lngtd_qty,\n        'PBC' AS src\n    FROM\n        {{ ref('mdm_msa_pbc_xref') }}\n    WHERE grpng_val IS NOT NULL\n        AND lat_qty IS NOT NULL\n        AND lngtd_qty IS NOT NULL\n),\n\nouter_t AS (\n    SELECT\n        grpng_val,\n        lat_qty,\n        lngtd_qty,\n        row_number() OVER ( PARTITION BY grpng_val ORDER BY LENGTH(RTRIM(REGEXP_REPLACE(CAST(lat_qty AS VARCHAR(100)),'0',''))) DESC ) AS geo_code_accu_rank\n    FROM inner_t\n)\n\nSELECT\n    grpng_val AS msa_id,\n    lat_qty,\n    lngtd_qty,\n    current_timestamp() AS last_updt_dt\nFROM outer_t\nWHERE geo_code_accu_rank = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_msa_lat_lon_v"], "unique_id": "model.sdna_project.btg_msa_lat_lon_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_msa_lat_lon_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_msa_lat_lon_v.sql", "name": "btg_msa_lat_lon_v", "resource_type": "model", "alias": "btg_msa_lat_lon_v", "checksum": {"name": "sha256", "checksum": "d96673aa455db5c8ef56fcb66a1a73f46517d05b103ba995dc7e1149fbba1ba5"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mdm_msa_fl_xref"], ["mdm_msa_pbc_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mdm_msa_fl_xref", "model.sdna_project.mdm_msa_pbc_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_msa_pbc_xref": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_msa_pbc_xref\nSELECT\n    t.msa_id,\n\tt.pbc_cust_id,\n\tt.latest_sale_dt,\n\tROW_NUMBER() OVER(\n\t\tPARTITION BY t.msa_id\n\t\tORDER BY\n\t\t\tt.latest_sale_dt DESC,\n\t\t\tt.net_rev DESC\n\t) AS sale_seq,\n\tCURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM\n\t(\n\t\tSELECT\n\t\t\txref.grpng_val AS msa_id,\n\t\t\ts.cust_id AS pbc_cust_id,\n\t\t\tMAX(s.FSCL_WK_END_DTE) AS latest_sale_dt,\n\t\t\tSUM(s.net_rev) As net_rev\n\t\tFROM {{ ref('btg_load_stat') }} AS st,\n\t\t\t {{ ref('pbc_sales_cust_wk_agg') }} AS s\n\t\tJOIN {{ ref('mdm_msa_pbc_xref') }} AS xref ON s.cust_id = xref.src_sys_rcrd_id_val\n\t\tWHERE\n\t\t\tctry_iso_cdv = 'USA' AND xref.grpng_val <> ''\n\t\tGROUP BY\n\t\t\ts.cust_id,\n\t\t\txref.grpng_val\n\t) t", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_msa_pbc_xref"], "unique_id": "model.sdna_project.btg_msa_pbc_xref", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_msa_pbc_xref.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_msa_pbc_xref.sql", "name": "btg_msa_pbc_xref", "resource_type": "model", "alias": "btg_msa_pbc_xref", "checksum": {"name": "sha256", "checksum": "2aa3b79ffc52939785d14fa96994b5d6ab578aedc16ad994f1ea397752a191e4"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_load_stat"], ["pbc_sales_cust_wk_agg"], ["mdm_msa_pbc_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_load_stat", "model.sdna_project.pbc_sales_cust_wk_agg", "model.sdna_project.mdm_msa_pbc_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_msa_pbc_xref_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_msa_pbc_xref_v\nSELECT * FROM {{ ref('btg_msa_pbc_xref') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_msa_pbc_xref_v"], "unique_id": "model.sdna_project.btg_msa_pbc_xref_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_msa_pbc_xref_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_msa_pbc_xref_v.sql", "name": "btg_msa_pbc_xref_v", "resource_type": "model", "alias": "btg_msa_pbc_xref_v", "checksum": {"name": "sha256", "checksum": "243fb1f824a48010f8cb928ab7175eea866644c0ad6cb7dc365f36a15bb60bae"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_msa_pbc_xref"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_msa_pbc_xref"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_cust_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_pbc_cust_v\n\nSELECT\n    cust_id,\n    bulk_dely_flg,\n    chain_flg,\n    chain_owner_cde,\n    chain_owner_desc,\n    cur_stat_cde,\n    cur_stat_desc,\n    cur_stat_dte,\n    cust_prod_flg,\n    cust_serv_flg,\n    cust_org_flg,\n    cust_blg_flg,\n    cust_misc_flg,\n    cust_added_dte,\n    cust_lglnme,\n    lang_cde,\n    lang_desc,\n    loc_prod_id,\n    loc_serv_id,\n    nme,\n    natl_acct_flg,\n    po_reqd_flg,\n    pymt_term_beg_dte,\n    pymt_term_cde,\n    pymt_term_desc,\n    sep_inv_flg,\n    tax_exempt_num,\n    tin_num,\n    tin_type_cde,\n    tin_type_desc,\n    empl_tac_id,\n    cust_equip_flg,\n    udf_num,\n    vrtx_geo_cde,\n    bus_type_cde,\n    bus_type_desc,\n    tme_zone_cde,\n    tme_zone_desc,\n    cust_fobo_btlr_flg,\n    cust_fobo_cust_flg,\n    cust_fsv_flg,\n    prc_zone_id,\n    ethnic_cde,\n    ethnic_desc,\n    cust_ucs_cmctn_id,\n    cust_dab_num,\n    cust_dex_beg_dte,\n    leg_chain_num,\n    seas_clsd_beg_dte,\n    seas_clsd_end_dte,\n    cust_lgtud_num,\n    cust_latud_num,\n    bus_type_aggr_cde,\n    bus_type_aggr_desc,\n    outside_city_lmt_ind,\n    cust_last_actvty_dte,\n    grp1_type_desc,\n    grp1_ownr_id,\n    grp1_ownr_desc,\n    grp1_lvl_1_id,\n    grp1_lvl_1_desc,\n    grp1_lvl_2_id,\n    grp1_lvl_2_desc,\n    grp2_type_desc,\n    grp2_ownr_id,\n    grp2_ownr_desc,\n    grp2_lvl_1_ancstr_id,\n    grp2_lvl_1_ancstr_nme,\n    grp2_lvl_1_ancstr_prev_nme,\n    grp2_lvl_1_id,\n    grp2_lvl_1_desc,\n    grp2_lvl_2_id,\n    grp2_lvl_2_desc,\n    grp3_type_desc,\n    grp3_ownr_id,\n    grp3_ownr_desc,\n    grp3_lvl_1_id,\n    grp3_lvl_1_desc,\n    grp3_lvl_2_id,\n    grp3_lvl_2_desc,\n    loc_prod_nme,\n    loc_prod_mu_id,\n    loc_prod_mu_nme,\n    loc_prod_bu_id,\n    loc_prod_bu_nme,\n    loc_prod_area_rpt_id,\n    loc_prod_area_rpt_nme,\n    loc_prod_mu_rpt_id,\n    loc_prod_mu_rpt_nme,\n    loc_prod_bu_rpt_id,\n    loc_prod_bu_rpt_nme,\n    loc_serv_nme,\n    loc_serv_mu_id,\n    loc_serv_mu_nme,\n    loc_serv_bu_id,\n    loc_serv_bu_nme,\n    loc_serv_area_rpt_id,\n    loc_serv_area_rpt_nme,\n    loc_serv_mu_rpt_id,\n    loc_serv_mu_rpt_nme,\n    loc_serv_bu_rpt_id,\n    loc_serv_bu_rpt_nme,\n    bus_type_ctgy_cde,\n    bus_type_ctgy_desc,\n    grp4_type_desc,\n    grp4_ownr_id,\n    grp4_ownr_desc,\n    grp4_lvl_1_id,\n    grp4_lvl_1_desc,\n    grp4_lvl_2_id,\n    grp4_lvl_2_desc,\n    dex_vers_num,\n    dely_adr_city,\n    dely_adr_cntry_cde,\n    dely_adr_cnty,\n    dely_adr_state,\n    dely_adr_strt1,\n    dely_adr_strt2,\n    dely_adr_strt3,\n    dely_adr_zip,\n    SUBSTRING(dely_adr_zip, 1, 5) AS dely_adr_zip5,\n    blg_adr_city,\n    blg_adr_cntry_cde,\n    blg_adr_cnty,\n    blg_adr_state,\n    blg_adr_strt1,\n    blg_adr_strt2,\n    blg_adr_strt3,\n    blg_adr_zip,\n    SUBSTRING(blg_adr_zip, 1, 5) AS blg_adr_zip5,\n    mlg_adr_city,\n    mlg_adr_cntry_cde,\n    mlg_adr_cnty,\n    mlg_adr_state,\n    mlg_adr_strt1,\n    mlg_adr_strt2,\n    mlg_adr_strt3,\n    mlg_adr_zip,\n    SUBSTRING(mlg_adr_zip, 1, 5) AS mlg_adr_zip5,\n    sls_cnct_first_nme,\n    sls_cnct_last_nme,\n    sls_cnct_phone_acd_num,\n    sls_cnct_phone_num,\n    sls_cnct_phone_ext_num,\n    rpr_cnct_first_nme,\n    rpr_cnct_last_nme,\n    rpr_cnct_phone_acd_num,\n    rpr_cnct_phone_num,\n    rpr_cnct_phone_ext_num,\n    ts_cnct_first_nme,\n    ts_cnct_last_nme,\n    ts_cnct_phone_acd_num,\n    ts_cnct_phone_num,\n    ts_cnct_phone_ext_num,\n    fsv_cnct_first_nme,\n    fsv_cnct_last_nme,\n    fsv_cnct_phone_acd_num,\n    fsv_cnct_phone_num,\n    fsv_cnct_phone_ext_num,\n    merch_acct_flg,\n    min_ord_qty,\n    chrg_to_frnch,\n    inv_udf_num_cde,\n    inv_udf_num_desc,\n    dw_srce_id,\n    dw_updt_dte,\n    actv_dely_loc_id,\n    cust_cmnt_txt,\n    cust_origtn_cde,\n    current_timestamp() AS last_updt_dt\nFROM {{ ref('pbc_cust') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_cust_v"], "unique_id": "model.sdna_project.btg_pbc_cust_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_cust_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_cust_v.sql", "name": "btg_pbc_cust_v", "resource_type": "model", "alias": "btg_pbc_cust_v", "checksum": {"name": "sha256", "checksum": "01535937bdeabe5cce0f44ea83a89fea29e889630c1a6fece556692d7ad8b2c7"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_cust"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_cust"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_pbc_prod_v\n\nSELECT *,\n       CASE\n            WHEN ss_mp_ms = 'MP' THEN 'TH'\n            WHEN ss_mp_ms = 'MS' THEN 'TH'\n            WHEN ss_mp_ms = 'SS' THEN 'SS'\n\t\t\tWHEN ss_mp_ms = 'NA' THEN 'NA'\n        END AS ss_th,\n        CURRENT_TIMESTAMP() AS last_updt_dt\nFROM (\n    SELECT\n        inven_id,\n        inven_dply_grp_nme,\n        brnd_id,\n        pkg_id,\n        inven_type_cde,\n        inven_type_desc,\n        nme,\n        inven_dply_seq_num,\n        inven_dply_grp_seq,\n        inven_dply_nme,\n        purch_ctgy_id,\n        ord_ref_num,\n        inven_uom_cde,\n        inven_uom_desc,\n        create_dte,\n        upc_cde,\n        inven_sfty_stk_pct,\n        prod_mix_cde,\n        prod_mix_desc,\n        prod_grp_cde,\n        prod_grp_desc,\n        prod_type_cde,\n        prod_type_desc,\n        avg_flr_cost_amt,\n        std_wgt_qty,\n        natl_acct_cde,\n        natl_acct_desc,\n        prod_8oz_conv_fctr,\n        conc_mark_up_amt,\n        sply_type_cde,\n        sply_type_desc,\n        serv_type_cde,\n        serv_type_desc,\n        brnd_nme,\n        trdmrk_cde,\n        trdmrk_desc,\n        flvr_cde,\n        flvr_desc,\n        corp_cde,\n        corp_desc,\n        ctgy_type_cde,\n        ctgy_type_desc,\n        caff_flg,\n        brnd_juice_pct,\n        brnd_shrt_nme,\n        brnd_swtnr_cde,\n        brnd_swtnr_desc,\n        pkg_nr_flag,\n        clust_cde,\n        clust_desc,\n        clust_qty,\n        config_qty,\n        pkg_nme,\n        pkg_shrt_nme,\n        rpt_pkg_id,\n        cont_cde,\n        cont_desc,\n        cont_uom_cde,\n        cont_uom_desc,\n        cont_uom_qty,\n        cont_nr_flag,\n        pkg_cont_mtrl_cde,\n        pkg_cont_mtrl_desc,\n        pkg_clstr_mtrl_cde,\n        pkg_clstr_mtrl_desc,\n        pkg_mtrl_cde,\n        pkg_mtl_desc,\n        pkg_cont_st_dp_flg,\n        logo_id,\n        logo_desc,\n        hrzn_prod_grp_id,\n        hrzn_prod_grp_desc,\n        hrzn_pkg_grp_id,\n        hrzn_pkg_grp_desc,\n        hrzn_prod_ctgy_id,\n        hrzn_prod_ctgy_desc,\n        hrzn_brnd_ctgy_id,\n        hrzn_brnd_ctgy_desc,\n        hrzn_pkg_ctgy_id,\n        hrzn_pkg_ctgy_desc,\n        hrzn_pkg_aggr_id,\n        hrzn_pkg_aggr_desc,\n        hrzn_corp_aggr_id,\n        hrzn_corp_aggr_desc,\n        case_upc_cde,\n        hrzn_pkg_cont_ctgy_id,\n        hrzn_pkg_cont_ctgy_desc,\n        hrzn_brnd_pkg_list_id,\n        hrzn_brnd_pkg_list_desc,\n        hrzn_brnd_pkg_summ_id,\n        hrzn_brnd_pkg_summ_desc,\n        hrzn_pkg_gm_id,\n        hrzn_pkg_gm_desc,\n        hrzn_pkg_summ_id,\n        hrzn_pkg_summ_desc,\n        comm_pkg_grp1_id,\n        comm_pkg_grp1_nme,\n        comm_pkg_grp2_id,\n        comm_pkg_grp2_nme,\n        hrzn_brnd_gm_id,\n        hrzn_brnd_gm_desc,\n        hrzn_brnd_trdmrk_id,\n        hrzn_brnd_trdmrk_desc,\n        hrzn_brnd_summ_id,\n        hrzn_brnd_summ_desc,\n        pbg_utilized_flg,\n        case_conv_fctr,\n        lcl_case_conv_fctr,\n        prod_best_taste_wk_qty,\n        delete_flg,\n        mkt_ctgy_id,\n        mkt_ctgy_desc,\n        mkt_trdmrk_id,\n        mkt_trdmrk_desc,\n        pkg_cont_mtrl_grp_id,\n        pkg_cont_mtrl_grp_desc,\n        entrprs_initiv_01_id,\n        entrprs_initiv_01_nme,\n        entrprs_initiv_01_desc,\n        entrprs_initiv_02_id,\n        entrprs_initiv_02_nme,\n        entrprs_initiv_02_desc,\n        apxig_id,\n        apxig_nme,\n        dw_srce_id,\n        dw_updt_dte,\n        comm_asm_grp_id,\n        comm_asm_grp_nme,\n        comm_cnvntl_drvr_grp_id,\n        comm_cnvntl_drvr_grp_nme,\n        comm_fsv_drvr_grp_id,\n        comm_fsv_drvr_grp_nme,\n        comm_psell_drvr_grp_id,\n        comm_psell_drvr_grp_nme,\n        pkg_wdth_unit_qty,\n        pkg_hgt_unit_qty,\n        pkg_lngth_unit_qty,\n        pkg_dim_uofm_cde,\n        pkg_frnt_dim_cde,\n        pkg_stkblty_cde,\n        prod_wgt_unit_qty,\n        prod_wgt_uofm_cde,\n        rfrg_reqd_flg,\n        COALESCE(CASE\n        WHEN clust_qty > 1 THEN 'MP'\n        WHEN cont_uom_desc = 'GALLON' THEN 'MS'\n        WHEN (clust_qty = 1 AND ctgy_type_desc IN ('FLAVORED WATER', 'FLAVORED SPARKLING WATER', 'WATER', 'UNFLAVORED SPARKLING WATER', 'WATER WITH SALTS'))\n            THEN\n                CASE\n                    WHEN cont_uom_desc = 'OUNCE' THEN\n                        CASE\n                            WHEN cont_uom_qty <= 50.7 THEN 'SS' ELSE 'MS'\n                        END\n                    WHEN cont_uom_desc = 'LITER' THEN\n                        CASE\n                            WHEN cont_uom_qty <= 1.5 THEN 'SS' ELSE 'MS'\n                        END\n                    WHEN cont_uom_desc = 'MILLILITER' THEN\n                        CASE\n                            WHEN cont_uom_qty <= 1500 THEN 'SS' ELSE 'MS'\n                        END\n                END\n        ELSE\n            CASE\n                WHEN cont_uom_desc = 'OUNCE' THEN\n                    CASE\n                        WHEN cont_uom_qty <= 33.8 THEN 'SS' ELSE 'MS'\n                    END\n                WHEN cont_uom_desc = 'LITER' THEN\n                    CASE\n                        WHEN cont_uom_qty <= 1 THEN 'SS' ELSE 'MS'\n                    END\n                WHEN cont_uom_desc = 'MILLILITER' THEN\n                    CASE\n                        WHEN cont_uom_qty <= 1000 THEN 'SS' ELSE 'MS'\n                    END\n            END\n        END, 'NA') as ss_mp_ms\n    FROM {{ ref('pbc_prod') }}\n)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_prod_v"], "unique_id": "model.sdna_project.btg_pbc_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_prod_v.sql", "name": "btg_pbc_prod_v", "resource_type": "model", "alias": "btg_pbc_prod_v", "checksum": {"name": "sha256", "checksum": "2c14541aeeaf4d64e8397fa3516177a6fb80e162636dec945b49e05d303b6c47"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load btg_pbc_retailer_assgnt_excptn_v\n\n-- {{ ref('btg_pbc_retailer_xref_v') }}\n-- {{ ref('btg_pbc_sales_cust_v') }}\n\nSELECT DISTINCT\n    grp1_lvl_1_desc,\n\tgrp2_lvl_1_desc,\n\tgrp2_lvl_2_desc,\n\tbus_type_aggr_desc,\n\tpbc_retailer,\n\tassgnt_descp,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('btg_pbc_retailer_xref_v') }} AS a\n\tINNER JOIN {{ ref('btg_pbc_sales_cust_v') }} AS cust ON cust.msa_id = a.msa_id\nWHERE\n\ta.pbc_retailer = 'NOT ASSIGNED'", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_retailer_assgnt_excptn_v"], "unique_id": "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_retailer_assgnt_excptn_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_retailer_assgnt_excptn_v.sql", "name": "btg_pbc_retailer_assgnt_excptn_v", "resource_type": "model", "alias": "btg_pbc_retailer_assgnt_excptn_v", "checksum": {"name": "sha256", "checksum": "e77a882522f0461f3060e747aa7461a5e4d964dbc4e8f16ef54a90b51717f22a"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_retailer_xref_v"], ["btg_pbc_sales_cust_v"], ["btg_pbc_retailer_xref_v"], ["btg_pbc_sales_cust_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_sales_cust_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_retailer_xref_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n-- Load btg_pbc_retailer_xref_v\n\n-- {{ ref('btg_pbc_retailer_assgnt') }}\n-- {{ ref('btg_pbc_sales_cust_v') }}\n\nWITH pbc_ret1 AS (\n    SELECT DISTINCT\n        a.grp1_lvl_1_desc,\n\t\ta.grp2_lvl_1_desc,\n\t\ta.bus_type_aggr_desc,\n\t\tCASE WHEN b.ct_chk > 1 THEN 'NOT ASSIGNED' ELSE a.pbc_retailer END AS pbc_retailer\n\tFROM\n\t\t{{ ref('btg_pbc_retailer_assgnt') }} AS a\n\t\tJOIN (\n\t\t\tSELECT\n\t\t\t\tgrp1_lvl_1_desc,\n\t\t\t\tgrp2_lvl_1_desc,\n\t\t\t\tbus_type_aggr_desc,\n\t\t\t\tCOUNT(DISTINCT pbc_retailer) AS ct_chk\n\t\t\tFROM\n\t\t\t\t{{ ref('btg_pbc_retailer_assgnt') }}\n\t\t\tGROUP BY\n\t\t\t\tgrp1_lvl_1_desc,\n\t\t\t\tgrp2_lvl_1_desc,\n\t\t\t\tbus_type_aggr_desc\n\t\t) b ON\n            TRIM(UPPER(COALESCE(a.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(b.grp1_lvl_1_desc, ' ')))\n            AND TRIM(UPPER(COALESCE(a.grp2_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(b.grp2_lvl_1_desc, ' ')))\n            AND TRIM(UPPER(COALESCE(a.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(b.bus_type_aggr_desc, ' ')))\n),\npbc_ret2 AS\n(\n\tSELECT DISTINCT\n        a.grp1_lvl_1_desc,\n\t\ta.bus_type_aggr_desc,\n\t\tCASE WHEN b.ct_chk > 1 THEN 'NOT ASSIGNED' ELSE a.pbc_retailer END AS pbc_retailer\n\tFROM\n\t\t{{ ref('btg_pbc_retailer_assgnt') }} AS a\n\t\tJOIN (\n\t\t\tSELECT\n\t\t\t\tgrp1_lvl_1_desc,\n\t\t\t\tbus_type_aggr_desc,\n\t\t\t\tCOUNT(DISTINCT pbc_retailer) AS ct_chk\n\t\t\tFROM\n\t\t\t\t{{ ref('btg_pbc_retailer_assgnt') }}\n\t\t\tGROUP BY\n\t\t\t\tgrp1_lvl_1_desc,\n\t\t\t\tbus_type_aggr_desc\n\t\t) AS b ON\n            TRIM(UPPER(COALESCE(a.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(b.grp1_lvl_1_desc, ' ')))\n            AND TRIM(UPPER(COALESCE(a.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(b.bus_type_aggr_desc, ' ')))\n),\npbc_round_1_match AS\n(\n\tSELECT DISTINCT\n        cust.msa_id,\n\t\tcust.grp1_lvl_1_desc,\n\t\tcust.grp2_lvl_1_desc,\n\t\tcust.grp2_lvl_2_desc,\n\t\tcust.bus_type_aggr_desc,\n        (\n            CASE\n                WHEN (\n                    TRIM(UPPER(COALESCE(cust.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp1_lvl_1_desc, ' ')))\n                    AND TRIM(UPPER(COALESCE(cust.grp2_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp2_lvl_1_desc, ' ')))\n                    AND TRIM(UPPER(COALESCE(cust.grp2_lvl_2_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp2_lvl_2_desc, ' ')))\n                    AND TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n                )\n                THEN pbc_ret.pbc_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS pbc_retailer_old,\n        1 AS Round_number\n    FROM\n         {{ ref('btg_pbc_sales_cust_v') }} AS cust\n    JOIN\n         {{ ref('btg_pbc_retailer_assgnt') }} AS pbc_ret\n    ON\n        TRIM(UPPER(COALESCE(cust.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp1_lvl_1_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.grp2_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp2_lvl_1_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.grp2_lvl_2_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp2_lvl_2_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n),\npbc_round_2_match AS\n(\n    SELECT DISTINCT\n        cust.msa_id ,\n        cust.grp1_lvl_1_desc ,\n        cust.grp2_lvl_1_desc ,\n        cust.grp2_lvl_2_desc ,\n        cust.bus_type_aggr_desc ,\n        (\n            CASE\n                WHEN (ltrim(rtrim(UPPER (COALESCE(cust.grp1_lvl_1_desc,' '))))=ltrim(rtrim(UPPER (COALESCE(pbc_ret.grp1_lvl_1_desc,' '))))\n                AND ltrim(rtrim(UPPER (COALESCE(cust.grp2_lvl_1_desc,' '))))=ltrim(rtrim(UPPER (COALESCE(pbc_ret.grp2_lvl_1_desc,' '))))\n                AND ltrim(rtrim(UPPER (COALESCE(cust.bus_type_aggr_desc,' '))))=ltrim(rtrim(UPPER (COALESCE(pbc_ret.bus_type_aggr_desc,' ')))))\n                THEN pbc_ret.pbc_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS pbc_retailer_old ,\n        2 AS Round_number\n    FROM\n         {{ ref('btg_pbc_sales_cust_v') }} AS cust\n    JOIN\n        pbc_ret1 AS pbc_ret\n    ON\n        TRIM(UPPER(COALESCE(cust.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp1_lvl_1_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.grp2_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp2_lvl_1_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n),\npbc_round_3_match AS\n(\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.grp1_lvl_1_desc,\n        cust.grp2_lvl_1_desc,\n        cust.grp2_lvl_2_desc,\n        cust.bus_type_aggr_desc,\n        (\n            CASE\n                WHEN (\n                    TRIM(UPPER(COALESCE(cust.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp1_lvl_1_desc, ' ')))\n                    AND TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n                )\n                THEN pbc_ret.pbc_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS pbc_retailer_old,\n        3 AS Round_number\n    FROM\n         {{ ref('btg_pbc_sales_cust_v') }} AS cust\n    JOIN\n        pbc_ret2 AS pbc_ret\n    ON\n        TRIM(UPPER(COALESCE(cust.grp1_lvl_1_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.grp1_lvl_1_desc, ' ')))\n        AND TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n),\npbc_round_4_match AS\n(\n    SELECT DISTINCT\n        cust.msa_id,\n        cust.grp1_lvl_1_desc,\n        cust.grp2_lvl_1_desc,\n        cust.grp2_lvl_2_desc,\n        cust.bus_type_aggr_desc,\n        (\n            CASE\n                WHEN TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n                THEN pbc_ret.pbc_retailer\n                ELSE 'NOT ASSIGNED'\n            END\n        ) AS pbc_retailer_old,\n        4 AS Round_number\n    FROM\n        {{ ref('btg_pbc_sales_cust_v') }} AS cust\n    LEFT JOIN\n        (\n            SELECT DISTINCT\n                bus_type_aggr_desc,\n                pbc_retailer\n            FROM\n                 {{ ref('btg_pbc_retailer_assgnt') }}\n            WHERE\n                IFNULL(grp1_lvl_1_desc, '') = ''\n                AND IFNULL(grp2_lvl_1_desc, '') = ''\n        ) AS pbc_ret\n    ON\n        TRIM(UPPER(COALESCE(cust.bus_type_aggr_desc, ' '))) = TRIM(UPPER(COALESCE(pbc_ret.bus_type_aggr_desc, ' ')))\n),\npbc_all_rounds AS\n(\n    SELECT * FROM pbc_round_1_match\n    UNION ALL\n    SELECT * FROM pbc_round_2_match\n    UNION ALL\n    SELECT * FROM pbc_round_3_match\n    UNION ALL\n    SELECT * FROM pbc_round_4_match\n)\nSELECT\n\tmsa_id,\n\tpbc_retailer_old AS pbc_retailer,\n\tCASE WHEN round_number = 1 THEN 'Business Assigned' ELSE 'IT assigned' END AS assgnt_descp,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t(\n\t\tSELECT\n\t\t\tmsa_id,\n\t\t\tgrp1_lvl_1_desc,\n\t\t\tgrp2_lvl_1_desc,\n\t\t\tgrp2_lvl_2_desc,\n\t\t\tbus_type_aggr_desc,\n\t\t\tpbc_retailer_old,\n\t\t\tround_number,\n\t\t\tROW_NUMBER() OVER(\n\t\t\t\tPARTITION BY msa_id,\n\t\t\t\tgrp1_lvl_1_desc,\n\t\t\t\tgrp2_lvl_1_desc,\n\t\t\t\tgrp2_lvl_2_desc,\n\t\t\t\tbus_type_aggr_desc\n\t\t\t\tORDER BY\n\t\t\t\t\tround_number ASC\n\t\t\t) AS seq_num\n\t\tFROM\n\t\t\tpbc_all_rounds\n\t) AS a\nWHERE\n\tseq_num = 1", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_retailer_xref_v"], "unique_id": "model.sdna_project.btg_pbc_retailer_xref_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_retailer_xref_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_retailer_xref_v.sql", "name": "btg_pbc_retailer_xref_v", "resource_type": "model", "alias": "btg_pbc_retailer_xref_v", "checksum": {"name": "sha256", "checksum": "a6db336671e79a7422c70970c93afcde8289808bbe709b9ae66593f497b47988"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_retailer_assgnt"], ["btg_pbc_sales_cust_v"], ["btg_pbc_retailer_assgnt"], ["btg_pbc_retailer_assgnt"], ["btg_pbc_retailer_assgnt"], ["btg_pbc_retailer_assgnt"], ["btg_pbc_sales_cust_v"], ["btg_pbc_retailer_assgnt"], ["btg_pbc_sales_cust_v"], ["btg_pbc_sales_cust_v"], ["btg_pbc_sales_cust_v"], ["btg_pbc_retailer_assgnt"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_retailer_assgnt"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load btg_pbc_sales_cust_prod_v\n\n-- {{ ref('pbc_sales_cust_prod_agg') }}\n-- {{ ref('btg_msa_pbc_xref') }}\n-- {{ ref('pbc_prod') }}\n-- {{ ref('stg_pbc_xref_unique') }}\n\nWITH sales AS (\n    SELECT\n           xref.msa_id,\n           s.inven_id,\n           sum(s.DELY_LNE_QTY_CY_YTD) as DELY_LNE_QTY_CY_YTD,\n           sum(s.DELY_LNE_QTY_PY) as DELY_LNE_QTY_PY,\n           sum(s.DELY_LNE_QTY_2PY) as DELY_LNE_QTY_2PY,\n           sum(s.DELY_LNE_QTY_PY_YTD) as DELY_LNE_QTY_PY_YTD,\n           sum(s.DELY_LNE_QTY_2PY_YTD) as DELY_LNE_QTY_2PY_YTD,\n           sum(s.DELY_LNE_QTY_CY_L13P) as DELY_LNE_QTY_CY_L13P,\n           sum(s.DELY_LNE_QTY_PY_L13P) as DELY_LNE_QTY_PY_L13P,\n           -- added sum logic for 4,12 and 26 week levels\n           sum(s.DELY_LNE_QTY_CY_L4wk) as DELY_LNE_QTY_CY_L4wk,\n           sum(s.DELY_LNE_QTY_PY_L4wk) as DELY_LNE_QTY_PY_L4wk,\n           sum(s.DELY_LNE_QTY_CY_L12wk) as DELY_LNE_QTY_CY_L12wk,\n           sum(s.DELY_LNE_QTY_PY_L12wk) as DELY_LNE_QTY_PY_L12wk,\n           sum(s.DELY_LNE_QTY_CY_L26wk) as DELY_LNE_QTY_CY_L26wk,\n           sum(s.DELY_LNE_QTY_PY_L26wk) as DELY_LNE_QTY_PY_L26wk,\n           ----- end -----\n           sum(s.DELY_LNE_QTY_CY_L52wk) as DELY_LNE_QTY_CY_L52wk,\n           sum(s.DELY_LNE_QTY_PY_L52wk) as DELY_LNE_QTY_PY_L52wk,\n           sum(s.RAW_VOL_CY_YTD) as RAW_VOL_CY_YTD,\n           sum(s.RAW_VOL_PY) as RAW_VOL_PY,\n           sum(s.RAW_VOL_2PY) as RAW_VOL_2PY,\n           sum(s.RAW_VOL_PY_YTD) as RAW_VOL_PY_YTD,\n           sum(s.RAW_VOL_2PY_YTD) as RAW_VOL_2PY_YTD,\n           sum(s.RAW_VOL_CY_L13P) as RAW_VOL_CY_L13P,\n           sum(s.RAW_VOL_PY_L13P) as RAW_VOL_PY_L13P,\n           -- added sum logic for 4,12 and 26 week levels\n           sum(s.RAW_VOL_CY_L4wk) as RAW_VOL_CY_L4wk,\n           sum(s.RAW_VOL_PY_L4wk) as RAW_VOL_PY_L4wk,\n           sum(s.RAW_VOL_CY_L12wk) as RAW_VOL_CY_L12wk,\n           sum(s.RAW_VOL_PY_L12wk) as RAW_VOL_PY_L12wk,\n           sum(s.RAW_VOL_CY_L26wk) as RAW_VOL_CY_L26wk,\n           sum(s.RAW_VOL_PY_L26wk) as RAW_VOL_PY_L26wk,\n           ----- end -------\n           sum(s.RAW_VOL_CY_L52wk) as RAW_VOL_CY_L52wk,\n           sum(s.RAW_VOL_PY_L52wk) as RAW_VOL_PY_L52wk,\n           sum(s.EGHT_OZ_VOL_CY_YTD) as EGHT_OZ_VOL_CY_YTD,\n           sum(s.EGHT_OZ_VOL_PY) as EGHT_OZ_VOL_PY,\n           sum(s.EGHT_OZ_VOL_2PY) as EGHT_OZ_VOL_2PY,\n           sum(s.EGHT_OZ_VOL_PY_YTD) as EGHT_OZ_VOL_PY_YTD,\n           sum(s.EGHT_OZ_VOL_2PY_YTD) as EGHT_OZ_VOL_2PY_YTD,\n           sum(s.EGHT_OZ_VOL_CY_L13P) as EGHT_OZ_VOL_CY_L13P,\n           sum(s.EGHT_OZ_VOL_PY_L13P) as EGHT_OZ_VOL_PY_L13P,\n           -- added sum logic for 4,12 and 26 week levels\n           sum(s.eght_oz_vol_cy_l4wk) as eght_oz_vol_cy_l4wk,\n           sum(s.eght_oz_vol_py_l4wk) as eght_oz_vol_py_l4wk,\n           sum(s.eght_oz_vol_cy_l12wk) as eght_oz_vol_cy_l12wk,\n           sum(s.eght_oz_vol_py_l12wk) as eght_oz_vol_py_l12wk,\n           sum(s.eght_oz_vol_cy_l26wk) as eght_oz_vol_cy_l26wk,\n           sum(s.eght_oz_vol_py_l26wk) as eght_oz_vol_py_l26wk,\n           ------ end ----------\n           sum(s.eght_oz_vol_cy_l52wk) as eght_oz_vol_cy_l52wk,\n           sum(s.eght_oz_vol_py_l52wk) as eght_oz_vol_py_l52wk,\n           sum(s.NET_REV_CY_YTD) as NET_REV_CY_YTD,\n           sum(s.NET_REV_PY) as NET_REV_PY,\n           sum(s.NET_REV_2PY) as NET_REV_2PY,\n           sum(s.NET_REV_PY_YTD) as NET_REV_PY_YTD,\n           sum(s.NET_REV_2PY_YTD) as NET_REV_2PY_YTD,\n           sum(s.NET_REV_CY_L13P) as NET_REV_CY_L13P,\n           sum(s.NET_REV_PY_L13P) as NET_REV_PY_L13P,\n           -- added sum logic for 4,12 and 26 week levels\n           sum(s.NET_REV_CY_L4wk) as NET_REV_CY_L4wk,\n           sum(s.NET_REV_PY_L4wk) as NET_REV_PY_L4wk,\n           sum(s.NET_REV_CY_L12wk) as NET_REV_CY_L12wk,\n           sum(s.NET_REV_PY_L12wk) as NET_REV_PY_L12wk,\n           sum(s.NET_REV_CY_L26wk) as NET_REV_CY_L26wk,\n           sum(s.NET_REV_PY_L26wk) as NET_REV_PY_L26wk,\n           ------ end ------\n           sum(s.NET_REV_CY_L52wk) as NET_REV_CY_L52wk,\n           sum(s.NET_REV_PY_L52wk) as NET_REV_PY_L52wk\n    FROM {{ ref('pbc_sales_cust_prod_agg') }} s\n    JOIN {{ ref('btg_msa_pbc_xref') }} xref ON (xref.pbc_cust_id = s.cust_id)\n    JOIN {{ ref('pbc_prod') }} prod ON (s.inven_id = prod.inven_id)\n    WHERE prod.hrzn_corp_aggr_id <> 2\n    GROUP BY xref.msa_id, s.inven_id\n)\n\nSELECT\n    xref_uniq.*,\n    sales.inven_id,\n    sales.DELY_LNE_QTY_CY_YTD,\n    sales.DELY_LNE_QTY_PY,\n    sales.DELY_LNE_QTY_2PY,\n    sales.DELY_LNE_QTY_PY_YTD,\n    sales.DELY_LNE_QTY_2PY_YTD,\n    sales.DELY_LNE_QTY_CY_L13P,\n    sales.DELY_LNE_QTY_PY_L13P,\n    -- Added code for 4,12 and 26 week level columns\n    sales.DELY_LNE_QTY_CY_L4wk,\n    sales.DELY_LNE_QTY_PY_L4wk,\n    sales.DELY_LNE_QTY_CY_L12wk,\n    sales.DELY_LNE_QTY_PY_L12wk,\n    sales.DELY_LNE_QTY_CY_L26wk,\n    sales.DELY_LNE_QTY_PY_L26wk,\n    ------- end --------\n    sales.DELY_LNE_QTY_CY_L52wk,\n    sales.DELY_LNE_QTY_PY_L52wk,\n    sales.RAW_VOL_CY_YTD,\n    sales.RAW_VOL_PY,\n    sales.RAW_VOL_2PY,\n    sales.RAW_VOL_PY_YTD,\n    sales.RAW_VOL_2PY_YTD,\n    sales.RAW_VOL_CY_L13P,\n    sales.RAW_VOL_PY_L13P,\n    -- Added code for 4,12 and 26 week level columns\n    sales.RAW_VOL_CY_L4wk,\n    sales.RAW_VOL_PY_L4wk,\n    sales.RAW_VOL_CY_L12wk,\n    sales.RAW_VOL_PY_L12wk,\n    sales.RAW_VOL_CY_L26wk,\n    sales.RAW_VOL_PY_L26wk,\n    ------ end ---------\n    sales.RAW_VOL_CY_L52wk,\n    sales.RAW_VOL_PY_L52wk,\n    sales.EGHT_OZ_VOL_CY_YTD,\n    sales.EGHT_OZ_VOL_PY,\n    sales.EGHT_OZ_VOL_2PY,\n    sales.EGHT_OZ_VOL_PY_YTD,\n    sales.EGHT_OZ_VOL_2PY_YTD,\n    sales.EGHT_OZ_VOL_CY_L13P,\n    sales.EGHT_OZ_VOL_PY_L13P,\n    -- Added code for 4,12 and 26 week level columns\n    sales.EGHT_OZ_VOL_CY_L4wk,\n    sales.EGHT_OZ_VOL_PY_L4wk,\n    sales.EGHT_OZ_VOL_CY_L12wk,\n    sales.EGHT_OZ_VOL_PY_L12wk,\n    sales.EGHT_OZ_VOL_CY_L26wk,\n    sales.EGHT_OZ_VOL_PY_L26wk,\n    ------- end -----------\n    sales.EGHT_OZ_VOL_CY_L52wk,\n    sales.EGHT_OZ_VOL_PY_L52wk,\n    sales.NET_REV_CY_YTD,\n    sales.NET_REV_PY,\n    sales.NET_REV_2PY,\n    sales.NET_REV_PY_YTD,\n    sales.NET_REV_2PY_YTD,\n    sales.NET_REV_CY_L13P,\n    sales.NET_REV_PY_L13P,\n    -- Added code for 4,12 and 26 week level columns\n    sales.NET_REV_CY_L4wk,\n    sales.NET_REV_PY_L4wk,\n    sales.NET_REV_CY_L12wk,\n    sales.NET_REV_PY_L12wk,\n    sales.NET_REV_CY_L26wk,\n    sales.NET_REV_PY_L26wk,\n    -------- end ------\n    sales.NET_REV_CY_L52wk,\n    sales.NET_REV_PY_L52wk,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM sales\nJOIN {{ ref('stg_pbc_xref_unique') }} xref_uniq ON sales.msa_id = xref_uniq.msa_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_sales_cust_prod_v"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_prod_v.sql", "name": "btg_pbc_sales_cust_prod_v", "resource_type": "model", "alias": "btg_pbc_sales_cust_prod_v", "checksum": {"name": "sha256", "checksum": "5ca407d93374e2c0d8c9ab1a6afb3846af4c3a73e59472b8b5d6a95d5dbd8b12"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales_cust_prod_agg"], ["btg_msa_pbc_xref"], ["pbc_prod"], ["stg_pbc_xref_unique"], ["pbc_sales_cust_prod_agg"], ["btg_msa_pbc_xref"], ["pbc_prod"], ["stg_pbc_xref_unique"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.pbc_prod", "model.sdna_project.stg_pbc_xref_unique", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.pbc_prod", "model.sdna_project.stg_pbc_xref_unique"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_pbc_sales_cust_v\n\nSELECT\n    xref_uniq.msa_id,\n\txref_uniq.pbc_cust_id,\n\txref_uniq.cust_cnt,\n\tcust.cust_id,\n\tcust.bulk_dely_flg,\n\tcust.chain_flg,\n\tcust.chain_owner_cde,\n\tcust.chain_owner_desc,\n\tcust.cur_stat_cde,\n\tcust.cur_stat_desc,\n\tcust.cur_stat_dte,\n\tcust.cust_prod_flg,\n\tcust.cust_serv_flg,\n\tcust.cust_org_flg,\n\tcust.cust_blg_flg,\n\tcust.cust_misc_flg,\n\tcust.cust_added_dte,\n\tcust.cust_lglnme,\n\tcust.lang_cde,\n\tcust.lang_desc,\n\tcust.loc_prod_id,\n\tcust.loc_serv_id,\n\tcust.nme,\n\tcust.natl_acct_flg,\n\tcust.po_reqd_flg,\n\tcust.pymt_term_beg_dte,\n\tcust.pymt_term_cde,\n\tcust.pymt_term_desc,\n\tcust.sep_inv_flg,\n\tcust.tax_exempt_num,\n\tcust.tin_num,\n\tcust.tin_type_cde,\n\tcust.tin_type_desc,\n\tcust.empl_tac_id,\n\tcust.cust_equip_flg,\n\tcust.udf_num,\n\tcust.vrtx_geo_cde,\n\tcust.bus_type_cde,\n\tcust.bus_type_desc,\n\tcust.tme_zone_cde,\n\tcust.tme_zone_desc,\n\tcust.cust_fobo_btlr_flg,\n\tcust.cust_fobo_cust_flg,\n\tcust.cust_fsv_flg,\n\tcust.prc_zone_id,\n\tcust.ethnic_cde,\n\tcust.ethnic_desc,\n\tcust.cust_ucs_cmctn_id,\n\tcust.cust_dab_num,\n\tcust.cust_dex_beg_dte,\n\tcust.leg_chain_num,\n\tcust.seas_clsd_beg_dte,\n\tcust.seas_clsd_end_dte,\n\tcust.cust_lgtud_num,\n\tcust.cust_latud_num,\n\tcust.bus_type_aggr_cde,\n\tcust.bus_type_aggr_desc,\n\tcust.outside_city_lmt_ind,\n\tcust.cust_last_actvty_dte,\n\tcust.grp1_type_desc,\n\tcust.grp1_ownr_id,\n\tcust.grp1_ownr_desc,\n\tcust.grp1_lvl_1_id,\n\tcust.grp1_lvl_1_desc,\n\tcust.grp1_lvl_2_id,\n\tcust.grp1_lvl_2_desc,\n\tcust.grp2_type_desc,\n\tcust.grp2_ownr_id,\n\tcust.grp2_ownr_desc,\n\tcust.grp2_lvl_1_ancstr_id,\n\tcust.grp2_lvl_1_ancstr_nme,\n\tcust.grp2_lvl_1_ancstr_prev_nme,\n\tcust.grp2_lvl_1_id,\n\tcust.grp2_lvl_1_desc,\n\tcust.grp2_lvl_2_id,\n\tcust.grp2_lvl_2_desc,\n\tcust.grp3_type_desc,\n\tcust.grp3_ownr_id,\n\tcust.grp3_ownr_desc,\n\tcust.grp3_lvl_1_id,\n\tcust.grp3_lvl_1_desc,\n\tcust.grp3_lvl_2_id,\n\tcust.grp3_lvl_2_desc,\n\tcust.loc_prod_nme,\n\tcust.loc_prod_mu_id,\n\tcust.loc_prod_mu_nme,\n\tcust.loc_prod_bu_id,\n\tcust.loc_prod_bu_nme,\n\tcust.loc_prod_area_rpt_id,\n\tcust.loc_prod_area_rpt_nme,\n\tcust.loc_prod_mu_rpt_id,\n\tcust.loc_prod_mu_rpt_nme,\n\tcust.loc_prod_bu_rpt_id,\n\tcust.loc_prod_bu_rpt_nme,\n\tcust.loc_serv_nme,\n\tcust.loc_serv_mu_id,\n\tcust.loc_serv_mu_nme,\n\tcust.loc_serv_bu_id,\n\tcust.loc_serv_bu_nme,\n\tcust.loc_serv_area_rpt_id,\n\tcust.loc_serv_area_rpt_nme,\n\tcust.loc_serv_mu_rpt_id,\n\tcust.loc_serv_mu_rpt_nme,\n\tcust.loc_serv_bu_rpt_id,\n\tcust.loc_serv_bu_rpt_nme,\n\tcust.bus_type_ctgy_cde,\n\tcust.bus_type_ctgy_desc,\n\tcust.grp4_type_desc,\n\tcust.grp4_ownr_id,\n\tcust.grp4_ownr_desc,\n\tcust.grp4_lvl_1_id,\n\tcust.grp4_lvl_1_desc,\n\tcust.grp4_lvl_2_id,\n\tcust.grp4_lvl_2_desc,\n\tcust.dex_vers_num,\n\tcust.dely_adr_city,\n\tcust.dely_adr_cntry_cde,\n\tcust.dely_adr_cnty,\n\tcust.dely_adr_state,\n\tcust.dely_adr_strt1,\n\tcust.dely_adr_strt2,\n\tcust.dely_adr_strt3,\n\tcust.dely_adr_zip,\n\tcust.dely_adr_zip5,\n\tcust.blg_adr_city,\n\tcust.blg_adr_cntry_cde,\n\tcust.blg_adr_cnty,\n\tcust.blg_adr_state,\n\tcust.blg_adr_strt1,\n\tcust.blg_adr_strt2,\n\tcust.blg_adr_strt3,\n\tcust.blg_adr_zip,\n\tcust.blg_adr_zip5,\n\tcust.mlg_adr_city,\n\tcust.mlg_adr_cntry_cde,\n\tcust.mlg_adr_cnty,\n\tcust.mlg_adr_state,\n\tcust.mlg_adr_strt1,\n\tcust.mlg_adr_strt2,\n\tcust.mlg_adr_strt3,\n\tcust.mlg_adr_zip,\n\tcust.mlg_adr_zip5,\n\tcust.sls_cnct_first_nme,\n\tcust.sls_cnct_last_nme,\n\tcust.sls_cnct_phone_acd_num,\n\tcust.sls_cnct_phone_num,\n\tcust.sls_cnct_phone_ext_num,\n\tcust.rpr_cnct_first_nme,\n\tcust.rpr_cnct_last_nme,\n\tcust.rpr_cnct_phone_acd_num,\n\tcust.rpr_cnct_phone_num,\n\tcust.rpr_cnct_phone_ext_num,\n\tcust.ts_cnct_first_nme,\n\tcust.ts_cnct_last_nme,\n\tcust.ts_cnct_phone_acd_num,\n\tcust.ts_cnct_phone_num,\n\tcust.ts_cnct_phone_ext_num,\n\tcust.fsv_cnct_first_nme,\n\tcust.fsv_cnct_last_nme,\n\tcust.fsv_cnct_phone_acd_num,\n\tcust.fsv_cnct_phone_num,\n\tcust.fsv_cnct_phone_ext_num,\n\tcust.merch_acct_flg,\n\tcust.min_ord_qty,\n\tcust.chrg_to_frnch,\n\tcust.inv_udf_num_cde,\n\tcust.inv_udf_num_desc,\n\tcust.dw_srce_id,\n\tcust.dw_updt_dte,\n\tcust.actv_dely_loc_id,\n\tcust.cust_cmnt_txt,\n\tcust.cust_origtn_cde,\n\tsales.dely_lne_qty_cy_ytd,\n\tsales.dely_lne_qty_py,\n\tsales.dely_lne_qty_2py,\n\tsales.dely_lne_qty_py_ytd,\n\tsales.dely_lne_qty_2py_ytd,\n\tsales.dely_lne_qty_cy_l13p,\n\tsales.dely_lne_qty_py_l13p,\n\tsales.dely_lne_qty_cy_l4wk,\n\tsales.dely_lne_qty_py_l4wk,\n\tsales.dely_lne_qty_cy_l12wk,\n\tsales.dely_lne_qty_py_l12wk,\n\tsales.dely_lne_qty_cy_l26wk,\n\tsales.dely_lne_qty_py_l26wk,\n\tsales.dely_lne_qty_cy_l52wk,\n\tsales.dely_lne_qty_py_l52wk,\n\tsales.raw_vol_cy_ytd,\n\tsales.raw_vol_py,\n\tsales.raw_vol_2py,\n\tsales.raw_vol_py_ytd,\n\tsales.raw_vol_2py_ytd,\n\tsales.raw_vol_cy_l13p,\n\tsales.raw_vol_py_l13p,\n\tsales.raw_vol_cy_l4wk,\n\tsales.raw_vol_py_l4wk,\n\tsales.raw_vol_cy_l12wk,\n\tsales.raw_vol_py_l12wk,\n\tsales.raw_vol_cy_l26wk,\n\tsales.raw_vol_py_l26wk,\n\tsales.raw_vol_cy_l52wk,\n\tsales.raw_vol_py_l52wk,\n\tsales.eght_oz_vol_cy_ytd,\n\tsales.eght_oz_vol_py,\n\tsales.eght_oz_vol_2py,\n\tsales.eght_oz_vol_py_ytd,\n\tsales.eght_oz_vol_2py_ytd,\n\tsales.eght_oz_vol_cy_l13p,\n\tsales.eght_oz_vol_py_l13p,\n\tsales.eght_oz_vol_cy_l4wk,\n\tsales.eght_oz_vol_py_l4wk,\n\tsales.eght_oz_vol_cy_l12wk,\n\tsales.eght_oz_vol_py_l12wk,\n\tsales.eght_oz_vol_cy_l26wk,\n\tsales.eght_oz_vol_py_l26wk,\n\tsales.eght_oz_vol_cy_l52wk,\n\tsales.eght_oz_vol_py_l52wk,\n\tsales.net_rev_cy_ytd,\n\tsales.net_rev_py,\n\tsales.net_rev_2py,\n\tsales.net_rev_py_ytd,\n\tsales.net_rev_2py_ytd,\n\tsales.net_rev_cy_l13p,\n\tsales.net_rev_py_l13p,\n\tsales.net_rev_cy_l4wk,\n\tsales.net_rev_py_l4wk,\n\tsales.net_rev_cy_l12wk,\n\tsales.net_rev_py_l12wk,\n\tsales.net_rev_cy_l26wk,\n\tsales.net_rev_py_l26wk,\n\tsales.net_rev_cy_l52wk,\n\tsales.net_rev_py_l52wk\nFROM {{ ref('stg_pbc_sales') }} sales\nJOIN {{ ref('stg_pbc_xref_unique') }} xref_uniq ON sales.msa_id = xref_uniq.msa_id\nJOIN {{ ref('stg_pbc_cust') }} cust ON cust.cust_id = xref_uniq.pbc_cust_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_sales_cust_v"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_v.sql", "name": "btg_pbc_sales_cust_v", "resource_type": "model", "alias": "btg_pbc_sales_cust_v", "checksum": {"name": "sha256", "checksum": "fde738f0ade33d39e8ff5f3aa527957dfbebf738b4a0b2e9cdf318f34f9ba798"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["stg_pbc_sales"], ["stg_pbc_xref_unique"], ["stg_pbc_cust"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.stg_pbc_sales", "model.sdna_project.stg_pbc_xref_unique", "model.sdna_project.stg_pbc_cust"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_wk_prod_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load btg_pbc_sales_cust_wk_prod_v\n\nWITH sales AS (\n    SELECT\n        xref.msa_id,\n        p.inven_id,\n        s.FSCL_WK_END_DTE,\n        s.FSCL_YR_NUM,\n        s.FSCL_PD_NUM,\n        s.FSCL_WK_IN_PD_NUM,\n        SUM(s.DELY_LNE_QTY) AS DELY_LNE_QTY,\n        SUM(s.RAW_VOL)      AS RAW_VOL,\n        SUM(s.EGHT_OZ_VOL)  AS EGHT_OZ_VOL,\n        SUM(s.NET_REV)      AS NET_REV\n    FROM {{ ref('btg_pbc_cust_v') }} c\n    JOIN {{ ref('pbc_sales') }} s ON c.cust_id = s.CUST_ID\n    JOIN {{ ref('btg_pbc_prod_v') }} p ON p.INVEN_ID = s.INVEN_ID\n    JOIN {{ ref('btg_msa_pbc_xref') }} xref ON xref.pbc_cust_id = s.cust_id\n    WHERE p.hrzn_corp_aggr_id <> 2\n    GROUP BY\n        xref.msa_id,\n        p.INVEN_ID,\n        s.FSCL_WK_END_DTE,\n        s.FSCL_YR_NUM,\n        s.FSCL_PD_NUM,\n        s.FSCL_WK_IN_PD_NUM\n\n)\n\nSELECT\n    xref_uniq.msa_id,\n    xref_uniq.pbc_cust_id,\n    sales.inven_id,\n    sales.FSCL_WK_END_DTE,\n    sales.FSCL_YR_NUM,\n    sales.FSCL_PD_NUM,\n    sales.FSCL_WK_IN_PD_NUM,\n    sales.DELY_LNE_QTY,\n    sales.RAW_VOL,\n    sales.EGHT_OZ_VOL,\n    sales.NET_REV\nFROM sales\nJOIN {{ ref('stg_pbc_xref_unique') }} xref_uniq\nON sales.msa_id = xref_uniq.msa_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_sales_cust_wk_prod_v"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_wk_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_wk_prod_v.sql", "name": "btg_pbc_sales_cust_wk_prod_v", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_prod_v", "checksum": {"name": "sha256", "checksum": "6776c6dd8c17fa473ae0d21fa0ffcd3f039b1eecf038560336ca108b2ac9c420"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_cust_v"], ["pbc_sales"], ["btg_pbc_prod_v"], ["btg_msa_pbc_xref"], ["stg_pbc_xref_unique"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_cust_v", "model.sdna_project.pbc_sales", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.stg_pbc_xref_unique"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_wk_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_pbc_sales_cust_wk_v\nWITH sales AS (\n    SELECT\n        xref.msa_id,\n        s.fscl_wk_end_dte,\n        s.fscl_yr_num,\n        s.fscl_pd_num,\n        s.fscl_wk_in_pd_num,\n        SUM(s.dely_lne_qty) AS dely_lne_qty,\n        SUM(s.raw_vol) AS raw_vol,\n        SUM(s.eght_oz_vol) AS eght_oz_vol,\n        SUM(s.net_rev) AS net_rev\n    FROM {{ ref('pbc_sales_cust_wk_agg_no_allied') }} AS s\n    JOIN {{ ref('btg_msa_pbc_xref') }} AS xref ON xref.pbc_cust_id = s.cust_id\n    GROUP BY\n        xref.msa_id,\n        s.fscl_wk_end_dte,\n        s.fscl_yr_num,\n        s.fscl_pd_num,\n        s.fscl_wk_in_pd_num\n)\n\nSELECT\n    xref_uniq.msa_id,\n\txref_uniq.pbc_cust_id,\n\txref_uniq.cust_cnt,\n\tcust.cust_id,\n\tcust.bulk_dely_flg,\n\tcust.chain_flg,\n\tcust.chain_owner_cde,\n\tcust.chain_owner_desc,\n\tcust.cur_stat_cde,\n\tcust.cur_stat_desc,\n\tcust.cur_stat_dte,\n\tcust.cust_prod_flg,\n\tcust.cust_serv_flg,\n\tcust.cust_org_flg,\n\tcust.cust_blg_flg,\n\tcust.cust_misc_flg,\n\tcust.cust_added_dte,\n\tcust.cust_lglnme,\n\tcust.lang_cde,\n\tcust.lang_desc,\n\tcust.loc_prod_id,\n\tcust.loc_serv_id,\n\tcust.nme,\n\tcust.natl_acct_flg,\n\tcust.po_reqd_flg,\n\tcust.pymt_term_beg_dte,\n\tcust.pymt_term_cde,\n\tcust.pymt_term_desc,\n\tcust.sep_inv_flg,\n\tcust.tax_exempt_num,\n\tcust.tin_num,\n\tcust.tin_type_cde,\n\tcust.tin_type_desc,\n\tcust.empl_tac_id,\n\tcust.cust_equip_flg,\n\tcust.udf_num,\n\tcust.vrtx_geo_cde,\n\tcust.bus_type_cde,\n\tcust.bus_type_desc,\n\tcust.tme_zone_cde,\n\tcust.tme_zone_desc,\n\tcust.cust_fobo_btlr_flg,\n\tcust.cust_fobo_cust_flg,\n\tcust.cust_fsv_flg,\n\tcust.prc_zone_id,\n\tcust.ethnic_cde,\n\tcust.ethnic_desc,\n\tcust.cust_ucs_cmctn_id,\n\tcust.cust_dab_num,\n\tcust.cust_dex_beg_dte,\n\tcust.leg_chain_num,\n\tcust.seas_clsd_beg_dte,\n\tcust.seas_clsd_end_dte,\n\tcust.cust_lgtud_num,\n\tcust.cust_latud_num,\n\tcust.bus_type_aggr_cde,\n\tcust.bus_type_aggr_desc,\n\tcust.outside_city_lmt_ind,\n\tcust.cust_last_actvty_dte,\n\tcust.grp1_type_desc,\n\tcust.grp1_ownr_id,\n\tcust.grp1_ownr_desc,\n\tcust.grp1_lvl_1_id,\n\tcust.grp1_lvl_1_desc,\n\tcust.grp1_lvl_2_id,\n\tcust.grp1_lvl_2_desc,\n\tcust.grp2_type_desc,\n\tcust.grp2_ownr_id,\n\tcust.grp2_ownr_desc,\n\tcust.grp2_lvl_1_ancstr_id,\n\tcust.grp2_lvl_1_ancstr_nme,\n\tcust.grp2_lvl_1_ancstr_prev_nme,\n\tcust.grp2_lvl_1_id,\n\tcust.grp2_lvl_1_desc,\n\tcust.grp2_lvl_2_id,\n\tcust.grp2_lvl_2_desc,\n\tcust.grp3_type_desc,\n\tcust.grp3_ownr_id,\n\tcust.grp3_ownr_desc,\n\tcust.grp3_lvl_1_id,\n\tcust.grp3_lvl_1_desc,\n\tcust.grp3_lvl_2_id,\n\tcust.grp3_lvl_2_desc,\n\tcust.loc_prod_nme,\n\tcust.loc_prod_mu_id,\n\tcust.loc_prod_mu_nme,\n\tcust.loc_prod_bu_id,\n\tcust.loc_prod_bu_nme,\n\tcust.loc_prod_area_rpt_id,\n\tcust.loc_prod_area_rpt_nme,\n\tcust.loc_prod_mu_rpt_id,\n\tcust.loc_prod_mu_rpt_nme,\n\tcust.loc_prod_bu_rpt_id,\n\tcust.loc_prod_bu_rpt_nme,\n\tcust.loc_serv_nme,\n\tcust.loc_serv_mu_id,\n\tcust.loc_serv_mu_nme,\n\tcust.loc_serv_bu_id,\n\tcust.loc_serv_bu_nme,\n\tcust.loc_serv_area_rpt_id,\n\tcust.loc_serv_area_rpt_nme,\n\tcust.loc_serv_mu_rpt_id,\n\tcust.loc_serv_mu_rpt_nme,\n\tcust.loc_serv_bu_rpt_id,\n\tcust.loc_serv_bu_rpt_nme,\n\tcust.bus_type_ctgy_cde,\n\tcust.bus_type_ctgy_desc,\n\tcust.grp4_type_desc,\n\tcust.grp4_ownr_id,\n\tcust.grp4_ownr_desc,\n\tcust.grp4_lvl_1_id,\n\tcust.grp4_lvl_1_desc,\n\tcust.grp4_lvl_2_id,\n\tcust.grp4_lvl_2_desc,\n\tcust.dex_vers_num,\n\tcust.dely_adr_city,\n\tcust.dely_adr_cntry_cde,\n\tcust.dely_adr_cnty,\n\tcust.dely_adr_state,\n\tcust.dely_adr_strt1,\n\tcust.dely_adr_strt2,\n\tcust.dely_adr_strt3,\n\tcust.dely_adr_zip,\n\tcust.dely_adr_zip5,\n\tcust.blg_adr_city,\n\tcust.blg_adr_cntry_cde,\n\tcust.blg_adr_cnty,\n\tcust.blg_adr_state,\n\tcust.blg_adr_strt1,\n\tcust.blg_adr_strt2,\n\tcust.blg_adr_strt3,\n\tcust.blg_adr_zip,\n\tcust.blg_adr_zip5,\n\tcust.mlg_adr_city,\n\tcust.mlg_adr_cntry_cde,\n\tcust.mlg_adr_cnty,\n\tcust.mlg_adr_state,\n\tcust.mlg_adr_strt1,\n\tcust.mlg_adr_strt2,\n\tcust.mlg_adr_strt3,\n\tcust.mlg_adr_zip,\n\tcust.mlg_adr_zip5,\n\tcust.sls_cnct_first_nme,\n\tcust.sls_cnct_last_nme,\n\tcust.sls_cnct_phone_acd_num,\n\tcust.sls_cnct_phone_num,\n\tcust.sls_cnct_phone_ext_num,\n\tcust.rpr_cnct_first_nme,\n\tcust.rpr_cnct_last_nme,\n\tcust.rpr_cnct_phone_acd_num,\n\tcust.rpr_cnct_phone_num,\n\tcust.rpr_cnct_phone_ext_num,\n\tcust.ts_cnct_first_nme,\n\tcust.ts_cnct_last_nme,\n\tcust.ts_cnct_phone_acd_num,\n\tcust.ts_cnct_phone_num,\n\tcust.ts_cnct_phone_ext_num,\n\tcust.fsv_cnct_first_nme,\n\tcust.fsv_cnct_last_nme,\n\tcust.fsv_cnct_phone_acd_num,\n\tcust.fsv_cnct_phone_num,\n\tcust.fsv_cnct_phone_ext_num,\n\tcust.merch_acct_flg,\n\tcust.min_ord_qty,\n\tcust.chrg_to_frnch,\n\tcust.inv_udf_num_cde,\n\tcust.inv_udf_num_desc,\n\tcust.dw_srce_id,\n\tcust.dw_updt_dte,\n\tcust.actv_dely_loc_id,\n\tcust.cust_cmnt_txt,\n\tcust.cust_origtn_cde,\n\tsales.fscl_wk_end_dte,\n\tsales.fscl_yr_num,\n\tsales.fscl_pd_num,\n\tsales.fscl_wk_in_pd_num,\n\tsales.dely_lne_qty,\n\tsales.raw_vol,\n\tsales.eght_oz_vol,\n\tsales.net_rev\nFROM sales\nJOIN {{ ref('stg_pbc_xref_unique') }} xref_uniq ON sales.msa_id = xref_uniq.msa_id\nJOIN {{ ref('stg_pbc_cust') }} cust ON cust.cust_id = xref_uniq.pbc_cust_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_sales_cust_wk_v"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_wk_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_sales_cust_wk_v.sql", "name": "btg_pbc_sales_cust_wk_v", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_v", "checksum": {"name": "sha256", "checksum": "785936f02b7af0a8cbad4ee62f07150baaa067176fe7bc67b4bd0d11bfcda22d"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales_cust_wk_agg_no_allied"], ["btg_msa_pbc_xref"], ["stg_pbc_xref_unique"], ["stg_pbc_cust"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales_cust_wk_agg_no_allied", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.stg_pbc_xref_unique", "model.sdna_project.stg_pbc_cust"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\nSELECT\n    cust.cust_id AS pbc_cust_id,\n    sls.inven_id,\n    cust.nme,\n    sls.fscl_yr_num,\n    sls.fscl_pd_num,\n    sls.fscl_wk_in_pd_num,\n    sls.fscl_wk_end_dte,\n    sls.dely_lne_qty,\n    sls.raw_vol,\n    sls.eght_oz_vol,\n    sls.net_rev,\n    cust.bulk_dely_flg,\n    cust.chain_flg,\n    cust.chain_owner_cde,\n    cust.chain_owner_desc,\n    cust.cur_stat_cde,\n    cust.cur_stat_desc,\n    cust.cur_stat_dte,\n    cust.cust_prod_flg,\n    cust.cust_serv_flg,\n    cust.cust_org_flg,\n    cust.cust_blg_flg,\n    cust.cust_misc_flg,\n    cust.cust_added_dte,\n    cust.cust_lglnme,\n    cust.lang_cde,\n    cust.lang_desc,\n    cust.loc_prod_id,\n    cust.loc_serv_id,\n    cust.natl_acct_flg,\n    cust.po_reqd_flg,\n    cust.pymt_term_beg_dte,\n    cust.pymt_term_cde,\n    cust.pymt_term_desc,\n    cust.sep_inv_flg,\n    cust.tax_exempt_num,\n    cust.tin_num,\n    cust.tin_type_cde,\n    cust.tin_type_desc,\n    cust.empl_tac_id,\n    cust.cust_equip_flg,\n    cust.udf_num,\n    cust.vrtx_geo_cde,\n    cust.bus_type_cde,\n    cust.bus_type_desc,\n    cust.tme_zone_cde,\n    cust.tme_zone_desc,\n    cust.cust_fobo_btlr_flg,\n    cust.cust_fobo_cust_flg,\n    cust.cust_fsv_flg,\n    cust.prc_zone_id,\n    cust.ethnic_cde,\n    cust.ethnic_desc,\n    cust.cust_ucs_cmctn_id,\n    cust.cust_dab_num,\n    cust.cust_dex_beg_dte,\n    cust.leg_chain_num,\n    cust.seas_clsd_beg_dte,\n    cust.seas_clsd_end_dte,\n    cust.cust_lgtud_num,\n    cust.cust_latud_num,\n    cust.bus_type_aggr_cde,\n    cust.bus_type_aggr_desc,\n    cust.outside_city_lmt_ind,\n    cust.cust_last_actvty_dte,\n    cust.grp1_type_desc,\n    cust.grp1_ownr_id,\n    cust.grp1_ownr_desc,\n    cust.grp1_lvl_1_id,\n    cust.grp1_lvl_1_desc,\n    cust.grp1_lvl_2_id,\n    cust.grp1_lvl_2_desc,\n    cust.grp2_type_desc,\n    cust.grp2_ownr_id,\n    cust.grp2_ownr_desc,\n    cust.grp2_lvl_1_ancstr_id,\n    cust.grp2_lvl_1_ancstr_nme,\n    cust.grp2_lvl_1_ancstr_prev_nme,\n    cust.grp2_lvl_1_id,\n    cust.grp2_lvl_1_desc,\n    cust.grp2_lvl_2_id,\n    cust.grp2_lvl_2_desc,\n    cust.grp3_type_desc,\n    cust.grp3_ownr_id,\n    cust.grp3_ownr_desc,\n    cust.grp3_lvl_1_id,\n    cust.grp3_lvl_1_desc,\n    cust.grp3_lvl_2_id,\n    cust.grp3_lvl_2_desc,\n    cust.loc_prod_nme,\n    cust.loc_prod_mu_id,\n    cust.loc_prod_mu_nme,\n    cust.loc_prod_bu_id,\n    cust.loc_prod_bu_nme,\n    cust.loc_prod_area_rpt_id,\n    cust.loc_prod_area_rpt_nme,\n    cust.loc_prod_mu_rpt_id,\n    cust.loc_prod_mu_rpt_nme,\n    cust.loc_prod_bu_rpt_id,\n    cust.loc_prod_bu_rpt_nme,\n    cust.loc_serv_nme,\n    cust.loc_serv_mu_id,\n    cust.loc_serv_mu_nme,\n    cust.loc_serv_bu_id,\n    cust.loc_serv_bu_nme,\n    cust.loc_serv_area_rpt_id,\n    cust.loc_serv_area_rpt_nme,\n    cust.loc_serv_mu_rpt_id,\n    cust.loc_serv_mu_rpt_nme,\n    cust.loc_serv_bu_rpt_id,\n    cust.loc_serv_bu_rpt_nme,\n    cust.bus_type_ctgy_cde,\n    cust.bus_type_ctgy_desc,\n    prod.inven_dply_grp_nme,\n    prod.brnd_id,\n    prod.pkg_id,\n    prod.inven_type_cde,\n    prod.inven_type_desc,\n    prod.inven_dply_seq_num,\n    prod.inven_dply_grp_seq,\n    prod.inven_dply_nme,\n    prod.purch_ctgy_id,\n    prod.ord_ref_num,\n    prod.inven_uom_cde,\n    prod.inven_uom_desc,\n    prod.create_dte,\n    prod.upc_cde,\n    prod.inven_sfty_stk_pct,\n    prod.prod_mix_cde,\n    prod.prod_mix_desc,\n    prod.prod_grp_cde,\n    prod.prod_grp_desc,\n    prod.prod_type_cde,\n    prod.prod_type_desc,\n    prod.avg_flr_cost_amt,\n    prod.std_wgt_qty,\n    prod.natl_acct_cde,\n    prod.natl_acct_desc,\n    prod.prod_8oz_conv_fctr,\n    prod.conc_mark_up_amt,\n    prod.sply_type_cde,\n    prod.sply_type_desc,\n    prod.serv_type_cde,\n    prod.serv_type_desc,\n    prod.brnd_nme,\n    prod.trdmrk_cde,\n    prod.trdmrk_desc,\n    prod.flvr_cde,\n    prod.flvr_desc,\n    prod.corp_cde,\n    prod.corp_desc,\n    prod.ctgy_type_cde,\n    prod.ctgy_type_desc,\n    prod.caff_flg,\n    prod.brnd_juice_pct,\n    prod.brnd_shrt_nme,\n    prod.brnd_swtnr_cde,\n    prod.brnd_swtnr_desc,\n    prod.pkg_nr_flag,\n    prod.clust_cde,\n    prod.clust_desc,\n    prod.clust_qty,\n    prod.config_qty,\n    prod.pkg_nme,\n    prod.pkg_shrt_nme,\n    prod.rpt_pkg_id,\n    prod.cont_cde,\n    prod.cont_desc,\n    prod.cont_uom_cde,\n    prod.cont_uom_desc,\n    prod.cont_uom_qty,\n    prod.cont_nr_flag,\n    prod.pkg_cont_mtrl_cde,\n    prod.pkg_cont_mtrl_desc,\n    prod.pkg_clstr_mtrl_cde,\n    prod.pkg_clstr_mtrl_desc,\n    prod.pkg_mtrl_cde,\n    prod.pkg_mtl_desc,\n    prod.pkg_cont_st_dp_flg,\n    prod.logo_id,\n    prod.logo_desc,\n    prod.hrzn_prod_grp_id,\n    prod.hrzn_prod_grp_desc,\n    prod.hrzn_pkg_grp_id,\n    prod.hrzn_pkg_grp_desc,\n    prod.hrzn_prod_ctgy_id,\n    prod.hrzn_prod_ctgy_desc,\n    prod.hrzn_brnd_ctgy_id,\n    prod.hrzn_brnd_ctgy_desc,\n    prod.hrzn_pkg_ctgy_id,\n    prod.hrzn_pkg_ctgy_desc,\n    prod.hrzn_pkg_aggr_id,\n    prod.hrzn_pkg_aggr_desc,\n    prod.hrzn_corp_aggr_id,\n    prod.hrzn_corp_aggr_desc,\n    prod.case_upc_cde,\n    prod.hrzn_pkg_cont_ctgy_id,\n    prod.hrzn_pkg_cont_ctgy_desc,\n    prod.hrzn_brnd_pkg_list_id,\n    prod.hrzn_brnd_pkg_list_desc,\n    prod.hrzn_brnd_pkg_summ_id,\n    prod.hrzn_brnd_pkg_summ_desc,\n    prod.hrzn_pkg_gm_id,\n    prod.hrzn_pkg_gm_desc,\n    prod.hrzn_pkg_summ_id,\n    prod.hrzn_pkg_summ_desc,\n    prod.hrzn_brnd_gm_id,\n    prod.hrzn_brnd_gm_desc,\n    prod.hrzn_brnd_trdmrk_id,\n    prod.hrzn_brnd_trdmrk_desc,\n    prod.hrzn_brnd_summ_id,\n    prod.hrzn_brnd_summ_desc,\n    prod.pbg_utilized_flg,\n    prod.case_conv_fctr,\n    prod.lcl_case_conv_fctr,\n    prod.prod_best_taste_wk_qty,\n    prod.delete_flg,\n    prod.mkt_ctgy_id,\n    prod.mkt_ctgy_desc,\n    prod.mkt_trdmrk_id,\n    prod.mkt_trdmrk_desc,\n    prod.pkg_cont_mtrl_grp_id,\n    prod.pkg_cont_mtrl_grp_desc,\n    prod.entrprs_initiv_01_id,\n    prod.entrprs_initiv_01_nme,\n    prod.entrprs_initiv_01_desc,\n    prod.entrprs_initiv_02_id,\n    prod.entrprs_initiv_02_nme,\n    prod.entrprs_initiv_02_desc,\n    prod.apxig_id,\n    prod.apxig_nme,\n    prod.comm_asm_grp_id,\n    prod.comm_asm_grp_nme,\n    prod.comm_cnvntl_drvr_grp_id,\n    prod.comm_cnvntl_drvr_grp_nme,\n    prod.comm_fsv_drvr_grp_id,\n    prod.comm_fsv_drvr_grp_nme,\n    prod.comm_psell_drvr_grp_id,\n    prod.comm_psell_drvr_grp_nme,\n    prod.pkg_wdth_unit_qty,\n    prod.pkg_hgt_unit_qty,\n    prod.pkg_lngth_unit_qty,\n    prod.pkg_dim_uofm_cde,\n    prod.pkg_frnt_dim_cde,\n    prod.pkg_stkblty_cde,\n    prod.prod_wgt_unit_qty,\n    prod.prod_wgt_uofm_cde,\n    prod.rfrg_reqd_flg,\n    prod.comm_pkg_grp1_id,\n    prod.comm_pkg_grp1_nme,\n    prod.comm_pkg_grp2_id,\n    prod.comm_pkg_grp2_nme,\n    current_timestamp() as last_updt_dt\nFROM {{ ref('btg_pbc_cust_v') }} cust\nJOIN {{ ref('pbc_sales') }} sls ON sls.cust_id = cust.cust_id\nJOIN {{ ref('pbc_prod') }} prod ON sls.inven_id = prod.inven_id\nWHERE prod.hrzn_corp_aggr_id <> 2", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pbc_sales_v"], "unique_id": "model.sdna_project.btg_pbc_sales_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pbc_sales_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pbc_sales_v.sql", "name": "btg_pbc_sales_v", "resource_type": "model", "alias": "btg_pbc_sales_v", "checksum": {"name": "sha256", "checksum": "c6a47fbee1422def8cfb89c1766b82c75e745a2f6cf148f3a682300feb42157e"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_cust_v"], ["pbc_sales"], ["pbc_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_cust_v", "model.sdna_project.pbc_sales", "model.sdna_project.pbc_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pep_calendar_v": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load btg_pep_calendar_v\n\nSELECT\n    caldr_dte,\n    caldr_day_in_wk_num,\n    caldr_day_in_wk_shrt_desc,\n    caldr_day_in_wk_long_desc,\n    caldr_day_in_mnth_num,\n    caldr_day_in_yr_num,\n    caldr_wk_start_dte,\n    caldr_wk_end_dte,\n    caldr_wk_in_yr_num,\n    caldr_wk_in_yr_shrt_desc,\n    caldr_wk_end_flg,\n    caldr_mnth_num,\n    caldr_mnth_shrt_desc,\n    caldr_mnth_long_desc,\n    caldr_mnth_start_dte,\n    caldr_mnth_end_dte,\n    caldr_mnth_end_flg,\n    caldr_qrtr_num,\n    caldr_qrtr_shrt_desc,\n    caldr_qrtr_long_desc,\n    caldr_qrtr_end_flg,\n    caldr_semi_annual_num,\n    caldr_semi_annual_desc,\n    caldr_yr_num,\n    caldr_yr_end_flg,\n    fscl_day_in_pd_num,\n    fscl_wk_start_dte,\n    fscl_wk_end_dte,\n    fscl_wk_in_pd_num,\n    fscl_wk_in_pd_desc,\n    fscl_wk_in_yr_num,\n    fscl_wk_in_yr_shrt_desc,\n    fscl_pd_num,\n    fscl_pd_shrt_desc,\n    fscl_pd_desc,\n    fscl_pd_end_flg,\n    fscl_pd_start_dte,\n    fscl_pd_end_dte,\n    fscl_yr_mnth_wk_num,\n    fscl_qrtr_num,\n    fscl_qrtr_shrt_desc,\n    fscl_qrtr_long_desc,\n    fscl_qrtr_end_flg,\n    fscl_day_in_trimester_num,\n    fscl_trimester_num,\n    fscl_trimester_shrt_desc,\n    fscl_trimester_desc,\n    fscl_trimester_end_flg,\n    fscl_yr_end_flg,\n    fscl_day_in_yr_num,\n    fscl_yr_num,\n    holiday_flg,\n    holiday_desc,\n    rpt_pd_day_num,\n    dw_srce_id,\n    dw_updt_dte,\n    last_updt_dt\nFROM {{ ref('btg_pep_calendar') }}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "btg_pep_calendar_v"], "unique_id": "model.sdna_project.btg_pep_calendar_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/btg_pep_calendar_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/btg_pep_calendar_v.sql", "name": "btg_pep_calendar_v", "resource_type": "model", "alias": "btg_pep_calendar_v", "checksum": {"name": "sha256", "checksum": "4b910bf4c5b3583ce60fc0741ff6d314f85229ee83ee0c6d0c9554821712a7e7"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pep_calendar"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pep_calendar"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fl_sales": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n{% set start_year = 2018 %}\n{% set current_year = modules.datetime.datetime.now().year %}\n\n-- load FL_SALES using the CY, PY & 2PY tables\n{% for year in range(start_year, current_year + 1) -%}\n{% set ref_table =  '{{ ref(' + \"'\" + 'fl_sales_' + year|string + \"'\" + ') }}' %}\n-- depends on: {{ ref_table }}\nSELECT * FROM fl_sales_{{ year }}\n{{ 'UNION ALL' if not loop.last }}\n{% endfor -%}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "fl_sales"], "unique_id": "model.sdna_project.fl_sales", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/fl_sales.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/fl_sales.sql", "name": "fl_sales", "resource_type": "model", "alias": "fl_sales", "checksum": {"name": "sha256", "checksum": "20e87b0e2d52f5c03ad24c269d5af8f734a90bccc1416185494d1148f9005b51"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fl_sales_cust_agg": {"raw_sql": "-- load fl_sales_cust_agg\nSELECT\n  CUST_NBR,\n  SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_YTD, SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY, SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_2PY, SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_YTD, SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_L13P , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_YTD , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 1\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY , SUM(\n  CASE\n    WHEN\n      CAST(SALE_TKT_YR AS INT) = dt.curr_btg_load_year - 2\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_2PY , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_2PY_YTD , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_L13P , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_L52wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_L52wk, \t--New code added for 4,12 and 26 weeks\n  SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_QTY_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS TKT_SALE_WT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_QTY_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      GROSS_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS GROSS_TKT_SALE_WT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_QTY_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      NET_TKT_SALE_WT\n    ELSE\n      NULL\n  END\n) AS NET_TKT_SALE_WT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_ALLOW_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_ALLOW_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      AM_PROMO_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS AM_PROMO_SALE_QTY_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_AMT\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_AMT_PY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_L4wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_L12wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_CY_L26wk , SUM(\n  CASE\n    WHEN\n      (\n        SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n        AND SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n      )\n    THEN\n      FULL_REVNU_SALE_QTY\n    ELSE\n      NULL\n  END\n) AS FULL_REVNU_SALE_QTY_PY_L26wk,\n  CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('fl_sales') }}, {{ ref('btg_load_stat') }} dt\nGROUP BY CUST_NBR", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "fl_sales_cust_agg"], "unique_id": "model.sdna_project.fl_sales_cust_agg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/fl_sales_cust_agg.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/fl_sales_cust_agg.sql", "name": "fl_sales_cust_agg", "resource_type": "model", "alias": "fl_sales_cust_agg", "checksum": {"name": "sha256", "checksum": "f9edc2d6967b93e31a33fbab3810e95c7497753f4179f887ac9095f6dff373ee"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_sales"], ["btg_load_stat"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_sales", "model.sdna_project.btg_load_stat"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fl_sales_cust_prod_agg": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load fl_sales_cust_prod_agg\n\n-- {{ ref('fl_sales') }}\n-- {{ ref('btg_load_stat') }}\n\nSELECT\n    sls.CUST_NBR,\n\tsls.PROD_SLBL,\n\tsls.PROD_UPC,\n\t-----------Metric TKT_SALE_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_L52wk,\n\t-----------Metric TKT_SALE_QTY-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_L52wk,\n\t-----------Metric TKT_SALE_WT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_L52wk,\n    -----------Metric GROSS_TKT_SALE_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_L52wk,\n\t-----------Metric GROSS_TKT_SALE_QTY-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_L52wk,\n\t-----------Metric GROSS_TKT_SALE_WT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_L52wk,\n    -----------Metric NET_TKT_SALE_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_L52wk,\n    -----------Metric NET_TKT_SALE_QTY-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_L52wk,\n    -----------Metric NET_TKT_SALE_WT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_L52wk,\n\t-----------Metric AM_PROMO_ALLOW_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_L52wk,\n    -----------Metric AM_PROMO_SALE_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_L52wk,\n    -----------Metric AM_PROMO_SALE_QTY-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_L52wk,\n\t-----------Metric FULL_REVNU_SALE_AMT-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_L52wk,\n    -----------Metric FULL_REVNU_SALE_QTY-----------\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 1 THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN cast(sls.SALE_TKT_YR AS int) = dt.curr_btg_load_year - 2 THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_AMT ELSE NULL END\n\t) AS TKT_SALE_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_QTY ELSE NULL END\n\t) AS TKT_SALE_QTY_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.TKT_SALE_WT ELSE NULL END\n\t) AS TKT_SALE_WT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_AMT ELSE NULL END\n\t) AS GROSS_TKT_SALE_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_QTY ELSE NULL END\n\t) AS GROSS_TKT_SALE_QTY_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.GROSS_TKT_SALE_WT ELSE NULL END\n\t) AS GROSS_TKT_SALE_WT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_AMT ELSE NULL END\n\t) AS NET_TKT_SALE_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_QTY ELSE NULL END\n\t) AS NET_TKT_SALE_QTY_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.NET_TKT_SALE_WT ELSE NULL END\n\t) AS NET_TKT_SALE_WT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_ALLOW_AMT ELSE NULL END\n\t) AS AM_PROMO_ALLOW_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_AMT ELSE NULL END\n\t) AS AM_PROMO_SALE_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.AM_PROMO_SALE_QTY ELSE NULL END\n\t) AS AM_PROMO_SALE_QTY_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_AMT ELSE NULL END\n\t) AS FULL_REVNU_SALE_AMT_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tsls.SALE_TKT_WK_END_DT >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND sls.SALE_TKT_WK_END_DT <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN sls.FULL_REVNU_SALE_QTY ELSE NULL END\n\t) AS FULL_REVNU_SALE_QTY_PY_L26wk,\n\tCURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM\n\t{{ ref('fl_sales') }} AS sls\nCROSS JOIN\n\t{{ ref('btg_load_stat') }} AS dt\nGROUP BY\n\tsls.CUST_NBR,\n\tsls.PROD_SLBL,\n\tsls.PROD_UPC", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "fl_sales_cust_prod_agg"], "unique_id": "model.sdna_project.fl_sales_cust_prod_agg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/fl_sales_cust_prod_agg.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/fl_sales_cust_prod_agg.sql", "name": "fl_sales_cust_prod_agg", "resource_type": "model", "alias": "fl_sales_cust_prod_agg", "checksum": {"name": "sha256", "checksum": "e3ee8a622c20a3d579714738ff043742a3af16c5d3b2f88ba19a97e4b5c51db6"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_sales"], ["btg_load_stat"], ["fl_sales"], ["btg_load_stat"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_sales", "model.sdna_project.btg_load_stat", "model.sdna_project.fl_sales", "model.sdna_project.btg_load_stat"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.fl_sales_cust_wk_agg": {"raw_sql": "-- load fl_sales_cust_wk_agg\nSELECT\n    CUST_NBR,\n    SALE_TKT_YR,\n    SALE_TKT_PD,\n    SALE_TKT_WK,\n    SALE_TKT_WK_END_DT,\n    SUM(TKT_SALE_AMT) as TKT_SALE_AMT,\n    SUM(TKT_SALE_QTY) TKT_SALE_QTY,\n    SUM(TKT_SALE_WT) TKT_SALE_WT,\n    SUM(GROSS_TKT_SALE_AMT) GROSS_TKT_SALE_AMT,\n    SUM(GROSS_TKT_SALE_QTY) GROSS_TKT_SALE_QTY,\n    SUM(GROSS_TKT_SALE_WT) GROSS_TKT_SALE_WT,\n    SUM(NET_TKT_SALE_AMT) NET_TKT_SALE_AMT,\n    SUM(NET_TKT_SALE_QTY) NET_TKT_SALE_QTY,\n    SUM(NET_TKT_SALE_WT) NET_TKT_SALE_WT,\n    SUM(AM_PROMO_ALLOW_AMT) AM_PROMO_ALLOW_AMT,\n    SUM(AM_PROMO_SALE_AMT) AM_PROMO_SALE_AMT,\n    SUM(AM_PROMO_SALE_QTY) AM_PROMO_SALE_QTY,\n    SUM(FULL_REVNU_SALE_AMT) FULL_REVNU_SALE_AMT,\n    SUM(FULL_REVNU_SALE_QTY) FULL_REVNU_SALE_QTY,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('fl_sales') }}\nGROUP BY\n    CUST_NBR,\n    SALE_TKT_YR,\n    SALE_TKT_PD,\n    SALE_TKT_WK,\n    SALE_TKT_WK_END_DT", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "fl_sales_cust_wk_agg"], "unique_id": "model.sdna_project.fl_sales_cust_wk_agg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/fl_sales_cust_wk_agg.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/fl_sales_cust_wk_agg.sql", "name": "fl_sales_cust_wk_agg", "resource_type": "model", "alias": "fl_sales_cust_wk_agg", "checksum": {"name": "sha256", "checksum": "4e067ab4b1295f2101f51a145407f28739d0fa7dd3ed04a964bb725235d85882"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_sales"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_sales"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n{% set start_year = 2018 %}\n{% set current_year = modules.datetime.datetime.now().year %}\n\n-- load PBC_SALES using the CY, PY & 2PY tables\n{% for year in range(start_year, current_year + 1) -%}\n{% set ref_table =  '{{ ref(' + \"'\" + 'pbc_sales_' + year|string + \"'\" + ') }}' %}\n-- depends on: {{ ref_table }}\nSELECT * FROM pbc_sales_{{ year }}\n{{ 'UNION ALL' if not loop.last }}\n{% endfor -%}", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales"], "unique_id": "model.sdna_project.pbc_sales", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales.sql", "name": "pbc_sales", "resource_type": "model", "alias": "pbc_sales", "checksum": {"name": "sha256", "checksum": "d2c7619e07aaceebb7a7fdebae3305625efdee3ec8ea6022b2d0e73521e75ead"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales_agg_cust": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load pbc_sales_cust_agg\n\n-- {{ ref('pbc_sales') }}\n-- {{ ref('btg_load_stat') }}\n\nSELECT\n    CUST_ID,\n-- DELY_LNE_QTY\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_YTD,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_2PY,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_2PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_L13P,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_L13P,\n-- RAW_VOL\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_YTD,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_2PY,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_2PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_L13P,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_L13P,\n-- EGHT_OZ_VOL\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_YTD,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_2PY,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_2PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_L13P,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_L13P,\n-- NET_REV\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_YTD,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY,\n    SUM(\n    CASE\n    \tWHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_2PY,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_2PY_YTD,\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_L13P,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_L13P,\n    --Additional metrics for L52Wk\n--    DELY_LNE_QTY\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_L52wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_L52wk,\n-- RAW_VOL\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_L52wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_L52wk,\n-- EGHT_OZ_VOL\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_L52wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_L52wk,\n-- NET_REV\n\tSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_L52wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_L52wk,\n\n-- added logic for 4,12 and 26 week level columns\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_L4wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_L4wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_L12wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_L12wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_CY_L26wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN DELY_LNE_QTY\n    \t\tELSE NULL\n    END) AS DELY_LNE_QTY_PY_L26wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_L4wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_L4wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_L12wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_L12wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_CY_L26wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN RAW_VOL\n    \t\tELSE NULL\n    END) AS RAW_VOL_PY_L26wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_L4wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_L4wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_L12wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_L12wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_CY_L26wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN EGHT_OZ_VOL\n    \t\tELSE NULL\n    END) AS EGHT_OZ_VOL_PY_L26wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_L4wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_L4wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_L12wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_L12wk,\nSUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_CY_L26wk,\n  SUM(\n    CASE\n\t\tWHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t\t)\n\t\tTHEN NET_REV\n    \t\tELSE NULL\n    END) AS NET_REV_PY_L26wk,\n-- added logic end for 4, 12 and 26 week level columns\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('pbc_sales') }} sls,\n     {{ ref('btg_load_stat') }} dt\nGROUP BY CUST_ID", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales_agg_cust"], "unique_id": "model.sdna_project.pbc_sales_agg_cust", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales_agg_cust.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales_agg_cust.sql", "name": "pbc_sales_agg_cust", "resource_type": "model", "alias": "pbc_sales_agg_cust", "checksum": {"name": "sha256", "checksum": "111da9d5f39cba476569b6a7ad78fadee6bd6b527afa3175bd985b03cd44d811"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales"], ["btg_load_stat"], ["pbc_sales"], ["btg_load_stat"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales", "model.sdna_project.btg_load_stat", "model.sdna_project.pbc_sales", "model.sdna_project.btg_load_stat"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales_cust_agg_no_allied": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load pbc_sales_cust_agg_no_allied\n\nSELECT\n    CUST_ID,\n\t-- DELY_LNE_QTY\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_YTD,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_L13P,\n\t-- RAW_VOL\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_YTD,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_L13P,\n\t-- EGHT_OZ_VOL\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_YTD,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_L13P,\n\t-- NET_REV\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_YTD,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY,\n\tSUM(\n\t\tCASE WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN NET_REV ELSE NULL END\n\t) AS NET_REV_2PY,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_2PY_YTD,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_L13P,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_L13P,\n\t--Additional metrics for L52Wk\n\t--    DELY_LNE_QTY\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_L52wk,\n\t-- RAW_VOL\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_L52wk,\n\t-- EGHT_OZ_VOL\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_L52wk,\n\t-- NET_REV\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_L52wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_L52wk,\n\t-- added logic for 4,12 AND 26 week level columns\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN DELY_LNE_QTY ELSE NULL END\n\t) AS DELY_LNE_QTY_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN RAW_VOL ELSE NULL END\n\t) AS RAW_VOL_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN EGHT_OZ_VOL ELSE NULL END\n\t) AS EGHT_OZ_VOL_PY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_L4wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_L12wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_CY_L26wk,\n\tSUM(\n\t\tCASE WHEN (\n\t\t\tFSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n\t\t\tAND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n\t\t) THEN NET_REV ELSE NULL END\n\t) AS NET_REV_PY_L26wk,\n\tCURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('pbc_sales') }} AS s,\n\t {{ ref('btg_load_stat') }} AS dt,\n\t {{ ref('pbc_prod') }} AS p\nWHERE s.inven_id = p.inven_id AND p.hrzn_corp_aggr_id <> 2\nGROUP BY CUST_ID", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales_cust_agg_no_allied"], "unique_id": "model.sdna_project.pbc_sales_cust_agg_no_allied", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales_cust_agg_no_allied.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales_cust_agg_no_allied.sql", "name": "pbc_sales_cust_agg_no_allied", "resource_type": "model", "alias": "pbc_sales_cust_agg_no_allied", "checksum": {"name": "sha256", "checksum": "9a242e08d0eecbbaca0271c6ad047f8522b9272b3464390b4e89dce595b99b16"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales"], ["btg_load_stat"], ["pbc_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales", "model.sdna_project.btg_load_stat", "model.sdna_project.pbc_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales_cust_prod_agg": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load pbc_sales_cust_prod_agg\n\n-- {{ ref('pbc_sales') }}\n-- {{ ref('btg_load_stat') }}\n\nSELECT\n    CUST_ID,\n    INVEN_ID,\n    -- DELY_LNE_QTY\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_YTD,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_2PY,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n                )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_2PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_L13P,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_L13P,\n    -- RAW_VOL\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_YTD,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_2PY,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_2PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_L13P,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_L13P,\n    -- EGHT_OZ_VOL\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_YTD,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_2PY,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_2PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_L13P,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_L13P,\n    -- NET_REV\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_YTD,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 1 THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY,\n    SUM(\n        CASE\n            WHEN FSCL_YR_NUM = dt.curr_btg_load_year - 2 THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_2PY,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_YTD_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY2_YTD_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY2_YTD_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_2PY_YTD,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L13P_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_L13P,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L13P_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L13P_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_L13P,\n        -- Additional metrics for L52Wk\n    --    DELY_LNE_QTY\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_L52wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_L52wk,\n    -- RAW_VOL\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_L52wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_L52wk,\n    -- EGHT_OZ_VOL\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_L52wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_L52wk,\n    -- NET_REV\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L52wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_L52wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L52wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L52wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_L52wk,\n    -- added logic for 4,12 and 26 week level columns\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_CY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n            )\n            THEN DELY_LNE_QTY\n                ELSE NULL\n        END) AS DELY_LNE_QTY_PY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_CY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n            )\n            THEN RAW_VOL\n                ELSE NULL\n        END) AS RAW_VOL_PY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_CY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n            )\n            THEN EGHT_OZ_VOL\n                ELSE NULL\n        END) AS EGHT_OZ_VOL_PY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L4wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L4wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L4wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_L4wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L12wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L12wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L12wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_L12wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.CY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.CY_L26wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_CY_L26wk,\n    SUM(\n        CASE\n            WHEN (FSCL_WK_END_DTE >= dt.PY_L26wk_FRM_WK_DT\n                AND FSCL_WK_END_DTE <= dt.PY_L26wk_TO_WK_DT\n            )\n            THEN NET_REV\n                ELSE NULL\n        END) AS NET_REV_PY_L26wk,\n-- added logic end for 4, 12 and 26 week level columns\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM\n     {{ ref('pbc_sales') }} sls,\n     {{ ref('btg_load_stat') }} dt\nGROUP BY  CUST_ID, INVEN_ID", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales_cust_prod_agg"], "unique_id": "model.sdna_project.pbc_sales_cust_prod_agg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales_cust_prod_agg.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales_cust_prod_agg.sql", "name": "pbc_sales_cust_prod_agg", "resource_type": "model", "alias": "pbc_sales_cust_prod_agg", "checksum": {"name": "sha256", "checksum": "4d300de0dfb43d37207656136bcecdfd7de806ef5663a542bf395b748aa968f3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales"], ["btg_load_stat"], ["pbc_sales"], ["btg_load_stat"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales", "model.sdna_project.btg_load_stat", "model.sdna_project.pbc_sales", "model.sdna_project.btg_load_stat"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales_cust_wk_agg": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\n--Load pbc_sales_cust_wk_agg\n\nSELECT\n    CUST_ID,\n\tFSCL_YR_NUM,\n\tFSCL_PD_NUM,\n\tFSCL_WK_IN_PD_NUM,\n\tFSCL_WK_END_DTE,\n\tSUM(DELY_LNE_QTY) AS DELY_LNE_QTY,\n\tSUM(RAW_VOL) AS RAW_VOL,\n\tSUM(EGHT_OZ_VOL) AS EGHT_OZ_VOL,\n\tSUM(NET_REV) AS NET_REV,\n\tCURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('pbc_sales') }}\nGROUP BY\n\tCUST_ID,\n\tFSCL_YR_NUM,\n\tFSCL_PD_NUM,\n\tFSCL_WK_IN_PD_NUM,\n\tFSCL_WK_END_DTE", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales_cust_wk_agg"], "unique_id": "model.sdna_project.pbc_sales_cust_wk_agg", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales_cust_wk_agg.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales_cust_wk_agg.sql", "name": "pbc_sales_cust_wk_agg", "resource_type": "model", "alias": "pbc_sales_cust_wk_agg", "checksum": {"name": "sha256", "checksum": "19cb854d1cd9a5506d2dba8edb7a67cdd32b6fb0cf85341d552d39075254ccb5"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.pbc_sales_cust_wk_agg_no_allied": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n-- load pbc_sales_cust_wk_agg_no_allied\n\n--  {{ ref('pbc_sales') }}\n--  {{ ref('pbc_prod') }}\n\nSELECT\n    CUST_ID,\n    FSCL_YR_NUM,\n    FSCL_PD_NUM,\n    FSCL_WK_IN_PD_NUM,\n    FSCL_WK_END_DTE,\n    SUM(DELY_LNE_QTY) DELY_LNE_QTY,\n    SUM(RAW_VOL) RAW_VOL,\n    SUM(EGHT_OZ_VOL) EGHT_OZ_VOL,\n    SUM(NET_REV) NET_REV,\n    CURRENT_TIMESTAMP() AS LAST_UPDT_DT\nFROM {{ ref('pbc_sales') }} s\nJOIN {{ ref('pbc_prod') }} p on s.inven_id=p.inven_id\nWHERE p.hrzn_corp_aggr_id <> 2\nGROUP BY\n    CUST_ID,\n    FSCL_YR_NUM,\n    FSCL_PD_NUM,\n    FSCL_WK_IN_PD_NUM,\n    FSCL_WK_END_DTE", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "btg", "pbc_sales_cust_wk_agg_no_allied"], "unique_id": "model.sdna_project.pbc_sales_cust_wk_agg_no_allied", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/btg/pbc_sales_cust_wk_agg_no_allied.sql", "original_file_path": "models/sdna_us/store_sales/transformations/btg/pbc_sales_cust_wk_agg_no_allied.sql", "name": "pbc_sales_cust_wk_agg_no_allied", "resource_type": "model", "alias": "pbc_sales_cust_wk_agg_no_allied", "checksum": {"name": "sha256", "checksum": "044d7825a1a01be5ef81c21628ebe39bdc25472f7615cd517c892208c38a75f5"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_sales"], ["pbc_prod"], ["pbc_sales"], ["pbc_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_sales", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_sales", "model.sdna_project.pbc_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_prod_upc_sale_seq": {"raw_sql": "-- Load btg_fl_prod_upc_sale_seq\n\n-- {{ ref('btg_fl_prod_v') }}\n-- {{ ref('btg_fl_sales_cust_wk_prod_v') }}\n\nWITH prod AS\n(\n    SELECT\n\t\t*,\n\t\tCASE WHEN BUS_UNIT_CODE = '099' THEN BUS_UNIT_CODE ELSE 'OT' END AS BUS_UNIT_CODE_NEW,\n\t\tCASE WHEN BUS_UNIT_CODE = '099' THEN BUS_UNIT_DESCP ELSE 'OT' END AS BUS_UNIT_DESCP_NEW,\n\t\tCASE WHEN BUS_UNIT_CODE = '099' THEN 'SSF' --//SINGLE SERVE FLEX\n\t\tWHEN (\n\t\t\tBUS_UNIT_CODE IN (\n\t\t\t\t'007', '008', '043', '060', '072', '114'\n\t\t\t)\n\t\t) THEN 'CF' WHEN BUS_UNIT_CODE = '010' THEN 'DIP' WHEN BUS_UNIT_CODE = '085' THEN 'MULTIPAK' ELSE 'TAKEHOME' END AS MAJOR_CAT\n\tFROM\n        {{ ref('btg_fl_prod_v') }}\n),\nprod2 AS \n(\n\tSELECT\n\t\tprod.*,\n\t\tCASE WHEN (prod.MAJOR_CAT = 'SSF') THEN (\n\t\t\tCASE prod.SIZE_DESCP WHEN 'XXVL STRIP' THEN 'X-XVL' WHEN 'XXVL' THEN 'X-XVL' WHEN 'SGLWKEND     PPW' THEN 'PPW' WHEN 'SGLWKEND PPW' THEN 'PPW' ELSE prod.SIZE_DESCP END\n\t\t) ELSE prod.MAJOR_CAT END AS MAJOR_CAT_SIZE\n\tFROM\n\t\tprod\n),\nsales AS \n(\n\tSELECT\n\t\tprod2.UPC_10,\n\t\tprod2.categ_code,\n\t\tprod2.categ_descp,\n\t\tprod2.bus_unit_code,\n\t\tprod2.bus_unit_descp,\n\t\tprod2.brand_code,\n\t\tprod2.brand_descp,\n\t\tprod2.prod_tkt_descp_txt,\n\t\tprod2.bdc_descp,\n\t\tprod2.sale_class_code,\n\t\tprod2.sale_class_descp,\n\t\tprod2.size_code,\n\t\tprod2.size_descp,\n\t\tprod2.flvr_code,\n\t\tprod2.flvr_descp,\n\t\tprod2.BUS_UNIT_CODE_NEW,\n\t\tprod2.BUS_UNIT_DESCP_NEW,\n\t\tprod2.MAJOR_CAT,\n\t\tprod2.MAJOR_CAT_SIZE,\n\t\tSUM(sl.net_tkt_sale_amt) AS net_tkt_sale_amt_sum_2018_2019_2020\n\tFROM\n\t\tprod2\n\t\tLEFT JOIN {{ ref('btg_fl_sales_cust_wk_prod_v') }} AS sl\n            ON (prod2.PROD_UPC = sl.prod_upc) AND (prod2.PROD_SLBL = sl.prod_slbl)\n\tWHERE\n\t\tprod2.UPC_10 <> '0000000000'\n\tGROUP BY\n\t\tprod2.UPC_10,\n\t\tprod2.categ_code,\n\t\tprod2.categ_descp,\n\t\tprod2.bus_unit_code,\n\t\tprod2.bus_unit_descp,\n\t\tprod2.brand_code,\n\t\tprod2.brand_descp,\n\t\tprod2.prod_tkt_descp_txt,\n\t\tprod2.bdc_descp,\n\t\tprod2.sale_class_code,\n\t\tprod2.sale_class_descp,\n\t\tprod2.size_code,\n\t\tprod2.size_descp,\n\t\tprod2.flvr_code,\n\t\tprod2.flvr_descp,\n\t\tprod2.BUS_UNIT_CODE_NEW,\n\t\tprod2.BUS_UNIT_DESCP_NEW,\n\t\tprod2.MAJOR_CAT,\n\t\tprod2.MAJOR_CAT_SIZE\n\tHAVING\n\t\tSUM(sl.net_tkt_sale_amt) <> 0\n)\nSELECT\n\t*,\n\tROW_NUMBER() OVER (\n\t\tPARTITION BY sales.UPC_10\n\t\tORDER BY\n\t\t\tsales.net_tkt_sale_amt_sum_2018_2019_2020 DESC\n\t) AS sale_seq,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\tsales", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_fl_prod_upc_sale_seq"], "unique_id": "model.sdna_project.btg_fl_prod_upc_sale_seq", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_fl_prod_upc_sale_seq.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_fl_prod_upc_sale_seq.sql", "name": "btg_fl_prod_upc_sale_seq", "resource_type": "model", "alias": "btg_fl_prod_upc_sale_seq", "checksum": {"name": "sha256", "checksum": "8f1b7be455fe219ba3066b2f50018646692e5a8a3ca164cde0752660e6bf547c"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_prod_v"], ["btg_fl_sales_cust_wk_prod_v"], ["btg_fl_prod_v"], ["btg_fl_sales_cust_wk_prod_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_prod_v_extend": {"raw_sql": "with prod as (\n    select *\n    ,case when bus_unit_code='099' then bus_unit_code else 'ot' end as bus_unit_code_new\n    ,case when bus_unit_code='099' then bus_unit_descp else 'ot' end as bus_unit_descp_new\n    ,case\n          when bus_unit_code='099'then 'ssf' --//single serve flex\n          when  (bus_unit_code in ('007','008','043','060','072','114')) then 'cf'\n          when  bus_unit_code='010' then 'dip'\n          when  bus_unit_code='085' then 'multipak'\n          else 'takehome'\n     end as major_cat\n    from {{ ref('btg_fl_prod_v') }}\n)\nselect\n    sls.msa_id\n    ,sls.fl_cust_id\n    ,sls.cust_cnt\n    ,sls.prod_upc\n    ,sls.prod_slbl\n    ,prod.upc_mfg_id\n    --cust attributes\n    ,trim(cust.tdlinx_id) as tdlinx_id\n    ,upper(cust.cust_nm) as cust_name\n    ,upper(cust.phy_loc_str_addr1) as address\n    ,upper(cust.phy_loc_city) as city\n    ,upper(cust.phy_loc_st_prov) as state\n    ,cust.phy_loc_post_code_zip5 as zip5\n    ,trim(cust.phy_loc_post_code) as zip9\n    ,upper(cust.phy_loc_cnty_sburb) as county\n    ,cust.lat_code as latitude\n    ,cust.lon_code as longitude\n    ,upper(cust.geo_lvl1_node_nbr) as division_id\n    ,upper(cust.geo_lvl1_node_nm) as division\n    ,upper(cust.geo_lvl2_node_nbr) as region_id\n    ,upper(cust.geo_lvl2_node_nm) as region\n    ,upper(cust.geo_lvl3_node_nbr) as zone_id\n    ,upper(cust.geo_lvl3_node_nm) as zone\n    ,upper(cust.geo_lvl4_node_nbr) as district_id\n    ,upper(cust.geo_lvl4_node_nm) as district\n    ,cust.rt_nbr\n    ,upper(cust.trade_chanl_code) as trade_chanl_code\n    ,upper(cust.trade_chanl_descp) as trade_chanl_descp\n    --,upper(pbc.btg_format) as format\n    ,null as format\n    ,upper(coalesce(cust.chain_lvl1_node_nm,pbc.grp1_lvl_1_desc)) as retailer\n    --new additions post first prod run sept 2020\n    ,upper(trim(zip.pbc_fbu_flg)) as  pbc_fbu_flg\n    ,upper(cust.chain_lvl1_node_nbr) as chain_lvl1_node_nbr\n    ,upper(cust.chain_lvl1_node_nm) as  chain_lvl1_node_nm\n    ,upper(cust.chain_lvl2_node_nbr) as chain_lvl2_node_nbr\n    ,upper(cust.chain_lvl2_node_nm) as  chain_lvl2_node_nm\n    ,upper(cust.chain_lvl3_node_nbr) as chain_lvl3_node_nbr\n    ,upper(cust.chain_lvl3_node_nm) as chain_lvl3_node_nm\n    ,upper(cust.chain_lvl4_node_nbr) as chain_lvl4_node_nbr\n    ,upper(cust.chain_lvl4_node_nm) as chain_lvl4_node_nm\n    ,upper(prod.sale_class_code) as sale_class_code\n    ,upper(prod.sale_class_descp) as sale_class_descp\n    ,upper(prod.size_code) as size_code\n    ,upper(prod.size_descp) as size_descp\n    --end:new additions post first prod run sept 2020\n    --prod attributes\n    ,upper(prod.categ_code) as categ_code\n    ,upper(prod.categ_descp) as categ_descp\n    -- ,upper(prod.bus_unit_code) as trdmark_cde\n    -- ,upper(prod.bus_unit_descp) as trdmark_desc\n    ,upper(prod.bus_unit_code) as bus_unit_code\n    ,upper(prod.bus_unit_descp) as bus_unit_descp\n    ,upper(trim(prod.brand_code)) as brand_code\n    ,upper(prod.brand_descp) as brand_descp\n    ,upper(prod.flvr_code) as flvr_code\n    ,upper(prod.flvr_descp) as flvr_descp\n    ,upper(prod.prod_tkt_descp_txt) as prod_tkt_descp_txt\n    ,concat(prod.prod_upc,prod.prod_slbl) as upc_cde\n    ,prod.upc_10 as upc_10\n    ,upper(trim(prod.bdc_descp)) as bdc_descp\n    ,prod.gtin as gtin\n    -- ,upper(prod.bus_unit_code_new) as bus_unit_code_new\n    -- ,upper(prod.bus_unit_descp_new) as bus_unit_descp_new\n    ,upper(prod.major_cat) as major_cat\n    -- ,case\n    --       when (prod.major_cat='ssf') then\n    --         (case prod.size_descp\n    --                 when 'xxvl strip' then 'x-xvl'\n    --                 when 'xxvl' then 'x-xvl'\n    --                 when 'sglwkend     ppw'  then 'ppw'\n    --                 when 'sglwkend ppw' then 'ppw'\n    --         else prod.size_descp\n    --         end)\n    --       else prod.major_cat\n    --  end as major_cat_size\n    ,sls.tkt_sale_amt_cy_ytd\n    ,sls.tkt_sale_amt_py\n    ,sls.tkt_sale_amt_2py\n    ,sls.tkt_sale_amt_py_ytd\n    ,sls.tkt_sale_amt_2py_ytd\n    ,sls.tkt_sale_amt_cy_l13p\n    ,sls.tkt_sale_amt_py_l13p\n    ,sls.tkt_sale_amt_cy_l4wk\n    ,sls.tkt_sale_amt_py_l4wk\n    ,sls.tkt_sale_amt_cy_l12wk\n    ,sls.tkt_sale_amt_py_l12wk\n    ,sls.tkt_sale_amt_cy_l26wk\n    ,sls.tkt_sale_amt_py_l26wk\n    ,sls.tkt_sale_amt_cy_l52wk\n    ,sls.tkt_sale_amt_py_l52wk\n    ,sls.tkt_sale_qty_cy_ytd\n    ,sls.tkt_sale_qty_py\n    ,sls.tkt_sale_qty_2py\n    ,sls.tkt_sale_qty_py_ytd\n    ,sls.tkt_sale_qty_2py_ytd\n    ,sls.tkt_sale_qty_cy_l13p\n    ,sls.tkt_sale_qty_py_l13p\n    ,sls.tkt_sale_qty_cy_l4wk\n    ,sls.tkt_sale_qty_py_l4wk\n    ,sls.tkt_sale_qty_cy_l12wk\n    ,sls.tkt_sale_qty_py_l12wk\n    ,sls.tkt_sale_qty_cy_l26wk\n    ,sls.tkt_sale_qty_py_l26wk\n    ,sls.tkt_sale_qty_cy_l52wk\n    ,sls.tkt_sale_qty_py_l52wk\n    ,sls.tkt_sale_wt_cy_ytd\n    ,sls.tkt_sale_wt_py\n    ,sls.tkt_sale_wt_2py\n    ,sls.tkt_sale_wt_py_ytd\n    ,sls.tkt_sale_wt_2py_ytd\n    ,sls.tkt_sale_wt_cy_l13p\n    ,sls.tkt_sale_wt_py_l13p\n    ,sls.tkt_sale_wt_cy_l4wk\n    ,sls.tkt_sale_wt_py_l4wk\n    ,sls.tkt_sale_wt_cy_l12wk\n    ,sls.tkt_sale_wt_py_l12wk\n    ,sls.tkt_sale_wt_cy_l26wk\n    ,sls.tkt_sale_wt_py_l26wk\n    ,sls.tkt_sale_wt_cy_l52wk\n    ,sls.tkt_sale_wt_py_l52wk\n    ,sls.gross_tkt_sale_amt_cy_ytd\n    ,sls.gross_tkt_sale_amt_py\n    ,sls.gross_tkt_sale_amt_2py\n    ,sls.gross_tkt_sale_amt_py_ytd\n    ,sls.gross_tkt_sale_amt_2py_ytd\n    ,sls.gross_tkt_sale_amt_cy_l13p\n    ,sls.gross_tkt_sale_amt_py_l13p\n    ,sls.gross_tkt_sale_amt_cy_l4wk\n    ,sls.gross_tkt_sale_amt_py_l4wk\n    ,sls.gross_tkt_sale_amt_cy_l12wk\n    ,sls.gross_tkt_sale_amt_py_l12wk\n    ,sls.gross_tkt_sale_amt_cy_l26wk\n    ,sls.gross_tkt_sale_amt_py_l26wk\n    ,sls.gross_tkt_sale_amt_cy_l52wk\n    ,sls.gross_tkt_sale_amt_py_l52wk\n    ,sls.gross_tkt_sale_qty_cy_ytd\n    ,sls.gross_tkt_sale_qty_py\n    ,sls.gross_tkt_sale_qty_2py\n    ,sls.gross_tkt_sale_qty_py_ytd\n    ,sls.gross_tkt_sale_qty_2py_ytd\n    ,sls.gross_tkt_sale_qty_cy_l13p\n    ,sls.gross_tkt_sale_qty_py_l13p\n    ,sls.gross_tkt_sale_qty_cy_l4wk\n    ,sls.gross_tkt_sale_qty_py_l4wk\n    ,sls.gross_tkt_sale_qty_cy_l12wk\n    ,sls.gross_tkt_sale_qty_py_l12wk\n    ,sls.gross_tkt_sale_qty_cy_l26wk\n    ,sls.gross_tkt_sale_qty_py_l26wk\n    ,sls.gross_tkt_sale_qty_cy_l52wk\n    ,sls.gross_tkt_sale_qty_py_l52wk\n    ,sls.gross_tkt_sale_wt_cy_ytd\n    ,sls.gross_tkt_sale_wt_py\n    ,sls.gross_tkt_sale_wt_2py\n    ,sls.gross_tkt_sale_wt_py_ytd\n    ,sls.gross_tkt_sale_wt_2py_ytd\n    ,sls.gross_tkt_sale_wt_cy_l13p\n    ,sls.gross_tkt_sale_wt_py_l13p\n    ,sls.gross_tkt_sale_wt_cy_l4wk\n    ,sls.gross_tkt_sale_wt_py_l4wk\n    ,sls.gross_tkt_sale_wt_cy_l12wk\n    ,sls.gross_tkt_sale_wt_py_l12wk\n    ,sls.gross_tkt_sale_wt_cy_l26wk\n    ,sls.gross_tkt_sale_wt_py_l26wk\n    ,sls.gross_tkt_sale_wt_cy_l52wk\n    ,sls.gross_tkt_sale_wt_py_l52wk\n    ,sls.net_tkt_sale_amt_cy_ytd\n    ,sls.net_tkt_sale_amt_py\n    ,sls.net_tkt_sale_amt_2py\n    ,sls.net_tkt_sale_amt_py_ytd\n    ,sls.net_tkt_sale_amt_2py_ytd\n    ,sls.net_tkt_sale_amt_cy_l13p\n    ,sls.net_tkt_sale_amt_py_l13p\n    ,sls.net_tkt_sale_amt_cy_l4wk\n    ,sls.net_tkt_sale_amt_py_l4wk\n    ,sls.net_tkt_sale_amt_cy_l12wk\n    ,sls.net_tkt_sale_amt_py_l12wk\n    ,sls.net_tkt_sale_amt_cy_l26wk\n    ,sls.net_tkt_sale_amt_py_l26wk\n    ,sls.net_tkt_sale_amt_cy_l52wk\n    ,sls.net_tkt_sale_amt_py_l52wk\n    ,sls.net_tkt_sale_qty_cy_ytd\n    ,sls.net_tkt_sale_qty_py\n    ,sls.net_tkt_sale_qty_2py\n    ,sls.net_tkt_sale_qty_py_ytd\n    ,sls.net_tkt_sale_qty_2py_ytd\n    ,sls.net_tkt_sale_qty_cy_l13p\n    ,sls.net_tkt_sale_qty_py_l13p\n    ,sls.net_tkt_sale_qty_cy_l4wk\n    ,sls.net_tkt_sale_qty_py_l4wk\n    ,sls.net_tkt_sale_qty_cy_l12wk\n    ,sls.net_tkt_sale_qty_py_l12wk\n    ,sls.net_tkt_sale_qty_cy_l26wk\n    ,sls.net_tkt_sale_qty_py_l26wk\n    ,sls.net_tkt_sale_qty_cy_l52wk\n    ,sls.net_tkt_sale_qty_py_l52wk\n    ,sls.net_tkt_sale_wt_cy_ytd\n    ,sls.net_tkt_sale_wt_py\n    ,sls.net_tkt_sale_wt_2py\n    ,sls.net_tkt_sale_wt_py_ytd\n    ,sls.net_tkt_sale_wt_2py_ytd\n    ,sls.net_tkt_sale_wt_cy_l13p\n    ,sls.net_tkt_sale_wt_py_l13p\n    ,sls.net_tkt_sale_wt_cy_l4wk\n    ,sls.net_tkt_sale_wt_py_l4wk\n    ,sls.net_tkt_sale_wt_cy_l12wk\n    ,sls.net_tkt_sale_wt_py_l12wk\n    ,sls.net_tkt_sale_wt_cy_l26wk\n    ,sls.net_tkt_sale_wt_py_l26wk\n    ,sls.net_tkt_sale_wt_cy_l52wk\n    ,sls.net_tkt_sale_wt_py_l52wk\n    ,sls.am_promo_allow_amt_cy_ytd\n    ,sls.am_promo_allow_amt_py\n    ,sls.am_promo_allow_amt_2py\n    ,sls.am_promo_allow_amt_py_ytd\n    ,sls.am_promo_allow_amt_2py_ytd\n    ,sls.am_promo_allow_amt_cy_l13p\n    ,sls.am_promo_allow_amt_py_l13p\n    ,sls.am_promo_allow_amt_cy_l4wk\n    ,sls.am_promo_allow_amt_py_l4wk\n    ,sls.am_promo_allow_amt_cy_l12wk\n    ,sls.am_promo_allow_amt_py_l12wk\n    ,sls.am_promo_allow_amt_cy_l26wk\n    ,sls.am_promo_allow_amt_py_l26wk\n    ,sls.am_promo_allow_amt_cy_l52wk\n    ,sls.am_promo_allow_amt_py_l52wk\n    ,sls.am_promo_sale_amt_cy_ytd\n    ,sls.am_promo_sale_amt_py\n    ,sls.am_promo_sale_amt_2py\n    ,sls.am_promo_sale_amt_py_ytd\n    ,sls.am_promo_sale_amt_2py_ytd\n    ,sls.am_promo_sale_amt_cy_l13p\n    ,sls.am_promo_sale_amt_py_l13p\n    ,sls.am_promo_sale_amt_cy_l4wk\n    ,sls.am_promo_sale_amt_py_l4wk\n    ,sls.am_promo_sale_amt_cy_l12wk\n    ,sls.am_promo_sale_amt_py_l12wk\n    ,sls.am_promo_sale_amt_cy_l26wk\n    ,sls.am_promo_sale_amt_py_l26wk\n    ,sls.am_promo_sale_amt_cy_l52wk\n    ,sls.am_promo_sale_amt_py_l52wk\n    ,sls.am_promo_sale_qty_cy_ytd\n    ,sls.am_promo_sale_qty_py\n    ,sls.am_promo_sale_qty_2py\n    ,sls.am_promo_sale_qty_py_ytd\n    ,sls.am_promo_sale_qty_2py_ytd\n    ,sls.am_promo_sale_qty_cy_l13p\n    ,sls.am_promo_sale_qty_py_l13p\n    ,sls.am_promo_sale_qty_cy_l4wk\n    ,sls.am_promo_sale_qty_py_l4wk\n    ,sls.am_promo_sale_qty_cy_l12wk\n    ,sls.am_promo_sale_qty_py_l12wk\n    ,sls.am_promo_sale_qty_cy_l26wk\n    ,sls.am_promo_sale_qty_py_l26wk\n    ,sls.am_promo_sale_qty_cy_l52wk\n    ,sls.am_promo_sale_qty_py_l52wk\n    ,sls.full_revnu_sale_amt_cy_ytd\n    ,sls.full_revnu_sale_amt_py\n    ,sls.full_revnu_sale_amt_2py\n    ,sls.full_revnu_sale_amt_py_ytd\n    ,sls.full_revnu_sale_amt_2py_ytd\n    ,sls.full_revnu_sale_amt_cy_l13p\n    ,sls.full_revnu_sale_amt_py_l13p\n    ,sls.full_revnu_sale_amt_cy_l4wk\n    ,sls.full_revnu_sale_amt_py_l4wk\n    ,sls.full_revnu_sale_amt_cy_l12wk\n    ,sls.full_revnu_sale_amt_py_l12wk\n    ,sls.full_revnu_sale_amt_cy_l26wk\n    ,sls.full_revnu_sale_amt_py_l26wk\n    ,sls.full_revnu_sale_amt_cy_l52wk\n    ,sls.full_revnu_sale_amt_py_l52wk\n    ,sls.full_revnu_sale_qty_cy_ytd\n    ,sls.full_revnu_sale_qty_py\n    ,sls.full_revnu_sale_qty_2py\n    ,sls.full_revnu_sale_qty_py_ytd\n    ,sls.full_revnu_sale_qty_2py_ytd\n    ,sls.full_revnu_sale_qty_cy_l13p\n    ,sls.full_revnu_sale_qty_py_l13p\n    ,sls.full_revnu_sale_qty_cy_l4wk\n    ,sls.full_revnu_sale_qty_py_l4wk\n    ,sls.full_revnu_sale_qty_cy_l12wk\n    ,sls.full_revnu_sale_qty_py_l12wk\n    ,sls.full_revnu_sale_qty_cy_l26wk\n    ,sls.full_revnu_sale_qty_py_l26wk\n    ,sls.full_revnu_sale_qty_cy_l52wk\n    ,sls.full_revnu_sale_qty_py_l52wk\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('btg_fl_sales_cust_prod_v') }} sls\nleft join {{ ref('btg_fl_cust_v') }} cust on (cust.cust_nbr = sls.fl_cust_id)\nleft join {{ ref('btg_pbc_cust_v') }} pbc on (pbc.cust_id = sls.fl_cust_id)\nleft join prod on (prod.prod_upc = sls.prod_upc and prod.prod_slbl = sls.prod_slbl)\nleft join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(cust.phy_loc_post_code_zip5),0,5))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_fl_sales_cust_prod_v_extend"], "unique_id": "model.sdna_project.btg_fl_sales_cust_prod_v_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_fl_sales_cust_prod_v_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_fl_sales_cust_prod_v_extend.sql", "name": "btg_fl_sales_cust_prod_v_extend", "resource_type": "model", "alias": "btg_fl_sales_cust_prod_v_extend", "checksum": {"name": "sha256", "checksum": "0495138547cad41d03437bdb8a859472e9df90201f654b4ed0c25fa1e7131706"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_prod_v"], ["btg_fl_sales_cust_prod_v"], ["btg_fl_cust_v"], ["btg_pbc_cust_v"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend": {"raw_sql": "with prod as (\n    select *\n    ,case when bus_unit_code='099' then bus_unit_code else 'ot' end as bus_unit_code_new\n    ,case when bus_unit_code='099' then bus_unit_descp else 'ot' end as bus_unit_descp_new\n    ,case\n          when bus_unit_code='099'then 'ssf' --//single serve flex\n          when  (bus_unit_code in ('007','008','043','060','072','114')) then 'cf'\n          when  bus_unit_code='010' then 'dip'\n          when  bus_unit_code='085' then 'multipak'\n          else 'takehome'\n     end as major_cat\n    from {{ ref('btg_fl_prod_v') }}\n)\nselect\n    sls.msa_id\n    ,sls.fl_cust_id\n    --,sls.cust_cnt\n    ,sls.prod_upc\n    ,sls.prod_slbl\n    ,prod.upc_mfg_id\n    ,sls.fscl_wk_end_dte\n    ,sls.fscl_yr_num\n    ,sls.fscl_pd_num\n    ,sls.fscl_wk_in_pd_num\n    --cust attributes\n    ,trim(cust.tdlinx_id) as tdlinx_id\n    ,upper(cust.cust_nm) as cust_name\n    ,upper(cust.phy_loc_str_addr1) as address\n    ,upper(cust.phy_loc_city) as city\n    ,upper(cust.phy_loc_st_prov) as state\n    ,cust.phy_loc_post_code_zip5 as zip5\n    ,trim(cust.phy_loc_post_code) as zip9\n    ,upper(cust.phy_loc_cnty_sburb) as county\n    ,cust.lat_code as latitude\n    ,cust.lon_code as longitude\n    ,upper(cust.geo_lvl1_node_nbr) as division_id\n    ,upper(cust.geo_lvl1_node_nm) as division\n    ,upper(cust.geo_lvl2_node_nbr) as region_id\n    ,upper(cust.geo_lvl2_node_nm) as region\n    ,upper(cust.geo_lvl3_node_nbr) as zone_id\n    ,upper(cust.geo_lvl3_node_nm) as zone\n    ,upper(cust.geo_lvl4_node_nbr) as district_id\n    ,upper(cust.geo_lvl4_node_nm) as district\n    ,cust.rt_nbr\n    ,upper(cust.trade_chanl_code) as trade_chanl_code\n    ,upper(cust.trade_chanl_descp) as trade_chanl_descp\n    --,upper(pbc.btg_format) as format\n    ,null as format\n    ,upper(coalesce(cust.chain_lvl1_node_nm,pbc.grp1_lvl_1_desc)) as retailer\n    --new additions post first prod run sept 2020\n    ,upper(trim(zip.pbc_fbu_flg)) as  pbc_fbu_flg\n    ,upper(cust.chain_lvl1_node_nbr) as chain_lvl1_node_nbr\n    ,upper(cust.chain_lvl1_node_nm) as  chain_lvl1_node_nm\n    ,upper(cust.chain_lvl2_node_nbr) as chain_lvl2_node_nbr\n    ,upper(cust.chain_lvl2_node_nm) as  chain_lvl2_node_nm\n    ,upper(cust.chain_lvl3_node_nbr) as chain_lvl3_node_nbr\n    ,upper(cust.chain_lvl3_node_nm) as chain_lvl3_node_nm\n    ,upper(cust.chain_lvl4_node_nbr) as chain_lvl4_node_nbr\n    ,upper(cust.chain_lvl4_node_nm) as chain_lvl4_node_nm\n    ,upper(prod.sale_class_code) as sale_class_code\n    ,upper(prod.sale_class_descp) as sale_class_descp\n    ,upper(prod.size_code) as size_code\n    ,upper(prod.size_descp) as size_descp\n    --end:new additions post first prod run sept 2020\n    --prod attributes\n    ,upper(prod.categ_code) as categ_code\n    ,upper(prod.categ_descp) as categ_descp\n    -- ,upper(prod.bus_unit_code) as trdmark_cde\n    -- ,upper(prod.bus_unit_descp) as trdmark_desc\n    ,upper(prod.bus_unit_code) as bus_unit_code\n    ,upper(prod.bus_unit_descp) as bus_unit_descp\n    ,upper(trim(prod.brand_code)) as brand_code\n    ,upper(prod.brand_descp) as brand_descp\n    ,upper(prod.flvr_code) as flvr_code\n    ,upper(prod.flvr_descp) as flvr_descp\n    ,upper(prod.prod_tkt_descp_txt) as prod_tkt_descp_txt\n    ,concat(prod.prod_upc,prod.prod_slbl) as upc_cde\n    ,prod.upc_10 as upc_10\n    ,upper(trim(prod.bdc_descp)) as bdc_descp\n    ,prod.gtin as gtin\n    -- ,upper(prod.bus_unit_code_new) as bus_unit_code_new\n    -- ,upper(prod.bus_unit_descp_new) as bus_unit_descp_new\n    ,upper(prod.major_cat) as major_cat\n    -- ,case\n    --       when (prod.major_cat='ssf') then\n    --         (case prod.size_descp\n    --                 when 'xxvl strip' then 'x-xvl'\n    --                 when 'xxvl' then 'x-xvl'\n    --                 when 'sglwkend     ppw'  then 'ppw'\n    --                 when 'sglwkend ppw' then 'ppw'\n    --         else prod.size_descp\n    --         end)\n    --       else prod.major_cat\n    --  end as major_cat_size\n    --remaining sls columns\n    ,sls.tkt_sale_amt\n    ,sls.tkt_sale_qty\n    ,sls.tkt_sale_wt\n    ,sls.gross_tkt_sale_amt\n    ,sls.gross_tkt_sale_qty\n    ,sls.gross_tkt_sale_wt\n    ,sls.net_tkt_sale_amt\n    ,sls.net_tkt_sale_qty\n    ,sls.net_tkt_sale_wt\n    ,sls.am_promo_allow_amt\n    ,sls.am_promo_sale_amt\n    ,sls.am_promo_sale_qty\n    ,sls.full_revnu_sale_amt\n    ,sls.full_revnu_sale_qty\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('btg_fl_sales_cust_wk_prod_v') }} sls\nleft join {{ ref('btg_fl_cust_v') }} cust on (cust.cust_nbr = sls.fl_cust_id)\nleft join {{ ref('btg_pbc_cust_v') }} pbc on (pbc.cust_id = sls.fl_cust_id)\nleft join prod on (prod.prod_upc = sls.prod_upc and prod.prod_slbl = sls.prod_slbl)\nleft join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(cust.phy_loc_post_code_zip5),0,5))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_fl_sales_cust_wk_prod_v_extend"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_fl_sales_cust_wk_prod_v_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_fl_sales_cust_wk_prod_v_extend.sql", "name": "btg_fl_sales_cust_wk_prod_v_extend", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_prod_v_extend", "checksum": {"name": "sha256", "checksum": "873d66913c87c814af6e1f44471a0fb0575e9399eba5a55beaff85922d24ba71"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_prod_v"], ["btg_fl_sales_cust_wk_prod_v"], ["btg_fl_cust_v"], ["btg_pbc_cust_v"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_prod_upc_sale_seq": {"raw_sql": "-- Load btg_pbc_prod_upc_sale_seq\n\n-- {{ ref('btg_pbc_prod_v') }}\n-- {{ ref('btg_pbc_sales_cust_wk_prod_v') }}\n\nWITH sales_upc AS (\n    SELECT\n\t\tupc_cde,\n\t\tnme AS upc_descp,\n\t\tctgy_type_cde,\n\t\tctgy_type_desc,\n\t\tmkt_trdmrk_id,\n\t\tmkt_trdmrk_desc,\n\t\ttrdmrk_cde,\n\t\ttrdmrk_desc,\n\t\tbrnd_id,\n\t\tbrnd_nme,\n\t\tflvr_cde,\n\t\tflvr_desc,\n\t\thrzn_prod_ctgy_desc,\n\t\thrzn_pkg_aggr_desc,\n\t\tcont_desc,\n\t\tpkg_cont_mtrl_desc,\n\t\tpkg_clstr_mtrl_desc,\n\t\tprod_grp_desc,\n\t\tcont_uom_desc,\n\t\tcont_uom_qty,\n\t\tclust_cde,\n\t\tclust_desc,\n\t\tclust_qty,\n\t\tss_mp_ms,\n\t\tss_th,\n\t\tSUM(sls.net_rev) AS net_rev_sum\n\tFROM\n        {{ ref('btg_pbc_prod_v') }} AS prod\n\t\tLEFT JOIN {{ ref('btg_pbc_sales_cust_wk_prod_v') }} AS sls ON (prod.inven_id = sls.inven_id)\n\tWHERE\n\t\tupc_cde <> '000000000000'\n\tGROUP BY\n\t\tupc_cde,\n\t\tnme,\n\t\tctgy_type_cde,\n\t\tctgy_type_desc,\n\t\tmkt_trdmrk_id,\n\t\tmkt_trdmrk_desc,\n\t\ttrdmrk_cde,\n\t\ttrdmrk_desc,\n\t\tbrnd_id,\n\t\tbrnd_nme,\n\t\tflvr_cde,\n\t\tflvr_desc,\n\t\thrzn_prod_ctgy_desc,\n\t\thrzn_pkg_aggr_desc,\n\t\tcont_desc,\n\t\tpkg_cont_mtrl_desc,\n\t\tpkg_clstr_mtrl_desc,\n\t\tprod_grp_desc,\n\t\tcont_uom_desc,\n\t\tcont_uom_qty,\n\t\tclust_cde,\n\t\tclust_desc,\n\t\tclust_qty,\n\t\tss_mp_ms,\n\t\tss_th\n\tHAVING\n\t\tSUM(sls.net_rev) <> 0\n)\nSELECT\n\t*,\n\tROW_NUMBER() OVER (\n\t\tPARTITION BY sales_upc.upc_cde\n\t\tORDER BY\n\t\t\tsales_upc.net_rev_sum DESC\n\t) AS upc_sale_seq,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\tsales_upc", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_pbc_prod_upc_sale_seq"], "unique_id": "model.sdna_project.btg_pbc_prod_upc_sale_seq", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_pbc_prod_upc_sale_seq.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_pbc_prod_upc_sale_seq.sql", "name": "btg_pbc_prod_upc_sale_seq", "resource_type": "model", "alias": "btg_pbc_prod_upc_sale_seq", "checksum": {"name": "sha256", "checksum": "179831f3e50114b979dc397ece2742d752bd04f3ebb29f37c12fa7636e298269"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_prod_v"], ["btg_pbc_sales_cust_wk_prod_v"], ["btg_pbc_prod_v"], ["btg_pbc_sales_cust_wk_prod_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_prod_v_extend": {"raw_sql": "select\n    sls.msa_id\n    ,sls.pbc_cust_id\n    ,sls.inven_id\n    --cust attributes\n    ,upper(cust.nme) as cust_name\n    ,upper(cust.dely_adr_strt1) as address\n    ,upper(cust.dely_adr_city) as city\n    ,upper(cust.dely_adr_state) as state\n    ,upper(cust.dely_adr_zip5) as zip5\n    ,upper(trim(cust.dely_adr_zip)) as zip9\n    ,upper(cust.dely_adr_cnty) as county\n    --lat-long table attributes\n    ,ll.lat_qty\n    ,ll.lngtd_qty\n    --division hierarchy atributes\n    ,mkt.hq_id as division_id\n    ,upper(mkt.hq_nme) as division\n    ,mkt.bu_id as region_id\n    ,upper(mkt.bu_nme) as region\n    ,mkt.mu_id as market_id\n    ,upper(mkt.mu_nme) as market\n    ,upper(trim(mkt.nme)) as location\n    --rte attributes\n    ,rte.terr_id\n    ,upper(trim(rte.terr_nme)) as terr_nme\n    ,rte.rte_id as route_id\n    --some more cust attributes\n    ,upper(cust.bus_type_aggr_cde) as channel_cde\n    ,upper(cust.bus_type_aggr_desc) as channel_desc\n    ,upper(cust.bus_type_ctgy_cde) as format_cde\n    ,upper(cust.bus_type_ctgy_desc) as format_desc\n    ,upper(cust.grp1_lvl_1_desc) as banner\n    ,upper(coalesce(fl.chain_lvl1_node_nm,cust.grp1_lvl_1_desc)) as retailer\n    --new changes post-production sept 2020\n    ,upper(cust.cur_stat_desc) as cur_stat_desc\n    ,upper(trim(cust.bus_type_desc)) as sub_channel_desc\n    ,upper(cust.grp1_lvl_2_desc) as grp1_lvl_2_desc\n    ,upper(cust.grp2_lvl_1_desc) as grp2_lvl_1_desc\n    ,upper(cust.grp2_lvl_2_desc) as grp2_lvl_2_desc\n    ,upper(trim(prod.clust_cde)) as clust_cde\n    ,upper(prod.clust_desc) as clust_desc\n    ,prod.clust_qty\n    ,upper(prod.cont_desc) as cont_desc\n    ,upper(prod.cont_uom_desc) as cont_uom_desc\n    ,prod.cont_uom_qty\n    ,upper(prod.hrzn_pkg_aggr_desc) as hrzn_pkg_aggr_desc\n    ,upper(prod.hrzn_prod_ctgy_desc) as hrzn_prod_ctgy_desc\n    ,upper(prod.mkt_trdmrk_desc) as mkt_trdmrk_desc\n    ,upper(prod.mkt_trdmrk_id) as mkt_trdmrk_id\n    ,upper(trim(zip.pbc_fbu_flg)) as pbc_fbu_flg\n    ,upper(prod.pkg_clstr_mtrl_desc) as pkg_clstr_mtrl_desc\n    ,upper(prod.pkg_cont_mtrl_desc) as pkg_cont_mtrl_desc\n    ,upper(prod.prod_grp_desc) as prod_grp_desc\n    --end: new changes post-production sept 2020\n    --prod attributes\n    ,upper(prod.ctgy_type_cde) as ctgy_type_cde\n    ,upper(prod.ctgy_type_desc) as ctgy_type_desc\n    ,upper(prod.trdmrk_cde) as trdmrk_cde\n    ,upper(prod.trdmrk_desc) as trdmark_desc\n    ,prod.brnd_id\n    ,upper(trim(prod.brnd_nme)) as brnd_nme\n    ,upper(prod.flvr_cde) as flvr_cde\n    ,upper(prod.flvr_desc) as flvr_desc\n    ,upper(prod.pkg_nme) as pkg_nme\n    ,prod.pkg_id as pkg_cde\n    ,prod.upc_cde as upc_cde\n    ,upper(prod.inven_dply_grp_nme) as upc_descp\n    ,upper(prod.ss_mp_ms) as ss_mp_ms\n    ,upper(prod.ss_th) as ss_th\n    ,sls.dely_lne_qty_cy_ytd\n    ,sls.dely_lne_qty_cy_ytd * prod.config_qty as eaches_cy_ytd\n    ,sls.dely_lne_qty_py\n    ,sls.dely_lne_qty_py *  prod.config_qty as eaches_py\n    ,sls.dely_lne_qty_2py\n    ,sls.dely_lne_qty_2py  * prod.config_qty as eaches_2py\n    ,sls.dely_lne_qty_py_ytd\n    ,sls.dely_lne_qty_py_ytd * prod.config_qty as eaches_py_ytd\n    ,sls.dely_lne_qty_2py_ytd\n    ,sls.dely_lne_qty_2py_ytd * prod.config_qty as eaches_2py_ytd\n    ,sls.dely_lne_qty_cy_l13p\n    ,sls.dely_lne_qty_cy_l13p * prod.config_qty as eaches_cy_l13p\n    ,sls.dely_lne_qty_py_l13p\n    ,sls.dely_lne_qty_py_l13p * prod.config_qty as eaches_py_l13p\n    ,sls.dely_lne_qty_cy_l4wk\n    ,sls.dely_lne_qty_cy_l4wk * prod.config_qty as eaches_cy_l4wk\n    ,sls.dely_lne_qty_py_l4wk\n    ,sls.dely_lne_qty_py_l4wk * prod.config_qty as eaches_py_l4wk\n    ,sls.dely_lne_qty_cy_l12wk\n    ,sls.dely_lne_qty_cy_l12wk * prod.config_qty as eaches_cy_l12wk\n    ,sls.dely_lne_qty_py_l12wk\n    ,sls.dely_lne_qty_py_l12wk * prod.config_qty as eaches_py_l12wk\n    ,sls.dely_lne_qty_cy_l26wk\n    ,sls.dely_lne_qty_cy_l26wk * prod.config_qty as eaches_cy_l26wk\n    ,sls.dely_lne_qty_py_l26wk\n    ,sls.dely_lne_qty_py_l26wk * prod.config_qty as eaches_py_l26wk\n    ,sls.dely_lne_qty_cy_l52wk\n    ,sls.dely_lne_qty_cy_l52wk * prod.config_qty as eaches_cy_l52wk\n    ,sls.dely_lne_qty_py_l52wk\n    ,sls.dely_lne_qty_py_l52wk * prod.config_qty as eaches_py_l52wk\n    ,sls.raw_vol_cy_ytd\n    ,sls.raw_vol_py\n    ,sls.raw_vol_2py\n    ,sls.raw_vol_py_ytd\n    ,sls.raw_vol_2py_ytd\n    ,sls.raw_vol_cy_l13p\n    ,sls.raw_vol_py_l13p\n    ,sls.raw_vol_cy_l4wk\n    ,sls.raw_vol_py_l4wk\n    ,sls.raw_vol_cy_l12wk\n    ,sls.raw_vol_py_l12wk\n    ,sls.raw_vol_cy_l26wk\n    ,sls.raw_vol_py_l26wk\n    ,sls.raw_vol_cy_l52wk\n    ,sls.raw_vol_py_l52wk\n    ,sls.eght_oz_vol_cy_ytd\n    ,sls.eght_oz_vol_py\n    ,sls.eght_oz_vol_2py\n    ,sls.eght_oz_vol_py_ytd\n    ,sls.eght_oz_vol_2py_ytd\n    ,sls.eght_oz_vol_cy_l13p\n    ,sls.eght_oz_vol_py_l13p\n    ,sls.eght_oz_vol_cy_l4wk\n    ,sls.eght_oz_vol_py_l4wk\n    ,sls.eght_oz_vol_cy_l12wk\n    ,sls.eght_oz_vol_py_l12wk\n    ,sls.eght_oz_vol_cy_l26wk\n    ,sls.eght_oz_vol_py_l26wk\n    ,sls.eght_oz_vol_cy_l52wk\n    ,sls.eght_oz_vol_py_l52wk\n    ,sls.net_rev_cy_ytd\n    ,sls.net_rev_py\n    ,sls.net_rev_2py\n    ,sls.net_rev_py_ytd\n    ,sls.net_rev_2py_ytd\n    ,sls.net_rev_cy_l13p\n    ,sls.net_rev_py_l13p\n    ,sls.net_rev_cy_l4wk\n    ,sls.net_rev_py_l4wk\n    ,sls.net_rev_cy_l12wk\n    ,sls.net_rev_py_l12wk\n    ,sls.net_rev_cy_l26wk\n    ,sls.net_rev_py_l26wk\n    ,sls.net_rev_cy_l52wk\n    ,sls.net_rev_py_l52wk\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('btg_pbc_sales_cust_prod_v') }} sls\nleft join {{ ref('btg_pbc_cust_v') }} cust on (cust.cust_id = sls.pbc_cust_id)\nleft join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(cust.dely_adr_zip5),0,5))\nleft join {{ ref('btg_fl_cust_v') }} fl on (fl.cust_nbr = sls.pbc_cust_id)\nleft join {{ ref('btg_msa_lat_lon_v') }} ll on (ll.msa_id = sls.msa_id)\nleft join {{ ref('btg_pbc_prod_v') }} prod on (prod.inven_id = sls.inven_id)\nleft join {{ ref('btg_pbc_new_mkt_loc') }} mkt on (mkt.cust_id = sls.pbc_cust_id)\nleft join {{ ref('btg_pbc_route_data') }} rte on (rte.cust_id = sls.pbc_cust_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_pbc_sales_cust_prod_v_extend"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_pbc_sales_cust_prod_v_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_pbc_sales_cust_prod_v_extend.sql", "name": "btg_pbc_sales_cust_prod_v_extend", "resource_type": "model", "alias": "btg_pbc_sales_cust_prod_v_extend", "checksum": {"name": "sha256", "checksum": "6f1caf7f4422a3c053b1a0c32e7d3af53761d35e44c6566cac085345a03bcc1c"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_prod_v"], ["btg_pbc_cust_v"], ["zip_code_priority_report"], ["btg_fl_cust_v"], ["btg_msa_lat_lon_v"], ["btg_pbc_prod_v"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend": {"raw_sql": "select\n    sls.msa_id\n    ,sls.pbc_cust_id\n    ,sls.inven_id\n    --cust attributes\n    ,upper(cust.nme) as cust_name\n    ,upper(cust.dely_adr_strt1) as address\n    ,upper(cust.dely_adr_city) as city\n    ,upper(cust.dely_adr_state) as state\n    ,upper(cust.dely_adr_zip5) as zip5\n    ,upper(trim(cust.dely_adr_zip)) as zip9\n    ,upper(cust.dely_adr_cnty) as county\n    --lat-long table attributes\n    ,ll.lat_qty\n    ,ll.lngtd_qty\n    --division hierarchy atributes\n    ,mkt.hq_id as division_id\n    ,upper(mkt.hq_nme) as division\n    ,mkt.bu_id as region_id\n    ,upper(mkt.bu_nme) as region\n    ,mkt.mu_id as market_id\n    ,upper(mkt.mu_nme) as market\n    ,upper(trim(mkt.nme)) as location\n    --rte attributes\n    ,rte.terr_id\n    ,upper(trim(rte.terr_nme)) as terr_nme\n    ,rte.rte_id as route_id\n    --some more cust attributes\n    ,upper(cust.bus_type_aggr_cde) as channel_cde\n    ,upper(cust.bus_type_aggr_desc) as channel_desc\n    ,upper(cust.bus_type_ctgy_cde) as format_cde\n    ,upper(cust.bus_type_ctgy_desc) as format_desc\n    ,upper(cust.grp1_lvl_1_desc) as banner\n    ,upper(coalesce(fl.chain_lvl1_node_nm,cust.grp1_lvl_1_desc)) as retailer\n    --new changes post-production sept 2020\n    ,upper(cust.cur_stat_desc) as cur_stat_desc\n    ,upper(trim(cust.bus_type_desc)) as sub_channel_desc\n    ,upper(cust.grp1_lvl_2_desc) as grp1_lvl_2_desc\n    ,upper(cust.grp2_lvl_1_desc) as grp2_lvl_1_desc\n    ,upper(cust.grp2_lvl_2_desc) as grp2_lvl_2_desc\n    ,upper(trim(prod.clust_cde)) as clust_cde\n    ,upper(prod.clust_desc) as clust_desc\n    ,prod.clust_qty\n    ,upper(prod.cont_desc) as cont_desc\n    ,upper(prod.cont_uom_desc) as cont_uom_desc\n    ,prod.cont_uom_qty\n    ,upper(prod.hrzn_pkg_aggr_desc) as hrzn_pkg_aggr_desc\n    ,upper(prod.hrzn_prod_ctgy_desc) as hrzn_prod_ctgy_desc\n    ,upper(prod.mkt_trdmrk_desc) as mkt_trdmrk_desc\n    ,upper(prod.mkt_trdmrk_id) as mkt_trdmrk_id\n    ,upper(trim(zip.pbc_fbu_flg)) as pbc_fbu_flg\n    ,upper(prod.pkg_clstr_mtrl_desc) as pkg_clstr_mtrl_desc\n    ,upper(prod.pkg_cont_mtrl_desc) as pkg_cont_mtrl_desc\n    ,upper(prod.prod_grp_desc) as prod_grp_desc\n    --end: new changes post-production sept 2020\n    --prod attributes\n    ,upper(prod.ctgy_type_cde) as ctgy_type_cde\n    ,upper(prod.ctgy_type_desc) as ctgy_type_desc\n    ,upper(prod.trdmrk_cde) as trdmrk_cde\n    ,upper(prod.trdmrk_desc) as trdmrk_desc\n    ,prod.brnd_id as brand_cde\n    ,upper(trim(prod.brnd_nme)) as brnd_nme\n    ,upper(prod.flvr_cde) as flvr_cde\n    ,upper(prod.flvr_desc) as flvr_desc\n    ,upper(prod.pkg_nme) as pkg_nme\n    ,prod.pkg_id as pkg_cde\n    ,prod.upc_cde as upc_cde\n    ,upper(prod.inven_dply_grp_nme) as upc_descp\n    ,upper(prod.ss_mp_ms) as ss_mp_ms\n    ,upper(prod.ss_th) as ss_th\n    --sls remaining columns\n    ,sls.fscl_wk_end_dte\n    ,sls.fscl_yr_num\n    ,sls.fscl_pd_num\n    ,sls.fscl_wk_in_pd_num\n    ,sls.dely_lne_qty as cases\n    ,sls.dely_lne_qty*prod.config_qty as eaches\n    ,sls.raw_vol\n    ,sls.eght_oz_vol\n    ,sls.net_rev\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('btg_pbc_sales_cust_wk_prod_v') }} sls\nleft join {{ ref('btg_pbc_cust_v') }} cust on (cust.cust_id = sls.pbc_cust_id)\nleft join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(cust.dely_adr_zip5),0,5))\nleft join {{ ref('btg_fl_cust_v') }} fl on (fl.cust_nbr = sls.pbc_cust_id)\nleft join {{ ref('btg_msa_lat_lon_v') }} ll on (ll.msa_id = sls.msa_id)\nleft join {{ ref('btg_pbc_prod_v') }} prod on (prod.inven_id = sls.inven_id)\nleft join {{ ref('btg_pbc_new_mkt_loc') }} mkt on (mkt.cust_id = sls.pbc_cust_id)\nleft join {{ ref('btg_pbc_route_data') }} rte on (rte.cust_id = sls.pbc_cust_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "btg_pbc_sales_cust_wk_prod_v_extend"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/btg_pbc_sales_cust_wk_prod_v_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/btg_pbc_sales_cust_wk_prod_v_extend.sql", "name": "btg_pbc_sales_cust_wk_prod_v_extend", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_prod_v_extend", "checksum": {"name": "sha256", "checksum": "215204f871c17e5f7bbe09450954670471b0504759e5e5cb18d7b7315fc33b21"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_wk_prod_v"], ["btg_pbc_cust_v"], ["zip_code_priority_report"], ["btg_fl_cust_v"], ["btg_msa_lat_lon_v"], ["btg_pbc_prod_v"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc": {"raw_sql": "-- Load cm_btg_fl_sales_cust_pd_prod_upc\n\n-- {{ ref('btg_pep_calendar') }}\n-- {{ ref('cm_btg_fl_sales_cust_wk_prod_upc') }}\n\nWITH pd_tbl AS \n(\n    SELECT\n\t\tfscl_yr_num,\n\t\tfscl_pd_num,\n\t\tMAX(fscl_pd_end_dte) AS max_fscl_pd_end_dte\n\tFROM\n\t\t{{ ref('btg_pep_calendar') }}\n\tGROUP BY\n\t\tfscl_yr_num,\n\t\tfscl_pd_num\n),\npd_sales AS \n(\n\tSELECT\n\t\tsl.msa_id,\n\t\tsl.fl_cust_id,\n\t\tsl.UPC_10,\n\t\tsl.fscl_yr_num,\n\t\tsl.fscl_pd_num,\n\t\tsl.cust_Name,\n\t\tsl.Address,\n\t\tsl.City,\n\t\tsl.State,\n\t\tsl.Zip5,\n\t\tsl.Zip9,\n\t\tsl.County,\n\t\tsl.Latitude,\n\t\tsl.Longitude,\n\t\tsl.Division_ID,\n\t\tsl.Division,\n\t\tsl.Region_ID,\n\t\tsl.Region,\n\t\tsl.Zone_ID,\n\t\tsl.Zone,\n\t\tsl.District_ID,\n\t\tsl.District,\n\t\tsl.rt_nbr,\n\t\tsl.trade_chanl_code,\n\t\tsl.trade_chanl_descp,\n\t\tsl.chain_lvl1_node_nbr,\n\t\tsl.chain_lvl1_node_nm,\n\t\tsl.chain_lvl2_node_nbr,\n\t\tsl.chain_lvl2_node_nm,\n\t\tsl.chain_lvl3_node_nbr,\n\t\tsl.chain_lvl3_node_nm,\n\t\tsl.chain_lvl4_node_nbr,\n\t\tsl.chain_lvl4_node_nm,\n\t\tsl.categ_code,\n\t\tsl.categ_descp,\n\t\tsl.bus_unit_code,\n\t\tsl.bus_unit_descp,\n\t\tsl.brand_code,\n\t\tsl.brand_descp,\n\t\tsl.prod_tkt_descp_txt,\n\t\tsl.bdc_descp,\n\t\tsl.sale_class_code,\n\t\tsl.sale_class_descp,\n\t\tsl.size_code,\n\t\tsl.size_descp,\n\t\tsl.flvr_code,\n\t\tsl.flvr_descp,\n\t\tsl.MAJOR_CAT,\n\t\tSUM(sl.tkt_sale_amt) AS tkt_sale_amt,\n\t\tSUM(sl.tkt_sale_qty) AS tkt_sale_qty,\n\t\tSUM(sl.tkt_sale_wt) AS tkt_sale_wt,\n\t\tSUM(sl.gross_tkt_sale_amt) AS gross_tkt_sale_amt,\n\t\tSUM(sl.gross_tkt_sale_qty) AS gross_tkt_sale_qty,\n\t\tSUM(sl.gross_tkt_sale_wt) AS gross_tkt_sale_wt,\n\t\tSUM(sl.net_tkt_sale_amt) AS net_tkt_sale_amt,\n\t\tSUM(sl.net_tkt_sale_qty) AS net_tkt_sale_qty,\n\t\tSUM(sl.net_tkt_sale_wt) AS net_tkt_sale_wt,\n\t\tSUM(sl.am_promo_allow_amt) AS am_promo_allow_amt,\n\t\tSUM(sl.am_promo_sale_amt) AS am_promo_sale_amt,\n\t\tSUM(sl.am_promo_sale_qty) AS am_promo_sale_qty,\n\t\tSUM(sl.full_revnu_sale_amt) AS full_revnu_sale_amt,\n\t\tSUM(sl.full_revnu_sale_qty) AS full_revnu_sale_qty\n\tFROM\n        {{ ref('cm_btg_fl_sales_cust_wk_prod_upc') }} AS sl\n\tGROUP BY\n\t\tsl.msa_id,\n\t\tsl.fl_cust_id,\n\t\tsl.UPC_10,\n\t\tsl.fscl_yr_num,\n\t\tsl.fscl_pd_num,\n\t\tsl.cust_Name,\n\t\tsl.Address,\n\t\tsl.City,\n\t\tsl.State,\n\t\tsl.Zip5,\n\t\tsl.Zip9,\n\t\tsl.County,\n\t\tsl.Latitude,\n\t\tsl.Longitude,\n\t\tsl.Division_ID,\n\t\tsl.Division,\n\t\tsl.Region_ID,\n\t\tsl.Region,\n\t\tsl.Zone_ID,\n\t\tsl.Zone,\n\t\tsl.District_ID,\n\t\tsl.District,\n\t\tsl.rt_nbr,\n\t\tsl.trade_chanl_code,\n\t\tsl.trade_chanl_descp,\n\t\tsl.chain_lvl1_node_nbr,\n\t\tsl.chain_lvl1_node_nm,\n\t\tsl.chain_lvl2_node_nbr,\n\t\tsl.chain_lvl2_node_nm,\n\t\tsl.chain_lvl3_node_nbr,\n\t\tsl.chain_lvl3_node_nm,\n\t\tsl.chain_lvl4_node_nbr,\n\t\tsl.chain_lvl4_node_nm,\n\t\tsl.categ_code,\n\t\tsl.categ_descp,\n\t\tsl.bus_unit_code,\n\t\tsl.bus_unit_descp,\n\t\tsl.brand_code,\n\t\tsl.brand_descp,\n\t\tsl.prod_tkt_descp_txt,\n\t\tsl.bdc_descp,\n\t\tsl.sale_class_code,\n\t\tsl.sale_class_descp,\n\t\tsl.size_code,\n\t\tsl.size_descp,\n\t\tsl.flvr_code,\n\t\tsl.flvr_descp,\n\t\tsl.MAJOR_CAT\n)\nSELECT\n\tpd_sales.msa_id,\n\tpd_sales.fl_cust_id,\n\tpd_sales.UPC_10,\n\tpd_tbl.max_fscl_pd_end_dte AS fscl_pd_end_dte,\n\tpd_sales.fscl_yr_num,\n\tpd_sales.fscl_pd_num,\n\tpd_sales.cust_Name,\n\tpd_sales.Address,\n\tpd_sales.City,\n\tpd_sales.State,\n\tpd_sales.Zip5,\n\tpd_sales.Zip9,\n\tpd_sales.County,\n\tpd_sales.Latitude,\n\tpd_sales.Longitude,\n\tpd_sales.Division_ID,\n\tpd_sales.Division,\n\tpd_sales.Region_ID,\n\tpd_sales.Region,\n\tpd_sales.Zone_ID,\n\tpd_sales.Zone,\n\tpd_sales.District_ID,\n\tpd_sales.District,\n\tpd_sales.rt_nbr,\n\tpd_sales.trade_chanl_code,\n\tpd_sales.trade_chanl_descp,\n\tpd_sales.chain_lvl1_node_nbr,\n\tpd_sales.chain_lvl1_node_nm,\n\tpd_sales.chain_lvl2_node_nbr,\n\tpd_sales.chain_lvl2_node_nm,\n\tpd_sales.chain_lvl3_node_nbr,\n\tpd_sales.chain_lvl3_node_nm,\n\tpd_sales.chain_lvl4_node_nbr,\n\tpd_sales.chain_lvl4_node_nm,\n\tpd_sales.categ_code,\n\tpd_sales.categ_descp,\n\tpd_sales.bus_unit_code,\n\tpd_sales.bus_unit_descp,\n\tpd_sales.brand_code,\n\tpd_sales.brand_descp,\n\tpd_sales.prod_tkt_descp_txt,\n\tpd_sales.bdc_descp,\n\tpd_sales.sale_class_code,\n\tpd_sales.sale_class_descp,\n\tpd_sales.size_code,\n\tpd_sales.size_descp,\n\tpd_sales.flvr_code,\n\tpd_sales.flvr_descp,\n\tpd_sales.MAJOR_CAT,\n\tpd_sales.tkt_sale_amt,\n\tpd_sales.tkt_sale_qty,\n\tpd_sales.tkt_sale_wt,\n\tpd_sales.gross_tkt_sale_amt,\n\tpd_sales.gross_tkt_sale_qty,\n\tpd_sales.gross_tkt_sale_wt,\n\tpd_sales.net_tkt_sale_amt,\n\tpd_sales.net_tkt_sale_qty,\n\tpd_sales.net_tkt_sale_wt,\n\tpd_sales.am_promo_allow_amt,\n\tpd_sales.am_promo_sale_amt,\n\tpd_sales.am_promo_sale_qty,\n\tpd_sales.full_revnu_sale_amt,\n\tpd_sales.full_revnu_sale_qty,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\tpd_sales\n\tLEFT JOIN pd_tbl ON (\n\t\tpd_sales.fscl_yr_num = pd_tbl.fscl_yr_num\n\t\tAND pd_sales.fscl_pd_num = pd_tbl.fscl_pd_num\n\t)\nWHERE\n\tpd_tbl.max_fscl_pd_end_dte <= DATEADD(day, -7, NEXT_DAY(CURRENT_DATE(),\t'Sa'))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_pd_prod_upc"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_pd_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_pd_prod_upc.sql", "name": "cm_btg_fl_sales_cust_pd_prod_upc", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_pd_prod_upc", "checksum": {"name": "sha256", "checksum": "2bd73a8aeb9649e22a6b48e7232f4b0a95594b9e12c92fb8bed0a4b6422cb8eb"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pep_calendar"], ["cm_btg_fl_sales_cust_wk_prod_upc"], ["btg_pep_calendar"], ["cm_btg_fl_sales_cust_wk_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v": {"raw_sql": "-- Load cm_btg_fl_sales_cust_pd_prod_v\n\n-- {{ ref('msa_tdlinx_xref_final') }}\n-- {{ ref('iri_rma_store_list') }}\n-- {{ ref('iri_srma_sample_stores') }}\n-- {{ ref('iri_pbc_markets_divs_by_fips') }}\n-- {{ ref('zip_code_priority_report') }}\n-- {{ ref('cm_btg_fl_sales_cust_pd_prod_upc') }}\n\nWITH sls AS\n(\n\tSELECT\n\t\ts1.*,\n\t\tUPPER(z1.pbc_fbu_flg) AS pbc_fbu_flg\n\tFROM\n    {{ ref('cm_btg_fl_sales_cust_pd_prod_upc') }} AS s1\n        LEFT JOIN {{ ref('zip_code_priority_report') }} AS z1\n            ON (SUBSTR(TRIM(z1.zip_code), 0, 5) = SUBSTR(TRIM(s1.zip5), 0, 5))\n)\nSELECT\n\tCONCAT(\n\t\tCOALESCE(tdlinx1.sstatusind, 'null'), '|',\n\t\tCOALESCE(sls.msa_id, 'null'), '|',\n\t\tCOALESCE(tdlinx1.iri_retailer, 'null'), '|',\n\t\tCOALESCE(tdlinx1.aulname, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sgrpnm, 'null'), '|',\n\t\tCOALESCE(tdlinx1.stradeclcd, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sformatcd, 'null'), '|',\n\t\tCOALESCE(sls.division, 'null'), '|',\n\t\tCOALESCE(sls.region, 'null'), '|',\n\t\tCOALESCE(sls.chain_lvl1_node_nbr, 'null'), '|',\n\t\tCOALESCE(sls.categ_code, 'null'), '|',\n\t\tCOALESCE(sls.sale_class_code, 'null'), '|',\n\t\tCOALESCE(sls.major_cat, 'null'), '|',\n\t\tCOALESCE(sls.trade_chanl_code, 'null'), '|',\n\t\tCOALESCE(sls.brand_code, 'null')\n\t) AS fl_concat,\n\ttdlinx1.AULNAME,\n\ttdlinx1.SGRPNM,\n\ttdlinx1.SNAME,\n\ttdlinx1.SNO,\n\ttdlinx1.FIPS,\n\ttdlinx1.STRADECLCD,\n\ttdlinx1.SFORMATCD,\n\ttdlinx1.STRADECLDESC,\n\ttdlinx1.SFORMATDESC,\n\ttdlinx1.SSTATUSIND,\n\ttdlinx1.STDLINXSCD,\n\ttdlinx1.SLAT,\n\ttdlinx1.SLONG,\n\ttdlinx1.tdl_msa_id,\n\ttdlinx1.iri_retailer,\n\ttdlinx1.iri_rma1,\n\ttdlinx1.iri_rma2,\n\ttdlinx1.iri_rma3,\n\ttdlinx1.iri_rma4,\n\ttdlinx1.iri_rma5,\n\ttdlinx1.iri_rma6,\n\ttdlinx1.iri_rma7,\n\ttdlinx1.iri_rma8,\n\ttdlinx1.iri_rma9,\n\ttdlinx1.RMA_SRMA,\n\ttdlinx1.corporate_srma,\n\ttdlinx1.iri_pbc_div,\n\ttdlinx1.iri_pbc_mkt,\n\tCOALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg) AS pbc_fbu_flg,\n\tsls.msa_id,\n\tsls.fl_cust_id,\n\tsls.UPC_10,\n\tsls.fscl_pd_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.cust_Name,\n\tCOALESCE(tdlinx1.SSTREETADD, sls.Address) AS Address,\n\tCOALESCE(tdlinx1.SCITY, sls.City) AS City,\n\tCOALESCE(tdlinx1.SST, sls.State) AS State,\n\tCOALESCE(tdlinx1.SZIP, sls.Zip5) AS Zip5,\n\tsls.Zip9,\n\tCOALESCE(tdlinx1.MCOUNTYNM, sls.County) AS County,\n\tsls.Latitude,\n\tsls.Longitude,\n\tsls.Division_ID,\n\tsls.Division,\n\tsls.Region_ID,\n\tsls.Region,\n\tsls.Zone_ID,\n\tsls.Zone,\n\tsls.District_ID,\n\tsls.District,\n\tsls.rt_nbr,\n\tsls.trade_chanl_code,\n\tsls.trade_chanl_descp,\n\tsls.chain_lvl1_node_nbr,\n\tsls.chain_lvl1_node_nm,\n\tsls.chain_lvl2_node_nbr,\n\tsls.chain_lvl2_node_nm,\n\tsls.chain_lvl3_node_nbr,\n\tsls.chain_lvl3_node_nm,\n\tsls.chain_lvl4_node_nbr,\n\tsls.chain_lvl4_node_nm,\n\tsls.categ_code,\n\tsls.categ_descp,\n\tsls.bus_unit_code,\n\tsls.bus_unit_descp,\n\tsls.brand_code,\n\tsls.brand_descp,\n\tsls.prod_tkt_descp_txt,\n\tsls.bdc_descp,\n\tsls.sale_class_code,\n\tsls.sale_class_descp,\n\tsls.size_code,\n\tsls.size_descp,\n\tsls.flvr_code,\n\tsls.flvr_descp,\n\tsls.MAJOR_CAT,\n\tsls.tkt_sale_amt,\n\tsls.tkt_sale_qty,\n\tsls.tkt_sale_wt,\n\tsls.gross_tkt_sale_amt,\n\tsls.gross_tkt_sale_qty,\n\tsls.gross_tkt_sale_wt,\n\tsls.net_tkt_sale_amt,\n\tsls.net_tkt_sale_qty,\n\tsls.net_tkt_sale_wt,\n\tsls.am_promo_allow_amt,\n\tsls.am_promo_sale_amt,\n\tsls.am_promo_sale_qty,\n\tsls.full_revnu_sale_amt,\n\tsls.full_revnu_sale_qty,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('cm_btg_fl_sales_tdlinx1') }} AS tdlinx1\n\t    FULL JOIN sls ON (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_pd_prod_v"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_pd_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_pd_prod_v.sql", "name": "cm_btg_fl_sales_cust_pd_prod_v", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_pd_prod_v", "checksum": {"name": "sha256", "checksum": "fa424c263bcfc29c9556c7c876103da2b8caf4b38f377d4d9f11c278e4d334c3"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_fl_sales_cust_pd_prod_upc"], ["cm_btg_fl_sales_cust_pd_prod_upc"], ["zip_code_priority_report"], ["cm_btg_fl_sales_tdlinx1"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_fl_sales_tdlinx1"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid": {"raw_sql": "select\n    sls.msa_id\n    ,sls.fl_cust_id\n    ,prod.prod_upc\n    ,prod.prod_slbl\n    ,concat(substr(prod.upc_mfg_id,-5),substr(concat('0000',prod.prod_upc),-5)) as upc_10\n    --cust attributes\n    ,cust.cust_nm as cust_name\n    ,cust.phy_loc_str_addr1 as address\n    ,cust.phy_loc_city as city\n    ,cust.phy_loc_st_prov as state\n    ,cust.phy_loc_post_code_zip5 as zip5\n    ,cust.phy_loc_post_code as zip9\n    ,cust.phy_loc_cnty_sburb as county\n    ,cust.lat_code as latitude\n    ,cust.lon_code as longitude\n    ,cust.geo_lvl1_node_nbr as division_id\n    ,cust.geo_lvl1_node_nm as division\n    ,cust.geo_lvl2_node_nbr as region_id\n    ,cust.geo_lvl2_node_nm as region\n    ,cust.geo_lvl3_node_nbr as zone_id\n    ,cust.geo_lvl3_node_nm as zone\n    ,cust.geo_lvl4_node_nbr as district_id\n    ,cust.geo_lvl4_node_nm as district\n    ,cust.rt_nbr\n    ,cust.trade_chanl_code\n    ,cust.trade_chanl_descp\n    ,cust.chain_lvl1_node_nbr\n    ,cust.chain_lvl1_node_nm\n    ,cust.chain_lvl2_node_nbr\n    ,cust.chain_lvl2_node_nm\n    ,cust.chain_lvl3_node_nbr\n    ,cust.chain_lvl3_node_nm\n    ,cust.chain_lvl4_node_nbr\n    ,cust.chain_lvl4_node_nm\n    ,prod.categ_code\n    ,prod.categ_descp\n    ,prod.bus_unit_code\n    ,prod.bus_unit_descp\n    ,prod.brand_code\n    ,prod.brand_descp\n    ,prod.prod_tkt_descp_txt\n    ,prod.bdc_descp\n    ,prod.sale_class_code\n    ,prod.sale_class_descp\n    ,prod.size_code\n    ,prod.size_descp\n    ,prod.flvr_code\n    ,prod.flvr_descp\n    --voluntarily left as nulls since these values will be replaced while joining to the sale_seq table\n    ,null as bus_unit_code_new\n    ,null as bus_unit_descp_new\n    ,null as major_cat\n    ,null as major_cat_size\n    ,sls.tkt_sale_amt_cy_ytd\n    ,sls.tkt_sale_amt_py\n    ,sls.tkt_sale_amt_2py\n    ,sls.tkt_sale_amt_py_ytd\n    ,sls.tkt_sale_amt_2py_ytd\n    ,sls.tkt_sale_amt_cy_l13p\n    ,sls.tkt_sale_amt_py_l13p\n    ,sls.tkt_sale_amt_cy_l4wk\n    ,sls.tkt_sale_amt_py_l4wk\n    ,sls.tkt_sale_amt_cy_l12wk\n    ,sls.tkt_sale_amt_py_l12wk\n    ,sls.tkt_sale_amt_cy_l26wk\n    ,sls.tkt_sale_amt_py_l26wk\n    ,sls.tkt_sale_amt_cy_l52wk\n    ,sls.tkt_sale_amt_py_l52wk\n    ,sls.tkt_sale_qty_cy_ytd\n    ,sls.tkt_sale_qty_py\n    ,sls.tkt_sale_qty_2py\n    ,sls.tkt_sale_qty_py_ytd\n    ,sls.tkt_sale_qty_2py_ytd\n    ,sls.tkt_sale_qty_cy_l13p\n    ,sls.tkt_sale_qty_py_l13p\n    ,sls.tkt_sale_qty_cy_l4wk\n    ,sls.tkt_sale_qty_py_l4wk\n    ,sls.tkt_sale_qty_cy_l12wk\n    ,sls.tkt_sale_qty_py_l12wk\n    ,sls.tkt_sale_qty_cy_l26wk\n    ,sls.tkt_sale_qty_py_l26wk\n    ,sls.tkt_sale_qty_cy_l52wk\n    ,sls.tkt_sale_qty_py_l52wk\n    ,sls.tkt_sale_wt_cy_ytd\n    ,sls.tkt_sale_wt_py\n    ,sls.tkt_sale_wt_2py\n    ,sls.tkt_sale_wt_py_ytd\n    ,sls.tkt_sale_wt_2py_ytd\n    ,sls.tkt_sale_wt_cy_l13p\n    ,sls.tkt_sale_wt_py_l13p\n    ,sls.tkt_sale_wt_cy_l4wk\n    ,sls.tkt_sale_wt_py_l4wk\n    ,sls.tkt_sale_wt_cy_l12wk\n    ,sls.tkt_sale_wt_py_l12wk\n    ,sls.tkt_sale_wt_cy_l26wk\n    ,sls.tkt_sale_wt_py_l26wk\n    ,sls.tkt_sale_wt_cy_l52wk\n    ,sls.tkt_sale_wt_py_l52wk\n    ,sls.gross_tkt_sale_amt_cy_ytd\n    ,sls.gross_tkt_sale_amt_py\n    ,sls.gross_tkt_sale_amt_2py\n    ,sls.gross_tkt_sale_amt_py_ytd\n    ,sls.gross_tkt_sale_amt_2py_ytd\n    ,sls.gross_tkt_sale_amt_cy_l13p\n    ,sls.gross_tkt_sale_amt_py_l13p\n    ,sls.gross_tkt_sale_amt_cy_l4wk\n    ,sls.gross_tkt_sale_amt_py_l4wk\n    ,sls.gross_tkt_sale_amt_cy_l12wk\n    ,sls.gross_tkt_sale_amt_py_l12wk\n    ,sls.gross_tkt_sale_amt_cy_l26wk\n    ,sls.gross_tkt_sale_amt_py_l26wk\n    ,sls.gross_tkt_sale_amt_cy_l52wk\n    ,sls.gross_tkt_sale_amt_py_l52wk\n    ,sls.gross_tkt_sale_qty_cy_ytd\n    ,sls.gross_tkt_sale_qty_py\n    ,sls.gross_tkt_sale_qty_2py\n    ,sls.gross_tkt_sale_qty_py_ytd\n    ,sls.gross_tkt_sale_qty_2py_ytd\n    ,sls.gross_tkt_sale_qty_cy_l13p\n    ,sls.gross_tkt_sale_qty_py_l13p\n    ,sls.gross_tkt_sale_qty_cy_l4wk\n    ,sls.gross_tkt_sale_qty_py_l4wk\n    ,sls.gross_tkt_sale_qty_cy_l12wk\n    ,sls.gross_tkt_sale_qty_py_l12wk\n    ,sls.gross_tkt_sale_qty_cy_l26wk\n    ,sls.gross_tkt_sale_qty_py_l26wk\n    ,sls.gross_tkt_sale_qty_cy_l52wk\n    ,sls.gross_tkt_sale_qty_py_l52wk\n    ,sls.gross_tkt_sale_wt_cy_ytd\n    ,sls.gross_tkt_sale_wt_py\n    ,sls.gross_tkt_sale_wt_2py\n    ,sls.gross_tkt_sale_wt_py_ytd\n    ,sls.gross_tkt_sale_wt_2py_ytd\n    ,sls.gross_tkt_sale_wt_cy_l13p\n    ,sls.gross_tkt_sale_wt_py_l13p\n    ,sls.gross_tkt_sale_wt_cy_l4wk\n    ,sls.gross_tkt_sale_wt_py_l4wk\n    ,sls.gross_tkt_sale_wt_cy_l12wk\n    ,sls.gross_tkt_sale_wt_py_l12wk\n    ,sls.gross_tkt_sale_wt_cy_l26wk\n    ,sls.gross_tkt_sale_wt_py_l26wk\n    ,sls.gross_tkt_sale_wt_cy_l52wk\n    ,sls.gross_tkt_sale_wt_py_l52wk\n    ,sls.net_tkt_sale_amt_cy_ytd\n    ,sls.net_tkt_sale_amt_py\n    ,sls.net_tkt_sale_amt_2py\n    ,sls.net_tkt_sale_amt_py_ytd\n    ,sls.net_tkt_sale_amt_2py_ytd\n    ,sls.net_tkt_sale_amt_cy_l13p\n    ,sls.net_tkt_sale_amt_py_l13p\n    ,sls.net_tkt_sale_amt_cy_l4wk\n    ,sls.net_tkt_sale_amt_py_l4wk\n    ,sls.net_tkt_sale_amt_cy_l12wk\n    ,sls.net_tkt_sale_amt_py_l12wk\n    ,sls.net_tkt_sale_amt_cy_l26wk\n    ,sls.net_tkt_sale_amt_py_l26wk\n    ,sls.net_tkt_sale_amt_cy_l52wk\n    ,sls.net_tkt_sale_amt_py_l52wk\n    ,sls.net_tkt_sale_qty_cy_ytd\n    ,sls.net_tkt_sale_qty_py\n    ,sls.net_tkt_sale_qty_2py\n    ,sls.net_tkt_sale_qty_py_ytd\n    ,sls.net_tkt_sale_qty_2py_ytd\n    ,sls.net_tkt_sale_qty_cy_l13p\n    ,sls.net_tkt_sale_qty_py_l13p\n    ,sls.net_tkt_sale_qty_cy_l4wk\n    ,sls.net_tkt_sale_qty_py_l4wk\n    ,sls.net_tkt_sale_qty_cy_l12wk\n    ,sls.net_tkt_sale_qty_py_l12wk\n    ,sls.net_tkt_sale_qty_cy_l26wk\n    ,sls.net_tkt_sale_qty_py_l26wk\n    ,sls.net_tkt_sale_qty_cy_l52wk\n    ,sls.net_tkt_sale_qty_py_l52wk\n    ,sls.net_tkt_sale_wt_cy_ytd\n    ,sls.net_tkt_sale_wt_py\n    ,sls.net_tkt_sale_wt_2py\n    ,sls.net_tkt_sale_wt_py_ytd\n    ,sls.net_tkt_sale_wt_2py_ytd\n    ,sls.net_tkt_sale_wt_cy_l13p\n    ,sls.net_tkt_sale_wt_py_l13p\n    ,sls.net_tkt_sale_wt_cy_l4wk\n    ,sls.net_tkt_sale_wt_py_l4wk\n    ,sls.net_tkt_sale_wt_cy_l12wk\n    ,sls.net_tkt_sale_wt_py_l12wk\n    ,sls.net_tkt_sale_wt_cy_l26wk\n    ,sls.net_tkt_sale_wt_py_l26wk\n    ,sls.net_tkt_sale_wt_cy_l52wk\n    ,sls.net_tkt_sale_wt_py_l52wk\n    ,sls.am_promo_allow_amt_cy_ytd\n    ,sls.am_promo_allow_amt_py\n    ,sls.am_promo_allow_amt_2py\n    ,sls.am_promo_allow_amt_py_ytd\n    ,sls.am_promo_allow_amt_2py_ytd\n    ,sls.am_promo_allow_amt_cy_l13p\n    ,sls.am_promo_allow_amt_py_l13p\n    ,sls.am_promo_allow_amt_cy_l4wk\n    ,sls.am_promo_allow_amt_py_l4wk\n    ,sls.am_promo_allow_amt_cy_l12wk\n    ,sls.am_promo_allow_amt_py_l12wk\n    ,sls.am_promo_allow_amt_cy_l26wk\n    ,sls.am_promo_allow_amt_py_l26wk\n    ,sls.am_promo_allow_amt_cy_l52wk\n    ,sls.am_promo_allow_amt_py_l52wk\n    ,sls.am_promo_sale_amt_cy_ytd\n    ,sls.am_promo_sale_amt_py\n    ,sls.am_promo_sale_amt_2py\n    ,sls.am_promo_sale_amt_py_ytd\n    ,sls.am_promo_sale_amt_2py_ytd\n    ,sls.am_promo_sale_amt_cy_l13p\n    ,sls.am_promo_sale_amt_py_l13p\n    ,sls.am_promo_sale_amt_cy_l4wk\n    ,sls.am_promo_sale_amt_py_l4wk\n    ,sls.am_promo_sale_amt_cy_l12wk\n    ,sls.am_promo_sale_amt_py_l12wk\n    ,sls.am_promo_sale_amt_cy_l26wk\n    ,sls.am_promo_sale_amt_py_l26wk\n    ,sls.am_promo_sale_amt_cy_l52wk\n    ,sls.am_promo_sale_amt_py_l52wk\n    ,sls.am_promo_sale_qty_cy_ytd\n    ,sls.am_promo_sale_qty_py\n    ,sls.am_promo_sale_qty_2py\n    ,sls.am_promo_sale_qty_py_ytd\n    ,sls.am_promo_sale_qty_2py_ytd\n    ,sls.am_promo_sale_qty_cy_l13p\n    ,sls.am_promo_sale_qty_py_l13p\n    ,sls.am_promo_sale_qty_cy_l4wk\n    ,sls.am_promo_sale_qty_py_l4wk\n    ,sls.am_promo_sale_qty_cy_l12wk\n    ,sls.am_promo_sale_qty_py_l12wk\n    ,sls.am_promo_sale_qty_cy_l26wk\n    ,sls.am_promo_sale_qty_py_l26wk\n    ,sls.am_promo_sale_qty_cy_l52wk\n    ,sls.am_promo_sale_qty_py_l52wk\n    ,sls.full_revnu_sale_amt_cy_ytd\n    ,sls.full_revnu_sale_amt_py\n    ,sls.full_revnu_sale_amt_2py\n    ,sls.full_revnu_sale_amt_py_ytd\n    ,sls.full_revnu_sale_amt_2py_ytd\n    ,sls.full_revnu_sale_amt_cy_l13p\n    ,sls.full_revnu_sale_amt_py_l13p\n    ,sls.full_revnu_sale_amt_cy_l4wk\n    ,sls.full_revnu_sale_amt_py_l4wk\n    ,sls.full_revnu_sale_amt_cy_l12wk\n    ,sls.full_revnu_sale_amt_py_l12wk\n    ,sls.full_revnu_sale_amt_cy_l26wk\n    ,sls.full_revnu_sale_amt_py_l26wk\n    ,sls.full_revnu_sale_amt_cy_l52wk\n    ,sls.full_revnu_sale_amt_py_l52wk\n    ,sls.full_revnu_sale_qty_cy_ytd\n    ,sls.full_revnu_sale_qty_py\n    ,sls.full_revnu_sale_qty_2py\n    ,sls.full_revnu_sale_qty_py_ytd\n    ,sls.full_revnu_sale_qty_2py_ytd\n    ,sls.full_revnu_sale_qty_cy_l13p\n    ,sls.full_revnu_sale_qty_py_l13p\n    ,sls.full_revnu_sale_qty_cy_l4wk\n    ,sls.full_revnu_sale_qty_py_l4wk\n    ,sls.full_revnu_sale_qty_cy_l12wk\n    ,sls.full_revnu_sale_qty_py_l12wk\n    ,sls.full_revnu_sale_qty_cy_l26wk\n    ,sls.full_revnu_sale_qty_py_l26wk\n    ,sls.full_revnu_sale_qty_cy_l52wk\n    ,sls.full_revnu_sale_qty_py_l52wk\nfrom {{ ref('btg_fl_sales_cust_prod_v') }} sls\nleft join {{ ref('btg_fl_cust_v') }} cust on (cust.cust_nbr = sls.fl_cust_id)\nleft join {{ ref('btg_fl_prod_v') }} prod on (prod.prod_upc = sls.prod_upc and prod.prod_slbl = sls.prod_slbl)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_prod_invenid"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_invenid.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_invenid.sql", "name": "cm_btg_fl_sales_cust_prod_invenid", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_prod_invenid", "checksum": {"name": "sha256", "checksum": "67b8d6f176ef11ebbc12793e9c5e6b3761e1a03bf594aae7a1da38dbc5d408f2"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_prod_v"], ["btg_fl_cust_v"], ["btg_fl_prod_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_prod_upc": {"raw_sql": "select\n    sls.msa_id\n    ,sls.fl_cust_id\n    ,sls.upc_10\n    ,upper(sls.cust_name) as cust_name\n    ,upper(sls.address) as address\n    ,upper(sls.city) as city\n    ,upper(sls.state) as state\n    ,sls.zip5\n    ,sls.zip9\n    ,upper(sls.county) as county\n    ,sls.latitude\n    ,sls.longitude\n    ,upper(sls.division_id) as division_id\n    ,upper(sls.division) as division\n    ,upper(sls.region_id) as region_id\n    ,upper(sls.region) as region\n    ,upper(sls.zone_id) as zone_id\n    ,upper(sls.zone) as zone\n    ,upper(sls.district_id) as district_id\n    ,upper(sls.district) as district\n    ,sls.rt_nbr\n    ,upper(sls.trade_chanl_code) as trade_chanl_code\n    ,upper(sls.trade_chanl_descp) as trade_chanl_descp\n    ,upper(sls.chain_lvl1_node_nbr) as chain_lvl1_node_nbr\n    ,upper(sls.chain_lvl1_node_nm) as chain_lvl1_node_nm\n    ,upper(sls.chain_lvl2_node_nbr) as chain_lvl2_node_nbr\n    ,upper(sls.chain_lvl2_node_nm) as chain_lvl2_node_nm\n    ,upper(sls.chain_lvl3_node_nbr) as chain_lvl3_node_nbr\n    ,upper(sls.chain_lvl3_node_nm) as chain_lvl3_node_nm\n    ,upper(sls.chain_lvl4_node_nbr) as chain_lvl4_node_nbr\n    ,upper(sls.chain_lvl4_node_nm) as chain_lvl4_node_nm\n    ,upper(sls.categ_code) as categ_code\n    ,upper(sls.categ_descp) as categ_descp\n    ,upper(sls.bus_unit_code) as bus_unit_code\n    ,upper(sls.bus_unit_descp ) as bus_unit_descp\n    ,upper(sls.brand_code) as brand_code\n    ,upper(sls.brand_descp) as brand_descp\n    ,upper(sls.prod_tkt_descp_txt) as prod_tkt_descp_txt\n    ,upper(sls.bdc_descp) as bdc_descp\n    ,upper(sls.sale_class_code) as sale_class_code\n    ,upper(sls.sale_class_descp) as sale_class_descp\n    ,upper(sls.size_code) as size_code\n    ,upper(sls.size_descp) as size_descp\n    ,upper(sls.flvr_code) as flvr_code\n    ,upper(sls.flvr_descp) as flvr_descp\n    -- ,upper(sls.bus_unit_code_new) as bus_unit_code_new\n    -- ,upper(sls.bus_unit_descp_new) as bus_unit_descp_new\n    ,upper(sls.major_cat) as major_cat\n    -- ,upper(sls.major_cat_size) as major_cat_size\n    ,sum(sls.tkt_sale_amt_cy_ytd) as tkt_sale_amt_cy_ytd\n    ,sum(sls.tkt_sale_amt_py) as tkt_sale_amt_py\n    ,sum(sls.tkt_sale_amt_2py) as tkt_sale_amt_2py\n    ,sum(sls.tkt_sale_amt_py_ytd) as tkt_sale_amt_py_ytd\n    ,sum(sls.tkt_sale_amt_2py_ytd) as tkt_sale_amt_2py_ytd\n    ,sum(sls.tkt_sale_amt_cy_l13p) as tkt_sale_amt_cy_l13p\n    ,sum(sls.tkt_sale_amt_py_l13p) as tkt_sale_amt_py_l13p\n    ,sum(sls.tkt_sale_amt_cy_l4wk) as tkt_sale_amt_cy_l4wk\n    ,sum(sls.tkt_sale_amt_py_l4wk) as tkt_sale_amt_py_l4wk\n    ,sum(sls.tkt_sale_amt_cy_l12wk) as tkt_sale_amt_cy_l12wk\n    ,sum(sls.tkt_sale_amt_py_l12wk) as tkt_sale_amt_py_l12wk\n    ,sum(sls.tkt_sale_amt_cy_l26wk) as tkt_sale_amt_cy_l26wk\n    ,sum(sls.tkt_sale_amt_py_l26wk) as tkt_sale_amt_py_l26wk\n    ,sum(sls.tkt_sale_amt_cy_l52wk) as tkt_sale_amt_cy_l52wk\n    ,sum(sls.tkt_sale_amt_py_l52wk) as tkt_sale_amt_py_l52wk\n    ,sum(sls.tkt_sale_qty_cy_ytd) as tkt_sale_qty_cy_ytd\n    ,sum(sls.tkt_sale_qty_py) as tkt_sale_qty_py\n    ,sum(sls.tkt_sale_qty_2py) as tkt_sale_qty_2py\n    ,sum(sls.tkt_sale_qty_py_ytd) as tkt_sale_qty_py_ytd\n    ,sum(sls.tkt_sale_qty_2py_ytd) as tkt_sale_qty_2py_ytd\n    ,sum(sls.tkt_sale_qty_cy_l13p) as tkt_sale_qty_cy_l13p\n    ,sum(sls.tkt_sale_qty_py_l13p) as tkt_sale_qty_py_l13p\n    ,sum(sls.tkt_sale_qty_cy_l4wk) as tkt_sale_qty_cy_l4wk\n    ,sum(sls.tkt_sale_qty_py_l4wk) as tkt_sale_qty_py_l4wk\n    ,sum(sls.tkt_sale_qty_cy_l12wk) as tkt_sale_qty_cy_l12wk\n    ,sum(sls.tkt_sale_qty_py_l12wk) as tkt_sale_qty_py_l12wk\n    ,sum(sls.tkt_sale_qty_cy_l26wk) as tkt_sale_qty_cy_l26wk\n    ,sum(sls.tkt_sale_qty_py_l26wk) as tkt_sale_qty_py_l26wk\n    ,sum(sls.tkt_sale_qty_cy_l52wk) as tkt_sale_qty_cy_l52wk\n    ,sum(sls.tkt_sale_qty_py_l52wk) as tkt_sale_qty_py_l52wk\n    ,sum(sls.tkt_sale_wt_cy_ytd) as tkt_sale_wt_cy_ytd\n    ,sum(sls.tkt_sale_wt_py) as tkt_sale_wt_py\n    ,sum(sls.tkt_sale_wt_2py) as tkt_sale_wt_2py\n    ,sum(sls.tkt_sale_wt_py_ytd) as tkt_sale_wt_py_ytd\n    ,sum(sls.tkt_sale_wt_2py_ytd) as tkt_sale_wt_2py_ytd\n    ,sum(sls.tkt_sale_wt_cy_l13p) as tkt_sale_wt_cy_l13p\n    ,sum(sls.tkt_sale_wt_py_l13p) as tkt_sale_wt_py_l13p\n    ,sum(sls.tkt_sale_wt_cy_l4wk) as tkt_sale_wt_cy_l4wk\n    ,sum(sls.tkt_sale_wt_py_l4wk) as tkt_sale_wt_py_l4wk\n    ,sum(sls.tkt_sale_wt_cy_l12wk) as tkt_sale_wt_cy_l12wk\n    ,sum(sls.tkt_sale_wt_py_l12wk) as tkt_sale_wt_py_l12wk\n    ,sum(sls.tkt_sale_wt_cy_l26wk) as tkt_sale_wt_cy_l26wk\n    ,sum(sls.tkt_sale_wt_py_l26wk) as tkt_sale_wt_py_l26wk\n    ,sum(sls.tkt_sale_wt_cy_l52wk) as tkt_sale_wt_cy_l52wk\n    ,sum(sls.tkt_sale_wt_py_l52wk) as tkt_sale_wt_py_l52wk\n    ,sum(sls.gross_tkt_sale_amt_cy_ytd) as gross_tkt_sale_amt_cy_ytd\n    ,sum(sls.gross_tkt_sale_amt_py) as gross_tkt_sale_amt_py\n    ,sum(sls.gross_tkt_sale_amt_2py) as gross_tkt_sale_amt_2py\n    ,sum(sls.gross_tkt_sale_amt_py_ytd) as gross_tkt_sale_amt_py_ytd\n    ,sum(sls.gross_tkt_sale_amt_2py_ytd) as gross_tkt_sale_amt_2py_ytd\n    ,sum(sls.gross_tkt_sale_amt_cy_l13p) as gross_tkt_sale_amt_cy_l13p\n    ,sum(sls.gross_tkt_sale_amt_py_l13p) as gross_tkt_sale_amt_py_l13p\n    ,sum(sls.gross_tkt_sale_amt_cy_l4wk) as gross_tkt_sale_amt_cy_l4wk\n    ,sum(sls.gross_tkt_sale_amt_py_l4wk) as gross_tkt_sale_amt_py_l4wk\n    ,sum(sls.gross_tkt_sale_amt_cy_l12wk) as gross_tkt_sale_amt_cy_l12wk\n    ,sum(sls.gross_tkt_sale_amt_py_l12wk) as gross_tkt_sale_amt_py_l12wk\n    ,sum(sls.gross_tkt_sale_amt_cy_l26wk) as gross_tkt_sale_amt_cy_l26wk\n    ,sum(sls.gross_tkt_sale_amt_py_l26wk) as gross_tkt_sale_amt_py_l26wk\n    ,sum(sls.gross_tkt_sale_amt_cy_l52wk) as gross_tkt_sale_amt_cy_l52wk\n    ,sum(sls.gross_tkt_sale_amt_py_l52wk) as gross_tkt_sale_amt_py_l52wk\n    ,sum(sls.gross_tkt_sale_qty_cy_ytd) as gross_tkt_sale_qty_cy_ytd\n    ,sum(sls.gross_tkt_sale_qty_py) as gross_tkt_sale_qty_py\n    ,sum(sls.gross_tkt_sale_qty_2py) as gross_tkt_sale_qty_2py\n    ,sum(sls.gross_tkt_sale_qty_py_ytd) as gross_tkt_sale_qty_py_ytd\n    ,sum(sls.gross_tkt_sale_qty_2py_ytd) as gross_tkt_sale_qty_2py_ytd\n    ,sum(sls.gross_tkt_sale_qty_cy_l13p) as gross_tkt_sale_qty_cy_l13p\n    ,sum(sls.gross_tkt_sale_qty_py_l13p) as gross_tkt_sale_qty_py_l13p\n    ,sum(sls.gross_tkt_sale_qty_cy_l4wk) as gross_tkt_sale_qty_cy_l4wk\n    ,sum(sls.gross_tkt_sale_qty_py_l4wk) as gross_tkt_sale_qty_py_l4wk\n    ,sum(sls.gross_tkt_sale_qty_cy_l12wk) as gross_tkt_sale_qty_cy_l12wk\n    ,sum(sls.gross_tkt_sale_qty_py_l12wk) as gross_tkt_sale_qty_py_l12wk\n    ,sum(sls.gross_tkt_sale_qty_cy_l26wk) as gross_tkt_sale_qty_cy_l26wk\n    ,sum(sls.gross_tkt_sale_qty_py_l26wk) as gross_tkt_sale_qty_py_l26wk\n    ,sum(sls.gross_tkt_sale_qty_cy_l52wk) as gross_tkt_sale_qty_cy_l52wk\n    ,sum(sls.gross_tkt_sale_qty_py_l52wk) as gross_tkt_sale_qty_py_l52wk\n    ,sum(sls.gross_tkt_sale_wt_cy_ytd) as gross_tkt_sale_wt_cy_ytd\n    ,sum(sls.gross_tkt_sale_wt_py) as gross_tkt_sale_wt_py\n    ,sum(sls.gross_tkt_sale_wt_2py) as gross_tkt_sale_wt_2py\n    ,sum(sls.gross_tkt_sale_wt_py_ytd) as gross_tkt_sale_wt_py_ytd\n    ,sum(sls.gross_tkt_sale_wt_2py_ytd) as gross_tkt_sale_wt_2py_ytd\n    ,sum(sls.gross_tkt_sale_wt_cy_l13p) as gross_tkt_sale_wt_cy_l13p\n    ,sum(sls.gross_tkt_sale_wt_py_l13p) as gross_tkt_sale_wt_py_l13p\n    ,sum(sls.gross_tkt_sale_wt_cy_l4wk) as gross_tkt_sale_wt_cy_l4wk\n    ,sum(sls.gross_tkt_sale_wt_py_l4wk) as gross_tkt_sale_wt_py_l4wk\n    ,sum(sls.gross_tkt_sale_wt_cy_l12wk) as gross_tkt_sale_wt_cy_l12wk\n    ,sum(sls.gross_tkt_sale_wt_py_l12wk) as gross_tkt_sale_wt_py_l12wk\n    ,sum(sls.gross_tkt_sale_wt_cy_l26wk) as gross_tkt_sale_wt_cy_l26wk\n    ,sum(sls.gross_tkt_sale_wt_py_l26wk) as gross_tkt_sale_wt_py_l26wk\n    ,sum(sls.gross_tkt_sale_wt_cy_l52wk) as gross_tkt_sale_wt_cy_l52wk\n    ,sum(sls.gross_tkt_sale_wt_py_l52wk) as gross_tkt_sale_wt_py_l52wk\n    ,sum(sls.net_tkt_sale_amt_cy_ytd) as net_tkt_sale_amt_cy_ytd\n    ,sum(sls.net_tkt_sale_amt_py) as net_tkt_sale_amt_py\n    ,sum(sls.net_tkt_sale_amt_2py) as net_tkt_sale_amt_2py\n    ,sum(sls.net_tkt_sale_amt_py_ytd) as net_tkt_sale_amt_py_ytd\n    ,sum(sls.net_tkt_sale_amt_2py_ytd) as net_tkt_sale_amt_2py_ytd\n    ,sum(sls.net_tkt_sale_amt_cy_l13p) as net_tkt_sale_amt_cy_l13p\n    ,sum(sls.net_tkt_sale_amt_py_l13p) as net_tkt_sale_amt_py_l13p\n    ,sum(sls.net_tkt_sale_amt_cy_l4wk) as net_tkt_sale_amt_cy_l4wk\n    ,sum(sls.net_tkt_sale_amt_py_l4wk) as net_tkt_sale_amt_py_l4wk\n    ,sum(sls.net_tkt_sale_amt_cy_l12wk) as net_tkt_sale_amt_cy_l12wk\n    ,sum(sls.net_tkt_sale_amt_py_l12wk) as net_tkt_sale_amt_py_l12wk\n    ,sum(sls.net_tkt_sale_amt_cy_l26wk) as net_tkt_sale_amt_cy_l26wk\n    ,sum(sls.net_tkt_sale_amt_py_l26wk) as net_tkt_sale_amt_py_l26wk\n    ,sum(sls.net_tkt_sale_amt_cy_l52wk) as net_tkt_sale_amt_cy_l52wk\n    ,sum(sls.net_tkt_sale_amt_py_l52wk) as net_tkt_sale_amt_py_l52wk\n    ,sum(sls.net_tkt_sale_qty_cy_ytd) as net_tkt_sale_qty_cy_ytd\n    ,sum(sls.net_tkt_sale_qty_py) as net_tkt_sale_qty_py\n    ,sum(sls.net_tkt_sale_qty_2py) as net_tkt_sale_qty_2py\n    ,sum(sls.net_tkt_sale_qty_py_ytd) as net_tkt_sale_qty_py_ytd\n    ,sum(sls.net_tkt_sale_qty_2py_ytd) as net_tkt_sale_qty_2py_ytd\n    ,sum(sls.net_tkt_sale_qty_cy_l13p) as net_tkt_sale_qty_cy_l13p\n    ,sum(sls.net_tkt_sale_qty_py_l13p) as net_tkt_sale_qty_py_l13p\n    ,sum(sls.net_tkt_sale_qty_cy_l4wk) as net_tkt_sale_qty_cy_l4wk\n    ,sum(sls.net_tkt_sale_qty_py_l4wk) as net_tkt_sale_qty_py_l4wk\n    ,sum(sls.net_tkt_sale_qty_cy_l12wk) as net_tkt_sale_qty_cy_l12wk\n    ,sum(sls.net_tkt_sale_qty_py_l12wk) as net_tkt_sale_qty_py_l12wk\n    ,sum(sls.net_tkt_sale_qty_cy_l26wk) as net_tkt_sale_qty_cy_l26wk\n    ,sum(sls.net_tkt_sale_qty_py_l26wk) as net_tkt_sale_qty_py_l26wk\n    ,sum(sls.net_tkt_sale_qty_cy_l52wk) as net_tkt_sale_qty_cy_l52wk\n    ,sum(sls.net_tkt_sale_qty_py_l52wk) as net_tkt_sale_qty_py_l52wk\n    ,sum(sls.net_tkt_sale_wt_cy_ytd) as net_tkt_sale_wt_cy_ytd\n    ,sum(sls.net_tkt_sale_wt_py) as net_tkt_sale_wt_py\n    ,sum(sls.net_tkt_sale_wt_2py) as net_tkt_sale_wt_2py\n    ,sum(sls.net_tkt_sale_wt_py_ytd) as net_tkt_sale_wt_py_ytd\n    ,sum(sls.net_tkt_sale_wt_2py_ytd) as net_tkt_sale_wt_2py_ytd\n    ,sum(sls.net_tkt_sale_wt_cy_l13p) as net_tkt_sale_wt_cy_l13p\n    ,sum(sls.net_tkt_sale_wt_py_l13p) as net_tkt_sale_wt_py_l13p\n    ,sum(sls.net_tkt_sale_wt_cy_l4wk) as net_tkt_sale_wt_cy_l4wk\n    ,sum(sls.net_tkt_sale_wt_py_l4wk) as net_tkt_sale_wt_py_l4wk\n    ,sum(sls.net_tkt_sale_wt_cy_l12wk) as net_tkt_sale_wt_cy_l12wk\n    ,sum(sls.net_tkt_sale_wt_py_l12wk) as net_tkt_sale_wt_py_l12wk\n    ,sum(sls.net_tkt_sale_wt_cy_l26wk) as net_tkt_sale_wt_cy_l26wk\n    ,sum(sls.net_tkt_sale_wt_py_l26wk) as net_tkt_sale_wt_py_l26wk\n    ,sum(sls.net_tkt_sale_wt_cy_l52wk) as net_tkt_sale_wt_cy_l52wk\n    ,sum(sls.net_tkt_sale_wt_py_l52wk) as net_tkt_sale_wt_py_l52wk\n    ,sum(sls.am_promo_allow_amt_cy_ytd) as am_promo_allow_amt_cy_ytd\n    ,sum(sls.am_promo_allow_amt_py) as am_promo_allow_amt_py\n    ,sum(sls.am_promo_allow_amt_2py) as am_promo_allow_amt_2py\n    ,sum(sls.am_promo_allow_amt_py_ytd) as am_promo_allow_amt_py_ytd\n    ,sum(sls.am_promo_allow_amt_2py_ytd) as am_promo_allow_amt_2py_ytd\n    ,sum(sls.am_promo_allow_amt_cy_l13p) as am_promo_allow_amt_cy_l13p\n    ,sum(sls.am_promo_allow_amt_py_l13p) as am_promo_allow_amt_py_l13p\n    ,sum(sls.am_promo_allow_amt_cy_l4wk) as am_promo_allow_amt_cy_l4wk\n    ,sum(sls.am_promo_allow_amt_py_l4wk) as am_promo_allow_amt_py_l4wk\n    ,sum(sls.am_promo_allow_amt_cy_l12wk) as am_promo_allow_amt_cy_l12wk\n    ,sum(sls.am_promo_allow_amt_py_l12wk) as am_promo_allow_amt_py_l12wk\n    ,sum(sls.am_promo_allow_amt_cy_l26wk) as am_promo_allow_amt_cy_l26wk\n    ,sum(sls.am_promo_allow_amt_py_l26wk) as am_promo_allow_amt_py_l26wk\n    ,sum(sls.am_promo_allow_amt_cy_l52wk) as am_promo_allow_amt_cy_l52wk\n    ,sum(sls.am_promo_allow_amt_py_l52wk) as am_promo_allow_amt_py_l52wk\n    ,sum(sls.am_promo_sale_amt_cy_ytd) as am_promo_sale_amt_cy_ytd\n    ,sum(sls.am_promo_sale_amt_py) as am_promo_sale_amt_py\n    ,sum(sls.am_promo_sale_amt_2py) as am_promo_sale_amt_2py\n    ,sum(sls.am_promo_sale_amt_py_ytd) as am_promo_sale_amt_py_ytd\n    ,sum(sls.am_promo_sale_amt_2py_ytd) as am_promo_sale_amt_2py_ytd\n    ,sum(sls.am_promo_sale_amt_cy_l13p) as am_promo_sale_amt_cy_l13p\n    ,sum(sls.am_promo_sale_amt_py_l13p) as am_promo_sale_amt_py_l13p\n    ,sum(sls.am_promo_sale_amt_cy_l4wk) as am_promo_sale_amt_cy_l4wk\n    ,sum(sls.am_promo_sale_amt_py_l4wk) as am_promo_sale_amt_py_l4wk\n    ,sum(sls.am_promo_sale_amt_cy_l12wk) as am_promo_sale_amt_cy_l12wk\n    ,sum(sls.am_promo_sale_amt_py_l12wk) as am_promo_sale_amt_py_l12wk\n    ,sum(sls.am_promo_sale_amt_cy_l26wk) as am_promo_sale_amt_cy_l26wk\n    ,sum(sls.am_promo_sale_amt_py_l26wk) as am_promo_sale_amt_py_l26wk\n    ,sum(sls.am_promo_sale_amt_cy_l52wk) as am_promo_sale_amt_cy_l52wk\n    ,sum(sls.am_promo_sale_amt_py_l52wk) as am_promo_sale_amt_py_l52wk\n    ,sum(sls.am_promo_sale_qty_cy_ytd) as am_promo_sale_qty_cy_ytd\n    ,sum(sls.am_promo_sale_qty_py) as am_promo_sale_qty_py\n    ,sum(sls.am_promo_sale_qty_2py) as am_promo_sale_qty_2py\n    ,sum(sls.am_promo_sale_qty_py_ytd) as am_promo_sale_qty_py_ytd\n    ,sum(sls.am_promo_sale_qty_2py_ytd) as am_promo_sale_qty_2py_ytd\n    ,sum(sls.am_promo_sale_qty_cy_l13p) as am_promo_sale_qty_cy_l13p\n    ,sum(sls.am_promo_sale_qty_py_l13p) as am_promo_sale_qty_py_l13p\n    ,sum(sls.am_promo_sale_qty_cy_l4wk) as am_promo_sale_qty_cy_l4wk\n    ,sum(sls.am_promo_sale_qty_py_l4wk) as am_promo_sale_qty_py_l4wk\n    ,sum(sls.am_promo_sale_qty_cy_l12wk) as am_promo_sale_qty_cy_l12wk\n    ,sum(sls.am_promo_sale_qty_py_l12wk) as am_promo_sale_qty_py_l12wk\n    ,sum(sls.am_promo_sale_qty_cy_l26wk) as am_promo_sale_qty_cy_l26wk\n    ,sum(sls.am_promo_sale_qty_py_l26wk) as am_promo_sale_qty_py_l26wk\n    ,sum(sls.am_promo_sale_qty_cy_l52wk) as am_promo_sale_qty_cy_l52wk\n    ,sum(sls.am_promo_sale_qty_py_l52wk) as am_promo_sale_qty_py_l52wk\n    ,sum(sls.full_revnu_sale_amt_cy_ytd) as full_revnu_sale_amt_cy_ytd\n    ,sum(sls.full_revnu_sale_amt_py) as full_revnu_sale_amt_py\n    ,sum(sls.full_revnu_sale_amt_2py) as full_revnu_sale_amt_2py\n    ,sum(sls.full_revnu_sale_amt_py_ytd) as full_revnu_sale_amt_py_ytd\n    ,sum(sls.full_revnu_sale_amt_2py_ytd) as full_revnu_sale_amt_2py_ytd\n    ,sum(sls.full_revnu_sale_amt_cy_l13p) as full_revnu_sale_amt_cy_l13p\n    ,sum(sls.full_revnu_sale_amt_py_l13p) as full_revnu_sale_amt_py_l13p\n    ,sum(sls.full_revnu_sale_amt_cy_l4wk) as full_revnu_sale_amt_cy_l4wk\n    ,sum(sls.full_revnu_sale_amt_py_l4wk) as full_revnu_sale_amt_py_l4wk\n    ,sum(sls.full_revnu_sale_amt_cy_l12wk) as full_revnu_sale_amt_cy_l12wk\n    ,sum(sls.full_revnu_sale_amt_py_l12wk) as full_revnu_sale_amt_py_l12wk\n    ,sum(sls.full_revnu_sale_amt_cy_l26wk) as full_revnu_sale_amt_cy_l26wk\n    ,sum(sls.full_revnu_sale_amt_py_l26wk) as full_revnu_sale_amt_py_l26wk\n    ,sum(sls.full_revnu_sale_amt_cy_l52wk) as full_revnu_sale_amt_cy_l52wk\n    ,sum(sls.full_revnu_sale_amt_py_l52wk) as full_revnu_sale_amt_py_l52wk\n    ,sum(sls.full_revnu_sale_qty_cy_ytd) as full_revnu_sale_qty_cy_ytd\n    ,sum(sls.full_revnu_sale_qty_py) as full_revnu_sale_qty_py\n    ,sum(sls.full_revnu_sale_qty_2py) as full_revnu_sale_qty_2py\n    ,sum(sls.full_revnu_sale_qty_py_ytd) as full_revnu_sale_qty_py_ytd\n    ,sum(sls.full_revnu_sale_qty_2py_ytd) as full_revnu_sale_qty_2py_ytd\n    ,sum(sls.full_revnu_sale_qty_cy_l13p) as full_revnu_sale_qty_cy_l13p\n    ,sum(sls.full_revnu_sale_qty_py_l13p) as full_revnu_sale_qty_py_l13p\n    ,sum(sls.full_revnu_sale_qty_cy_l4wk) as full_revnu_sale_qty_cy_l4wk\n    ,sum(sls.full_revnu_sale_qty_py_l4wk) as full_revnu_sale_qty_py_l4wk\n    ,sum(sls.full_revnu_sale_qty_cy_l12wk) as full_revnu_sale_qty_cy_l12wk\n    ,sum(sls.full_revnu_sale_qty_py_l12wk) as full_revnu_sale_qty_py_l12wk\n    ,sum(sls.full_revnu_sale_qty_cy_l26wk) as full_revnu_sale_qty_cy_l26wk\n    ,sum(sls.full_revnu_sale_qty_py_l26wk) as full_revnu_sale_qty_py_l26wk\n    ,sum(sls.full_revnu_sale_qty_cy_l52wk) as full_revnu_sale_qty_cy_l52wk\n    ,sum(sls.full_revnu_sale_qty_py_l52wk) as full_revnu_sale_qty_py_l52wk\nfrom {{ ref('cm_stage_btg_fl_sales_cust_prod_upc') }} sls\ngroup by\n    sls.msa_id\n    ,sls.fl_cust_id\n    ,sls.upc_10\n    ,sls.cust_name\n    ,sls.address\n    ,sls.city\n    ,sls.state\n    ,sls.zip5\n    ,sls.zip9\n    ,sls.county\n    ,sls.latitude\n    ,sls.longitude\n    ,sls.division_id\n    ,sls.division\n    ,sls.region_id\n    ,sls.region\n    ,sls.zone_id\n    ,sls.zone\n    ,sls.district_id\n    ,sls.district\n    ,sls.rt_nbr\n    ,sls.trade_chanl_code\n    ,sls.trade_chanl_descp\n    ,sls.chain_lvl1_node_nbr\n    ,sls.chain_lvl1_node_nm\n    ,sls.chain_lvl2_node_nbr\n    ,sls.chain_lvl2_node_nm\n    ,sls.chain_lvl3_node_nbr\n    ,sls.chain_lvl3_node_nm\n    ,sls.chain_lvl4_node_nbr\n    ,sls.chain_lvl4_node_nm\n    ,sls.categ_code\n    ,sls.categ_descp\n    ,sls.bus_unit_code\n    ,sls.bus_unit_descp\n    ,sls.brand_code\n    ,sls.brand_descp\n    ,sls.prod_tkt_descp_txt\n    ,sls.bdc_descp\n    ,sls.sale_class_code\n    ,sls.sale_class_descp\n    ,sls.size_code\n    ,sls.size_descp\n    ,sls.flvr_code\n    ,sls.flvr_descp\n    -- ,sls.bus_unit_code_new\n    -- ,sls.bus_unit_descp_new\n    ,sls.major_cat\n    -- ,sls.major_cat_size", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_prod_upc"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_upc.sql", "name": "cm_btg_fl_sales_cust_prod_upc", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_prod_upc", "checksum": {"name": "sha256", "checksum": "54149812a4b0d83633a6225c4ad8999daee93cb1187096caf307f65727759a5f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_stage_btg_fl_sales_cust_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_prod_v": {"raw_sql": "with tdlinx1 as (\n    select \n        upper(td.aulname) as aulname\n        ,upper(td.sgrpnm) as sgrpnm\n        ,upper(td.sname) as sname\n        -- ,upper(sno) as sno   -- TODO: This field requires attention\n        ,null as sno\n        ,upper(td.sstreetadd) as sstreetadd\n        ,upper(td.scity) as scity\n        ,upper(td.sst) as sst\n        ,substr(td.szip,1,5) as szip\n        ,upper(td.mcountynm) as mcountynm\n        ,td.fips\n        ,upper(td.stradeclcd) as stradeclcd\n        ,upper(td.sformatcd) as sformatcd\n        ,upper(td.stradecldesc) as stradecldesc\n        ,upper(td.sformatdesc) as sformatdesc\n        ,upper(td.sstatusind) as sstatusind\n        ,upper(td.stdlinxscd) as stdlinxscd\n        ,td.slat\n        ,td.slong\n        ,td.msa_id as tdl_msa_id\n        ,upper(rma.iri_retailer) as iri_retailer\n        ,upper(rma.iri_rma1) as iri_rma1\n        ,upper(rma.iri_rma2) as iri_rma2\n        ,upper(rma.iri_rma3) as iri_rma3\n        ,upper(rma.iri_rma4) as iri_rma4\n        ,upper(rma.iri_rma5) as iri_rma5\n        ,upper(rma.iri_rma6) as iri_rma6\n        ,upper(rma.iri_rma7) as iri_rma7\n        ,upper(rma.iri_rma8) as iri_rma8\n        ,upper(rma.iri_rma9) as iri_rma9\n        ,case \n            when upper(rma.iri_rma1) like '%-rma%' then 'rma'\n            when upper(rma.iri_rma1) like '%-srma%' then 'srma'\n            -- else 'na'\n        end as rma_srma\n        ,case \n            when srma.tdlinx_id is null then 'n' \n            else 'y'\n        end as corporate_srma\n        --,fi.fips as fips_iri\n        ,upper(fi.iri_pbc_div) as iri_pbc_div\n        ,upper(fi.iri_pbc_mkt) as iri_pbc_mkt\n        -- ,zip.zip_code as zip_code_zipfile \n        -- ,upper(zip.division) as division_zipfile\n        -- ,upper(zip.owner_name) as owner_name_zipfile\n        ,upper(zip.pbc_fbu_flg) as pbc_fbu_flg\n        -- ,upper(zip.market) as market_zipfile\n    from {{ ref('msa_tdlinx_xref_final') }} td\n    left join {{ ref('iri_rma_store_list') }} rma on (td.stdlinxscd = rma.tdlinx_id)\n    left join {{ ref('iri_srma_sample_stores') }} srma on (td.stdlinxscd = srma.tdlinx_id)\n    left join {{ ref('iri_pbc_markets_divs_by_fips') }} fi on (fi.fips = td.fips)\n    left join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(td.szip),0,5))\n)\n,sls as (\n  select\n        s1.*\n        ,upper(z1.pbc_fbu_flg) as pbc_fbu_flg\n  from {{ ref('cm_btg_fl_sales_cust_prod_upc') }} s1\n  left join {{ ref('zip_code_priority_report') }} z1 on (substr(trim(z1.zip_code),0,5) = substr(trim(s1.zip5),0,5))    \n)\nselect \n    concat(\n         coalesce(tdlinx1.sstatusind,'null'), '|'\n        ,coalesce(sls.msa_id,'null'), '|'\n        ,coalesce(tdlinx1.iri_retailer,'null'), '|'\n        ,coalesce(tdlinx1.aulname,'null'), '|'\n        ,coalesce(tdlinx1.sgrpnm,'null'), '|'\n        ,coalesce(tdlinx1.stradeclcd,'null'), '|'\n        ,coalesce(tdlinx1.sformatcd,'null'), '|'\n        ,coalesce(sls.division,'null'), '|'\n        ,coalesce(sls.region,'null'), '|'\n        ,coalesce(sls.chain_lvl1_node_nbr,'null'), '|'\n        ,coalesce(sls.categ_code,'null'), '|'\n        ,coalesce(sls.sale_class_code,'null'), '|'\n        ,coalesce(sls.major_cat,'null'), '|'\n        ,coalesce(sls.trade_chanl_code,'null'), '|'\n        ,coalesce(sls.brand_code,'null')\n    ) as fl_concat\n    ,tdlinx1.aulname\n    ,tdlinx1.sgrpnm\n    ,tdlinx1.sname\n    -- ,tdlinx1.sno  -- TODO: this field requires attention\n    ,null as sno\n    -- ,tdlinx1.sstreetadd\n    -- ,tdlinx1.scity\n    -- ,tdlinx1.sst\n    -- ,tdlinx1.szip\n    -- ,tdlinx1.mcountynm\n    ,tdlinx1.fips\n    ,tdlinx1.stradeclcd\n    ,tdlinx1.sformatcd\n    ,tdlinx1.stradecldesc\n    ,tdlinx1.sformatdesc\n    ,tdlinx1.sstatusind\n    ,tdlinx1.stdlinxscd\n    ,tdlinx1.slat\n    ,tdlinx1.slong\n    ,tdlinx1.tdl_msa_id\n    ,tdlinx1.iri_retailer\n    ,tdlinx1.iri_rma1\n    ,tdlinx1.iri_rma2\n    ,tdlinx1.iri_rma3\n    ,tdlinx1.iri_rma4\n    ,tdlinx1.iri_rma5\n    ,tdlinx1.iri_rma6\n    ,tdlinx1.iri_rma7\n    ,tdlinx1.iri_rma8\n    ,tdlinx1.iri_rma9\n    ,tdlinx1.rma_srma\n    ,tdlinx1.corporate_srma\n    ,tdlinx1.iri_pbc_div\n    ,tdlinx1.iri_pbc_mkt\n    ,coalesce(tdlinx1.pbc_fbu_flg,sls.pbc_fbu_flg) as pbc_fbu_flg\n    ,sls.msa_id\n    ,sls.fl_cust_id\n    ,sls.upc_10\n    ,sls.cust_name\n    ,coalesce(tdlinx1.sstreetadd,sls.address) as address\n    ,coalesce(tdlinx1.scity,sls.city) as city\n    ,coalesce(tdlinx1.sst,sls.state) as state\n    ,coalesce(tdlinx1.szip,sls.zip5) as zip5\n    ,sls.zip9\n    ,coalesce(tdlinx1.mcountynm,sls.county) as county\n    ,sls.latitude\n    ,sls.longitude\n    ,sls.division_id\n    ,sls.division\n    ,sls.region_id\n    ,sls.region\n    ,sls.zone_id\n    ,sls.zone\n    ,sls.district_id\n    ,sls.district\n    ,sls.rt_nbr\n    ,sls.trade_chanl_code\n    ,sls.trade_chanl_descp\n    ,sls.chain_lvl1_node_nbr\n    ,sls.chain_lvl1_node_nm\n    ,sls.chain_lvl2_node_nbr\n    ,sls.chain_lvl2_node_nm\n    ,sls.chain_lvl3_node_nbr\n    ,sls.chain_lvl3_node_nm\n    ,sls.chain_lvl4_node_nbr\n    ,sls.chain_lvl4_node_nm\n    ,sls.categ_code\n    ,sls.categ_descp\n    ,sls.bus_unit_code\n    ,sls.bus_unit_descp \n    ,sls.brand_code\n    ,sls.brand_descp\n    ,sls.prod_tkt_descp_txt\n    ,sls.bdc_descp\n    ,sls.sale_class_code\n    ,sls.sale_class_descp\n    ,sls.size_code\n    ,sls.size_descp\n    ,sls.flvr_code\n    ,sls.flvr_descp\n    -- ,bus_unit_code_new\n    -- ,bus_unit_descp_new\n    ,sls.major_cat\n    -- ,major_cat_size\n    ,sls.tkt_sale_amt_cy_ytd\n    ,sls.tkt_sale_amt_py\n    ,sls.tkt_sale_amt_2py\n    ,sls.tkt_sale_amt_py_ytd\n    ,sls.tkt_sale_amt_2py_ytd\n    ,sls.tkt_sale_amt_cy_l13p\n    ,sls.tkt_sale_amt_py_l13p\n    ,sls.tkt_sale_amt_cy_l4wk\n    ,sls.tkt_sale_amt_py_l4wk\n    ,sls.tkt_sale_amt_cy_l12wk\n    ,sls.tkt_sale_amt_py_l12wk\n    ,sls.tkt_sale_amt_cy_l26wk\n    ,sls.tkt_sale_amt_py_l26wk\n    ,sls.tkt_sale_amt_cy_l52wk\n    ,sls.tkt_sale_amt_py_l52wk\n    ,sls.tkt_sale_qty_cy_ytd\n    ,sls.tkt_sale_qty_py\n    ,sls.tkt_sale_qty_2py\n    ,sls.tkt_sale_qty_py_ytd\n    ,sls.tkt_sale_qty_2py_ytd\n    ,sls.tkt_sale_qty_cy_l13p\n    ,sls.tkt_sale_qty_py_l13p\n    ,sls.tkt_sale_qty_cy_l4wk\n    ,sls.tkt_sale_qty_py_l4wk\n    ,sls.tkt_sale_qty_cy_l12wk\n    ,sls.tkt_sale_qty_py_l12wk\n    ,sls.tkt_sale_qty_cy_l26wk\n    ,sls.tkt_sale_qty_py_l26wk\n    ,sls.tkt_sale_qty_cy_l52wk\n    ,sls.tkt_sale_qty_py_l52wk\n    ,sls.tkt_sale_wt_cy_ytd\n    ,sls.tkt_sale_wt_py\n    ,sls.tkt_sale_wt_2py\n    ,sls.tkt_sale_wt_py_ytd\n    ,sls.tkt_sale_wt_2py_ytd\n    ,sls.tkt_sale_wt_cy_l13p\n    ,sls.tkt_sale_wt_py_l13p\n    ,sls.tkt_sale_wt_cy_l4wk\n    ,sls.tkt_sale_wt_py_l4wk\n    ,sls.tkt_sale_wt_cy_l12wk\n    ,sls.tkt_sale_wt_py_l12wk\n    ,sls.tkt_sale_wt_cy_l26wk\n    ,sls.tkt_sale_wt_py_l26wk\n    ,sls.tkt_sale_wt_cy_l52wk\n    ,sls.tkt_sale_wt_py_l52wk\n    ,sls.gross_tkt_sale_amt_cy_ytd\n    ,sls.gross_tkt_sale_amt_py\n    ,sls.gross_tkt_sale_amt_2py\n    ,sls.gross_tkt_sale_amt_py_ytd\n    ,sls.gross_tkt_sale_amt_2py_ytd\n    ,sls.gross_tkt_sale_amt_cy_l13p\n    ,sls.gross_tkt_sale_amt_py_l13p\n    ,sls.gross_tkt_sale_amt_cy_l4wk\n    ,sls.gross_tkt_sale_amt_py_l4wk\n    ,sls.gross_tkt_sale_amt_cy_l12wk\n    ,sls.gross_tkt_sale_amt_py_l12wk\n    ,sls.gross_tkt_sale_amt_cy_l26wk\n    ,sls.gross_tkt_sale_amt_py_l26wk\n    ,sls.gross_tkt_sale_amt_cy_l52wk\n    ,sls.gross_tkt_sale_amt_py_l52wk\n    ,sls.gross_tkt_sale_qty_cy_ytd\n    ,sls.gross_tkt_sale_qty_py\n    ,sls.gross_tkt_sale_qty_2py\n    ,sls.gross_tkt_sale_qty_py_ytd\n    ,sls.gross_tkt_sale_qty_2py_ytd\n    ,sls.gross_tkt_sale_qty_cy_l13p\n    ,sls.gross_tkt_sale_qty_py_l13p\n    ,sls.gross_tkt_sale_qty_cy_l4wk\n    ,sls.gross_tkt_sale_qty_py_l4wk\n    ,sls.gross_tkt_sale_qty_cy_l12wk\n    ,sls.gross_tkt_sale_qty_py_l12wk\n    ,sls.gross_tkt_sale_qty_cy_l26wk\n    ,sls.gross_tkt_sale_qty_py_l26wk\n    ,sls.gross_tkt_sale_qty_cy_l52wk\n    ,sls.gross_tkt_sale_qty_py_l52wk\n    ,sls.gross_tkt_sale_wt_cy_ytd\n    ,sls.gross_tkt_sale_wt_py\n    ,sls.gross_tkt_sale_wt_2py\n    ,sls.gross_tkt_sale_wt_py_ytd\n    ,sls.gross_tkt_sale_wt_2py_ytd\n    ,sls.gross_tkt_sale_wt_cy_l13p\n    ,sls.gross_tkt_sale_wt_py_l13p\n    ,sls.gross_tkt_sale_wt_cy_l4wk\n    ,sls.gross_tkt_sale_wt_py_l4wk\n    ,sls.gross_tkt_sale_wt_cy_l12wk\n    ,sls.gross_tkt_sale_wt_py_l12wk\n    ,sls.gross_tkt_sale_wt_cy_l26wk\n    ,sls.gross_tkt_sale_wt_py_l26wk\n    ,sls.gross_tkt_sale_wt_cy_l52wk\n    ,sls.gross_tkt_sale_wt_py_l52wk\n    ,sls.net_tkt_sale_amt_cy_ytd\n    ,sls.net_tkt_sale_amt_py\n    ,sls.net_tkt_sale_amt_2py\n    ,sls.net_tkt_sale_amt_py_ytd\n    ,sls.net_tkt_sale_amt_2py_ytd\n    ,sls.net_tkt_sale_amt_cy_l13p\n    ,sls.net_tkt_sale_amt_py_l13p\n    ,sls.net_tkt_sale_amt_cy_l4wk\n    ,sls.net_tkt_sale_amt_py_l4wk\n    ,sls.net_tkt_sale_amt_cy_l12wk\n    ,sls.net_tkt_sale_amt_py_l12wk\n    ,sls.net_tkt_sale_amt_cy_l26wk\n    ,sls.net_tkt_sale_amt_py_l26wk\n    ,sls.net_tkt_sale_amt_cy_l52wk\n    ,sls.net_tkt_sale_amt_py_l52wk\n    ,sls.net_tkt_sale_qty_cy_ytd\n    ,sls.net_tkt_sale_qty_py\n    ,sls.net_tkt_sale_qty_2py\n    ,sls.net_tkt_sale_qty_py_ytd\n    ,sls.net_tkt_sale_qty_2py_ytd\n    ,sls.net_tkt_sale_qty_cy_l13p\n    ,sls.net_tkt_sale_qty_py_l13p\n    ,sls.net_tkt_sale_qty_cy_l4wk\n    ,sls.net_tkt_sale_qty_py_l4wk\n    ,sls.net_tkt_sale_qty_cy_l12wk\n    ,sls.net_tkt_sale_qty_py_l12wk\n    ,sls.net_tkt_sale_qty_cy_l26wk\n    ,sls.net_tkt_sale_qty_py_l26wk\n    ,sls.net_tkt_sale_qty_cy_l52wk\n    ,sls.net_tkt_sale_qty_py_l52wk\n    ,sls.net_tkt_sale_wt_cy_ytd\n    ,sls.net_tkt_sale_wt_py\n    ,sls.net_tkt_sale_wt_2py\n    ,sls.net_tkt_sale_wt_py_ytd\n    ,sls.net_tkt_sale_wt_2py_ytd\n    ,sls.net_tkt_sale_wt_cy_l13p\n    ,sls.net_tkt_sale_wt_py_l13p\n    ,sls.net_tkt_sale_wt_cy_l4wk\n    ,sls.net_tkt_sale_wt_py_l4wk\n    ,sls.net_tkt_sale_wt_cy_l12wk\n    ,sls.net_tkt_sale_wt_py_l12wk\n    ,sls.net_tkt_sale_wt_cy_l26wk\n    ,sls.net_tkt_sale_wt_py_l26wk\n    ,sls.net_tkt_sale_wt_cy_l52wk\n    ,sls.net_tkt_sale_wt_py_l52wk\n    ,sls.am_promo_allow_amt_cy_ytd\n    ,sls.am_promo_allow_amt_py\n    ,sls.am_promo_allow_amt_2py\n    ,sls.am_promo_allow_amt_py_ytd\n    ,sls.am_promo_allow_amt_2py_ytd\n    ,sls.am_promo_allow_amt_cy_l13p\n    ,sls.am_promo_allow_amt_py_l13p\n    ,sls.am_promo_allow_amt_cy_l4wk\n    ,sls.am_promo_allow_amt_py_l4wk\n    ,sls.am_promo_allow_amt_cy_l12wk\n    ,sls.am_promo_allow_amt_py_l12wk\n    ,sls.am_promo_allow_amt_cy_l26wk\n    ,sls.am_promo_allow_amt_py_l26wk\n    ,sls.am_promo_allow_amt_cy_l52wk\n    ,sls.am_promo_allow_amt_py_l52wk\n    ,sls.am_promo_sale_amt_cy_ytd\n    ,sls.am_promo_sale_amt_py\n    ,sls.am_promo_sale_amt_2py\n    ,sls.am_promo_sale_amt_py_ytd\n    ,sls.am_promo_sale_amt_2py_ytd\n    ,sls.am_promo_sale_amt_cy_l13p\n    ,sls.am_promo_sale_amt_py_l13p\n    ,sls.am_promo_sale_amt_cy_l4wk\n    ,sls.am_promo_sale_amt_py_l4wk\n    ,sls.am_promo_sale_amt_cy_l12wk\n    ,sls.am_promo_sale_amt_py_l12wk\n    ,sls.am_promo_sale_amt_cy_l26wk\n    ,sls.am_promo_sale_amt_py_l26wk\n    ,sls.am_promo_sale_amt_cy_l52wk\n    ,sls.am_promo_sale_amt_py_l52wk\n    ,sls.am_promo_sale_qty_cy_ytd\n    ,sls.am_promo_sale_qty_py\n    ,sls.am_promo_sale_qty_2py\n    ,sls.am_promo_sale_qty_py_ytd\n    ,sls.am_promo_sale_qty_2py_ytd\n    ,sls.am_promo_sale_qty_cy_l13p\n    ,sls.am_promo_sale_qty_py_l13p\n    ,sls.am_promo_sale_qty_cy_l4wk\n    ,sls.am_promo_sale_qty_py_l4wk\n    ,sls.am_promo_sale_qty_cy_l12wk\n    ,sls.am_promo_sale_qty_py_l12wk\n    ,sls.am_promo_sale_qty_cy_l26wk\n    ,sls.am_promo_sale_qty_py_l26wk\n    ,sls.am_promo_sale_qty_cy_l52wk\n    ,sls.am_promo_sale_qty_py_l52wk\n    ,sls.full_revnu_sale_amt_cy_ytd\n    ,sls.full_revnu_sale_amt_py\n    ,sls.full_revnu_sale_amt_2py\n    ,sls.full_revnu_sale_amt_py_ytd\n    ,sls.full_revnu_sale_amt_2py_ytd\n    ,sls.full_revnu_sale_amt_cy_l13p\n    ,sls.full_revnu_sale_amt_py_l13p\n    ,sls.full_revnu_sale_amt_cy_l4wk\n    ,sls.full_revnu_sale_amt_py_l4wk\n    ,sls.full_revnu_sale_amt_cy_l12wk\n    ,sls.full_revnu_sale_amt_py_l12wk\n    ,sls.full_revnu_sale_amt_cy_l26wk\n    ,sls.full_revnu_sale_amt_py_l26wk\n    ,sls.full_revnu_sale_amt_cy_l52wk\n    ,sls.full_revnu_sale_amt_py_l52wk\n    ,sls.full_revnu_sale_qty_cy_ytd\n    ,sls.full_revnu_sale_qty_py\n    ,sls.full_revnu_sale_qty_2py\n    ,sls.full_revnu_sale_qty_py_ytd\n    ,sls.full_revnu_sale_qty_2py_ytd\n    ,sls.full_revnu_sale_qty_cy_l13p\n    ,sls.full_revnu_sale_qty_py_l13p\n    ,sls.full_revnu_sale_qty_cy_l4wk\n    ,sls.full_revnu_sale_qty_py_l4wk\n    ,sls.full_revnu_sale_qty_cy_l12wk\n    ,sls.full_revnu_sale_qty_py_l12wk\n    ,sls.full_revnu_sale_qty_cy_l26wk\n    ,sls.full_revnu_sale_qty_py_l26wk\n    ,sls.full_revnu_sale_qty_cy_l52wk\n    ,sls.full_revnu_sale_qty_py_l52wk\n    ,current_timestamp() as last_updt_dt\nfrom tdlinx1\nfull join sls on (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_prod_v"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_prod_v.sql", "name": "cm_btg_fl_sales_cust_prod_v", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_prod_v", "checksum": {"name": "sha256", "checksum": "da51d4e18ef0b2731fbbbd1404256d1ea401f9950603ab7defd4309e22639089"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_fl_sales_cust_prod_upc"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_fl_sales_cust_prod_upc", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid": {"raw_sql": "-- Load cm_btg_fl_sales_cust_wk_prod_invenid\n\n-- {{ ref('btg_fl_sales_cust_wk_prod_v') }}\n-- {{ ref('btg_fl_cust_v') }}\n-- {{ ref('btg_fl_prod_v') }}\n\nSELECT\n    sls.msa_id,\n\tsls.fl_cust_id,\n\tsls.prod_upc,\n\tsls.prod_slbl,\n\tCONCAT(RIGHT(prod.upc_mfg_id, 5), RIGHT(CONCAT('0000', prod.prod_upc), 5)) AS UPC_10,\n\tsls.fscl_wk_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.fscl_wk_in_pd_num --cust attributes\n\t,\n\tcust.cust_nm AS cust_name,\n    cust.phy_loc_str_addr1 AS address,\n    cust.phy_loc_city AS city,\n    cust.phy_loc_st_prov AS state,\n    cust.phy_loc_post_code_zip5 AS zip5,\n    cust.phy_loc_post_code AS zip9,\n    cust.phy_loc_cnty_sburb AS county,\n    cust.lat_code AS latitude,\n    cust.lon_code AS longitude,\n    cust.geo_lvl1_node_nbr AS division_id,\n    cust.geo_lvl1_node_nm AS division,\n    cust.geo_lvl2_node_nbr AS region_id,\n    cust.geo_lvl2_node_nm AS region,\n    cust.geo_lvl3_node_nbr AS zone_id,\n    cust.geo_lvl3_node_nm AS zone,\n    cust.geo_lvl4_node_nbr AS district_id,\n    cust.geo_lvl4_node_nm AS district,\n    cust.rt_nbr,\n\tcust.trade_chanl_code,\n\tcust.trade_chanl_descp,\n\tcust.chain_lvl1_node_nbr,\n\tcust.chain_lvl1_node_nm,\n\tcust.chain_lvl2_node_nbr,\n\tcust.chain_lvl2_node_nm,\n\tcust.chain_lvl3_node_nbr,\n\tcust.chain_lvl3_node_nm,\n\tcust.chain_lvl4_node_nbr,\n\tcust.chain_lvl4_node_nm,\n\tprod.categ_code,\n\tprod.categ_descp,\n\tprod.bus_unit_code,\n\tprod.bus_unit_descp,\n\tprod.brand_code,\n\tprod.brand_descp,\n\tprod.prod_tkt_descp_txt,\n\tprod.bdc_descp,\n\tprod.sale_class_code,\n\tprod.sale_class_descp,\n\tprod.size_code,\n\tprod.size_descp,\n\tprod.flvr_code,\n\tprod.flvr_descp,\n\tNULL AS BUS_UNIT_CODE_NEW,\n\tNULL AS BUS_UNIT_DESCP_NEW,\n\tNULL AS MAJOR_CAT,\n\tNULL AS MAJOR_CAT_SIZE,\n\tsls.tkt_sale_amt,\n\tsls.tkt_sale_qty,\n\tsls.tkt_sale_wt,\n\tsls.gross_tkt_sale_amt,\n\tsls.gross_tkt_sale_qty,\n\tsls.gross_tkt_sale_wt,\n\tsls.net_tkt_sale_amt,\n\tsls.net_tkt_sale_qty,\n\tsls.net_tkt_sale_wt,\n\tsls.am_promo_allow_amt,\n\tsls.am_promo_sale_amt,\n\tsls.am_promo_sale_qty,\n\tsls.full_revnu_sale_amt,\n\tsls.full_revnu_sale_qty,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('btg_fl_sales_cust_wk_prod_v') }} AS sls\n    LEFT JOIN {{ ref('btg_fl_cust_v') }} AS cust ON (cust.cust_nbr = sls.fl_cust_id)\n\tLEFT JOIN {{ ref('btg_fl_prod_v') }} AS prod \n        ON (prod.prod_upc = sls.prod_upc AND prod.prod_slbl = sls.prod_slbl)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_wk_prod_invenid"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_invenid.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_invenid.sql", "name": "cm_btg_fl_sales_cust_wk_prod_invenid", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_wk_prod_invenid", "checksum": {"name": "sha256", "checksum": "d7b17af221e56a946c62c8901d1783bc2169af957b58bea588e1eb4c7abdab86"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_wk_prod_v"], ["btg_fl_cust_v"], ["btg_fl_prod_v"], ["btg_fl_sales_cust_wk_prod_v"], ["btg_fl_cust_v"], ["btg_fl_prod_v"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc": {"raw_sql": "-- Load cm_btg_fl_sales_cust_wk_prod_upc\n\n-- {{ ref('cm_stage_btg_fl_sales_cust_wk_prod_upc') }}\n\nSELECT\n    UPPER(sl.msa_id) AS msa_id,\n\tsl.fl_cust_id,\n\tsl.UPC_10,\n\tsl.fscl_wk_end_dte,\n\tsl.fscl_yr_num,\n\tsl.fscl_pd_num,\n\tsl.fscl_wk_in_pd_num,\n\tUPPER(sl.cust_Name) AS cust_Name,\n\tUPPER(sl.Address) AS Address,\n\tUPPER(sl.City) AS City,\n\tUPPER(sl.State) AS State,\n\tZip5,\n\tZip9,\n\tUPPER(sl.County) AS County,\n\tLatitude,\n\tLongitude,\n\tUPPER(sl.Division_ID) AS Division_ID,\n\tUPPER(sl.Division) AS Division,\n\tUPPER(sl.Region_ID) AS Region_ID,\n\tUPPER(sl.Region) AS Region,\n\tUPPER(sl.Zone_ID) AS Zone_ID,\n\tUPPER(sl.Zone) AS Zone,\n\tUPPER(sl.District_ID) AS District_ID,\n\tUPPER(sl.District) AS District,\n\trt_nbr,\n\tUPPER(sl.trade_chanl_code) AS trade_chanl_code,\n\tUPPER(sl.trade_chanl_descp) AS trade_chanl_descp,\n\tUPPER(sl.chain_lvl1_node_nbr) AS chain_lvl1_node_nbr,\n\tUPPER(sl.chain_lvl1_node_nm) AS chain_lvl1_node_nm,\n\tUPPER(sl.chain_lvl2_node_nbr) AS chain_lvl2_node_nbr,\n\tUPPER(sl.chain_lvl2_node_nm) AS chain_lvl2_node_nm,\n\tUPPER(sl.chain_lvl3_node_nbr) AS chain_lvl3_node_nbr,\n\tUPPER(sl.chain_lvl3_node_nm) AS chain_lvl3_node_nm,\n\tUPPER(sl.chain_lvl4_node_nbr) AS chain_lvl4_node_nbr,\n\tUPPER(sl.chain_lvl4_node_nm) AS chain_lvl4_node_nm,\n\tUPPER(sl.categ_code) AS categ_code,\n\tUPPER(sl.categ_descp) AS categ_descp,\n\tUPPER(sl.bus_unit_code) AS bus_unit_code,\n\tUPPER(sl.bus_unit_descp) AS bus_unit_descp,\n\tUPPER(sl.brand_code) AS brand_code,\n\tUPPER(sl.brand_descp) AS brand_descp,\n\tUPPER(sl.prod_tkt_descp_txt) AS prod_tkt_descp_txt,\n\tUPPER(sl.bdc_descp) AS bdc_descp,\n\tUPPER(sl.sale_class_code) AS sale_class_code,\n\tUPPER(sl.sale_class_descp) AS sale_class_descp,\n\tUPPER(sl.size_code) AS size_code,\n\tUPPER(sl.size_descp) AS size_descp,\n\tUPPER(sl.flvr_code) AS flvr_code,\n\tUPPER(sl.flvr_descp) AS flvr_descp,\n\tUPPER(sl.MAJOR_CAT) AS MAJOR_CAT,\n\tSUM(sl.tkt_sale_amt) AS tkt_sale_amt,\n\tSUM(sl.tkt_sale_qty) AS tkt_sale_qty,\n\tSUM(sl.tkt_sale_wt) AS tkt_sale_wt,\n\tSUM(sl.gross_tkt_sale_amt) AS gross_tkt_sale_amt,\n\tSUM(sl.gross_tkt_sale_qty) AS gross_tkt_sale_qty,\n\tSUM(sl.gross_tkt_sale_wt) AS gross_tkt_sale_wt,\n\tSUM(sl.net_tkt_sale_amt) AS net_tkt_sale_amt,\n\tSUM(sl.net_tkt_sale_qty) AS net_tkt_sale_qty,\n\tSUM(sl.net_tkt_sale_wt) AS net_tkt_sale_wt,\n\tSUM(sl.am_promo_allow_amt) AS am_promo_allow_amt,\n\tSUM(sl.am_promo_sale_amt) AS am_promo_sale_amt,\n\tSUM(sl.am_promo_sale_qty) AS am_promo_sale_qty,\n\tSUM(sl.full_revnu_sale_amt) AS full_revnu_sale_amt,\n\tSUM(sl.full_revnu_sale_qty) AS full_revnu_sale_qty,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('cm_stage_btg_fl_sales_cust_wk_prod_upc') }} AS sl\nGROUP BY\n\tsl.msa_id,\n\tsl.fl_cust_id,\n\tsl.UPC_10,\n\tsl.fscl_wk_end_dte,\n\tsl.fscl_yr_num,\n\tsl.fscl_pd_num,\n\tsl.fscl_wk_in_pd_num,\n\tsl.cust_Name,\n\tsl.Address,\n\tsl.City,\n\tsl.State,\n\tsl.Zip5,\n\tsl.Zip9,\n\tsl.County,\n\tsl.Latitude,\n\tsl.Longitude,\n\tsl.Division_ID,\n\tsl.Division,\n\tsl.Region_ID,\n\tsl.Region,\n\tsl.Zone_ID,\n\tsl.Zone,\n\tsl.District_ID,\n\tsl.District,\n\tsl.rt_nbr,\n\tsl.trade_chanl_code,\n\tsl.trade_chanl_descp,\n\tsl.chain_lvl1_node_nbr,\n\tsl.chain_lvl1_node_nm,\n\tsl.chain_lvl2_node_nbr,\n\tsl.chain_lvl2_node_nm,\n\tsl.chain_lvl3_node_nbr,\n\tsl.chain_lvl3_node_nm,\n\tsl.chain_lvl4_node_nbr,\n\tsl.chain_lvl4_node_nm,\n\tsl.categ_code,\n\tsl.categ_descp,\n\tsl.bus_unit_code,\n\tsl.bus_unit_descp,\n\tsl.brand_code,\n\tsl.brand_descp,\n\tsl.prod_tkt_descp_txt,\n\tsl.bdc_descp,\n\tsl.sale_class_code,\n\tsl.sale_class_descp,\n\tsl.size_code,\n\tsl.size_descp,\n\tsl.flvr_code,\n\tsl.flvr_descp,\n\tsl.MAJOR_CAT", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_wk_prod_upc"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_upc.sql", "name": "cm_btg_fl_sales_cust_wk_prod_upc", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_wk_prod_upc", "checksum": {"name": "sha256", "checksum": "99eb8e8502360ce08a60e741268dee25beb003d0c1f2bb09226183e3ffed9640"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_stage_btg_fl_sales_cust_wk_prod_upc"], ["cm_stage_btg_fl_sales_cust_wk_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v": {"raw_sql": "-- Load cm_btg_fl_sales_cust_wk_prod_v\n\n-- {{ ref('msa_tdlinx_xref_final') }}\n-- {{ ref('iri_rma_store_list') }}\n-- {{ ref('iri_srma_sample_stores') }}\n-- {{ ref('iri_pbc_markets_divs_by_fips') }}\n-- {{ ref('zip_code_priority_report') }}\n-- {{ ref('cm_btg_fl_sales_cust_wk_prod_upc') }}\n\nWITH sls AS\n(\n\tSELECT\n\t\ts1.*,\n\t\tUPPER(z1.pbc_fbu_flg) AS pbc_fbu_flg\n\tFROM\n    {{ ref('cm_btg_fl_sales_cust_wk_prod_upc') }} AS s1\n\t\tLEFT JOIN {{ ref('zip_code_priority_report') }} AS z1\n            ON (SUBSTR(TRIM(z1.zip_code), 0, 5) = SUBSTR(TRIM(s1.zip5), 0, 5))\n)\nselect\n\tCONCAT(COALESCE(tdlinx1.sstatusind, 'null'), '|',\n\t\tCOALESCE(sls.msa_id, 'null'), '|',\n\t\tCOALESCE(tdlinx1.iri_retailer, 'null'), '|',\n\t\tCOALESCE(tdlinx1.aulname, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sgrpnm, 'null'), '|',\n\t\tCOALESCE(tdlinx1.stradeclcd, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sformatcd, 'null'), '|',\n\t\tCOALESCE(sls.division, 'null'), '|',\n\t\tCOALESCE(sls.region, 'null'), '|',\n\t\tCOALESCE(sls.chain_lvl1_node_nbr, 'null'), '|',\n\t\tCOALESCE(sls.categ_code, 'null'), '|',\n\t\tCOALESCE(sls.sale_class_code, 'null'), '|',\n\t\tCOALESCE(sls.major_cat, 'null'), '|',\n\t\tCOALESCE(sls.trade_chanl_code, 'null'), '|',\n\t\tCOALESCE(sls.brand_code, 'null')\n\t) AS fl_concat,\n\ttdlinx1.AULNAME,\n\ttdlinx1.SGRPNM,\n\ttdlinx1.SNAME,\n\ttdlinx1.SNO,\n\ttdlinx1.FIPS,\n\ttdlinx1.STRADECLCD,\n\ttdlinx1.SFORMATCD,\n\ttdlinx1.STRADECLDESC,\n\ttdlinx1.SFORMATDESC,\n\ttdlinx1.SSTATUSIND,\n\ttdlinx1.STDLINXSCD,\n\ttdlinx1.SLAT,\n\ttdlinx1.SLONG,\n\ttdlinx1.tdl_msa_id,\n\ttdlinx1.iri_retailer,\n\ttdlinx1.iri_rma1,\n\ttdlinx1.iri_rma2,\n\ttdlinx1.iri_rma3,\n\ttdlinx1.iri_rma4,\n\ttdlinx1.iri_rma5,\n\ttdlinx1.iri_rma6,\n\ttdlinx1.iri_rma7,\n\ttdlinx1.iri_rma8,\n\ttdlinx1.iri_rma9,\n\ttdlinx1.RMA_SRMA,\n\ttdlinx1.corporate_srma,\n\ttdlinx1.iri_pbc_div,\n\ttdlinx1.iri_pbc_mkt,\n\tCOALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg) AS pbc_fbu_flg,\n\tsls.msa_id,\n\tsls.fl_cust_id,\n\tsls.UPC_10,\n\tsls.fscl_wk_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.fscl_wk_in_pd_num,\n\tsls.cust_Name,\n\tCOALESCE(tdlinx1.SSTREETADD, sls.Address) AS Address,\n\tCOALESCE(tdlinx1.SCITY, sls.City) AS City,\n\tCOALESCE(tdlinx1.SST, sls.State) AS State,\n\tCOALESCE(tdlinx1.SZIP, sls.Zip5) AS Zip5,\n\tsls.Zip9,\n\tCOALESCE(tdlinx1.MCOUNTYNM, sls.County) AS County,\n\tsls.Latitude,\n\tsls.Longitude,\n\tsls.Division_ID,\n\tsls.Division,\n\tsls.Region_ID,\n\tsls.Region,\n\tsls.Zone_ID,\n\tsls.Zone,\n\tsls.District_ID,\n\tsls.District,\n\tsls.rt_nbr,\n\tsls.trade_chanl_code,\n\tsls.trade_chanl_descp,\n\tsls.chain_lvl1_node_nbr,\n\tsls.chain_lvl1_node_nm,\n\tsls.chain_lvl2_node_nbr,\n\tsls.chain_lvl2_node_nm,\n\tsls.chain_lvl3_node_nbr,\n\tsls.chain_lvl3_node_nm,\n\tsls.chain_lvl4_node_nbr,\n\tsls.chain_lvl4_node_nm,\n\tsls.categ_code,\n\tsls.categ_descp,\n\tsls.bus_unit_code,\n\tsls.bus_unit_descp,\n\tsls.brand_code,\n\tsls.brand_descp,\n\tsls.prod_tkt_descp_txt,\n\tsls.bdc_descp,\n\tsls.sale_class_code,\n\tsls.sale_class_descp,\n\tsls.size_code,\n\tsls.size_descp,\n\tsls.flvr_code,\n\tsls.flvr_descp,\n\tsls.MAJOR_CAT,\n\tsls.tkt_sale_amt,\n\tsls.tkt_sale_qty,\n\tsls.tkt_sale_wt,\n\tsls.gross_tkt_sale_amt,\n\tsls.gross_tkt_sale_qty,\n\tsls.gross_tkt_sale_wt,\n\tsls.net_tkt_sale_amt,\n\tsls.net_tkt_sale_qty,\n\tsls.net_tkt_sale_wt,\n\tsls.am_promo_allow_amt,\n\tsls.am_promo_sale_amt,\n\tsls.am_promo_sale_qty,\n\tsls.full_revnu_sale_amt,\n\tsls.full_revnu_sale_qty,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t{{ ref('cm_btg_fl_sales_tdlinx1') }} AS tdlinx1\n\t    FULL JOIN sls ON (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_fl_sales_cust_wk_prod_v"], "unique_id": "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_fl_sales_cust_wk_prod_v.sql", "name": "cm_btg_fl_sales_cust_wk_prod_v", "resource_type": "model", "alias": "cm_btg_fl_sales_cust_wk_prod_v", "checksum": {"name": "sha256", "checksum": "098fab9a635c395ed16e698b52dde573b86cda5531efb1b687332b149929e857"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_fl_sales_cust_wk_prod_upc"], ["cm_btg_fl_sales_cust_wk_prod_upc"], ["zip_code_priority_report"], ["cm_btg_fl_sales_tdlinx1"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_fl_sales_tdlinx1"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc": {"raw_sql": "-- Load cm_btg_pbc_sales_cust_pd_prod_upc\n\n-- {{ ref('btg_pep_calendar') }}\n-- {{ ref('cm_btg_pbc_sales_cust_wk_prod_upc') }}\n\nWITH pd_tbl AS (\n    SELECT\n\t\tfscl_yr_num,\n\t\tfscl_pd_num,\n\t\tMAX(fscl_pd_end_dte) AS max_fscl_pd_end_dte\n\tFROM\n        {{ ref('btg_pep_calendar') }}\n\tGROUP BY\n\t\tfscl_yr_num,\n\t\tfscl_pd_num\n),\npd_sales AS (\n\tSELECT\n\t\tmsa_id,\n\t\tpbc_cust_id,\n\t\tupc_cde,\n\t\tupc_descp,\n\t\tcust_name,\n\t\taddress,\n\t\tcity,\n\t\tstate,\n\t\tzip5,\n\t\tzip9,\n\t\tcounty,\n\t\tlat_qty,\n\t\tlngtd_qty,\n\t\tcur_stat_desc,\n\t\tdivision_id,\n\t\tdivision,\n\t\tregion_id,\n\t\tregion,\n\t\tmarket_id,\n\t\tmarket,\n\t\tlocation,\n\t\tterr_id,\n\t\tterr_nme,\n\t\troute_id,\n\t\tsub_channel_desc,\n\t\tgrp1_lvl_1_desc,\n\t\tgrp1_lvl_2_desc,\n\t\tgrp2_lvl_1_desc,\n\t\tgrp2_lvl_2_desc,\n\t\tchannel_cde,\n\t\tchannel_desc,\n\t\tformat_cde,\n\t\tformat_desc,\n\t\tctgy_type_cde,\n\t\tctgy_type_desc,\n\t\tmkt_trdmrk_id,\n\t\tmkt_trdmrk_desc,\n\t\ttrdmrk_cde,\n\t\ttrdmrk_desc,\n\t\tbrand_cde,\n\t\tbrnd_nme,\n\t\tflvr_cde,\n\t\tflvr_desc,\n\t\thrzn_prod_ctgy_desc,\n\t\thrzn_pkg_aggr_desc,\n\t\tcont_desc,\n\t\tpkg_cont_mtrl_desc,\n\t\tpkg_clstr_mtrl_desc,\n\t\tprod_grp_desc,\n\t\tcont_uom_desc,\n\t\tcont_uom_qty,\n\t\tclust_cde,\n\t\tclust_desc,\n\t\tclust_qty,\n\t\tss_mp_ms,\n\t\tss_th,\n\t\tfscl_yr_num,\n\t\tfscl_pd_num,\n\t\tSUM(cases) AS cases,\n\t\tSUM(eaches) AS eaches,\n\t\tSUM(raw_vol) AS raw_vol,\n\t\tSUM(eght_oz_vol) AS eght_oz_vol,\n\t\tSUM(net_rev) AS net_rev\n\tFROM\n        {{ ref('cm_btg_pbc_sales_cust_wk_prod_upc') }}\n\tGROUP BY\n\t\tmsa_id,\n\t\tpbc_cust_id,\n\t\tupc_cde,\n\t\tupc_descp,\n\t\tcust_name,\n\t\taddress,\n\t\tcity,\n\t\tstate,\n\t\tzip5,\n\t\tzip9,\n\t\tcounty,\n\t\tlat_qty,\n\t\tlngtd_qty,\n\t\tcur_stat_desc,\n\t\tdivision_id,\n\t\tdivision,\n\t\tregion_id,\n\t\tregion,\n\t\tmarket_id,\n\t\tmarket,\n\t\tlocation,\n\t\tterr_id,\n\t\tterr_nme,\n\t\troute_id,\n\t\tsub_channel_desc,\n\t\tgrp1_lvl_1_desc,\n\t\tgrp1_lvl_2_desc,\n\t\tgrp2_lvl_1_desc,\n\t\tgrp2_lvl_2_desc,\n\t\tchannel_cde,\n\t\tchannel_desc,\n\t\tformat_cde,\n\t\tformat_desc,\n\t\tctgy_type_cde,\n\t\tctgy_type_desc,\n\t\tmkt_trdmrk_id,\n\t\tmkt_trdmrk_desc,\n\t\ttrdmrk_cde,\n\t\ttrdmrk_desc,\n\t\tbrand_cde,\n\t\tbrnd_nme,\n\t\tflvr_cde,\n\t\tflvr_desc,\n\t\thrzn_prod_ctgy_desc,\n\t\thrzn_pkg_aggr_desc,\n\t\tcont_desc,\n\t\tpkg_cont_mtrl_desc,\n\t\tpkg_clstr_mtrl_desc,\n\t\tprod_grp_desc,\n\t\tcont_uom_desc,\n\t\tcont_uom_qty,\n\t\tclust_cde,\n\t\tclust_desc,\n\t\tclust_qty,\n\t\tss_mp_ms,\n\t\tss_th,\n\t\tfscl_yr_num,\n\t\tfscl_pd_num\n)\nSELECT\n\tpd_sales.msa_id,\n\tpd_sales.pbc_cust_id,\n\tpd_sales.upc_cde,\n\tpd_sales.upc_descp,\n\tpd_sales.cust_name,\n\tpd_sales.address,\n\tpd_sales.city,\n\tpd_sales.state,\n\tpd_sales.zip5,\n\tpd_sales.zip9,\n\tpd_sales.county,\n\tpd_sales.lat_qty,\n\tpd_sales.lngtd_qty,\n\tpd_sales.cur_stat_desc,\n\tpd_sales.division_id,\n\tpd_sales.division,\n\tpd_sales.region_id,\n\tpd_sales.region,\n\tpd_sales.market_id,\n\tpd_sales.market,\n\tpd_sales.location,\n\tpd_sales.terr_id,\n\tpd_sales.terr_nme,\n\tpd_sales.route_id,\n\tpd_sales.sub_channel_desc,\n\tpd_sales.grp1_lvl_1_desc,\n\tpd_sales.grp1_lvl_2_desc,\n\tpd_sales.grp2_lvl_1_desc,\n\tpd_sales.grp2_lvl_2_desc,\n\tpd_sales.channel_cde,\n\tpd_sales.channel_desc,\n\tpd_sales.format_cde,\n\tpd_sales.format_desc,\n\tpd_sales.ctgy_type_cde,\n\tpd_sales.ctgy_type_desc,\n\tpd_sales.mkt_trdmrk_id,\n\tpd_sales.mkt_trdmrk_desc,\n\tpd_sales.trdmrk_cde,\n\tpd_sales.trdmrk_desc,\n\tpd_sales.brand_cde,\n\tpd_sales.brnd_nme,\n\tpd_sales.flvr_cde,\n\tpd_sales.flvr_desc,\n\tpd_sales.hrzn_prod_ctgy_desc,\n\tpd_sales.hrzn_pkg_aggr_desc,\n\tpd_sales.cont_desc,\n\tpd_sales.pkg_cont_mtrl_desc,\n\tpd_sales.pkg_clstr_mtrl_desc,\n\tpd_sales.prod_grp_desc,\n\tpd_sales.cont_uom_desc,\n\tpd_sales.cont_uom_qty,\n\tpd_sales.clust_cde,\n\tpd_sales.clust_desc,\n\tpd_sales.clust_qty,\n\tpd_sales.ss_mp_ms,\n\tpd_sales.ss_th,\n\tpd_tbl.max_fscl_pd_end_dte AS fscl_pd_end_dte,\n\tpd_sales.fscl_yr_num,\n\tpd_sales.fscl_pd_num,\n\tpd_sales.cases,\n\tpd_sales.eaches,\n\tpd_sales.raw_vol,\n\tpd_sales.eght_oz_vol,\n\tpd_sales.net_rev,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\tpd_sales\n\tLEFT JOIN pd_tbl ON (\n\t\tpd_sales.fscl_yr_num = pd_tbl.fscl_yr_num\n\t\tAND pd_sales.fscl_pd_num = pd_tbl.fscl_pd_num\n\t)\nWHERE\n\tpd_tbl.max_fscl_pd_end_dte <= DATEADD(day, -7, NEXT_DAY(CURRENT_DATE(),\t'Sa'))", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_pd_prod_upc"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_pd_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_pd_prod_upc.sql", "name": "cm_btg_pbc_sales_cust_pd_prod_upc", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_pd_prod_upc", "checksum": {"name": "sha256", "checksum": "bdf7c843b219d23372810a06c72127e7187d8ff2afd408e57747d3114942b033"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pep_calendar"], ["cm_btg_pbc_sales_cust_wk_prod_upc"], ["btg_pep_calendar"], ["cm_btg_pbc_sales_cust_wk_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v": {"raw_sql": "-- Load cm_btg_pbc_sales_cust_pd_prod_v\n\n-- {{ ref('msa_tdlinx_xref_final') }}\n-- {{ ref('cm_btg_pbc_sales_cust_pd_prod_upc') }}\n-- {{ ref('iri_rma_store_list') }}\n-- {{ ref('iri_srma_sample_stores') }}\n-- {{ ref('iri_pbc_markets_divs_by_fips') }}\n-- {{ ref('zip_code_priority_report') }}\n\nWITH sls AS\n(\n\tSELECT\n\t\ts1.*,\n\t\tUPPER(z1.pbc_fbu_flg) AS pbc_fbu_flg\n\tFROM\n        {{ ref('cm_btg_pbc_sales_cust_pd_prod_upc') }} AS s1\n        LEFT JOIN {{ ref('zip_code_priority_report') }} AS z1\n            ON (SUBSTR(TRIM(z1.zip_code), 0, 5) = SUBSTR(TRIM(s1.zip5), 0, 5))\n)\nSELECT\n\tCONCAT(\n\t\tCOALESCE(tdlinx1.sstatusind, 'null'), '|',\n\t\tCOALESCE(sls.msa_id, 'null'), '|',\n\t\tCOALESCE(tdlinx1.iri_retailer, 'null'), '|',\n\t\tCOALESCE(tdlinx1.aulname, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sgrpnm, 'null'), '|',\n\t\tCOALESCE(tdlinx1.stradeclcd, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sformatcd, 'null'), '|',\n\t\tCOALESCE(COALESCE(sls.division, tdlinx1.division_zipfile), 'null'), '|',\n\t\tCOALESCE(COALESCE(sls.market, tdlinx1.market_zipfile), 'null'), '|',\n\t\tCOALESCE(sls.grp1_lvl_1_desc, 'null'), '|',\n\t\tCOALESCE(sls.ctgy_type_cde, 'null'), '|',\n\t\tCOALESCE(sls.mkt_trdmrk_id, 'null'), '|',\n\t\tCOALESCE(sls.ss_mp_ms, 'null'), '|',\n\t\tCOALESCE(sls.channel_cde, 'null'), '|',\n\t\tCOALESCE(sls.sub_channel_desc, 'null'), '|',\n\t\tCOALESCE(sls.cur_stat_desc, 'null'), '|',\n\t\tCOALESCE(sls.format_cde, 'null'), '|',\n\t\tCOALESCE(COALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg), 'null')\n\t) AS pbi_concat,\n\ttdlinx1.AULNAME,\n\ttdlinx1.SGRPNM,\n\ttdlinx1.SNAME,\n\ttdlinx1.SNO,\n\ttdlinx1.FIPS,\n\ttdlinx1.STRADECLCD,\n\ttdlinx1.SFORMATCD,\n\ttdlinx1.STRADECLDESC,\n\ttdlinx1.SFORMATDESC,\n\ttdlinx1.SSTATUSIND,\n\ttdlinx1.STDLINXSCD,\n\ttdlinx1.SLAT,\n\ttdlinx1.SLONG,\n\ttdlinx1.tdl_msa_id,\n\ttdlinx1.iri_retailer,\n\ttdlinx1.iri_rma1,\n\ttdlinx1.iri_rma2,\n\ttdlinx1.iri_rma3,\n\ttdlinx1.iri_rma4,\n\ttdlinx1.iri_rma5,\n\ttdlinx1.iri_rma6,\n\ttdlinx1.iri_rma7,\n\ttdlinx1.iri_rma8,\n\ttdlinx1.iri_rma9,\n\ttdlinx1.RMA_SRMA,\n\ttdlinx1.corporate_srma,\n\ttdlinx1.iri_pbc_div,\n\ttdlinx1.iri_pbc_mkt,\n\tCOALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg) AS pbc_fbu_flg,\n\tsls.msa_id,\n\tsls.pbc_cust_id,\n\tsls.upc_cde,\n\tsls.upc_descp,\n\tsls.cust_name,\n\tCOALESCE(tdlinx1.SSTREETADD, sls.address) AS address,\n\tCOALESCE(tdlinx1.SCITY, sls.city) AS city,\n\tCOALESCE(tdlinx1.SST, sls.state) AS state,\n\tCOALESCE(tdlinx1.SZIP, sls.zip5) AS zip5,\n\tsls.zip9,\n\tCOALESCE(tdlinx1.MCOUNTYNM, sls.county) AS county,\n\tsls.lat_qty,\n\tsls.lngtd_qty,\n\tsls.cur_stat_desc,\n\tsls.division_id,\n\tCOALESCE(sls.division, tdlinx1.division_zipfile) AS division,\n\tsls.region_id,\n\tsls.region,\n\tsls.market_id,\n\tCOALESCE(sls.market, tdlinx1.market_zipfile) AS market,\n\tsls.location,\n\tsls.terr_id,\n\tsls.terr_nme,\n\tsls.route_id,\n\tsls.sub_channel_desc,\n\tsls.grp1_lvl_1_desc,\n\tsls.grp1_lvl_2_desc,\n\tsls.grp2_lvl_1_desc,\n\tsls.grp2_lvl_2_desc,\n\tsls.channel_cde,\n\tsls.channel_desc,\n\tsls.format_cde,\n\tsls.format_desc,\n\tsls.ctgy_type_cde,\n\tsls.ctgy_type_desc,\n\tsls.mkt_trdmrk_id,\n\tsls.mkt_trdmrk_desc,\n\tsls.trdmrk_cde,\n\tsls.trdmrk_desc,\n\tsls.brand_cde,\n\tsls.brnd_nme,\n\tsls.flvr_cde,\n\tsls.flvr_desc,\n\tsls.hrzn_prod_ctgy_desc,\n\tsls.hrzn_pkg_aggr_desc,\n\tsls.cont_desc,\n\tsls.pkg_cont_mtrl_desc,\n\tsls.pkg_clstr_mtrl_desc,\n\tsls.prod_grp_desc,\n\tsls.cont_uom_desc,\n\tsls.cont_uom_qty,\n\tsls.clust_cde,\n\tsls.clust_desc,\n\tsls.clust_qty,\n\tsls.ss_mp_ms,\n\tsls.ss_th,\n\tsls.fscl_pd_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.cases,\n\tsls.eaches,\n\tsls.raw_vol,\n\tsls.eght_oz_vol,\n\tsls.net_rev,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t{{ ref('cm_btg_pbc_sales_tdlinx1') }} AS tdlinx1\n\t    FULL JOIN sls ON (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_pd_prod_v"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_pd_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_pd_prod_v.sql", "name": "cm_btg_pbc_sales_cust_pd_prod_v", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_pd_prod_v", "checksum": {"name": "sha256", "checksum": "9729d81e1e733d804cf0c371590ecafa37c544e9314ad0c03bfbb06d5d9558b6"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["cm_btg_pbc_sales_cust_pd_prod_upc"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_pbc_sales_cust_pd_prod_upc"], ["zip_code_priority_report"], ["cm_btg_pbc_sales_tdlinx1"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid": {"raw_sql": "select\n    sls.msa_id\n    ,sls.pbc_cust_id\n    ,sls.inven_id\n    ,prod.upc_cde\n    ,prod.nme as upc_descp\n    --cust attributes\n    ,cust.nme as cust_name\n    ,cust.dely_adr_strt1 as address\n    ,cust.dely_adr_city as city\n    ,cust.dely_adr_state as state\n    ,cust.dely_adr_zip5 as zip5\n    ,cust.dely_adr_zip as zip9\n    ,cust.dely_adr_cnty as county\n    --lat-long table attributes\n    ,ll.lat_qty\n    ,ll.lngtd_qty\n    ,cust.cur_stat_desc\n    --division hierarchy atributes\n    ,mkt.hq_id as division_id\n    ,mkt.hq_nme as division\n    ,mkt.bu_id as region_id\n    ,mkt.bu_nme as region\n    ,mkt.mu_id as market_id\n    ,mkt.mu_nme as market\n    ,mkt.loc_nme as location\n    --rte attributes\n    ,rte.terr_id\n    ,rte.terr_nme\n    ,rte.rte_id as route_id\n    --some more cust attributes\n    ,cust.bus_type_desc as sub_channel_desc\n    ,cust.grp1_lvl_1_desc\n    ,cust.grp1_lvl_2_desc\n    ,cust.grp2_lvl_1_desc\n    ,cust.grp2_lvl_2_desc\n    ,cust.bus_type_aggr_cde as channel_cde\n    ,cust.bus_type_aggr_desc as channel_desc\n    ,cust.bus_type_ctgy_cde as format_cde\n    ,cust.bus_type_ctgy_desc as format_desc\n    --prod attributes\n    ,prod.ctgy_type_cde\n    ,prod.ctgy_type_desc\n    ,prod.mkt_trdmrk_id\n    ,prod.mkt_trdmrk_desc\n    ,prod.trdmrk_cde\n    ,prod.trdmrk_desc\n    ,prod.brnd_id as brand_cde\n    ,prod.brnd_nme\n    ,prod.flvr_cde\n    ,prod.flvr_desc\n    --,prod.pkg_nme\n    --,prod.pkg_id\n    ,prod.hrzn_prod_ctgy_desc\n    ,prod.hrzn_pkg_aggr_desc\n    --,prod.hrzn_pkg_grp_desc\n    ,prod.cont_desc\n    ,prod.pkg_cont_mtrl_desc\n    ,prod.pkg_clstr_mtrl_desc\n    ,prod.prod_grp_desc\n    ,prod.cont_uom_desc\n    ,prod.cont_uom_qty\n    ,prod.clust_cde\n    ,prod.clust_desc\n    ,prod.clust_qty\n    --,prod.inven_dply_grp_nme\n    ,prod.ss_mp_ms\n    ,prod.ss_th\n    ,sls.dely_lne_qty_cy_ytd\n    ,sls.dely_lne_qty_cy_ytd * prod.config_qty as eaches_cy_ytd\n    ,sls.dely_lne_qty_py\n    ,sls.dely_lne_qty_py *  prod.config_qty as eaches_py\n    ,sls.dely_lne_qty_2py\n    ,sls.dely_lne_qty_2py  * prod.config_qty as eaches_2py\n    ,sls.dely_lne_qty_py_ytd\n    ,sls.dely_lne_qty_py_ytd * prod.config_qty as eaches_py_ytd\n    ,sls.dely_lne_qty_2py_ytd\n    ,sls.dely_lne_qty_2py_ytd * prod.config_qty as eaches_2py_ytd\n    ,sls.dely_lne_qty_cy_l13p\n    ,sls.dely_lne_qty_cy_l13p * prod.config_qty as eaches_cy_l13p\n    ,sls.dely_lne_qty_py_l13p\n    ,sls.dely_lne_qty_py_l13p * prod.config_qty as eaches_py_l13p\n    ,sls.dely_lne_qty_cy_l4wk\n    ,sls.dely_lne_qty_cy_l4wk * prod.config_qty as eaches_cy_l4wk\n    ,sls.dely_lne_qty_py_l4wk\n    ,sls.dely_lne_qty_py_l4wk * prod.config_qty as eaches_py_l4wk\n    ,sls.dely_lne_qty_cy_l12wk\n    ,sls.dely_lne_qty_cy_l12wk * prod.config_qty as eaches_cy_l12wk\n    ,sls.dely_lne_qty_py_l12wk\n    ,sls.dely_lne_qty_py_l12wk * prod.config_qty as eaches_py_l12wk\n    ,sls.dely_lne_qty_cy_l26wk\n    ,sls.dely_lne_qty_cy_l26wk * prod.config_qty as eaches_cy_l26wk\n    ,sls.dely_lne_qty_py_l26wk\n    ,sls.dely_lne_qty_py_l26wk * prod.config_qty as eaches_py_l26wk\n    ,sls.dely_lne_qty_cy_l52wk\n    ,sls.dely_lne_qty_cy_l52wk * prod.config_qty as eaches_cy_l52wk\n    ,sls.dely_lne_qty_py_l52wk\n    ,sls.dely_lne_qty_py_l52wk * prod.config_qty as eaches_py_l52wk\n    ,sls.raw_vol_cy_ytd\n    ,sls.raw_vol_py\n    ,sls.raw_vol_2py\n    ,sls.raw_vol_py_ytd\n    ,sls.raw_vol_2py_ytd\n    ,sls.raw_vol_cy_l13p\n    ,sls.raw_vol_py_l13p\n    ,sls.raw_vol_cy_l4wk\n    ,sls.raw_vol_py_l4wk\n    ,sls.raw_vol_cy_l12wk\n    ,sls.raw_vol_py_l12wk\n    ,sls.raw_vol_cy_l26wk\n    ,sls.raw_vol_py_l26wk\n    ,sls.raw_vol_cy_l52wk\n    ,sls.raw_vol_py_l52wk\n    ,sls.eght_oz_vol_cy_ytd\n    ,sls.eght_oz_vol_py\n    ,sls.eght_oz_vol_2py\n    ,sls.eght_oz_vol_py_ytd\n    ,sls.eght_oz_vol_2py_ytd\n    ,sls.eght_oz_vol_cy_l13p\n    ,sls.eght_oz_vol_py_l13p\n    ,sls.eght_oz_vol_cy_l4wk\n    ,sls.eght_oz_vol_py_l4wk\n    ,sls.eght_oz_vol_cy_l12wk\n    ,sls.eght_oz_vol_py_l12wk\n    ,sls.eght_oz_vol_cy_l26wk\n    ,sls.eght_oz_vol_py_l26wk\n    ,sls.eght_oz_vol_cy_l52wk\n    ,sls.eght_oz_vol_py_l52wk\n    ,sls.net_rev_cy_ytd\n    ,sls.net_rev_py\n    ,sls.net_rev_2py\n    ,sls.net_rev_py_ytd\n    ,sls.net_rev_2py_ytd\n    ,sls.net_rev_cy_l13p\n    ,sls.net_rev_py_l13p\n    ,sls.net_rev_cy_l4wk\n    ,sls.net_rev_py_l4wk\n    ,sls.net_rev_cy_l12wk\n    ,sls.net_rev_py_l12wk\n    ,sls.net_rev_cy_l26wk\n    ,sls.net_rev_py_l26wk\n    ,sls.net_rev_cy_l52wk\n    ,sls.net_rev_py_l52wk\n    ,sls.last_updt_dt\nfrom {{ ref('btg_pbc_sales_cust_prod_v') }} sls\nleft join {{ ref('btg_pbc_cust_v') }} cust on (cust.cust_id = sls.pbc_cust_id)\nleft join {{ ref('btg_msa_lat_lon_v') }} ll on (ll.msa_id = sls.msa_id)\nleft join {{ ref('btg_pbc_prod_v') }} prod on (prod.inven_id = sls.inven_id)\nleft join {{ ref('btg_pbc_new_mkt_loc') }} mkt on (mkt.cust_id = sls.pbc_cust_id)\nleft join {{ ref('btg_pbc_route_data') }} rte on (rte.cust_id = sls.pbc_cust_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_prod_invenid"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_invenid.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_invenid.sql", "name": "cm_btg_pbc_sales_cust_prod_invenid", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_prod_invenid", "checksum": {"name": "sha256", "checksum": "6607e7bb4d6570731ab1e1546f4dd195b3802f27e3ba851d904f52ff22694fe2"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_prod_v"], ["btg_pbc_cust_v"], ["btg_msa_lat_lon_v"], ["btg_pbc_prod_v"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_prod_upc": {"raw_sql": "select\n    upper(msa_id) as msa_id\n    ,pbc_cust_id\n    ,upc_cde\n    ,upper(upc_descp) as upc_descp\n    ,upper(cust_name) as cust_name\n    ,upper(address) as address\n    ,upper(city) as city\n    ,upper(state) as state\n    ,zip5\n    ,zip9\n    ,upper(county) as county\n    ,lat_qty\n    ,lngtd_qty\n    ,upper(cur_stat_desc) as cur_stat_desc\n    ,division_id\n    ,upper(division) as division\n    ,region_id\n    ,upper(region) as region\n    ,market_id\n    ,upper(market) as market\n    ,upper(location) as location\n    ,terr_id\n    ,upper(terr_nme) as terr_nme\n    ,route_id\n    ,upper(sub_channel_desc) as sub_channel_desc\n    ,upper(grp1_lvl_1_desc) as grp1_lvl_1_desc\n    ,upper(grp1_lvl_2_desc) as grp1_lvl_2_desc\n    ,upper(grp2_lvl_1_desc) as grp2_lvl_1_desc\n    ,upper(grp2_lvl_2_desc) as grp2_lvl_2_desc\n    ,upper(channel_cde) as channel_cde\n    ,upper(channel_desc) as channel_desc\n    ,upper(format_cde) as format_cde\n    ,upper(format_desc) as format_desc\n    ,upper(ctgy_type_cde) as ctgy_type_cde\n    ,upper(ctgy_type_desc) as ctgy_type_desc\n    ,upper(mkt_trdmrk_id) as mkt_trdmrk_id\n    ,upper(mkt_trdmrk_desc) as mkt_trdmrk_desc\n    ,upper(trdmrk_cde) as trdmrk_cde\n    ,upper(trdmrk_desc) as trdmrk_desc\n    ,brand_cde\n    ,upper(brnd_nme) as brnd_nme\n    ,upper(flvr_cde) as flvr_cde\n    ,upper(flvr_desc) as flvr_desc\n    ,upper(hrzn_prod_ctgy_desc) as hrzn_prod_ctgy_desc\n    ,upper(hrzn_pkg_aggr_desc) as hrzn_pkg_aggr_desc\n    ,upper(cont_desc) as cont_desc\n    ,upper(pkg_cont_mtrl_desc) as pkg_cont_mtrl_desc\n    ,upper(pkg_clstr_mtrl_desc) as pkg_clstr_mtrl_desc\n    ,upper(prod_grp_desc) as prod_grp_desc\n    ,upper(cont_uom_desc) as cont_uom_desc\n    ,cont_uom_qty\n    ,upper(clust_cde) as clust_cde\n    ,upper(clust_desc) as clust_desc\n    ,clust_qty\n    ,upper(ss_mp_ms) as ss_mp_ms\n    ,upper(ss_th) as ss_th\n    ,sum(dely_lne_qty_cy_ytd) as  dely_lne_qty_cy_ytd\n    ,sum(eaches_cy_ytd) as eaches_cy_ytd\n    ,sum(dely_lne_qty_py) as dely_lne_qty_py\n    ,sum(eaches_py) as eaches_py\n    ,sum(dely_lne_qty_2py) as dely_lne_qty_2py\n    ,sum(eaches_2py) as eaches_2py\n    ,sum(dely_lne_qty_py_ytd) as dely_lne_qty_py_ytd\n    ,sum(eaches_py_ytd) as  eaches_py_ytd\n    ,sum(dely_lne_qty_2py_ytd) as dely_lne_qty_2py_ytd\n    ,sum(eaches_2py_ytd) as eaches_2py_ytd\n    ,sum(dely_lne_qty_cy_l13p) as  dely_lne_qty_cy_l13p\n    ,sum(eaches_cy_l13p) as eaches_cy_l13p\n    ,sum(dely_lne_qty_py_l13p) as dely_lne_qty_py_l13p\n    ,sum(eaches_py_l13p) as eaches_py_l13p\n    ,sum(dely_lne_qty_cy_l4wk) as dely_lne_qty_cy_l4wk\n    ,sum(eaches_cy_l4wk) as eaches_cy_l4wk\n    ,sum(dely_lne_qty_py_l4wk) as  dely_lne_qty_py_l4wk\n    ,sum(eaches_py_l4wk) as eaches_py_l4wk\n    ,sum(dely_lne_qty_cy_l12wk) as dely_lne_qty_cy_l12wk\n    ,sum(eaches_cy_l12wk) as  eaches_cy_l12wk\n    ,sum(dely_lne_qty_py_l12wk) as dely_lne_qty_py_l12wk\n    ,sum(eaches_py_l12wk) as  eaches_py_l12wk\n    ,sum(dely_lne_qty_cy_l26wk) as dely_lne_qty_cy_l26wk\n    ,sum(eaches_cy_l26wk) as eaches_cy_l26wk\n    ,sum(dely_lne_qty_py_l26wk) as dely_lne_qty_py_l26wk\n    ,sum(eaches_py_l26wk) as eaches_py_l26wk\n    ,sum(dely_lne_qty_cy_l52wk) as dely_lne_qty_cy_l52wk\n    ,sum(eaches_cy_l52wk) as  eaches_cy_l52wk\n    ,sum(dely_lne_qty_py_l52wk) as dely_lne_qty_py_l52wk\n    ,sum(eaches_py_l52wk) as eaches_py_l52wk\n    ,sum(raw_vol_cy_ytd) as raw_vol_cy_ytd\n    ,sum(raw_vol_py) as raw_vol_py\n    ,sum(raw_vol_2py) as raw_vol_2py\n    ,sum(raw_vol_py_ytd) as raw_vol_py_ytd\n    ,sum(raw_vol_2py_ytd) as raw_vol_2py_ytd\n    ,sum(raw_vol_cy_l13p) as raw_vol_cy_l13p\n    ,sum(raw_vol_py_l13p) as raw_vol_py_l13p\n    ,sum(raw_vol_cy_l4wk) as raw_vol_cy_l4wk\n    ,sum(raw_vol_py_l4wk) as raw_vol_py_l4wk\n    ,sum(raw_vol_cy_l12wk) as raw_vol_cy_l12wk\n    ,sum(raw_vol_py_l12wk) as raw_vol_py_l12wk\n    ,sum(raw_vol_cy_l26wk) as raw_vol_cy_l26wk\n    ,sum(raw_vol_py_l26wk) as raw_vol_py_l26wk\n    ,sum(raw_vol_cy_l52wk) as raw_vol_cy_l52wk\n    ,sum(raw_vol_py_l52wk) as raw_vol_py_l52wk\n    ,sum(eght_oz_vol_cy_ytd) as eght_oz_vol_cy_ytd\n    ,sum(eght_oz_vol_py) as eght_oz_vol_py\n    ,sum(eght_oz_vol_2py) as eght_oz_vol_2py\n    ,sum(eght_oz_vol_py_ytd) as eght_oz_vol_py_ytd\n    ,sum(eght_oz_vol_2py_ytd) as eght_oz_vol_2py_ytd\n    ,sum(eght_oz_vol_cy_l13p) as eght_oz_vol_cy_l13p\n    ,sum(eght_oz_vol_py_l13p) as eght_oz_vol_py_l13p\n    ,sum(eght_oz_vol_cy_l4wk) as eght_oz_vol_cy_l4wk\n    ,sum(eght_oz_vol_py_l4wk) as eght_oz_vol_py_l4wk\n    ,sum(eght_oz_vol_cy_l12wk) as eght_oz_vol_cy_l12wk\n    ,sum(eght_oz_vol_py_l12wk) as eght_oz_vol_py_l12wk\n    ,sum(eght_oz_vol_cy_l26wk) as eght_oz_vol_cy_l26wk\n    ,sum(eght_oz_vol_py_l26wk) as eght_oz_vol_py_l26wk\n    ,sum(eght_oz_vol_cy_l52wk) as eght_oz_vol_cy_l52wk\n    ,sum(eght_oz_vol_py_l52wk) as eght_oz_vol_py_l52wk\n    ,sum(net_rev_cy_ytd) as net_rev_cy_ytd\n    ,sum(net_rev_py) as net_rev_py\n    ,sum(net_rev_2py) as net_rev_2py\n    ,sum(net_rev_py_ytd) as net_rev_py_ytd\n    ,sum(net_rev_2py_ytd) as net_rev_2py_ytd\n    ,sum(net_rev_cy_l13p) as net_rev_cy_l13p\n    ,sum(net_rev_py_l13p) as net_rev_py_l13p\n    ,sum(net_rev_cy_l4wk) as net_rev_cy_l4wk\n    ,sum(net_rev_py_l4wk) as net_rev_py_l4wk\n    ,sum(net_rev_cy_l12wk) as net_rev_cy_l12wk\n    ,sum(net_rev_py_l12wk) as net_rev_py_l12wk\n    ,sum(net_rev_cy_l26wk) as net_rev_cy_l26wk\n    ,sum(net_rev_py_l26wk) as net_rev_py_l26wk\n    ,sum(net_rev_cy_l52wk) as net_rev_cy_l52wk\n    ,sum(net_rev_py_l52wk) as net_rev_py_l52wk\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('cm_stage_btg_pbc_sales_cust_prod_upc') }}\ngroup by\n    msa_id\n    ,pbc_cust_id\n    ,upc_cde\n    ,upc_descp\n    ,cust_name\n    ,address\n    ,city\n    ,state\n    ,zip5\n    ,zip9\n    ,county\n    ,lat_qty\n    ,lngtd_qty\n    ,cur_stat_desc\n    ,division_id\n    ,division\n    ,region_id\n    ,region\n    ,market_id\n    ,market\n    ,location\n    ,terr_id\n    ,terr_nme\n    ,route_id\n    ,sub_channel_desc\n    ,grp1_lvl_1_desc\n    ,grp1_lvl_2_desc\n    ,grp2_lvl_1_desc\n    ,grp2_lvl_2_desc\n    ,channel_cde\n    ,channel_desc\n    ,format_cde\n    ,format_desc\n    ,ctgy_type_cde\n    ,ctgy_type_desc\n    ,mkt_trdmrk_id\n    ,mkt_trdmrk_desc\n    ,trdmrk_cde\n    ,trdmrk_desc\n    ,brand_cde\n    ,brnd_nme\n    ,flvr_cde\n    ,flvr_desc\n    ,hrzn_prod_ctgy_desc\n    ,hrzn_pkg_aggr_desc\n    ,cont_desc\n    ,pkg_cont_mtrl_desc\n    ,pkg_clstr_mtrl_desc\n    ,prod_grp_desc\n    ,cont_uom_desc\n    ,cont_uom_qty\n    ,clust_cde\n    ,clust_desc\n    ,clust_qty\n    ,ss_mp_ms\n    ,ss_th", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_prod_upc"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_upc.sql", "name": "cm_btg_pbc_sales_cust_prod_upc", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_prod_upc", "checksum": {"name": "sha256", "checksum": "3d68b6a5b53f3da6b90c94b10e12c11bb870dd024855292e3467594b9105cb7d"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_stage_btg_pbc_sales_cust_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_prod_v": {"raw_sql": "with\ntdlinx1 as (\n    select\n        upper(td.aulname) as aulname\n        ,upper(td.sgrpnm) as sgrpnm\n        ,upper(td.sname) as sname\n        ,upper(sno) as sno\n        ,upper(td.sstreetadd) as sstreetadd\n        ,upper(td.scity) as scity\n        ,upper(td.sst) as sst\n        ,substr(td.szip,1,5) as szip\n        ,upper(td.mcountynm) as mcountynm\n        ,td.fips\n        ,upper(td.stradeclcd) as stradeclcd\n        ,upper(td.sformatcd) as sformatcd\n        ,upper(td.stradecldesc) as stradecldesc\n        ,upper(td.sformatdesc) as sformatdesc\n        ,upper(td.sstatusind) as sstatusind\n        ,upper(td.stdlinxscd) as stdlinxscd\n        ,td.slat\n        ,td.slong\n        ,td.msa_id as tdl_msa_id\n        ,upper(rma.iri_retailer) as iri_retailer\n        ,upper(rma.iri_rma1) as iri_rma1\n        ,upper(rma.iri_rma2) as iri_rma2\n        ,upper(rma.iri_rma3) as iri_rma3\n        ,upper(rma.iri_rma4) as iri_rma4\n        ,upper(rma.iri_rma5) as iri_rma5\n        ,upper(rma.iri_rma6) as iri_rma6\n        ,upper(rma.iri_rma7) as iri_rma7\n        ,upper(rma.iri_rma8) as iri_rma8\n        ,upper(rma.iri_rma9) as iri_rma9\n        ,case\n            when upper(rma.iri_rma1) like '%-rma%' then 'rma'\n            when upper(rma.iri_rma1) like '%-srma%' then 'srma'\n            -- else 'na'\n        end as rma_srma\n        ,case\n            when srma.tdlinx_id is null then 'n'\n            else 'y'\n        end as corporate_srma\n        --,fi.fips as fips_iri\n        ,upper(fi.iri_pbc_div) as iri_pbc_div\n        ,upper(fi.iri_pbc_mkt) as iri_pbc_mkt\n        -- ,zip.zip_code as zip_code_zipfile\n        ,upper(zip.division) as division_zipfile\n        -- ,upper(zip.owner_name) as owner_name_zipfile\n        ,upper(zip.pbc_fbu_flg) as pbc_fbu_flg\n        ,upper(zip.market) as market_zipfile\n    from {{ ref('msa_tdlinx_xref_final') }} td\n    left join {{ ref('iri_rma_store_list') }} rma on (td.stdlinxscd = rma.tdlinx_id)\n    left join {{ ref('iri_srma_sample_stores') }} srma on (td.stdlinxscd = srma.tdlinx_id)\n    left join {{ ref('iri_pbc_markets_divs_by_fips') }} fi on (fi.fips = td.fips)\n    left join {{ ref('zip_code_priority_report') }} zip on (substr(trim(zip.zip_code),0,5) = substr(trim(td.szip),0,5))\n)\n,sls as (\n  select\n        s1.*\n        ,upper(z1.pbc_fbu_flg) as pbc_fbu_flg\n  from {{ ref('cm_btg_pbc_sales_cust_prod_upc') }} s1\n  left join {{ ref('zip_code_priority_report') }} z1 on (substr(trim(z1.zip_code),0,5) = substr(trim(s1.zip5),0,5))\n)\nselect \n    concat(\n         coalesce(tdlinx1.sstatusind,'null'), '|'\n        ,coalesce(sls.msa_id,'null'), '|'\n        ,coalesce(tdlinx1.iri_retailer,'null'), '|'\n        ,coalesce(tdlinx1.aulname,'null'), '|'\n        ,coalesce(tdlinx1.sgrpnm,'null'), '|'\n        ,coalesce(tdlinx1.stradeclcd,'null'), '|'\n        ,coalesce(tdlinx1.sformatcd,'null'), '|'\n        ,coalesce(coalesce(sls.division,tdlinx1.division_zipfile),'null'), '|'\n        ,coalesce(coalesce(sls.market,tdlinx1.market_zipfile),'null'), '|'\n        ,coalesce(sls.grp1_lvl_1_desc,'null'), '|'\n        ,coalesce(sls.ctgy_type_cde,'null'), '|'\n        ,coalesce(sls.mkt_trdmrk_id,'null'), '|'\n        ,coalesce(sls.ss_mp_ms,'null'), '|'\n        ,coalesce(sls.channel_cde,'null'), '|'\n        ,coalesce(sls.sub_channel_desc,'null'), '|'\n        ,coalesce(sls.cur_stat_desc,'null'), '|'\n        ,coalesce(sls.format_cde,'null'), '|'\n        ,coalesce(coalesce(tdlinx1.pbc_fbu_flg,sls.pbc_fbu_flg),'null')\n    ) as pbi_concat\n    ,tdlinx1.aulname\n    ,tdlinx1.sgrpnm\n    ,tdlinx1.sname\n    ,tdlinx1.sno\n    -- ,tdlinx1.sstreetadd\n    -- ,tdlinx1.scity\n    -- ,tdlinx1.sst\n    -- ,tdlinx1.szip\n    -- ,tdlinx1.mcountynm\n    ,tdlinx1.fips\n    ,tdlinx1.stradeclcd\n    ,tdlinx1.sformatcd\n    ,tdlinx1.stradecldesc\n    ,tdlinx1.sformatdesc\n    ,tdlinx1.sstatusind\n    ,tdlinx1.stdlinxscd\n    ,tdlinx1.slat\n    ,tdlinx1.slong\n    ,tdlinx1.tdl_msa_id\n    ,tdlinx1.iri_retailer\n    ,tdlinx1.iri_rma1\n    ,tdlinx1.iri_rma2\n    ,tdlinx1.iri_rma3\n    ,tdlinx1.iri_rma4\n    ,tdlinx1.iri_rma5\n    ,tdlinx1.iri_rma6\n    ,tdlinx1.iri_rma7\n    ,tdlinx1.iri_rma8\n    ,tdlinx1.iri_rma9\n    ,tdlinx1.rma_srma\n    ,tdlinx1.corporate_srma\n    ,tdlinx1.iri_pbc_div\n    ,tdlinx1.iri_pbc_mkt\n    ,coalesce(tdlinx1.pbc_fbu_flg,sls.pbc_fbu_flg) as pbc_fbu_flg\n    ,sls.msa_id\n    ,sls.pbc_cust_id\n    ,sls.upc_cde\n    ,sls.upc_descp\n    ,sls.cust_name\n    ,coalesce(tdlinx1.sstreetadd,sls.address) as address\n    ,coalesce(tdlinx1.scity,sls.city) as city\n    ,coalesce(tdlinx1.sst,sls.state) as state\n    ,coalesce(tdlinx1.szip,sls.zip5) as zip5\n    ,sls.zip9\n    ,coalesce(tdlinx1.mcountynm,sls.county) as county\n    ,sls.lat_qty\n    ,sls.lngtd_qty\n    ,sls.cur_stat_desc\n    ,sls.division_id\n    ,coalesce(sls.division,tdlinx1.division_zipfile) as division\n    ,sls.region_id\n    ,sls.region\n    ,sls.market_id\n    ,coalesce(sls.market,tdlinx1.market_zipfile) as market\n    ,sls.location\n    ,sls.terr_id\n    ,sls.terr_nme\n    ,sls.route_id\n    ,sls.sub_channel_desc\n    ,sls.grp1_lvl_1_desc\n    ,sls.grp1_lvl_2_desc\n    ,sls.grp2_lvl_1_desc\n    ,sls.grp2_lvl_2_desc\n    ,sls.channel_cde\n    ,sls.channel_desc\n    ,sls.format_cde\n    ,sls.format_desc\n    ,sls.ctgy_type_cde\n    ,sls.ctgy_type_desc\n    ,sls.mkt_trdmrk_id\n    ,sls.mkt_trdmrk_desc\n    ,sls.trdmrk_cde\n    ,sls.trdmrk_desc\n    ,sls.brand_cde\n    ,sls.brnd_nme\n    ,sls.flvr_cde\n    ,sls.flvr_desc\n    ,sls.hrzn_prod_ctgy_desc\n    ,sls.hrzn_pkg_aggr_desc\n    ,sls.cont_desc\n    ,sls.pkg_cont_mtrl_desc\n    ,sls.pkg_clstr_mtrl_desc\n    ,sls.prod_grp_desc\n    ,sls.cont_uom_desc\n    ,sls.cont_uom_qty\n    ,sls.clust_cde\n    ,sls.clust_desc\n    ,sls.clust_qty\n    ,sls.ss_mp_ms\n    ,sls.ss_th\n    ,sls.dely_lne_qty_cy_ytd \n    ,sls.eaches_cy_ytd                   \n    ,sls.dely_lne_qty_py   \n    ,sls.eaches_py                       \n    ,sls.dely_lne_qty_2py \n    ,sls.eaches_2py                      \n    ,sls.dely_lne_qty_py_ytd \n    ,sls.eaches_py_ytd                     \n    ,sls.dely_lne_qty_2py_ytd \n    ,sls.eaches_2py_ytd                     \n    ,sls.dely_lne_qty_cy_l13p \n    ,sls.eaches_cy_l13p                    \n    ,sls.dely_lne_qty_py_l13p \n    ,sls.eaches_py_l13p                     \n    ,sls.dely_lne_qty_cy_l4wk  \n    ,sls.eaches_cy_l4wk                    \n    ,sls.dely_lne_qty_py_l4wk \n    ,sls.eaches_py_l4wk                    \n    ,sls.dely_lne_qty_cy_l12wk \n    ,sls.eaches_cy_l12wk                   \n    ,sls.dely_lne_qty_py_l12wk  \n    ,sls.eaches_py_l12wk                  \n    ,sls.dely_lne_qty_cy_l26wk  \n    ,sls.eaches_cy_l26wk                   \n    ,sls.dely_lne_qty_py_l26wk  \n    ,sls.eaches_py_l26wk                   \n    ,sls.dely_lne_qty_cy_l52wk \n    ,sls.eaches_cy_l52wk                  \n    ,sls.dely_lne_qty_py_l52wk  \n    ,sls.eaches_py_l52wk                    \n    ,sls.raw_vol_cy_ytd                            \n    ,sls.raw_vol_py                                \n    ,sls.raw_vol_2py                               \n    ,sls.raw_vol_py_ytd                            \n    ,sls.raw_vol_2py_ytd                           \n    ,sls.raw_vol_cy_l13p                           \n    ,sls.raw_vol_py_l13p                           \n    ,sls.raw_vol_cy_l4wk                           \n    ,sls.raw_vol_py_l4wk                           \n    ,sls.raw_vol_cy_l12wk                          \n    ,sls.raw_vol_py_l12wk                          \n    ,sls.raw_vol_cy_l26wk                          \n    ,sls.raw_vol_py_l26wk                          \n    ,sls.raw_vol_cy_l52wk                          \n    ,sls.raw_vol_py_l52wk                          \n    ,sls.eght_oz_vol_cy_ytd                        \n    ,sls.eght_oz_vol_py                            \n    ,sls.eght_oz_vol_2py                           \n    ,sls.eght_oz_vol_py_ytd                        \n    ,sls.eght_oz_vol_2py_ytd                       \n    ,sls.eght_oz_vol_cy_l13p                       \n    ,sls.eght_oz_vol_py_l13p                       \n    ,sls.eght_oz_vol_cy_l4wk                       \n    ,sls.eght_oz_vol_py_l4wk                       \n    ,sls.eght_oz_vol_cy_l12wk                      \n    ,sls.eght_oz_vol_py_l12wk                     \n    ,sls.eght_oz_vol_cy_l26wk                      \n    ,sls.eght_oz_vol_py_l26wk                      \n    ,sls.eght_oz_vol_cy_l52wk                      \n    ,sls.eght_oz_vol_py_l52wk                      \n    ,sls.net_rev_cy_ytd                            \n    ,sls.net_rev_py                                 \n    ,sls.net_rev_2py                               \n    ,sls.net_rev_py_ytd                            \n    ,sls.net_rev_2py_ytd                            \n    ,sls.net_rev_cy_l13p                           \n    ,sls.net_rev_py_l13p                           \n    ,sls.net_rev_cy_l4wk                           \n    ,sls.net_rev_py_l4wk                           \n    ,sls.net_rev_cy_l12wk                          \n    ,sls.net_rev_py_l12wk                          \n    ,sls.net_rev_cy_l26wk                          \n    ,sls.net_rev_py_l26wk                          \n    ,sls.net_rev_cy_l52wk                          \n    ,sls.net_rev_py_l52wk       \n    ,current_timestamp() as last_updt_dt\nfrom tdlinx1\nfull join sls on (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_prod_v"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_prod_v.sql", "name": "cm_btg_pbc_sales_cust_prod_v", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_prod_v", "checksum": {"name": "sha256", "checksum": "f97b5962f848e20a6f1c4fadc3a10ce52cb7605e73a1d7a78823b1f086d58573"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_pbc_sales_cust_prod_upc"], ["zip_code_priority_report"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_pbc_sales_cust_prod_upc", "model.sdna_project.zip_code_priority_report"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid": {"raw_sql": "-- Load cm_btg_pbc_sales_cust_wk_prod_invenid\n\n-- {{ ref('btg_pbc_sales_cust_wk_prod_v') }}\n-- {{ ref('btg_pbc_cust_v') }}\n-- {{ ref('btg_msa_lat_lon_v') }}\n-- {{ ref('btg_pbc_prod_v') }}\n-- {{ ref('btg_pbc_new_mkt_loc') }}\n-- {{ ref('btg_pbc_route_data') }}\n\nSELECT\n    sls.msa_id,\n\tsls.pbc_cust_id,\n\tsls.inven_id,\n\tprod.upc_cde,\n\tprod.nme AS upc_descp --cust attributes\n\t,\n\tcust.NME AS cust_name,\n\tcust.dely_adr_strt1 AS address,\n\tcust.dely_adr_city AS city,\n\tcust.dely_adr_state AS state,\n\tcust.dely_adr_zip5 AS zip5,\n\tcust.dely_adr_zip AS zip9,\n\tcust.dely_adr_cnty AS county --lat-long table attributes\n\t,\n\tll.lat_qty,\n\tll.lngtd_qty,\n\tcust.cur_stat_desc --Division hierarchy attributes\n\t,\n\tmkt.hq_id AS division_ID,\n\tmkt.hq_nme AS division,\n\tmkt.bu_id AS region_ID,\n\tmkt.bu_nme AS region,\n\tmkt.mu_id AS market_ID,\n\tmkt.mu_nme AS market,\n\tmkt.loc_NME AS location --rte attributes\n\t,\n\trte.terr_id,\n\trte.TERR_NME,\n\trte.RTE_ID AS route_ID --some more cust attributes\n\t,\n\tcust.bus_type_desc AS sub_channel_desc,\n\tcust.grp1_lvl_1_desc,\n\tcust.grp1_lvl_2_desc,\n\tcust.grp2_lvl_1_desc,\n\tcust.grp2_lvl_2_desc,\n\tcust.bus_type_aggr_cde AS channel_cde,\n\tcust.bus_type_aggr_desc AS channel_desc,\n\tcust.bus_type_ctgy_cde AS format_cde,\n\tcust.bus_type_ctgy_desc AS format_desc --prod attributes\n\t,\n\tprod.ctgy_type_cde,\n\tprod.ctgy_type_desc,\n\tprod.mkt_trdmrk_id,\n\tpROD.mkt_trdmrk_desc,\n\tprod.trdmrk_cde,\n\tprod.trdmrk_desc,\n\tprod.brnd_id AS brand_cde,\n\tprod.brnd_nme,\n\tprod.flvr_cde,\n\tprod.flvr_desc,\n\n\tpROD.hrzn_prod_ctgy_desc,\n\tpROD.hrzn_pkg_aggr_desc,\n\n\tpROD.cont_desc,\n\tpROD.pkg_cont_mtrl_desc,\n\tpROD.pkg_clstr_mtrl_desc,\n\tpROD.prod_grp_desc,\n\tpROD.cont_uom_desc,\n\tpROD.cont_uom_qty,\n\tprod.clust_cde,\n\tprod.clust_desc,\n\tprod.clust_qty,\n\n\tNULL AS ss_mp_ms,\n\tNULL AS ss_th --sls remaining columns\n\t,\n\tsls.fscl_wk_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.fscl_wk_in_pd_num,\n\tsls.dely_lne_qty AS cases,\n\tsls.dely_lne_qty * prod.config_qty AS eaches,\n\tsls.raw_vol,\n\tsls.eght_oz_vol,\n\tsls.net_rev,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\t{{ ref('btg_pbc_sales_cust_wk_prod_v') }} AS sls\n\tLEFT JOIN {{ ref('btg_pbc_cust_v') }} AS cust on (cust.cust_id = sls.pbc_cust_id)\n\tLEFT JOIN {{ ref('btg_msa_lat_lon_v') }} AS ll on (ll.msa_id = sls.msa_id)\n\tLEFT JOIN {{ ref('btg_pbc_prod_v') }} AS prod on (prod.inven_id = sls.inven_id)\n\tLEFT JOIN {{ ref('btg_pbc_new_mkt_loc') }} AS mkt on (mkt.cust_id = sls.pbc_cust_id)\n\tLEFT JOIN {{ ref('btg_pbc_route_data') }} AS rte on (rte.cust_id = sls.pbc_cust_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_wk_prod_invenid"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_invenid.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_invenid.sql", "name": "cm_btg_pbc_sales_cust_wk_prod_invenid", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_wk_prod_invenid", "checksum": {"name": "sha256", "checksum": "b250cb837624ff5559a2860bf7c134260d3da4ad0e8752632f6c89117685cfe0"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_wk_prod_v"], ["btg_pbc_cust_v"], ["btg_msa_lat_lon_v"], ["btg_pbc_prod_v"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"], ["btg_pbc_sales_cust_wk_prod_v"], ["btg_pbc_cust_v"], ["btg_msa_lat_lon_v"], ["btg_pbc_prod_v"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc": {"raw_sql": "-- Load cm_btg_pbc_sales_cust_wk_prod_upc\n\n-- {{ ref('cm_stage_btg_pbc_sales_cust_wk_prod_upc') }}\n\nSELECT\n    msa_id,\n\tpbc_cust_id,\n\tupc_cde,\n\tUPPER(upc_descp) AS upc_descp,\n\tUPPER(cust_name) AS cust_name,\n\tUPPER(address) AS address,\n\tUPPER(city) AS city,\n\tUPPER(state) AS state,\n\tzip5,\n\tzip9,\n\tUPPER(county) AS county,\n\tlat_qty,\n\tlngtd_qty,\n\tUPPER(cur_stat_desc) AS cur_stat_desc,\n\tdivision_id,\n\tUPPER(division) AS division,\n\tregion_id,\n\tUPPER(region) AS region,\n\tmarket_id,\n\tUPPER(market) AS market,\n\tUPPER(location) AS location,\n\tterr_id,\n\tUPPER(terr_nme) AS terr_nme,\n\troute_id,\n\tUPPER(sub_channel_desc) AS sub_channel_desc,\n\tUPPER(grp1_lvl_1_desc) AS grp1_lvl_1_desc,\n\tUPPER(grp1_lvl_2_desc) AS grp1_lvl_2_desc,\n\tUPPER(grp2_lvl_1_desc) AS grp2_lvl_1_desc,\n\tUPPER(grp2_lvl_2_desc) AS grp2_lvl_2_desc,\n\tUPPER(channel_cde) AS channel_cde,\n\tUPPER(channel_desc) AS channel_desc,\n\tUPPER(format_cde) AS format_cde,\n\tUPPER(format_desc) AS format_desc,\n\tUPPER(ctgy_type_cde) AS ctgy_type_cde,\n\tUPPER(ctgy_type_desc) AS ctgy_type_desc,\n\tUPPER(mkt_trdmrk_id) AS mkt_trdmrk_id,\n\tUPPER(mkt_trdmrk_desc) AS mkt_trdmrk_desc,\n\tUPPER(trdmrk_cde) AS trdmrk_cde,\n\tUPPER(trdmrk_desc) AS trdmrk_desc,\n\tbrand_cde,\n\tUPPER(brnd_nme) AS brnd_nme,\n\tUPPER(flvr_cde) AS flvr_cde,\n\tUPPER(flvr_desc) AS flvr_desc,\n\tUPPER(hrzn_prod_ctgy_desc) AS hrzn_prod_ctgy_desc,\n\tUPPER(hrzn_pkg_aggr_desc) AS hrzn_pkg_aggr_desc,\n\tUPPER(cont_desc) AS cont_desc,\n\tUPPER(pkg_cont_mtrl_desc) AS pkg_cont_mtrl_desc,\n\tUPPER(pkg_clstr_mtrl_desc) AS pkg_clstr_mtrl_desc,\n\tUPPER(prod_grp_desc) AS prod_grp_desc,\n\tUPPER(cont_uom_desc) AS cont_uom_desc,\n\tcont_uom_qty,\n\tUPPER(clust_cde) AS clust_cde,\n\tUPPER(clust_desc) AS clust_desc,\n\tclust_qty,\n\tUPPER(ss_mp_ms) AS ss_mp_ms,\n\tUPPER(ss_th) AS ss_th,\n\tfscl_wk_end_dte,\n\tfscl_yr_num,\n\tfscl_pd_num,\n\tfscl_wk_in_pd_num,\n\tSUM(cases) AS cases,\n\tSUM(eaches) AS eaches,\n\tSUM(raw_vol) AS raw_vol,\n\tSUM(eght_oz_vol) AS eght_oz_vol,\n\tSUM(net_rev) AS net_rev,\n    CURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('cm_stage_btg_pbc_sales_cust_wk_prod_upc') }}\nGROUP BY\n\tmsa_id,\n\tpbc_cust_id,\n\tupc_cde,\n\tupc_descp,\n\tcust_name,\n\taddress,\n\tcity,\n\tstate,\n\tzip5,\n\tzip9,\n\tcounty,\n\tlat_qty,\n\tlngtd_qty,\n\tcur_stat_desc,\n\tdivision_id,\n\tdivision,\n\tregion_id,\n\tregion,\n\tmarket_id,\n\tmarket,\n\tlocation,\n\tterr_id,\n\tterr_nme,\n\troute_id,\n\tsub_channel_desc,\n\tgrp1_lvl_1_desc,\n\tgrp1_lvl_2_desc,\n\tgrp2_lvl_1_desc,\n\tgrp2_lvl_2_desc,\n\tchannel_cde,\n\tchannel_desc,\n\tformat_cde,\n\tformat_desc,\n\tctgy_type_cde,\n\tctgy_type_desc,\n\tmkt_trdmrk_id,\n\tmkt_trdmrk_desc,\n\ttrdmrk_cde,\n\ttrdmrk_desc,\n\tbrand_cde,\n\tbrnd_nme,\n\tflvr_cde,\n\tflvr_desc,\n\thrzn_prod_ctgy_desc,\n\thrzn_pkg_aggr_desc,\n\tcont_desc,\n\tpkg_cont_mtrl_desc,\n\tpkg_clstr_mtrl_desc,\n\tprod_grp_desc,\n\tcont_uom_desc,\n\tcont_uom_qty,\n\tclust_cde,\n\tclust_desc,\n\tclust_qty,\n\tss_mp_ms,\n\tss_th,\n\tfscl_wk_end_dte,\n\tfscl_yr_num,\n\tfscl_pd_num,\n\tfscl_wk_in_pd_num", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_wk_prod_upc"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_upc.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_upc.sql", "name": "cm_btg_pbc_sales_cust_wk_prod_upc", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_wk_prod_upc", "checksum": {"name": "sha256", "checksum": "57ea46f7da0cdbd9c4e98b8bb96d5155ef2906d856617123ed61867f0f47d25e"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["cm_stage_btg_pbc_sales_cust_wk_prod_upc"], ["cm_stage_btg_pbc_sales_cust_wk_prod_upc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v": {"raw_sql": "-- Load cm_btg_pbc_sales_cust_wk_prod_v\n\n-- {{ ref('msa_tdlinx_xref_final') }}\n-- {{ ref('cm_btg_pbc_sales_cust_wk_prod_upc') }}\n-- {{ ref('iri_rma_store_list') }}\n-- {{ ref('iri_srma_sample_stores') }}\n-- {{ ref('iri_pbc_markets_divs_by_fips') }}\n-- {{ ref('zip_code_priority_report') }}\n\nWITH sls AS\n(\n\tSELECT\n\t\ts1.*,\n\t\tUPPER(z1.pbc_fbu_flg) AS pbc_fbu_flg\n\tFROM\n        {{ ref('cm_btg_pbc_sales_cust_wk_prod_upc') }} AS s1\n\t\tLEFT JOIN {{ ref('zip_code_priority_report') }} AS z1\n            ON (SUBSTR(TRIM(z1.zip_code), 0, 5) = SUBSTR(TRIM(s1.zip5), 0, 5))\n)\nSELECT\n\tCONCAT(\n\t\tCOALESCE(tdlinx1.sstatusind, 'null'), '|',\n\t\tCOALESCE(sls.msa_id, 'null'), '|',\n\t\tCOALESCE(tdlinx1.iri_retailer, 'null'), '|',\n\t\tCOALESCE(tdlinx1.aulname, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sgrpnm, 'null'), '|',\n\t\tCOALESCE(tdlinx1.stradeclcd, 'null'), '|',\n\t\tCOALESCE(tdlinx1.sformatcd, 'null'), '|',\n\t\tCOALESCE(COALESCE(sls.division, tdlinx1.division_zipfile), 'null'), '|',\n\t\tCOALESCE(COALESCE(sls.market, tdlinx1.market_zipfile),'null'), '|',\n\t\tCOALESCE(sls.grp1_lvl_1_desc, 'null'), '|',\n\t\tCOALESCE(sls.ctgy_type_cde, 'null'), '|',\n\t\tCOALESCE(sls.mkt_trdmrk_id, 'null'), '|',\n\t\tCOALESCE(sls.ss_mp_ms, 'null'), '|',\n\t\tCOALESCE(sls.channel_cde, 'null'), '|',\n\t\tCOALESCE(sls.sub_channel_desc, 'null'), '|',\n\t\tCOALESCE(sls.cur_stat_desc, 'null'), '|',\n\t\tCOALESCE(sls.format_cde, 'null'), '|',\n\t\tCOALESCE(COALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg), 'null')\n\t) AS pbi_concat,\n\ttdlinx1.AULNAME,\n\ttdlinx1.SGRPNM,\n\ttdlinx1.SNAME,\n\ttdlinx1.SNO,\n\ttdlinx1.FIPS,\n\ttdlinx1.STRADECLCD,\n\ttdlinx1.SFORMATCD,\n\ttdlinx1.STRADECLDESC,\n\ttdlinx1.SFORMATDESC,\n\ttdlinx1.SSTATUSIND,\n\ttdlinx1.STDLINXSCD,\n\ttdlinx1.SLAT,\n\ttdlinx1.SLONG,\n\ttdlinx1.tdl_msa_id,\n\ttdlinx1.iri_retailer,\n\ttdlinx1.iri_rma1,\n\ttdlinx1.iri_rma2,\n\ttdlinx1.iri_rma3,\n\ttdlinx1.iri_rma4,\n\ttdlinx1.iri_rma5,\n\ttdlinx1.iri_rma6,\n\ttdlinx1.iri_rma7,\n\ttdlinx1.iri_rma8,\n\ttdlinx1.iri_rma9,\n\ttdlinx1.RMA_SRMA,\n\ttdlinx1.corporate_srma,\n\ttdlinx1.iri_pbc_div,\n\ttdlinx1.iri_pbc_mkt,\n\tCOALESCE(tdlinx1.pbc_fbu_flg, sls.pbc_fbu_flg) AS pbc_fbu_flg,\n\tsls.msa_id,\n\tsls.pbc_cust_id,\n\tsls.upc_cde,\n\tsls.upc_descp,\n\tsls.cust_name,\n\tCOALESCE(tdlinx1.SSTREETADD, sls.address) AS address,\n\tCOALESCE(tdlinx1.SCITY, sls.city) AS city,\n\tCOALESCE(tdlinx1.SST, sls.state) AS state,\n\tCOALESCE(tdlinx1.SZIP, sls.zip5) AS zip5,\n\tsls.zip9,\n\tCOALESCE(tdlinx1.MCOUNTYNM, sls.county) AS county,\n\tsls.lat_qty,\n\tsls.lngtd_qty,\n\tsls.cur_stat_desc,\n\tsls.division_id,\n\tCOALESCE(sls.division, tdlinx1.division_zipfile) AS division,\n\tsls.region_id,\n\tsls.region,\n\tsls.market_id,\n\tCOALESCE(sls.market, tdlinx1.market_zipfile) AS market,\n\tsls.location,\n\tsls.terr_id,\n\tsls.terr_nme,\n\tsls.route_id,\n\tsls.sub_channel_desc,\n\tsls.grp1_lvl_1_desc,\n\tsls.grp1_lvl_2_desc,\n\tsls.grp2_lvl_1_desc,\n\tsls.grp2_lvl_2_desc,\n\tsls.channel_cde,\n\tsls.channel_desc,\n\tsls.format_cde,\n\tsls.format_desc,\n\tsls.ctgy_type_cde,\n\tsls.ctgy_type_desc,\n\tsls.mkt_trdmrk_id,\n\tsls.mkt_trdmrk_desc,\n\tsls.trdmrk_cde,\n\tsls.trdmrk_desc,\n\tsls.brand_cde,\n\tsls.brnd_nme,\n\tsls.flvr_cde,\n\tsls.flvr_desc,\n\tsls.hrzn_prod_ctgy_desc,\n\tsls.hrzn_pkg_aggr_desc,\n\tsls.cont_desc,\n\tsls.pkg_cont_mtrl_desc,\n\tsls.pkg_clstr_mtrl_desc,\n\tsls.prod_grp_desc,\n\tsls.cont_uom_desc,\n\tsls.cont_uom_qty,\n\tsls.clust_cde,\n\tsls.clust_desc,\n\tsls.clust_qty,\n\tsls.ss_mp_ms,\n\tsls.ss_th,\n\tsls.fscl_wk_end_dte,\n\tsls.fscl_yr_num,\n\tsls.fscl_pd_num,\n\tsls.fscl_wk_in_pd_num,\n\tsls.cases,\n\tsls.eaches,\n\tsls.raw_vol,\n\tsls.eght_oz_vol,\n\tsls.net_rev,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('cm_btg_pbc_sales_tdlinx1') }} AS tdlinx1\n        FULL JOIN sls ON (sls.msa_id = tdlinx1.tdl_msa_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "cm_btg_pbc_sales_cust_wk_prod_v"], "unique_id": "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_v.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/cm_btg_pbc_sales_cust_wk_prod_v.sql", "name": "cm_btg_pbc_sales_cust_wk_prod_v", "resource_type": "model", "alias": "cm_btg_pbc_sales_cust_wk_prod_v", "checksum": {"name": "sha256", "checksum": "481e137043c7aa86ec3a553c99b6810fb64aee7e9d358d3df6174b3a97c322b9"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["msa_tdlinx_xref_final"], ["cm_btg_pbc_sales_cust_wk_prod_upc"], ["iri_rma_store_list"], ["iri_srma_sample_stores"], ["iri_pbc_markets_divs_by_fips"], ["zip_code_priority_report"], ["cm_btg_pbc_sales_cust_wk_prod_upc"], ["zip_code_priority_report"], ["cm_btg_pbc_sales_tdlinx1"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.zip_code_priority_report", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_fl_prod": {"raw_sql": "-- Load dx_fl_prod\n\n-- {{ ref('fl_prod') }}\n-- {{ ref('dx_fl_sales_cust_wk_prod') }}\n\nSELECT\n    btgflprd.prod_upc AS prod_upc,\n\tbtgflprd.prod_slbl AS prod_slbl,\n\tbtgflprd.gtin AS gtin,\n\tbtgflprd.prod_tkt_descp_txt AS prod_tkt_descp_txt,\n\tbtgflprd.prt_wt AS prt_wt,\n\tbtgflprd.sale_class_code AS sale_class_code,\n\tbtgflprd.sale_class_descp AS sale_class_descp,\n\tbtgflprd.size_code AS size_code,\n\tbtgflprd.size_descp AS size_descp,\n\tbtgflprd.flvr_code AS flvr_code,\n\tbtgflprd.flvr_descp AS flvr_descp,\n\tbtgflprd.bdc_descp AS bdc_descp,\n\tbtgflprd.bus_unit_code AS bus_unit_code,\n\tbtgflprd.bus_unit_descp AS bus_unit_descp,\n\tbtgflprd.categ_code AS categ_code,\n\tbtgflprd.brand_code AS brand_code,\n\tbtgflprd.brand_descp AS brand_descp,\n\tbtgflprd.upc_mfg_id AS upc_mfg_id,\n\tCONCAT(\n\t\tSUBSTR(btgflprd.upc_mfg_id, -5),\n\t\tSUBSTR(CONCAT('0000', btgflprd.prod_upc), -5)\n\t) AS upc_10,\n\tSUBSTR(btgflprd.gtin, 2, 12) AS iri_eq_upc,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n    {{ ref('fl_prod') }} AS btgflprd\n\tJOIN (\n\t\tSELECT\n\t\t\tDISTINCT flslscustwkv.prod_upc,\n\t\t\tflslscustwkv.prod_slbl\n\t\tFROM\n\t\t\t{{ ref('dx_fl_sales_cust_wk_prod') }} AS flslscustwkv\n\t) AS dxflslscustwkv\n        ON btgflprd.prod_upc = dxflslscustwkv.prod_upc AND btgflprd.prod_slbl = dxflslscustwkv.prod_slbl", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "dx_fl_prod"], "unique_id": "model.sdna_project.dx_fl_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/dx_fl_prod.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/dx_fl_prod.sql", "name": "dx_fl_prod", "resource_type": "model", "alias": "dx_fl_prod", "checksum": {"name": "sha256", "checksum": "ea0f4aa73f7884ce92b3cf893ba841e1eca7085d4d01e073e93917bf229a7354"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["fl_prod"], ["dx_fl_sales_cust_wk_prod"], ["fl_prod"], ["dx_fl_sales_cust_wk_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.fl_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.fl_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_fl_sales_cust_wk_prod_extend": {"raw_sql": "with prod as (\n    select *\n    ,case when bus_unit_code='099' then bus_unit_code else 'ot' end as bus_unit_code_new\n    ,case when bus_unit_code='099' then bus_unit_descp else 'ot' end as bus_unit_descp_new\n    ,case\n        when bus_unit_code='099'then 'ssf' --//single serve flex\n        when  (bus_unit_code in ('007','008','043','060','072','114')) then 'cf'\n        when  bus_unit_code='010' then 'dip'\n        when  bus_unit_code='085' then 'multipak'\n        else 'takehome'\n     end as major_cat\n    from {{ ref('dx_fl_prod') }}\n)\nselect\n    sls.dx_id\n    --store attributes\n    ,upper(str.fl_cust_nm) as store_name\n    ,upper(str.btg_address) as address\n    ,upper(str.btg_city) as city\n    ,upper(str.btg_state) as state\n    ,str.btg_zip5 as zip5\n    ,str.btg_zip as zip9\n    ,upper(str.btg_county) as county\n    ,str.latitude\n    ,str.longitude\n    ,str.fl_geo_lvl1_node_nbr as division_id\n    ,upper(str.fl_geo_lvl1_node_nm) as division\n    ,str.fl_geo_lvl2_node_nbr as region_id\n    ,upper(str.fl_geo_lvl2_node_nm) as region\n    ,str.fl_geo_lvl3_node_nbr as zone_id\n    ,upper(str.fl_geo_lvl3_node_nm) as zone\n    ,str.fl_geo_lvl4_node_nbr as district_id\n    ,upper(str.fl_geo_lvl4_node_nm) as district\n    ,str.fl_rt_nbr as route_number\n    ,str.fl_trade_chanl_code\n    ,upper(str.fl_trade_chanl_descp) as fl_trade_chanl_descp\n    ,upper(str.btg_format) as format\n    ,upper(coalesce(str.fl_chain_lvl1_node_nm,str.btg_retailer)) as retailer\n    ,sls.prod_upc\n    ,sls.prod_slbl\n    ,prod.upc_mfg_id\n    --prod attributes\n    ,prod.categ_code\n    ,prod.bus_unit_code as trrdmrk_cde\n    ,upper(prod.bus_unit_descp) as trdmark_desc\n    ,prod.brand_code as brand_cde\n    ,upper(prod.brand_descp) as brnd_desc\n    ,prod.flvr_code as flvr_id\n    ,upper(prod.flvr_descp) as flvr_desc\n    ,upper(prod.prod_tkt_descp_txt) as pkg_nme\n    ,concat(prod.prod_upc,prod.prod_slbl) as upc_cde\n    ,prod.upc_10 as upc_10\n    ,upper(prod.bdc_descp) as bdc_desc\n    ,prod.gtin\n    ,upper(prod.bus_unit_code_new) as bus_unit_code_new\n    ,upper(prod.bus_unit_descp_new) as bus_unit_descp_new\n    ,upper(prod.major_cat) as major_cat\n    ,case\n          when (prod.major_cat='ssf') then\n            (case prod.size_descp\n                when 'xxvl strip' then 'x-xvl'\n                when 'xxvl' then 'x-xvl'\n                when 'sglwkend     ppw'  then 'ppw'\n                when 'sglwkend ppw' then 'ppw'\n            else prod.size_descp\n            end)\n          else prod.major_cat\n     end as major_cat_size\n    --remaining sls columns\n    ,sls.fscl_wk_end_dte\n    ,sls.fscl_yr_num\n    ,sls.fscl_pd_num\n    ,sls.fscl_wk_in_pd_num\n    ,sls.net_tkt_sale_amt\n    ,sls.net_tkt_sale_qty\n    ,sls.net_tkt_sale_wt\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('dx_fl_sales_cust_wk_prod') }} sls\nleft join {{ ref('dx_store_attr') }} str on (str.dx_id = sls.dx_id)\nleft join prod on (prod.prod_upc = sls.prod_upc and prod.prod_slbl = sls.prod_slbl)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "dx_fl_sales_cust_wk_prod_extend"], "unique_id": "model.sdna_project.dx_fl_sales_cust_wk_prod_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/dx_fl_sales_cust_wk_prod_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/dx_fl_sales_cust_wk_prod_extend.sql", "name": "dx_fl_sales_cust_wk_prod_extend", "resource_type": "model", "alias": "dx_fl_sales_cust_wk_prod_extend", "checksum": {"name": "sha256", "checksum": "b50f8e7479f2a068e03657752b06b8b5643b3439ceb2e7a716cc6c49b5540519"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_fl_prod"], ["dx_fl_sales_cust_wk_prod"], ["dx_store_attr"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_fl_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_store_attr"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_pbc_prod": {"raw_sql": "-- Load dx_pbc_prod\n\n-- {{ ref('pbc_prod') }}\n-- {{ ref('dx_pbc_sales_cust_wk_prod') }}\n\nWITH btgpbcprd AS (\n    SELECT\n\t\tpbc_prod.inven_id AS inven_id,\n\t\tpbc_prod.inven_dply_grp_nme AS inven_dply_grp_nme,\n\t\tpbc_prod.brnd_id AS brnd_id,\n\t\tpbc_prod.pkg_id AS pkg_id,\n\t\tpbc_prod.inven_type_cde AS inven_type_cde,\n\t\tpbc_prod.inven_type_desc AS inven_type_desc,\n\t\tpbc_prod.nme AS nme,\n\t\tpbc_prod.inven_dply_seq_num AS inven_dply_seq_num,\n\t\tpbc_prod.inven_dply_grp_seq AS inven_dply_grp_seq,\n\t\tpbc_prod.inven_dply_nme AS inven_dply_nme,\n\t\tpbc_prod.purch_ctgy_id AS purch_ctgy_id,\n\t\tpbc_prod.ord_ref_num AS ord_ref_num,\n\t\tpbc_prod.inven_uom_cde AS inven_uom_cde,\n\t\tpbc_prod.inven_uom_desc AS inven_uom_desc,\n\t\tpbc_prod.create_dte AS create_dte,\n\t\tpbc_prod.upc_cde AS upc_cde,\n\t\tpbc_prod.inven_sfty_stk_pct AS inven_sfty_stk_pct,\n\t\tpbc_prod.prod_mix_cde AS prod_mix_cde,\n\t\tpbc_prod.prod_mix_desc AS prod_mix_desc,\n\t\tpbc_prod.prod_grp_cde AS prod_grp_cde,\n\t\tpbc_prod.prod_grp_desc AS prod_grp_desc,\n\t\tpbc_prod.prod_type_cde AS prod_type_cde,\n\t\tpbc_prod.prod_type_desc AS prod_type_desc,\n\t\tpbc_prod.avg_flr_cost_amt AS avg_flr_cost_amt,\n\t\tpbc_prod.std_wgt_qty AS std_wgt_qty,\n\t\tpbc_prod.natl_acct_cde AS natl_acct_cde,\n\t\tpbc_prod.natl_acct_desc AS natl_acct_desc,\n\t\tpbc_prod.prod_8oz_conv_fctr AS prod_8oz_conv_fctr,\n\t\tpbc_prod.conc_mark_up_amt AS conc_mark_up_amt,\n\t\tpbc_prod.sply_type_cde AS sply_type_cde,\n\t\tpbc_prod.sply_type_desc AS sply_type_desc,\n\t\tpbc_prod.serv_type_cde AS serv_type_cde,\n\t\tpbc_prod.serv_type_desc AS serv_type_desc,\n\t\tpbc_prod.brnd_nme AS brnd_nme,\n\t\tpbc_prod.trdmrk_cde AS trdmrk_cde,\n\t\tpbc_prod.trdmrk_desc AS trdmrk_desc,\n\t\tpbc_prod.flvr_cde AS flvr_cde,\n\t\tpbc_prod.flvr_desc AS flvr_desc,\n\t\tpbc_prod.corp_cde AS corp_cde,\n\t\tpbc_prod.corp_desc AS corp_desc,\n\t\tpbc_prod.ctgy_type_cde AS ctgy_type_cde,\n\t\tpbc_prod.ctgy_type_desc AS ctgy_type_desc,\n\t\tpbc_prod.caff_flg AS caff_flg,\n\t\tpbc_prod.brnd_juice_pct AS brnd_juice_pct,\n\t\tpbc_prod.brnd_shrt_nme AS brnd_shrt_nme,\n\t\tpbc_prod.brnd_swtnr_cde AS brnd_swtnr_cde,\n\t\tpbc_prod.brnd_swtnr_desc AS brnd_swtnr_desc,\n\t\tpbc_prod.pkg_nr_flag AS pkg_nr_flag,\n\t\tpbc_prod.clust_cde AS clust_cde,\n\t\tpbc_prod.clust_desc AS clust_desc,\n\t\tpbc_prod.clust_qty AS clust_qty,\n\t\tpbc_prod.config_qty AS config_qty,\n\t\tpbc_prod.pkg_nme AS pkg_nme,\n\t\tpbc_prod.pkg_shrt_nme AS pkg_shrt_nme,\n\t\tpbc_prod.rpt_pkg_id AS rpt_pkg_id,\n\t\tpbc_prod.cont_cde AS cont_cde,\n\t\tpbc_prod.cont_desc AS cont_desc,\n\t\tpbc_prod.cont_uom_cde AS cont_uom_cde,\n\t\tpbc_prod.cont_uom_desc AS cont_uom_desc,\n\t\tpbc_prod.cont_uom_qty AS cont_uom_qty,\n\t\tpbc_prod.cont_nr_flag AS cont_nr_flag,\n\t\tpbc_prod.pkg_cont_mtrl_cde AS pkg_cont_mtrl_cde,\n\t\tpbc_prod.pkg_cont_mtrl_desc AS pkg_cont_mtrl_desc,\n\t\tpbc_prod.pkg_clstr_mtrl_cde AS pkg_clstr_mtrl_cde,\n\t\tpbc_prod.pkg_clstr_mtrl_desc AS pkg_clstr_mtrl_desc,\n\t\tpbc_prod.pkg_mtrl_cde AS pkg_mtrl_cde,\n\t\tpbc_prod.pkg_mtl_desc AS pkg_mtl_desc,\n\t\tpbc_prod.pkg_cont_st_dp_flg AS pkg_cont_st_dp_flg,\n\t\tpbc_prod.logo_id AS logo_id,\n\t\tpbc_prod.logo_desc AS logo_desc,\n\t\tpbc_prod.hrzn_prod_grp_id AS hrzn_prod_grp_id,\n\t\tpbc_prod.hrzn_prod_grp_desc AS hrzn_prod_grp_desc,\n\t\tpbc_prod.hrzn_pkg_grp_id AS hrzn_pkg_grp_id,\n\t\tpbc_prod.hrzn_pkg_grp_desc AS hrzn_pkg_grp_desc,\n\t\tpbc_prod.hrzn_prod_ctgy_id AS hrzn_prod_ctgy_id,\n\t\tpbc_prod.hrzn_prod_ctgy_desc AS hrzn_prod_ctgy_desc,\n\t\tpbc_prod.hrzn_brnd_ctgy_id AS hrzn_brnd_ctgy_id,\n\t\tpbc_prod.hrzn_brnd_ctgy_desc AS hrzn_brnd_ctgy_desc,\n\t\tpbc_prod.hrzn_pkg_ctgy_id AS hrzn_pkg_ctgy_id,\n\t\tpbc_prod.hrzn_pkg_ctgy_desc AS hrzn_pkg_ctgy_desc,\n\t\tpbc_prod.hrzn_pkg_aggr_id AS hrzn_pkg_aggr_id,\n\t\tpbc_prod.hrzn_pkg_aggr_desc AS hrzn_pkg_aggr_desc,\n\t\tpbc_prod.hrzn_corp_aggr_id AS hrzn_corp_aggr_id,\n\t\tpbc_prod.hrzn_corp_aggr_desc AS hrzn_corp_aggr_desc,\n\t\tpbc_prod.case_upc_cde AS case_upc_cde,\n\t\tpbc_prod.hrzn_pkg_cont_ctgy_id AS hrzn_pkg_cont_ctgy_id,\n\t\tpbc_prod.hrzn_pkg_cont_ctgy_desc AS hrzn_pkg_cont_ctgy_desc,\n\t\tpbc_prod.hrzn_brnd_pkg_list_id AS hrzn_brnd_pkg_list_id,\n\t\tpbc_prod.hrzn_brnd_pkg_list_desc AS hrzn_brnd_pkg_list_desc,\n\t\tpbc_prod.hrzn_brnd_pkg_summ_id AS hrzn_brnd_pkg_summ_id,\n\t\tpbc_prod.hrzn_brnd_pkg_summ_desc AS hrzn_brnd_pkg_summ_desc,\n\t\tpbc_prod.hrzn_pkg_gm_id AS hrzn_pkg_gm_id,\n\t\tpbc_prod.hrzn_pkg_gm_desc AS hrzn_pkg_gm_desc,\n\t\tpbc_prod.hrzn_pkg_summ_id AS hrzn_pkg_summ_id,\n\t\tpbc_prod.hrzn_pkg_summ_desc AS hrzn_pkg_summ_desc,\n\t\tpbc_prod.comm_pkg_grp1_id AS comm_pkg_grp1_id,\n\t\tpbc_prod.comm_pkg_grp1_nme AS comm_pkg_grp1_nme,\n\t\tpbc_prod.comm_pkg_grp2_id AS comm_pkg_grp2_id,\n\t\tpbc_prod.comm_pkg_grp2_nme AS comm_pkg_grp2_nme,\n\t\tpbc_prod.hrzn_brnd_gm_id AS hrzn_brnd_gm_id,\n\t\tpbc_prod.hrzn_brnd_gm_desc AS hrzn_brnd_gm_desc,\n\t\tpbc_prod.hrzn_brnd_trdmrk_id AS hrzn_brnd_trdmrk_id,\n\t\tpbc_prod.hrzn_brnd_trdmrk_desc AS hrzn_brnd_trdmrk_desc,\n\t\tpbc_prod.hrzn_brnd_summ_id AS hrzn_brnd_summ_id,\n\t\tpbc_prod.hrzn_brnd_summ_desc AS hrzn_brnd_summ_desc,\n\t\tpbc_prod.pbg_utilized_flg AS pbg_utilized_flg,\n\t\tpbc_prod.case_conv_fctr AS case_conv_fctr,\n\t\tpbc_prod.lcl_case_conv_fctr AS lcl_case_conv_fctr,\n\t\tpbc_prod.prod_best_taste_wk_qty AS prod_best_taste_wk_qty,\n\t\tpbc_prod.delete_flg AS delete_flg,\n\t\tpbc_prod.mkt_ctgy_id AS mkt_ctgy_id,\n\t\tpbc_prod.mkt_ctgy_desc AS mkt_ctgy_desc,\n\t\tpbc_prod.mkt_trdmrk_id AS mkt_trdmrk_id,\n\t\tpbc_prod.mkt_trdmrk_desc AS mkt_trdmrk_desc,\n\t\tpbc_prod.pkg_cont_mtrl_grp_id AS pkg_cont_mtrl_grp_id,\n\t\tpbc_prod.pkg_cont_mtrl_grp_desc AS pkg_cont_mtrl_grp_desc,\n\t\tpbc_prod.entrprs_initiv_01_id AS entrprs_initiv_01_id,\n\t\tpbc_prod.entrprs_initiv_01_nme AS entrprs_initiv_01_nme,\n\t\tpbc_prod.entrprs_initiv_01_desc AS entrprs_initiv_01_desc,\n\t\tpbc_prod.entrprs_initiv_02_id AS entrprs_initiv_02_id,\n\t\tpbc_prod.entrprs_initiv_02_nme AS entrprs_initiv_02_nme,\n\t\tpbc_prod.entrprs_initiv_02_desc AS entrprs_initiv_02_desc,\n\t\tpbc_prod.apxig_id AS apxig_id,\n\t\tpbc_prod.apxig_nme AS apxig_nme,\n\t\tpbc_prod.dw_srce_id AS dw_srce_id,\n\t\tpbc_prod.dw_updt_dte AS dw_updt_dte,\n\t\tpbc_prod.comm_asm_grp_id AS comm_asm_grp_id,\n\t\tpbc_prod.comm_asm_grp_nme AS comm_asm_grp_nme,\n\t\tpbc_prod.comm_cnvntl_drvr_grp_id AS comm_cnvntl_drvr_grp_id,\n\t\tpbc_prod.comm_cnvntl_drvr_grp_nme AS comm_cnvntl_drvr_grp_nme,\n\t\tpbc_prod.comm_fsv_drvr_grp_id AS comm_fsv_drvr_grp_id,\n\t\tpbc_prod.comm_fsv_drvr_grp_nme AS comm_fsv_drvr_grp_nme,\n\t\tpbc_prod.comm_psell_drvr_grp_id AS comm_psell_drvr_grp_id,\n\t\tpbc_prod.comm_psell_drvr_grp_nme AS comm_psell_drvr_grp_nme,\n\t\tpbc_prod.pkg_wdth_unit_qty AS pkg_wdth_unit_qty,\n\t\tpbc_prod.pkg_hgt_unit_qty AS pkg_hgt_unit_qty,\n\t\tpbc_prod.pkg_lngth_unit_qty AS pkg_lngth_unit_qty,\n\t\tpbc_prod.pkg_dim_uofm_cde AS pkg_dim_uofm_cde,\n\t\tpbc_prod.pkg_frnt_dim_cde AS pkg_frnt_dim_cde,\n\t\tpbc_prod.pkg_stkblty_cde AS pkg_stkblty_cde,\n\t\tpbc_prod.prod_wgt_unit_qty AS prod_wgt_unit_qty,\n\t\tpbc_prod.prod_wgt_uofm_cde AS prod_wgt_uofm_cde,\n\t\tpbc_prod.rfrg_reqd_flg AS rfrg_reqd_flg,\n\t\tLPAD(SUBSTR(pbc_prod.upc_cde, 1, 11), 12, '0') AS iri_eq_upc,\n\t\tCOALESCE(\n\t\t\tCASE\n\t\t\t    WHEN pbc_prod.clust_qty > 1 THEN 'MP'\n\t\t\t    WHEN pbc_prod.cont_uom_desc = 'GALLON' THEN 'MS'\n\t\t\t    WHEN (\n                    pbc_prod.clust_qty = 1\n                    AND pbc_prod.ctgy_type_desc IN (\n                        'FLAVORED WATER', 'FLAVORED SPARKLING WATER',\n                        'WATER', 'UNFLAVORED SPARKLING WATER',\n                        'WATER WITH SALTS'\n                    )\n\t\t\t    ) THEN\n\t\t\t        CASE\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'OUNCE' THEN CASE WHEN pbc_prod.cont_uom_qty <= 50.7 THEN 'SS' ELSE 'MS' END\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'LITER' THEN CASE WHEN pbc_prod.cont_uom_qty <= 1.5 THEN 'SS' ELSE 'MS' END\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'MILLILITER' THEN CASE WHEN pbc_prod.cont_uom_qty <= 1500 THEN 'SS' ELSE 'MS' END\n\t\t\t        END\n\t\t\t    ELSE\n\t\t\t        CASE\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'OUNCE' THEN CASE WHEN pbc_prod.cont_uom_qty <= 33.8 THEN 'SS' ELSE 'MS' END\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'LITER' THEN CASE WHEN pbc_prod.cont_uom_qty <= 1 THEN 'SS' ELSE 'MS' END\n\t\t\t            WHEN pbc_prod.cont_uom_desc = 'MILLILITER' THEN CASE WHEN pbc_prod.cont_uom_qty <= 1000 THEN 'SS' ELSE 'MS' END\n\t\t\t        END\n\t\t\tEND,\n\t\t\t'NA'\n\t\t) AS ss_mp_ms\n\tFROM\n        {{ ref('pbc_prod') }}\n)\nSELECT\n\tbtgpbcprd.*,\n\tCASE\n\t    WHEN btgpbcprd.ss_mp_ms = 'MP' THEN 'TH'\n\t    WHEN btgpbcprd.ss_mp_ms = 'MS' THEN 'TH'\n\t    WHEN btgpbcprd.ss_mp_ms = 'SS' THEN 'SS'\n\t    WHEN btgpbcprd.ss_mp_ms = 'NA' THEN 'NA'\n\tEND AS ss_th_flag,\n\tCURRENT_TIMESTAMP() AS last_updt_dt\nFROM\n\tbtgpbcprd\n\tINNER JOIN (\n\t\tSELECT\n\t\t\tDISTINCT pbcslscustwkv.inven_id\n\t\tFROM\n            {{ ref('dx_pbc_sales_cust_wk_prod') }} AS pbcslscustwkv\n\t) AS dxpbcslscustwkv ON btgpbcprd.inven_id = dxpbcslscustwkv.inven_id", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "dx_pbc_prod"], "unique_id": "model.sdna_project.dx_pbc_prod", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/dx_pbc_prod.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/dx_pbc_prod.sql", "name": "dx_pbc_prod", "resource_type": "model", "alias": "dx_pbc_prod", "checksum": {"name": "sha256", "checksum": "2a647af0c5a5cd900fabc74eb33b26b538465633baa4044a9e4ea0bf4abfbd54"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["pbc_prod"], ["dx_pbc_sales_cust_wk_prod"], ["pbc_prod"], ["dx_pbc_sales_cust_wk_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.pbc_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.pbc_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend": {"raw_sql": "with str as (\n    select \n        store.*\n        ,rte.rte_id as route_id\n        ,rte.terr_id as terr_id\n        ,rte.terr_nme\n        ,mkt.hq_id as division_id\n        ,mkt.hq_nme as division\n        ,mkt.bu_id as region_id\n        ,mkt.bu_nme as region\n        ,mkt.mu_id as market_id\n        ,mkt.mu_nme as market\n        ,mkt.loc_nme as location\n    from {{ ref('dx_store_attr') }} store\n    left join {{ ref('btg_pbc_new_mkt_loc') }} mkt on (mkt.cust_id = store.pbc_cust_id)\n    left join {{ ref('btg_pbc_route_data') }} rte on(rte.cust_id = store.pbc_cust_id)\n)\nselect\n    sls.dx_id\n    ,prod.upc_cde as upc_cde\n    ,upper(prod.inven_dply_grp_nme) as upc_descp\n    ,prod.inven_id\n    --store attributes\n    ,upper(str.btg_store_nm) as store_name\n    ,upper(str.btg_address) as address\n    ,upper(str.btg_city) as city\n    ,upper(str.btg_state) as state\n    ,str.btg_zip5 as zip5\n    ,str.btg_zip as zip9\n    ,upper(str.btg_county) as county\n    ,str.latitude as latitude\n    ,str.longitude as longitude\n    --route and alt-geos attributes\n    ,str.division_id\n    ,upper(str.division) as division\n    ,str.region_id\n    ,upper(str.region) as region\n    ,str.market_id\n    ,upper(str.market) as market\n    ,upper(str.location) as location\n    ,str.terr_id\n    ,upper(str.terr_nme) as terr_nme\n    ,str.route_id\n    --some more store attributes\n    ,str.pbc_bus_type_aggr_cde as channel_cde\n    ,upper(str.pbc_bus_type_aggr_desc) as channel_desc\n    ,str.pbc_bus_type_ctgy_cde as format_cde\n    ,upper(str.pbc_bus_type_ctgy_desc) as format_desc\n    ,upper(str.pbc_grp1_lvl_1_desc) as banner\n    ,upper(coalesce(str.btg_retailer,str.fl_chain_lvl1_node_nm)) as retailer\n    --prod attributes\n    ,prod.ctgy_type_cde as ctgy_type_cde\n    ,upper(prod.ctgy_type_desc) as ctgy_type_desc\n    ,prod.trdmrk_cde as trrdmrk_cde\n    ,upper(prod.trdmrk_desc) as trdmark_desc\n    ,prod.brnd_id as brand_cde\n    ,upper(prod.brnd_nme) as brnd_nme\n    ,prod.flvr_cde as flvr_cde\n    ,upper(prod.flvr_desc) as flvr_desc\n    ,upper(prod.pkg_nme) as pkg_nme\n    ,prod.pkg_id as pkg_cde\n    ,upper(prod.ss_mp_ms) as ss_mp_ms\n    ,upper(prod.ss_th_flag) as ss_th_flag\n    --remaining sales fileds\n    ,sls.fscl_wk_end_dte\n    ,sls.fscl_yr_num\n    ,sls.fscl_pd_num\n    ,sls.fscl_wk_in_pd_num\n    ,sls.dely_lne_qty as cases\n    ,sls.raw_vol\n    ,sls.eght_oz_vol\n    ,sls.net_rev\n    ,current_timestamp() as last_updt_dt\nfrom {{ ref('dx_pbc_sales_cust_wk_prod') }} sls\nleft join str on (str.dx_id = sls.dx_id)\nleft join {{ ref('dx_pbc_prod') }} prod on (prod.inven_id = sls.inven_id)", "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "sdna_us", "store_sales", "transformations", "catmgmt", "dx_pbc_sales_cust_wk_prod_extend"], "unique_id": "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "sdna_us/store_sales/transformations/catmgmt/dx_pbc_sales_cust_wk_prod_extend.sql", "original_file_path": "models/sdna_us/store_sales/transformations/catmgmt/dx_pbc_sales_cust_wk_prod_extend.sql", "name": "dx_pbc_sales_cust_wk_prod_extend", "resource_type": "model", "alias": "dx_pbc_sales_cust_wk_prod_extend", "checksum": {"name": "sha256", "checksum": "65e09da20a2b3c80de69ebfd9eea085ef3e40f3754ef5821d239982022312827"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "STORE_SALES_DEV", "database": "DP_SDNA_US", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_store_attr"], ["btg_pbc_new_mkt_loc"], ["btg_pbc_route_data"], ["dx_pbc_sales_cust_wk_prod"], ["dx_pbc_prod"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_store_attr", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_prod"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": "ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'", "materialized": "table", "database": "DP_SDNA_US", "transient": false, "schema": "STORE_SALES_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_prod_v_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('btg_fl_sales_cust_prod_v_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/btg/dx_mvhs/btg_fl_sales_cust_prod_v_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "btg_fl_sales_cust_prod_v_extend_WM"], "unique_id": "model.sdna_project.btg_fl_sales_cust_prod_v_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/btg_fl_sales_cust_prod_v_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/btg_fl_sales_cust_prod_v_extend_WM.sql", "name": "btg_fl_sales_cust_prod_v_extend_WM", "resource_type": "model", "alias": "btg_fl_sales_cust_prod_v_extend_WM", "checksum": {"name": "sha256", "checksum": "66498798ae7c17ef163e51ce924d4c7f950efbc011a8e44dce359d92d375052e"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('btg_fl_sales_cust_wk_prod_v_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/btg/dx_mvhs/btg_fl_sales_cust_wk_prod_v_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "btg_fl_sales_cust_wk_prod_v_extend_WM"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_WM.sql", "name": "btg_fl_sales_cust_wk_prod_v_extend_WM", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_prod_v_extend_WM", "checksum": {"name": "sha256", "checksum": "1cea09732825cc237ea74c3f422fe936f09544ba5d2e90faec33c40e68f78d08"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('btg_pbc_sales_cust_prod_v_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/btg/dx_mvhs/btg_pbc_sales_cust_prod_v_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "btg_pbc_sales_cust_prod_v_extend_WM"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/btg_pbc_sales_cust_prod_v_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/btg_pbc_sales_cust_prod_v_extend_WM.sql", "name": "btg_pbc_sales_cust_prod_v_extend_WM", "resource_type": "model", "alias": "btg_pbc_sales_cust_prod_v_extend_WM", "checksum": {"name": "sha256", "checksum": "06b91682f4ba0ffd5d8cc050e1957e2375b8f6d28ab44702ddbf14d335085e5b"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('btg_pbc_sales_cust_wk_prod_v_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/btg/dx_mvhs/btg_pbc_sales_cust_wk_prod_v_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "btg_pbc_sales_cust_wk_prod_v_extend_WM"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_WM.sql", "name": "btg_pbc_sales_cust_wk_prod_v_extend_WM", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_prod_v_extend_WM", "checksum": {"name": "sha256", "checksum": "3ca5cfb3199df3decb2867a81a7d99902dae1548aada8b465b63c115d3ace05d"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dx_fl_sales_cust_wk_prod_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/dxh/dx_mvhs/dx_fl_sales_cust_wk_prod_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "dx_fl_sales_cust_wk_prod_extend_WM"], "unique_id": "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/dx_fl_sales_cust_wk_prod_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/dx_fl_sales_cust_wk_prod_extend_WM.sql", "name": "dx_fl_sales_cust_wk_prod_extend_WM", "resource_type": "model", "alias": "dx_fl_sales_cust_wk_prod_extend_WM", "checksum": {"name": "sha256", "checksum": "0fcbf898595bd7e19a5245a0c53320aeb8fd6fd2bbf782c9e7158e7404fda524"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_WM": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dx_pbc_sales_cust_wk_prod_extend') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/dxh/dx_mvhs/dx_pbc_sales_cust_wk_prod_extend') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "dx_pbc_sales_cust_wk_prod_extend_WM"], "unique_id": "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_WM", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/dx_pbc_sales_cust_wk_prod_extend_WM.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/dx_pbc_sales_cust_wk_prod_extend_WM.sql", "name": "dx_pbc_sales_cust_wk_prod_extend_WM", "resource_type": "model", "alias": "dx_pbc_sales_cust_wk_prod_extend_WM", "checksum": {"name": "sha256", "checksum": "5d8de44720655db7e069a5d4b19f9b4bf95bc5bf61b4e0677bbe46524ef40b24"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.dx_retailer_trade_area": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='ORC',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('dx_retailer_trade_area') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/dxh/dx_mvhs/dx_retailer_trade_area') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "dx_retailer_trade_area"], "unique_id": "model.sdna_project.dx_retailer_trade_area", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/dx_retailer_trade_area.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/dx_retailer_trade_area.sql", "name": "dx_retailer_trade_area", "resource_type": "model", "alias": "dx_retailer_trade_area", "checksum": {"name": "sha256", "checksum": "1f64ef97e29eab5b1ed45da158ede2b5da54ef4818e918002385e5ce77612260"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "ORC", "copy_transform": true}}, "model.sdna_project.mvh_demog_data": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('mvh_demog_data') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/dxh/dx_mvhs/mvh_demog_data') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "mvh_demog_data"], "unique_id": "model.sdna_project.mvh_demog_data", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/mvh_demog_data.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/mvh_demog_data.sql", "name": "mvh_demog_data", "resource_type": "model", "alias": "mvh_demog_data", "checksum": {"name": "sha256", "checksum": "bc0b7d63e81ad243341851c7e67478fc367c2457ca5c9bff3076c8869dc91588"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.mvh_retailer_prod_attr_data": {"raw_sql": "{{\n  config(\n    materialized='from_external_stage',\n    stage_name='AZURE_ENT_CONTAINER',\n    file_format_name='PARQUET',\n    copy_transform=True\n  )\n}}\n(\nSELECT\n    {% for col in get_cols_field_column_mapping('mvh_retailer_prod_attr_data') %}\n    $1:{{ col[0] }}::{{ col[1] }},\n    {% endfor %}\n    CURRENT_TIMESTAMP()\nFROM\n{{ external_stage('/sDNA/mvh/dxh/dx_mvhs/mvh_retailer_prod_attr_data') }}\n)", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "loads", "btg_extend", "mvh_retailer_prod_attr_data"], "unique_id": "model.sdna_project.mvh_retailer_prod_attr_data", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/loads/btg_extend/mvh_retailer_prod_attr_data.sql", "original_file_path": "models/walmart_data_infra/loads/btg_extend/mvh_retailer_prod_attr_data.sql", "name": "mvh_retailer_prod_attr_data", "resource_type": "model", "alias": "mvh_retailer_prod_attr_data", "checksum": {"name": "sha256", "checksum": "d99fae5c1bb9dd4a518f349d1ca7e0393758e99ff30b39a0c05e73db0db099c2"}, "config": {"enabled": true, "materialized": "from_external_stage", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false, "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.sdna_project.get_cols_field_column_mapping", "macro.sdna_project.external_stage"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "from_external_stage", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}", "stage_name": "AZURE_ENT_CONTAINER", "file_format_name": "PARQUET", "copy_transform": true}}, "model.sdna_project.btg_fl_sales_cust_prod_v_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_fl_sales_cust_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAM''S CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_fl_sales_cust_prod_v_extend_sc"], "unique_id": "model.sdna_project.btg_fl_sales_cust_prod_v_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_prod_v_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_prod_v_extend_sc.sql", "name": "btg_fl_sales_cust_prod_v_extend_sc", "resource_type": "model", "alias": "btg_fl_sales_cust_prod_v_extend_sc", "checksum": {"name": "sha256", "checksum": "b3439dc9c7b9579f0f8c8db2e3b03aef2bf9e9f2dfe29317903e7d8ad2649193"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_prod_v_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_fl_sales_cust_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'WALMART CO'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_fl_sales_cust_prod_v_extend_wm"], "unique_id": "model.sdna_project.btg_fl_sales_cust_prod_v_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_prod_v_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_prod_v_extend_wm.sql", "name": "btg_fl_sales_cust_prod_v_extend_wm", "resource_type": "model", "alias": "btg_fl_sales_cust_prod_v_extend_wm", "checksum": {"name": "sha256", "checksum": "81957d9fa30688581552d4e172b71e74f9315854dedbb4adb03aed9bab9924c4"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_fl_sales_cust_wk_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAM''S CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_fl_sales_cust_wk_prod_v_extend_sc"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_sc.sql", "name": "btg_fl_sales_cust_wk_prod_v_extend_sc", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_prod_v_extend_sc", "checksum": {"name": "sha256", "checksum": "b6ea91277f1c4cbafec47edfa73e1a1f9ae84e4f88875fc46b2c62d715299242"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_wk_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_fl_sales_cust_wk_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'WALMART CO'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_fl_sales_cust_wk_prod_v_extend_wm"], "unique_id": "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_fl_sales_cust_wk_prod_v_extend_wm.sql", "name": "btg_fl_sales_cust_wk_prod_v_extend_wm", "resource_type": "model", "alias": "btg_fl_sales_cust_wk_prod_v_extend_wm", "checksum": {"name": "sha256", "checksum": "25bcb509c6a01e74d5dee007dbc44d98510b7a28f8cf7db7227c93035c616144"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_fl_sales_cust_wk_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_pbc_sales_cust_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAM''S WHOLESALE CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_pbc_sales_cust_prod_v_extend_sc"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_prod_v_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_prod_v_extend_sc.sql", "name": "btg_pbc_sales_cust_prod_v_extend_sc", "resource_type": "model", "alias": "btg_pbc_sales_cust_prod_v_extend_sc", "checksum": {"name": "sha256", "checksum": "227d6f7834b5a38ff592b055cc52effde15aa41ea196663d1a34e55971f4f205"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_pbc_sales_cust_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'WALMART SUPERCENTERS'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_pbc_sales_cust_prod_v_extend_wm"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_prod_v_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_prod_v_extend_wm.sql", "name": "btg_pbc_sales_cust_prod_v_extend_wm", "resource_type": "model", "alias": "btg_pbc_sales_cust_prod_v_extend_wm", "checksum": {"name": "sha256", "checksum": "93e12d39c432a975ad768b203d67445013635f393e82cbb2e818e7ea1bf50419"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_pbc_sales_cust_wk_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAM''S WHOLESALE CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_pbc_sales_cust_wk_prod_v_extend_sc"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_sc.sql", "name": "btg_pbc_sales_cust_wk_prod_v_extend_sc", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_prod_v_extend_sc", "checksum": {"name": "sha256", "checksum": "782db3a5e2d5728f34b3909bfcc303adc59781905c747dafed5588e78a0a3c07"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_wk_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('btg_pbc_sales_cust_wk_prod_v_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'WALMART SUPERCENTERS'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "btg_pbc_sales_cust_wk_prod_v_extend_wm"], "unique_id": "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/btg_pbc_sales_cust_wk_prod_v_extend_wm.sql", "name": "btg_pbc_sales_cust_wk_prod_v_extend_wm", "resource_type": "model", "alias": "btg_pbc_sales_cust_wk_prod_v_extend_wm", "checksum": {"name": "sha256", "checksum": "ed226efc88ab5a0fe5f619a4f604f3039fc7bb885f5decf7be54c30fc609b144"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["btg_pbc_sales_cust_wk_prod_v_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_fl_sales_cust_wk_prod_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAM''S CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_fl_sales_cust_wk_prod_extend_sc"], "unique_id": "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_fl_sales_cust_wk_prod_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_fl_sales_cust_wk_prod_extend_sc.sql", "name": "dx_fl_sales_cust_wk_prod_extend_sc", "resource_type": "model", "alias": "dx_fl_sales_cust_wk_prod_extend_sc", "checksum": {"name": "sha256", "checksum": "eb0403c11864076e6956ad67346f4e842381812810ab7f5b64994f3c5915a254"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_fl_sales_cust_wk_prod_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_fl_sales_cust_wk_prod_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'WALMART CO'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_fl_sales_cust_wk_prod_extend_wm"], "unique_id": "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_fl_sales_cust_wk_prod_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_fl_sales_cust_wk_prod_extend_wm.sql", "name": "dx_fl_sales_cust_wk_prod_extend_wm", "resource_type": "model", "alias": "dx_fl_sales_cust_wk_prod_extend_wm", "checksum": {"name": "sha256", "checksum": "563d8dafd72303e04bcd171fe20569a6f349cb48042085144ae4ae28ea7f37f9"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_fl_sales_cust_wk_prod_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_id_sc": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\nSELECT dx_id\nFROM {{ ref('dx_fl_sales_cust_wk_prod_extend_sc') }}\n\nUNION\n\nSELECT dx_id\nFROM {{ ref('dx_pbc_sales_cust_wk_prod_extend_sc') }}", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_id_sc"], "unique_id": "model.sdna_project.dx_id_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_id_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_id_sc.sql", "name": "dx_id_sc", "resource_type": "model", "alias": "dx_id_sc", "checksum": {"name": "sha256", "checksum": "27a4487f4271ea8b3228c25e6b1ab0ee853ce9f16bb21a7d9cdc80b6f978aa3f"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_fl_sales_cust_wk_prod_extend_sc"], ["dx_pbc_sales_cust_wk_prod_extend_sc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "table", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_id_wm": {"raw_sql": "{{ config(materialized='table', transient=false) }}\n\nSELECT dx_id\nFROM {{ ref('dx_fl_sales_cust_wk_prod_extend_wm') }}\n\nUNION\n\nSELECT dx_id\nFROM {{ ref('dx_pbc_sales_cust_wk_prod_extend_wm') }}", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_id_wm"], "unique_id": "model.sdna_project.dx_id_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_id_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_id_wm.sql", "name": "dx_id_wm", "resource_type": "model", "alias": "dx_id_wm", "checksum": {"name": "sha256", "checksum": "91c60aadc32197541e367f9b58fcff366dade954abfd3647e99aef78473f1a81"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_fl_sales_cust_wk_prod_extend_wm"], ["dx_pbc_sales_cust_wk_prod_extend_wm"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "table", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_pbc_sales_cust_wk_prod_extend') }}\nWHERE UPPER(TRIM(retailer)) = 'SAMS CLUB'", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_pbc_sales_cust_wk_prod_extend_sc"], "unique_id": "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_pbc_sales_cust_wk_prod_extend_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_pbc_sales_cust_wk_prod_extend_sc.sql", "name": "dx_pbc_sales_cust_wk_prod_extend_sc", "resource_type": "model", "alias": "dx_pbc_sales_cust_wk_prod_extend_sc", "checksum": {"name": "sha256", "checksum": "5b11f9d51c4829518fd5cde4fbe471bdcebd8a60c31ad2b1fe97ac3ce40b6e2d"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_pbc_sales_cust_wk_prod_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_pbc_sales_cust_wk_prod_extend') }}\nWHERE UPPER(TRIM(retailer)) IN ('ALL OTHER WALMART', 'NEIGHBORHOOD MARKET')", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_pbc_sales_cust_wk_prod_extend_wm"], "unique_id": "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_pbc_sales_cust_wk_prod_extend_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_pbc_sales_cust_wk_prod_extend_wm.sql", "name": "dx_pbc_sales_cust_wk_prod_extend_wm", "resource_type": "model", "alias": "dx_pbc_sales_cust_wk_prod_extend_wm", "checksum": {"name": "sha256", "checksum": "39d4de0eb472eb2ddd08cab649fcddba462c959eb6e14e1c4c91b8e31a68c27d"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_pbc_sales_cust_wk_prod_extend"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_retailer_trade_area_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_retailer_trade_area') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_sc') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_retailer_trade_area_sc"], "unique_id": "model.sdna_project.dx_retailer_trade_area_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_retailer_trade_area_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_retailer_trade_area_sc.sql", "name": "dx_retailer_trade_area_sc", "resource_type": "model", "alias": "dx_retailer_trade_area_sc", "checksum": {"name": "sha256", "checksum": "67b10c4e3729522a5be07e4bff42f5f9ed4504b8ca406704d5ba80b4e87e1882"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_retailer_trade_area"], ["dx_id_sc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_retailer_trade_area", "model.sdna_project.dx_id_sc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.dx_retailer_trade_area_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('dx_retailer_trade_area') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_wm') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "dx_retailer_trade_area_wm"], "unique_id": "model.sdna_project.dx_retailer_trade_area_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/dx_retailer_trade_area_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/dx_retailer_trade_area_wm.sql", "name": "dx_retailer_trade_area_wm", "resource_type": "model", "alias": "dx_retailer_trade_area_wm", "checksum": {"name": "sha256", "checksum": "2e4bc224e9d6330c2fa5ceadc0785ce63226d631fe3b69f29b37a4d97c90e1f0"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["dx_retailer_trade_area"], ["dx_id_wm"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.dx_retailer_trade_area", "model.sdna_project.dx_id_wm"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_demog_data_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('mvh_demog_data') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_sc') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "mvh_demog_data_sc"], "unique_id": "model.sdna_project.mvh_demog_data_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/mvh_demog_data_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/mvh_demog_data_sc.sql", "name": "mvh_demog_data_sc", "resource_type": "model", "alias": "mvh_demog_data_sc", "checksum": {"name": "sha256", "checksum": "3cf3f6c0f682df021c9d1397f5172033c019e8f9f2a4bdfa3efd802bd9bc4d0f"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_demog_data"], ["dx_id_sc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_demog_data", "model.sdna_project.dx_id_sc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_demog_data_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('mvh_demog_data') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_wm') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "mvh_demog_data_wm"], "unique_id": "model.sdna_project.mvh_demog_data_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/mvh_demog_data_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/mvh_demog_data_wm.sql", "name": "mvh_demog_data_wm", "resource_type": "model", "alias": "mvh_demog_data_wm", "checksum": {"name": "sha256", "checksum": "56033b0152d06047f1da69b7e68f7e259f9b5c9552960545f5a1ee3d76a0ebda"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_demog_data"], ["dx_id_wm"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_demog_data", "model.sdna_project.dx_id_wm"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_prod_attr_data_sc": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('mvh_retailer_prod_attr_data') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_sc') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "mvh_retailer_prod_attr_data_sc"], "unique_id": "model.sdna_project.mvh_retailer_prod_attr_data_sc", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/mvh_retailer_prod_attr_data_sc.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/mvh_retailer_prod_attr_data_sc.sql", "name": "mvh_retailer_prod_attr_data_sc", "resource_type": "model", "alias": "mvh_retailer_prod_attr_data_sc", "checksum": {"name": "sha256", "checksum": "0b2564d0fcc6a35999903d47a091b8ba82f8aa98584e9d992ebda10e869780df"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_retailer_prod_attr_data"], ["dx_id_sc"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_retailer_prod_attr_data", "model.sdna_project.dx_id_sc"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "model.sdna_project.mvh_retailer_prod_attr_data_wm": {"raw_sql": "{{ config(materialized='view') }}\n\nSELECT *\nFROM {{ ref('mvh_retailer_prod_attr_data') }}\nWHERE dx_id IN (SELECT dx_id FROM {{ ref('dx_id_wm') }})", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_DEV", "fqn": ["sdna_project", "walmart_data_infra", "transformations", "btg_extend", "mvh_retailer_prod_attr_data_wm"], "unique_id": "model.sdna_project.mvh_retailer_prod_attr_data_wm", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "walmart_data_infra/transformations/btg_extend/mvh_retailer_prod_attr_data_wm.sql", "original_file_path": "models/walmart_data_infra/transformations/btg_extend/mvh_retailer_prod_attr_data_wm.sql", "name": "mvh_retailer_prod_attr_data_wm", "resource_type": "model", "alias": "mvh_retailer_prod_attr_data_wm", "checksum": {"name": "sha256", "checksum": "edce52d7c368127743b6621d35a8609a3857e9805f0ade21bd3251b384007dcb"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}, {"sql": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": "WALMART_DATA_INFRA_DEV", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "transient": false}, "tags": [], "refs": [["mvh_retailer_prod_attr_data"], ["dx_id_wm"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.sdna_project.mvh_retailer_prod_attr_data", "model.sdna_project.dx_id_wm"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": " ALTER SESSION SET QUERY_TAG = '{{this.database.upper()}}.{{this.schema.upper()}}.{{this.table.upper()}}'; {% if target.name == 'dev' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_M {% elif target.name == 'stage' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_XL {% elif target.name == 'prod' %} USE WAREHOUSE DP_WALMART_DATA_INFRA_2XL {% endif %}", "materialized": "view", "transient": false, "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('DBT_CONTEXT')|upper }}"}}, "seed.sdna_project.field_column_mapping_sdna_mx": {"raw_sql": "", "database": "DP_SDNA_MX", "schema": "SDNA_MX_dev", "fqn": ["sdna_project", "mappings", "sdna_mx", "field_column_mapping_sdna_mx"], "unique_id": "seed.sdna_project.field_column_mapping_sdna_mx", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "mappings/sdna_mx/field_column_mapping_sdna_mx.csv", "original_file_path": "data/mappings/sdna_mx/field_column_mapping_sdna_mx.csv", "name": "field_column_mapping_sdna_mx", "resource_type": "seed", "alias": "field_column_mapping", "checksum": {"name": "sha256", "checksum": "05fc4d2740d9cd1241e54b6824f00d47365693ab131d29ae4b7b74fef6624a0d"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": "field_column_mapping", "schema": "SDNA_MX_dev", "database": "DP_SDNA_MX", "tags": [], "full_refresh": null, "quote_columns": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "field_column_mapping", "database": "DP_SDNA_MX", "schema": "SDNA_MX_{{ env_var('STAGE') }}"}}, "seed.sdna_project.field_column_mapping_sdna_us_hh": {"raw_sql": "", "database": "DP_SDNA_US", "schema": "HOUSEHOLD_dev", "fqn": ["sdna_project", "mappings", "sdna_us", "household", "field_column_mapping_sdna_us_hh"], "unique_id": "seed.sdna_project.field_column_mapping_sdna_us_hh", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "mappings/sdna_us/household/field_column_mapping_sdna_us_hh.csv", "original_file_path": "data/mappings/sdna_us/household/field_column_mapping_sdna_us_hh.csv", "name": "field_column_mapping_sdna_us_hh", "resource_type": "seed", "alias": "field_column_mapping", "checksum": {"name": "sha256", "checksum": "80d2ea783f511beb38e2cf382d8738fb5d12c9bbde7f2a6f50de1cb38958ec26"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": "field_column_mapping", "schema": "HOUSEHOLD_dev", "database": null, "tags": [], "full_refresh": null, "quote_columns": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "field_column_mapping", "schema": "HOUSEHOLD_{{ env_var('STAGE') }}"}}, "seed.sdna_project.field_column_mapping_walmart": {"raw_sql": "", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_dev", "fqn": ["sdna_project", "mappings", "walmart_data_infra", "field_column_mapping_walmart"], "unique_id": "seed.sdna_project.field_column_mapping_walmart", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "mappings/walmart_data_infra/field_column_mapping_walmart.csv", "original_file_path": "data/mappings/walmart_data_infra/field_column_mapping_walmart.csv", "name": "field_column_mapping_walmart", "resource_type": "seed", "alias": "field_column_mapping", "checksum": {"name": "sha256", "checksum": "75150a2a3e1bf8f6b5c147ef54a794df9b80a3894459d560f1a76f867d4c288c"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": "field_column_mapping", "schema": "WALMART_DATA_INFRA_dev", "database": "DP_WALMART_DATA_INFRA", "tags": [], "full_refresh": null, "quote_columns": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "field_column_mapping", "database": "DP_WALMART_DATA_INFRA", "schema": "WALMART_DATA_INFRA_{{ env_var('STAGE') }}"}}, "test.sdna_project.unique_stg_lookup_geo_code": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "geo_code", "model": "{{ ref('stg_lookup') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "unique_stg_lookup_geo_code"], "unique_id": "test.sdna_project.unique_stg_lookup_geo_code", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/unique_stg_lookup_geo_code.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "unique_stg_lookup_geo_code", "resource_type": "test", "alias": "unique_stg_lookup_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg_lookup"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.sdna_project.stg_lookup"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.not_null_stg_lookup_geo_code": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ ref('stg_lookup') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "not_null_stg_lookup_geo_code"], "unique_id": "test.sdna_project.not_null_stg_lookup_geo_code", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/not_null_stg_lookup_geo_code.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "not_null_stg_lookup_geo_code", "resource_type": "test", "alias": "not_null_stg_lookup_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg_lookup"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.sdna_project.stg_lookup"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.not_null_stg_mobility_data_geo_code": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ ref('stg_mobility_data') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "not_null_stg_mobility_data_geo_code"], "unique_id": "test.sdna_project.not_null_stg_mobility_data_geo_code", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/not_null_stg_mobility_data_geo_code.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "not_null_stg_mobility_data_geo_code", "resource_type": "test", "alias": "not_null_stg_mobility_data_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg_mobility_data"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.sdna_project.stg_mobility_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('stg_lookup')", "field": "geo_code", "column_name": "geo_code", "model": "{{ ref('stg_mobility_data') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_"], "unique_id": "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/relationships_stg_mobility_data_ee9315a5bd4007f79234f5b289acdb40.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_", "resource_type": "test", "alias": "relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg_lookup"], ["stg_mobility_data"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.sdna_project.stg_lookup", "model.sdna_project.stg_mobility_data"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.not_null_mobility_adm1_mx_geo_code": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ ref('mobility_adm1_mx') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "not_null_mobility_adm1_mx_geo_code"], "unique_id": "test.sdna_project.not_null_mobility_adm1_mx_geo_code", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/not_null_mobility_adm1_mx_geo_code.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "not_null_mobility_adm1_mx_geo_code", "resource_type": "test", "alias": "not_null_mobility_adm1_mx_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["mobility_adm1_mx"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.sdna_project.mobility_adm1_mx"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('stg_lookup')", "field": "geo_code", "column_name": "geo_code", "model": "{{ ref('mobility_adm1_mx') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_"], "unique_id": "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/relationships_mobility_adm1_mx_ee9315a5bd4007f79234f5b289acdb40.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_", "resource_type": "test", "alias": "relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg_lookup"], ["mobility_adm1_mx"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.sdna_project.stg_lookup", "model.sdna_project.mobility_adm1_mx"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "geo_code"}, "test.sdna_project.not_null_mobility_adm1_mx_activity_index_total": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "activity_index_total", "model": "{{ ref('mobility_adm1_mx') }}"}}, "database": "DP_SDNA_US", "schema": "STORE_SALES_DEV", "fqn": ["sdna_project", "schema_test", "not_null_mobility_adm1_mx_activity_index_total"], "unique_id": "test.sdna_project.not_null_mobility_adm1_mx_activity_index_total", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "schema_test/not_null_mobility_adm1_mx_activity_index_total.sql", "original_file_path": "models/sdna_mx/transformations/mobility/mobility.yml", "name": "not_null_mobility_adm1_mx_activity_index_total", "resource_type": "test", "alias": "not_null_mobility_adm1_mx_activity_index_total", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "test", "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "alter session set timezone='{{ var(\"default_timezone\") }}'", "transaction": true, "index": null}, {"sql": "alter session set week_start = 0", "transaction": true, "index": null}], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["mobility_adm1_mx"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.sdna_project.mobility_adm1_mx"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"pre-hook": ["alter session set timezone='{{ var(\"default_timezone\") }}'", "alter session set week_start = 0"], "severity": "ERROR"}, "column_name": "activity_index_total"}}, "sources": {"source.sdna_project.experian.MVH_CV_LIVING_UNIT_X258": {"fqn": ["sdna_project", "sdna_us", "experian", "MVH_CV_LIVING_UNIT_X258"], "database": "DP_DATA_SHARE_AWS_TO_AZ_REPLICA", "schema": "EXPERIAN", "unique_id": "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X258", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "models/sdna_us/sdna_us.yml", "original_file_path": "models/sdna_us/sdna_us.yml", "name": "MVH_CV_LIVING_UNIT_X258", "source_name": "experian", "source_description": "", "loader": "", "identifier": "MVH_CV_LIVING_UNIT_X258", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": null, "error_after": null, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "DP_DATA_SHARE_AWS_TO_AZ_REPLICA.EXPERIAN.MVH_CV_LIVING_UNIT_X258"}, "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261": {"fqn": ["sdna_project", "sdna_us", "experian", "MVH_CV_LIVING_UNIT_X261"], "database": "DP_DATA_SHARE_AWS_TO_AZ_REPLICA", "schema": "EXPERIAN", "unique_id": "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "models/sdna_us/sdna_us.yml", "original_file_path": "models/sdna_us/sdna_us.yml", "name": "MVH_CV_LIVING_UNIT_X261", "source_name": "experian", "source_description": "", "loader": "", "identifier": "MVH_CV_LIVING_UNIT_X261", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": null, "error_after": null, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "DP_DATA_SHARE_AWS_TO_AZ_REPLICA.EXPERIAN.MVH_CV_LIVING_UNIT_X261"}, "source.sdna_project.iri.MVH_IRI_PROSCORES_X261": {"fqn": ["sdna_project", "sdna_us", "iri", "MVH_IRI_PROSCORES_X261"], "database": "DP_EXTERNAL_DATA", "schema": "IRI", "unique_id": "source.sdna_project.iri.MVH_IRI_PROSCORES_X261", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "models/sdna_us/sdna_us.yml", "original_file_path": "models/sdna_us/sdna_us.yml", "name": "MVH_IRI_PROSCORES_X261", "source_name": "iri", "source_description": "", "loader": "", "identifier": "MVH_IRI_PROSCORES_X261", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": null, "error_after": null, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "DP_EXTERNAL_DATA.IRI.MVH_IRI_PROSCORES_X261"}}, "macros": {"macro.sdna_project.create_file_formats": {"unique_id": "macro.sdna_project.create_file_formats", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/create_file_formats.sql", "original_file_path": "macros/create_file_formats.sql", "name": "create_file_formats", "macro_sql": "{% macro create_file_formats() %}\n    -- Creates or replaces file formats\n    CREATE OR REPLACE FILE FORMAT {{ database }}.{{ schema }}.btg_csv\n        TYPE = CSV\n        FIELD_DELIMITER = '|'\n        RECORD_DELIMITER = '\\n'\n        ENCODING = 'iso-8859-1'\n        TRIM_SPACE = TRUE\n        NULL_IF = ('NULL', 'null')\n        ESCAPE_UNENCLOSED_FIELD = NONE\n        EMPTY_FIELD_AS_NULL = TRUE\n        ERROR_ON_COLUMN_COUNT_MISMATCH=FALSE;\n\n    CREATE OR REPLACE FILE FORMAT {{ database }}.{{ schema }}.btg_csv_skip_header\n        TYPE = CSV\n        SKIP_HEADER = 1\n        FIELD_DELIMITER = '|'\n        RECORD_DELIMITER = '\\n'\n        ENCODING = 'iso-8859-1'\n        TRIM_SPACE = TRUE\n        NULL_IF = ('NULL', 'null')\n        ESCAPE_UNENCLOSED_FIELD = NONE\n        EMPTY_FIELD_AS_NULL = TRUE\n        ERROR_ON_COLUMN_COUNT_MISMATCH=FALSE;\n\n    CREATE OR REPLACE FILE FORMAT mvh_csv_skip_header_comma\n        TYPE = CSV\n        SKIP_HEADER = 1\n        FIELD_DELIMITER = ','\n        RECORD_DELIMITER = '\\n'\n        ENCODING = 'iso-8859-1'\n        TRIM_SPACE = TRUE\n        NULL_IF = ('NULL', 'null')\n        ESCAPE_UNENCLOSED_FIELD = NONE\n        EMPTY_FIELD_AS_NULL = TRUE\n        ERROR_ON_COLUMN_COUNT_MISMATCH=FALSE;\n\n\n    CREATE OR REPLACE FILE FORMAT {{ database }}.{{ schema }}.parquet\n        TYPE = PARQUET\n        TRIM_SPACE = TRUE\n        NULL_IF = ('NULL', 'null');\n\n    CREATE OR REPLACE FILE FORMAT {{ database }}.{{ schema }}.orc\n        TYPE = ORC\n        TRIM_SPACE = TRUE\n        NULL_IF = ('NULL', 'null');\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.external_stage": {"unique_id": "macro.sdna_project.external_stage", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/from_external_stage_materialization.sql", "original_file_path": "macros/from_external_stage_materialization.sql", "name": "external_stage", "macro_sql": "{% macro external_stage(path='') %}\n    @{{ database }}.{{ schema }}.__STAGE_TOKEN__{{ path }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.materialization_from_external_stage_snowflake": {"unique_id": "macro.sdna_project.materialization_from_external_stage_snowflake", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/from_external_stage_materialization.sql", "original_file_path": "macros/from_external_stage_materialization.sql", "name": "materialization_from_external_stage_snowflake", "macro_sql": "{% materialization from_external_stage, adapter='snowflake' -%}\n    -- set parameters\n    {%- set identifier = model['alias'] -%}\n    {%- set stage_name = config.get('stage_name', default=identifier ~ '_stage') -%}\n    {%- set truncate = config.get('truncate', default=True) -%}\n    {%- set file_format = config.get('file_format', default='type = csv field_delimiter = \\'|\\'') -%}\n    {%- set file_format_name = config.get('file_format_name') -%}\n    {%- set pattern = config.get('pattern') -%}\n    {%- set copy_transform = config.get('copy_transform', default=False) -%}\n\n    {% if 'PARQUET' in file_format_name.upper() or 'ORC' in file_format_name.upper() or 'PARQUET' in file_format.upper() or 'ORC' in file_format.upper() -%}\n        {%- set is_parquet_orc = True -%}\n    {% else -%}\n        {%- set is_parquet_orc = False -%}\n    {%- endif %}\n\n    {%- set old_relation = adapter.get_relation(schema=schema, database=database, identifier=identifier) -%}\n    {%- set target_relation = api.Relation.create(schema=schema, database=database, identifier=identifier, type='table') -%}\n    {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\n    {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n    {%- set should_drop = (full_refresh_mode or not exists_as_table) -%}\n    -- setup\n    {% if old_relation is none -%}\n        -- noop\n    {%- elif should_drop -%}\n        {{ adapter.drop_relation(old_relation) }}\n        {%- set old_relation = none -%}\n    {%- endif %}\n\n    -- build model\n    {{ run_hooks(pre_hooks, inside_transaction=False) }}\n    -- `BEGIN` happens here:\n    {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n    -- truncate target relation\n    {% if truncate -%}\n        {# -- Truncate the table #}\n        {%- call statement() -%}\n            TRUNCATE TABLE IF EXISTS {{ target_relation }}\n        {%- endcall -%}\n    {%- endif %}\n\n    {# Perform the main load operation using COPY INTO #}\n    {# See https://docs.snowflake.net/manuals/user-guide/data-load-considerations-load.html #}\n    {# See https://docs.snowflake.net/manuals/user-guide/data-load-transform.html #}\n\n    {%- call statement() -%}\n        SET last_updt_dt = CURRENT_TIMESTAMP();\n        SET current_session = CAST(CURRENT_SESSION() AS BIGINT)\n    {%- endcall -%}\n\n    {%- call statement('main') -%}\n        COPY INTO {{ target_relation }}\n        FROM {{ sql | replace('__STAGE_TOKEN__', stage_name)}}\n        file_format = ( {% if file_format_name -%} format_name = '{{ database }}.{{ schema }}.{{ file_format_name }}' {% else -%} {{ file_format }} {% endif %})\n        {% if pattern -%} pattern = '{{ pattern }}' {% endif %}\n        ON_ERROR = CONTINUE\n        {% if is_parquet_orc and not copy_transform -%} MATCH_BY_COLUMN_NAME = CASE_INSENSITIVE {%- endif %}\n    {% endcall %}\n\n    {% if not is_parquet_orc or not copy_transform -%}\n        {%- call statement() -%}\n            UPDATE {{ target_relation }}\n            SET last_updt_dt = $last_updt_dt\n        {%- endcall -%}\n    {%- endif %}\n\n    {{ run_hooks(post_hooks, inside_transaction=True) }}\n    -- `COMMIT` happens here\n    {{ adapter.commit() }}\n    {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n    {{ run_hooks(pre_hooks, inside_transaction=False) }}\n    -- `BEGIN` happens here:\n    {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n    {% if not is_parquet_orc -%}\n        {%- call statement() -%}\n            SET job_id = (SELECT TOP 1 QUERY_ID\n            FROM TABLE(INFORMATION_SCHEMA.QUERY_HISTORY_BY_SESSION(SESSION_ID => $current_session))\n            WHERE QUERY_TEXT LIKE 'COPY INTO%'\n            ORDER BY START_TIME DESC);\n\n            INSERT INTO SAVE_COPY_ERRORS\n            SELECT $job_id, '{{target_relation}}', validate_tbl.*,\n                   query_history_tbl.QUERY_TEXT, query_history_tbl.DATABASE_NAME, query_history_tbl.SCHEMA_NAME,\n                   query_history_tbl.USER_NAME, query_history_tbl.ROLE_NAME, query_history_tbl.WAREHOUSE_NAME,\n                   query_history_tbl.QUERY_TAG, query_history_tbl.START_TIME, query_history_tbl.END_TIME\n            FROM TABLE(validate({{ target_relation }}, job_id => $job_id)) AS validate_tbl\n            LEFT JOIN TABLE(information_schema.query_history()) AS query_history_tbl ON query_history_tbl.query_id = $job_id;\n        {%- endcall -%}\n    {%- endif %}\n\n    {{ run_hooks(post_hooks, inside_transaction=True) }}\n    -- `COMMIT` happens here\n    {{ adapter.commit() }}\n    {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n    -- Return the relations created in this materialization\n    {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.generate_schema_name": {"unique_id": "macro.sdna_project.generate_schema_name", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/generate_schema_name.sql", "original_file_path": "macros/generate_schema_name.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.get_cols": {"unique_id": "macro.sdna_project.get_cols", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/get_cols.sql", "original_file_path": "macros/get_cols.sql", "name": "get_cols", "macro_sql": "{% macro get_cols() %}\n\n    {%- set identifier = model['alias']|upper -%}\n\n    {% set query %}\n        SELECT 'src.$' || ROW_NUMBER() OVER(ORDER BY ORDINAL_POSITION) AS COLS\n        FROM {{ database }}.INFORMATION_SCHEMA.COLUMNS\n        WHERE TABLE_SCHEMA = '{{ schema }}' AND TABLE_NAME = '{{ identifier }}' AND COLUMN_NAME != 'LAST_UPDT_DT'\n        ORDER BY ORDINAL_POSITION\n    {% endset %}\n\n    {% set results = run_query(query) %}\n\n    {% if execute %}\n    {% set results_list = results.columns[0].values() %}\n    {% else %}\n    {% set results_list = [] %}\n    {% endif %}\n    {{ return(results_list) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.get_cols_experian": {"unique_id": "macro.sdna_project.get_cols_experian", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/get_cols_experian.sql", "original_file_path": "macros/get_cols_experian.sql", "name": "get_cols_experian", "macro_sql": "{% macro get_cols_experian() %}\n\n    {%- set identifier = model['alias']|upper -%}\n\n    {% set query %}\n        WITH experian_cols AS\n        (\n            SELECT COLUMN_NAME\n            FROM DP_DATA_SHARE_AWS_TO_AZ_REPLICA.INFORMATION_SCHEMA.COLUMNS\n            WHERE TABLE_NAME = 'MVH_CV_LIVING_UNIT_X261'\n        )\n        SELECT\n            CASE WHEN CDP_COL LIKE 'FILLER%' OR experian_cols.COLUMN_NAME IS NULL THEN NULL ELSE CDP_COL END AS CDP_COL,\n            EXP_CV_STG\n        FROM {{ database }}.{{ schema }}.EXPERIAN_MAPPING_X258 AS map\n        LEFT JOIN experian_cols ON map.CDP_COL = experian_cols.COLUMN_NAME\n        WHERE EXP_CV_STG != ''\n    {% endset %}\n\n    {% set results = run_query(query) %}\n\n    {{ return(results) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.sdna_project.get_cols_field_column_mapping": {"unique_id": "macro.sdna_project.get_cols_field_column_mapping", "package_name": "sdna_project", "root_path": "/opt/airflow/dags/dbt/dbt", "path": "macros/get_cols_field_column_mapping.sql", "original_file_path": "macros/get_cols_field_column_mapping.sql", "name": "get_cols_field_column_mapping", "macro_sql": "{% macro get_cols_field_column_mapping(table_name) %}\n\n    {%- set identifier = model['alias']|upper -%}\n\n    {% set query %}\n        SELECT\n            FIELD_NAME,\n            DATA_TYPE,\n            COLUMN_NAME\n        FROM {{ database }}.{{ schema }}.FIELD_COLUMN_MAPPING\n        WHERE\n            UPPER(TABLE_NAME) = UPPER('{{ table_name }}')\n            AND UPPER(COLUMN_NAME) != 'LAST_UPDT_DT'\n        ORDER BY ORDINAL_POSITION\n    {% endset %}\n\n    {% set results = run_query(query) %}\n\n    {{ return(results) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__get_catalog": {"unique_id": "macro.dbt_snowflake.snowflake__get_catalog", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "name": "snowflake__get_catalog", "macro_sql": "{% macro snowflake__get_catalog(information_schema, schemas) -%}\n  {% set query %}\n      with tables as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n              table_type as \"table_type\",\n              comment as \"table_comment\",\n\n              -- note: this is the _role_ that owns the table\n              table_owner as \"table_owner\",\n\n              'Clustering Key' as \"stats:clustering_key:label\",\n              clustering_key as \"stats:clustering_key:value\",\n              'The key used to cluster this table' as \"stats:clustering_key:description\",\n              (clustering_key is not null) as \"stats:clustering_key:include\",\n\n              'Row Count' as \"stats:row_count:label\",\n              row_count as \"stats:row_count:value\",\n              'An approximate count of rows in this table' as \"stats:row_count:description\",\n              (row_count is not null) as \"stats:row_count:include\",\n\n              'Approximate Size' as \"stats:bytes:label\",\n              bytes as \"stats:bytes:value\",\n              'Approximate size of the table as reported by Snowflake' as \"stats:bytes:description\",\n              (bytes is not null) as \"stats:bytes:include\",\n\n              'Last Modified' as \"stats:last_modified:label\",\n              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as \"stats:last_modified:value\",\n              'The timestamp for last update/change' as \"stats:last_modified:description\",\n              (last_altered is not null and table_type='BASE TABLE') as \"stats:last_modified:include\"\n\n          from {{ information_schema }}.tables\n\n      ),\n\n      columns as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n\n              column_name as \"column_name\",\n              ordinal_position as \"column_index\",\n              data_type as \"column_type\",\n              comment as \"column_comment\"\n\n          from {{ information_schema }}.columns\n      )\n\n      select *\n      from tables\n      join columns using (\"table_database\", \"table_schema\", \"table_name\")\n      where (\n        {%- for schema in schemas -%}\n          upper(\"table_schema\") = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n      )\n      order by \"column_index\"\n    {%- endset -%}\n\n  {{ return(run_query(query)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__create_table_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_table_as", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__create_table_as", "macro_sql": "{% macro snowflake__create_table_as(temporary, relation, sql) -%}\n  {%- set transient = config.get('transient', default=true) -%}\n  {%- set cluster_by_keys = config.get('cluster_by', default=none) -%}\n  {%- set enable_automatic_clustering = config.get('automatic_clustering', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n  {%- if cluster_by_keys is not none and cluster_by_keys is string -%}\n    {%- set cluster_by_keys = [cluster_by_keys] -%}\n  {%- endif -%}\n  {%- if cluster_by_keys is not none -%}\n    {%- set cluster_by_string = cluster_by_keys|join(\", \")-%}\n  {% else %}\n    {%- set cluster_by_string = none -%}\n  {%- endif -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n      create or replace {% if temporary -%}\n        temporary\n      {%- elif transient -%}\n        transient\n      {%- endif %} table {{ relation }} {% if copy_grants and not temporary -%} copy grants {%- endif %} as\n      (\n        {%- if cluster_by_string is not none -%}\n          select * from(\n            {{ sql }}\n            ) order by ({{ cluster_by_string }})\n        {%- else -%}\n          {{ sql }}\n        {%- endif %}\n      );\n    {% if cluster_by_string is not none and not temporary -%}\n      alter table {{relation}} cluster by ({{cluster_by_string}});\n    {%- endif -%}\n    {% if enable_automatic_clustering and cluster_by_string is not none and not temporary  -%}\n      alter table {{relation}} resume recluster;\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__create_view_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_view_as", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__create_view_as", "macro_sql": "{% macro snowflake__create_view_as(relation, sql) -%}\n  {%- set secure = config.get('secure', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create or replace {% if secure -%}\n    secure\n  {%- endif %} view {{ relation }} {% if copy_grants -%} copy grants {%- endif %} as (\n    {{ sql }}\n  );\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__get_columns_in_relation": {"unique_id": "macro.dbt_snowflake.snowflake__get_columns_in_relation", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__get_columns_in_relation", "macro_sql": "{% macro snowflake__get_columns_in_relation(relation) -%}\n  {%- set sql -%}\n    describe table {{ relation }}\n  {%- endset -%}\n  {%- set result = run_query(sql) -%}\n\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many columns in relation {{ relation }}! dbt can only get\n      information about relations with fewer than {{ maximum }} columns.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n\n  {% set columns = [] %}\n  {% for row in result %}\n    {% do columns.append(api.Column.from_description(row['name'], row['type'])) %}\n  {% endfor %}\n  {% do return(columns) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__list_schemas": {"unique_id": "macro.dbt_snowflake.snowflake__list_schemas", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__list_schemas", "macro_sql": "{% macro snowflake__list_schemas(database) -%}\n  {# 10k limit from here: https://docs.snowflake.net/manuals/sql-reference/sql/show-schemas.html#usage-notes #}\n  {% set maximum = 10000 %}\n  {% set sql -%}\n    show terse schemas in database {{ database }}\n    limit {{ maximum }}\n  {%- endset %}\n  {% set result = run_query(sql) %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in database {{ database }}! dbt can only get\n      information about databases with fewer than {{ maximum }} schemas.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {{ return(result) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__list_relations_without_caching": {"unique_id": "macro.dbt_snowflake.snowflake__list_relations_without_caching", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__list_relations_without_caching", "macro_sql": "{% macro snowflake__list_relations_without_caching(schema_relation) %}\n  {%- set sql -%}\n    show terse objects in {{ schema_relation }}\n  {%- endset -%}\n\n  {%- set result = run_query(sql) -%}\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in schema  {{ schema_relation }}! dbt can only get\n      information about schemas with fewer than {{ maximum }} objects.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {%- do return(result) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__check_schema_exists": {"unique_id": "macro.dbt_snowflake.snowflake__check_schema_exists", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__check_schema_exists", "macro_sql": "{% macro snowflake__check_schema_exists(information_schema, schema) -%}\n  {% call statement('check_schema_exists', fetch_result=True) -%}\n        select count(*)\n        from {{ information_schema }}.schemata\n        where upper(schema_name) = upper('{{ schema }}')\n            and upper(catalog_name) = upper('{{ information_schema.database }}')\n  {%- endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__current_timestamp": {"unique_id": "macro.dbt_snowflake.snowflake__current_timestamp", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__current_timestamp", "macro_sql": "{% macro snowflake__current_timestamp() -%}\n  convert_timezone('UTC', current_timestamp())\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__snapshot_string_as_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_string_as_time", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__snapshot_string_as_time", "macro_sql": "{% macro snowflake__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"to_timestamp_ntz('\" ~ timestamp ~ \"')\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__snapshot_get_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_get_time", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__snapshot_get_time", "macro_sql": "{% macro snowflake__snapshot_get_time() -%}\n  to_timestamp_ntz({{ current_timestamp() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__rename_relation": {"unique_id": "macro.dbt_snowflake.snowflake__rename_relation", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__rename_relation", "macro_sql": "{% macro snowflake__rename_relation(from_relation, to_relation) -%}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ to_relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__alter_column_type": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_type", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_column_type", "macro_sql": "{% macro snowflake__alter_column_type(relation, column_name, new_column_type) -%}\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} alter {{ adapter.quote(column_name) }} set data type {{ new_column_type }};\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__alter_relation_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_relation_comment", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_relation_comment", "macro_sql": "{% macro snowflake__alter_relation_comment(relation, relation_comment) -%}\n  comment on {{ relation.type }} {{ relation }} IS $${{ relation_comment | replace('$', '[$]') }}$$;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__alter_column_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_comment", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_column_comment", "macro_sql": "{% macro snowflake__alter_column_comment(relation, column_dict) -%}\n    alter {{ relation.type }} {{ relation }} alter\n    {% for column_name in column_dict %}\n        {{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} COMMENT $${{ column_dict[column_name]['description'] | replace('$', '[$]') }}$$ {{ ',' if not loop.last else ';' }}\n    {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.get_current_query_tag": {"unique_id": "macro.dbt_snowflake.get_current_query_tag", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "get_current_query_tag", "macro_sql": "{% macro get_current_query_tag() -%}\n  {{ return(run_query(\"show parameters like 'query_tag' in session\").rows[0]['value']) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.set_query_tag": {"unique_id": "macro.dbt_snowflake.set_query_tag", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "set_query_tag", "macro_sql": "{% macro set_query_tag() -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% set original_query_tag = get_current_query_tag() %}\n    {{ log(\"Setting query_tag to '\" ~ new_query_tag ~ \"'. Will reset to '\" ~ original_query_tag ~ \"' after materialization.\") }}\n    {% do run_query(\"alter session set query_tag = '{}'\".format(new_query_tag)) %}\n    {{ return(original_query_tag)}}\n  {% endif %}\n  {{ return(none)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.unset_query_tag": {"unique_id": "macro.dbt_snowflake.unset_query_tag", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "unset_query_tag", "macro_sql": "{% macro unset_query_tag(original_query_tag) -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% if original_query_tag %}\n      {{ log(\"Resetting query_tag to '\" ~ original_query_tag ~ \"'.\") }}\n      {% do run_query(\"alter session set query_tag = '{}'\".format(original_query_tag)) %}\n    {% else %}\n      {{ log(\"No original query_tag, unsetting parameter.\") }}\n      {% do run_query(\"alter session unset query_tag\") %}\n    {% endif %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "dbt_snowflake_validate_get_incremental_strategy", "macro_sql": "{% macro dbt_snowflake_validate_get_incremental_strategy(config) %}\n  {#-- Find and validate the incremental strategy #}\n  {%- set strategy = config.get(\"incremental_strategy\", default=\"merge\") -%}\n\n  {% set invalid_strategy_msg -%}\n    Invalid incremental strategy provided: {{ strategy }}\n    Expected one of: 'merge', 'delete+insert'\n  {%- endset %}\n  {% if strategy not in ['merge', 'delete+insert'] %}\n    {% do exceptions.raise_compiler_error(invalid_strategy_msg) %}\n  {% endif %}\n\n  {% do return(strategy) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "dbt_snowflake_get_incremental_sql", "macro_sql": "{% macro dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n  {% if strategy == 'merge' %}\n    {% do return(get_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% elif strategy == 'delete+insert' %}\n    {% do return(get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% else %}\n    {% do exceptions.raise_compiler_error('invalid strategy: ' ~ strategy) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.materialization_incremental_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_incremental_snowflake", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "materialization_incremental_snowflake", "macro_sql": "{% materialization incremental, adapter='snowflake' -%}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set target_relation = this %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(this) %}\n\n  {#-- Validate early so we don't run SQL if the strategy is invalid --#}\n  {% set strategy = dbt_snowflake_validate_get_incremental_strategy(config) -%}\n\n  -- setup\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% if existing_relation is none %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  {% elif existing_relation.is_view %}\n    {#-- Can't overwrite a view with a table - we must drop --#}\n    {{ log(\"Dropping relation \" ~ target_relation ~ \" because it is a view and this model is a table.\") }}\n    {% do adapter.drop_relation(existing_relation) %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  {% elif full_refresh_mode %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n           from_relation=tmp_relation,\n           to_relation=target_relation) %}\n    {% set dest_columns = adapter.get_columns_in_relation(target_relation) %}\n    {% set build_sql = dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n  {% endif %}\n\n  {%- call statement('main') -%}\n    {{ build_sql }}\n  {%- endcall -%}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {% set target_relation = target_relation.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.snowflake__get_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__get_merge_sql", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/merge.sql", "original_file_path": "macros/materializations/merge.sql", "name": "snowflake__get_merge_sql", "macro_sql": "{% macro snowflake__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) -%}\n\n    {#\n       Workaround for Snowflake not being happy with a merge on a constant-false predicate.\n       When no unique_key is provided, this macro will do a regular insert. If a unique_key\n       is provided, then this macro will do a proper merge instead.\n    #}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute='name')) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {%- if unique_key is none -%}\n\n        {{ sql_header if sql_header is not none }}\n\n        insert into {{ target }} ({{ dest_cols_csv }})\n        (\n            select {{ dest_cols_csv }}\n            from {{ source_sql }}\n        );\n\n    {%- else -%}\n\n        {{ default__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) }}\n\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.materialization_table_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_table_snowflake", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/table.sql", "original_file_path": "macros/materializations/table.sql", "name": "materialization_table_snowflake", "macro_sql": "{% materialization table, adapter='snowflake' %}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database, type='table') -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {#-- Drop the relation if it was a view to \"convert\" it in a table. This may lead to\n    -- downtime, but it should be a relatively infrequent occurrence  #}\n  {% if old_relation is not none and not old_relation.is_table %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ drop_relation_if_exists(old_relation) }}\n  {% endif %}\n\n  --build model\n  {% call statement('main') -%}\n    {{ create_table_as(false, target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt_snowflake.materialization_view_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_view_snowflake", "package_name": "dbt_snowflake", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/snowflake", "path": "macros/materializations/view.sql", "original_file_path": "macros/materializations/view.sql", "name": "materialization_view_snowflake", "macro_sql": "{% materialization view, adapter='snowflake' -%}\n\n    {% set original_query_tag = set_query_tag() %}\n    {% set to_return = create_or_replace_view() %}\n\n    {% set target_relation = this.incorporate(type='view') %}\n    {% do persist_docs(target_relation, model, for_columns=false) %}\n\n    {% do return(to_return) %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/core.sql", "original_file_path": "macros/core.sql", "name": "statement", "macro_sql": "{% macro statement(name=None, fetch_result=False, auto_begin=True) -%}\n  {%- if execute: -%}\n    {%- set sql = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n      {{ write(sql) }}\n    {%- endif -%}\n\n    {%- set res, table = adapter.execute(sql, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/core.sql", "original_file_path": "macros/core.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.column_list": {"unique_id": "macro.dbt.column_list", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "column_list", "macro_sql": "{% macro column_list(columns) %}\n  {%- for col in columns %}\n    {{ col.name }} {% if not loop.last %},{% endif %}\n  {% endfor -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.column_list_for_create_table": {"unique_id": "macro.dbt.column_list_for_create_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "column_list_for_create_table", "macro_sql": "{% macro column_list_for_create_table(columns) %}\n  {%- for col in columns %}\n    {{ col.name }} {{ col.data_type }} {%- if not loop.last %},{% endif %}\n  {% endfor -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/helpers.sql", "original_file_path": "macros/materializations/helpers.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_get_time", "macro_sql": "{% macro snapshot_get_time() -%}\n  {{ adapter.dispatch('snapshot_get_time')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() -%}\n  {{ current_timestamp() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/fishtown-analytics/dbt/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists) -%}\n    {%- set query_columns = get_columns_in_query(node['compiled_sql']) -%}\n    {%- if not target_exists -%}\n        {# no table yet -> return whatever the query does #}\n        {{ return([false, query_columns]) }}\n    {%- endif -%}\n    {# handle any schema changes #}\n    {%- set target_table = node.get('alias', node.get('name')) -%}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=target_table) -%}\n    {%- set existing_cols = get_columns_in_query('select * from ' ~ target_relation) -%}\n    {%- set ns = namespace() -%} {# handle for-loop scoping with a namespace #}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(col) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return([ns.column_added, intersection]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/strategies.sql", "original_file_path": "macros/materializations/snapshot/strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    \n    {% set select_current_time -%}\n        select {{ snapshot_get_time() }} as snapshot_start\n    {%- endset %}\n\n    {#-- don't access the column by name, to avoid dealing with casing issues on snowflake #}\n    {%- set now = run_query(select_current_time)[0][0] -%}\n    {% if now is none or now is undefined -%}\n        {%- do exceptions.raise_compiler_error('Could not get a snapshot start time from the database') -%}\n    {%- endif %}\n    {% set updated_at = snapshot_string_as_time(now) %}\n\n    {% set column_added = false %}\n\n    {% if check_cols_config == 'all' %}\n        {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists) %}\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {% set check_cols = check_cols_config %}\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        TRUE\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshot/snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshot/snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n    ;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select \n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n    \n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n    \n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set tmp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, tmp_relation, select) }}\n    {% endcall %}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/snapshot/snapshot.sql", "original_file_path": "macros/materializations/snapshot/snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n\n  {% if not adapter.check_schema_exists(model.database, model.schema) %}\n    {% do create_schema(model.database, model.schema) %}\n  {% endif %}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_sql']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/table/table.sql", "original_file_path": "macros/materializations/table/table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type='table') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema,\n                                                      database=database,\n                                                      type='table') -%}\n\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type=backup_relation_type) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n\n  -- drop the temp relations if they exists for some reason\n  {{ adapter.drop_relation(intermediate_relation) }}\n  {{ adapter.drop_relation(backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_table_as(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if old_relation is not none %}\n      {{ adapter.rename_relation(target_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/view/create_or_replace_view.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch(\"handle_existing_table\", packages=['dbt'])(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/view/create_or_replace_view.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/view/create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view(run_outside_transaction_hooks=True) %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n\n  {% if run_outside_transaction_hooks %}\n      -- no transactions on BigQuery\n      {{ run_hooks(pre_hooks, inside_transaction=False) }}\n  {% endif %}\n\n  -- `BEGIN` happens here on Snowflake\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_view_as(target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if run_outside_transaction_hooks %}\n      -- No transactions on BigQuery\n      {{ run_hooks(post_hooks, inside_transaction=False) }}\n  {% endif %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/view/view.sql", "original_file_path": "macros/materializations/view/view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, database=database,\n                                                type='view') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema, database=database, type='view') -%}\n\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"old_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the old_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the old_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema, database=database,\n                                                type=backup_relation_type) -%}\n\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exists for some reason\n  {{ adapter.drop_relation(intermediate_relation) }}\n  {{ adapter.drop_relation(backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_view_as(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if old_relation is not none %}\n    {{ adapter.rename_relation(target_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% set unique_key_match %}\n            DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n        {% endset %}\n        {% do predicates.append(unique_key_match) %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column in dest_columns -%}\n            {{ adapter.quote(column.name) }} = DBT_INTERNAL_SOURCE.{{ adapter.quote(column.name) }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.common_get_delete_insert_merge_sql": {"unique_id": "macro.dbt.common_get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "common_get_delete_insert_merge_sql", "macro_sql": "{% macro common_get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key is not none %}\n    delete from {{ target }}\n    where ({{ unique_key }}) in (\n        select ({{ unique_key }})\n        from {{ source }}\n    );\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    );\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n    {{ common_get_delete_insert_merge_sql(target, source, unique_key, dest_columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/common/merge.sql", "original_file_path": "macros/materializations/common/merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/incremental/incremental.sql", "original_file_path": "macros/materializations/incremental/incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  {% set unique_key = config.get('unique_key') %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(this) %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n  {% if existing_relation is none %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n  {% elif existing_relation.is_view or should_full_refresh() %}\n      {#-- Make sure the backup doesn't exist so we don't encounter issues with the rename below #}\n      {% set backup_identifier = existing_relation.identifier ~ \"__dbt_backup\" %}\n      {% set backup_relation = existing_relation.incorporate(path={\"identifier\": backup_identifier}) %}\n      {% do adapter.drop_relation(backup_relation) %}\n\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n      {% do to_drop.append(backup_relation) %}\n  {% else %}\n      {% set tmp_relation = make_temp_relation(target_relation) %}\n      {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n      {% do adapter.expand_target_column_types(\n             from_relation=tmp_relation,\n             to_relation=target_relation) %}\n      {% set build_sql = incremental_upsert(tmp_relation, target_relation, unique_key=unique_key) %}\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.incremental_upsert": {"unique_id": "macro.dbt.incremental_upsert", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/incremental/helpers.sql", "original_file_path": "macros/materializations/incremental/helpers.sql", "name": "incremental_upsert", "macro_sql": "{% macro incremental_upsert(tmp_relation, target_relation, unique_key=none, statement_name=\"main\") %}\n    {%- set dest_columns = adapter.get_columns_in_relation(target_relation) -%}\n    {%- set dest_cols_csv = dest_columns | map(attribute='quoted') | join(', ') -%}\n\n    {%- if unique_key is not none -%}\n    delete\n    from {{ target_relation }}\n    where ({{ unique_key }}) in (\n        select ({{ unique_key }})\n        from {{ tmp_relation }}\n    );\n    {%- endif %}\n\n    insert into {{ target_relation }} ({{ dest_cols_csv }})\n    (\n       select {{ dest_cols_csv }}\n       from {{ tmp_relation }}\n    );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.basic_load_csv_rows": {"unique_id": "macro.dbt.basic_load_csv_rows", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "basic_load_csv_rows", "macro_sql": "{% macro basic_load_csv_rows(model, batch_size, agate_table) %}\n    {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n    {% set bindings = [] %}\n\n    {% set statements = [] %}\n\n    {% for chunk in agate_table.rows | batch(batch_size) %}\n        {% set bindings = [] %}\n\n        {% for row in chunk %}\n            {% do bindings.extend(row) %}\n        {% endfor %}\n\n        {% set sql %}\n            insert into {{ this.render() }} ({{ cols_sql }}) values\n            {% for row in chunk -%}\n                ({%- for column in agate_table.column_names -%}\n                    %s\n                    {%- if not loop.last%},{%- endif %}\n                {%- endfor -%})\n                {%- if not loop.last%},{%- endif %}\n            {%- endfor %}\n        {% endset %}\n\n        {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n        {% if loop.index0 == 0 %}\n            {% do statements.append(sql) %}\n        {% endif %}\n    {% endfor %}\n\n    {# Return SQL so we can render it out into the compiled files #}\n    {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n  {{ return(basic_load_csv_rows(model, 10000, agate_table) )}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/materializations/seed/seed.sql", "original_file_path": "macros/materializations/seed/seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set agate_table = load_agate_table() -%}\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ create_table_sql }};\n    -- dbt seed --\n    {{ sql }}\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/query.sql", "original_file_path": "macros/etc/query.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/get_custom_schema.sql", "original_file_path": "macros/etc/get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/get_custom_schema.sql", "original_file_path": "macros/etc/get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/get_custom_database.sql", "original_file_path": "macros/etc/get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/get_custom_database.sql", "original_file_path": "macros/etc/get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/is_incremental.sql", "original_file_path": "macros/etc/is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/etc/get_custom_alias.sql", "original_file_path": "macros/etc/get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, sql) -%}\n  {{ adapter.dispatch('create_table_as')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ adapter.dispatch('current_timestamp')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter '+adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation')(base_relation, suffix))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {% set tmp_identifier = base_relation.identifier ~ suffix %}\n    {% set tmp_relation = base_relation.incorporate(\n                                path={\"identifier\": tmp_identifier}) -%}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/adapters/common.sql", "original_file_path": "macros/adapters/common.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/relationships.sql", "original_file_path": "macros/schema_tests/relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, to, field) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('from')) %}\n\n\nselect count(*) as validation_errors\nfrom (\n    select {{ column_name }} as id from {{ model }}\n) as child\nleft join (\n    select {{ field }} as id from {{ to }}\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/relationships.sql", "original_file_path": "macros/schema_tests/relationships.sql", "name": "test_relationships", "macro_sql": "{% macro test_relationships(model, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships') %}\n    {{ macro(model, to, field, **kwargs) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/accepted_values.sql", "original_file_path": "macros/schema_tests/accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, values) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('field')) %}\n{% set quote_values = kwargs.get('quote', True) %}\n\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        {% for value in values -%}\n            {% if quote_values -%}\n            '{{ value }}'\n            {%- else -%}\n            {{ value }}\n            {%- endif -%}\n            {%- if not loop.last -%},{%- endif %}\n        {%- endfor %}\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/accepted_values.sql", "original_file_path": "macros/schema_tests/accepted_values.sql", "name": "test_accepted_values", "macro_sql": "{% macro test_accepted_values(model, values) %}\n    {% set macro = adapter.dispatch('test_accepted_values') %}\n    {{ macro(model, values, **kwargs) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/not_null.sql", "original_file_path": "macros/schema_tests/not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n\nselect count(*) as validation_errors\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/not_null.sql", "original_file_path": "macros/schema_tests/not_null.sql", "name": "test_not_null", "macro_sql": "{% macro test_not_null(model) %}\n    {% set macro = adapter.dispatch('test_not_null') %}\n    {{ macro(model, **kwargs) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/unique.sql", "original_file_path": "macros/schema_tests/unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        {{ column_name }}\n\n    from {{ model }}\n    where {{ column_name }} is not null\n    group by {{ column_name }}\n    having count(*) > 1\n\n) validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "macros/schema_tests/unique.sql", "original_file_path": "macros/schema_tests/unique.sql", "name": "test_unique", "macro_sql": "{% macro test_unique(model) %}\n    {% set macro = adapter.dispatch('test_unique') %}\n    {{ macro(model, **kwargs) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": []}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "/home/airflow/.local/lib/python3.7/site-packages/dbt/include/global_project", "path": "overview.md", "original_file_path": "docs/overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--models` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/overview)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [chat](https://community.getdbt.com/) on Slack for live questions and support."}}, "exposures": {}, "selectors": {}, "disabled": [], "parent_map": {"model.sdna_project.inegi_2pbi_stg": ["model.sdna_project.inegi_2"], "model.sdna_project.mx_stores_stg": ["model.sdna_project.dls_latam_ins_cia_ruta", "model.sdna_project.dls_latam_ins_maestrocliente", "model.sdna_project.dls_latam_ins_nivelcliente", "model.sdna_project.dls_latam_ins_ruta", "model.sdna_project.dls_latam_ins_sucursal", "model.sdna_project.dls_latam_ins_tipocliente", "model.sdna_project.dls_latam_ins_tiporuta", "model.sdna_project.dls_latam_ins_vtaclipro_sem_v"], "model.sdna_project.stg_dataplor_coordinates": ["model.sdna_project.dataplor"], "model.sdna_project.stg_mx_store_coordinates": ["model.sdna_project.mx_stores"], "model.sdna_project.inegi2_step1": ["model.sdna_project.inegi_2_stg"], "model.sdna_project.inegi2_step2": ["model.sdna_project.inegi2_step1", "model.sdna_project.urbanicity"], "model.sdna_project.inegi2_step3": ["model.sdna_project.inegi2_step2"], "model.sdna_project.inegi2_step4": ["model.sdna_project.inegi2_step3", "model.sdna_project.nse"], "model.sdna_project.inegi2_step5": ["model.sdna_project.inegi", "model.sdna_project.inegi2_step4"], "model.sdna_project.stg_lookup": [], "model.sdna_project.stg_mobility_data": [], "model.sdna_project.tradearea_df_lf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.tradearea_df_sf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.tradearea_r_lf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.tradearea_r_sf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.tradearea_u_lf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.tradearea_u_sf": ["model.sdna_project.inegi_2", "model.sdna_project.mx_stores"], "model.sdna_project.dataplor": [], "model.sdna_project.dls_latam_ins_categoria": [], "model.sdna_project.dls_latam_ins_cia_ruta": [], "model.sdna_project.dls_latam_ins_maestrocliente": [], "model.sdna_project.dls_latam_ins_nivelcliente": [], "model.sdna_project.dls_latam_ins_producto": [], "model.sdna_project.dls_latam_ins_ruta": [], "model.sdna_project.dls_latam_ins_semana": [], "model.sdna_project.dls_latam_ins_sucursal": [], "model.sdna_project.dls_latam_ins_tipocliente": [], "model.sdna_project.dls_latam_ins_tiporuta": [], "model.sdna_project.dls_latam_ins_vtaclipro_sem_v": [], "model.sdna_project.inegi_2_stg": [], "model.sdna_project.inegi_stg": [], "model.sdna_project.nse_stg": [], "model.sdna_project.urbanicity_stg": [], "model.sdna_project.inegi": ["model.sdna_project.inegi_stg"], "model.sdna_project.inegi_2": ["model.sdna_project.inegi2_step5"], "model.sdna_project.inegi_2pbi": ["model.sdna_project.inegi_2pbi_stg", "model.sdna_project.nse"], "model.sdna_project.mapping_id_cliente_dataplor_all": ["model.sdna_project.stg_dataplor_coordinates", "model.sdna_project.stg_mx_store_coordinates"], "model.sdna_project.mapping_id_cliente_quadkey_all": ["model.sdna_project.mx_stores"], "model.sdna_project.mx_products": ["model.sdna_project.dls_latam_ins_categoria", "model.sdna_project.dls_latam_ins_producto", "model.sdna_project.dls_latam_ins_vtaclipro_sem_v"], "model.sdna_project.mx_sales_current_and_last_year": ["model.sdna_project.dls_latam_ins_semana", "model.sdna_project.dls_latam_ins_semana", "model.sdna_project.mx_sales_wk", "model.sdna_project.mx_sales_wk"], "model.sdna_project.mx_sales_des_trimestre": ["model.sdna_project.dls_latam_ins_semana", "model.sdna_project.mx_sales_wk"], "model.sdna_project.mx_sales_l26_wk": ["model.sdna_project.mx_sales_wk"], "model.sdna_project.mx_sales_l52_wk": ["model.sdna_project.mx_sales_wk"], "model.sdna_project.mx_sales_periodo": ["model.sdna_project.dls_latam_ins_semana", "model.sdna_project.mx_sales_wk"], "model.sdna_project.mx_sales_wk": ["model.sdna_project.dls_latam_ins_producto", "model.sdna_project.dls_latam_ins_semana", "model.sdna_project.dls_latam_ins_vtaclipro_sem_v"], "model.sdna_project.mx_stores": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.nse": ["model.sdna_project.nse_stg"], "model.sdna_project.store_mobility": ["model.sdna_project.mapping_id_cliente_quadkey_all"], "model.sdna_project.store_poi_counts": ["model.sdna_project.dataplor", "model.sdna_project.mapping_id_cliente_dataplor_all"], "model.sdna_project.tradearea": ["model.sdna_project.tradearea_df_lf", "model.sdna_project.tradearea_df_sf", "model.sdna_project.tradearea_r_lf", "model.sdna_project.tradearea_r_sf", "model.sdna_project.tradearea_u_lf", "model.sdna_project.tradearea_u_sf"], "model.sdna_project.urbanicity": ["model.sdna_project.urbanicity_stg"], "model.sdna_project.mobility_adm1_mx": ["model.sdna_project.stg_lookup", "model.sdna_project.stg_mobility_data"], "model.sdna_project.dx_fl_sales_cust_wk_prod": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref"], "model.sdna_project.dx_msa_xref_der": ["model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref"], "model.sdna_project.dx_pbc_sales_cust_wk_prod": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref"], "model.sdna_project.exp_geo_temp": ["model.sdna_project.experian_cv_stg", "model.sdna_project.experian_cv_stg", "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.geo_retailer_zip9_zip5_chain_count"], "model.sdna_project.geo_retailer_stg_temp": ["model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info"], "model.sdna_project.mvh_retailer_dim_temp1": ["model.sdna_project.geo_retailer_stg"], "model.sdna_project.mvh_retailer_dim_temp2": ["model.sdna_project.mvh_retailer_dim_temp1", "model.sdna_project.mvh_retailer_dim_temp1"], "model.sdna_project.avbl_is_percentile_1": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.avbl_is_percentile_2": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.avbl_is_percentile_3": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.avbl_is_percentile_4": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.avbl_is_percentile_5": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.is_percentile_1": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_2": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_3": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_4": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_5": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_6": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_7": ["model.sdna_project.exp_geo_is"], "model.sdna_project.is_percentile_8": ["model.sdna_project.exp_geo_is"], "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl"], "model.sdna_project.dx_fl_trade_chnl_lkp": [], "model.sdna_project.dx_msa_xref": [], "model.sdna_project.dx_pbc_trade_chnl_lkp": [], "model.sdna_project.fsv_gsc_z9_drivetime": [], "model.sdna_project.fsv_is_coeff_raw": [], "model.sdna_project.fsv_is_means_raw": [], "model.sdna_project.fsv_stores": [], "model.sdna_project.fvh_cs_coeff_raw": [], "model.sdna_project.fvh_fs_coeff_raw": [], "model.sdna_project.fvh_life_stage_raw": [], "model.sdna_project.fvh_t_test_raw": [], "model.sdna_project.cbsa_list": [], "model.sdna_project.gsc_msa_z9_drivetime": [], "model.sdna_project.mvh_retailers_aldi": [], "model.sdna_project.mvh_retailers_tj": [], "model.sdna_project.mvh_retailers_wf": [], "model.sdna_project.iri_pepsi_fb_raw": [], "model.sdna_project.is_coeff_raw_stg": [], "model.sdna_project.is_means_raw": [], "model.sdna_project.experian_cv_stg": ["source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261"], "model.sdna_project.exp_fvh": ["model.sdna_project.exp_geo_is_cg"], "model.sdna_project.exp_geo_is_cg_fvh": ["model.sdna_project.exp_geo_is_cg", "model.sdna_project.fvh_cs_fs"], "model.sdna_project.fvh_cluster": ["model.sdna_project.exp_fvh"], "model.sdna_project.fvh_cs_fs": ["model.sdna_project.fvh_life_stage_stg", "model.sdna_project.fvh_probability"], "model.sdna_project.fvh_currentspend": ["model.sdna_project.fvh_cluster", "model.sdna_project.fvh_cs_coeff_raw"], "model.sdna_project.fvh_life_stage_stg": ["model.sdna_project.fvh_life_stage_raw", "model.sdna_project.fvh_life_stage_raw"], "model.sdna_project.fvh_probability": ["model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_test_raw", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value", "model.sdna_project.fvh_t_value"], "model.sdna_project.fvh_t_value": ["model.sdna_project.fvh_currentspend", "model.sdna_project.fvh_fs_coeff_raw"], "model.sdna_project.exp_geo_is_cg": ["model.sdna_project.cbsa_list", "model.sdna_project.exp_geo_is", "model.sdna_project.exp_geo_is"], "model.sdna_project.dx_store_attr": ["model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_trade_chnl_lkp", "model.sdna_project.dx_fl_trade_chnl_lkp", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_trade_chnl_lkp", "model.sdna_project.dx_pbc_trade_chnl_lkp"], "model.sdna_project.exp_geo": ["model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.experian_cv_stg", "model.sdna_project.experian_cv_stg"], "model.sdna_project.exp_geo_lmtd_cv": ["model.sdna_project.exp_geo_null", "model.sdna_project.exp_geo_null", "model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_temp", "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.geo_retailer_zip9_zip5_chain_count"], "model.sdna_project.exp_geo_null": ["model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_temp"], "model.sdna_project.geo_new_retailer_info": ["model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.mvh_retailers_aldi", "model.sdna_project.mvh_retailers_aldi", "model.sdna_project.mvh_retailers_tj", "model.sdna_project.mvh_retailers_tj", "model.sdna_project.mvh_retailers_wf", "model.sdna_project.mvh_retailers_wf"], "model.sdna_project.geo_retailer_stg": ["model.sdna_project.geo_retailer_stg_temp", "model.sdna_project.geo_retailer_stg_temp"], "model.sdna_project.geo_retailer_zip9_chain_count": ["model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.geo_retailer_zip9_info"], "model.sdna_project.geo_retailer_zip9_info": ["model.sdna_project.geo_retailer_stg", "model.sdna_project.geo_retailer_stg", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.gsc_msa_z9_drivetime"], "model.sdna_project.geo_retailer_zip9_zip5_chain_count": ["model.sdna_project.geo_retailer_zip9_chain_count", "model.sdna_project.geo_retailer_zip9_chain_count", "model.sdna_project.geo_retailer_zip9_chain_count"], "model.sdna_project.exp_geo_is_cg_fvh_iri": ["model.sdna_project.exp_geo_is_cg_fvh", "model.sdna_project.iri_all"], "model.sdna_project.iri_all": ["model.sdna_project.iri_pepsi_fb_raw", "source.sdna_project.iri.MVH_IRI_PROSCORES_X261"], "model.sdna_project.exp_geo_is": ["model.sdna_project.exp_geo", "model.sdna_project.exp_geo", "model.sdna_project.is_hh_store_tc_transpose", "model.sdna_project.is_hh_store_tc_transpose"], "model.sdna_project.is_coeff_raw": ["model.sdna_project.is_coeff_raw_stg"], "model.sdna_project.is_hh_store_tc": ["model.sdna_project.is_coeff_raw", "model.sdna_project.is_coeff_raw", "model.sdna_project.is_hh_transpose", "model.sdna_project.is_hh_transpose", "model.sdna_project.is_means_raw", "model.sdna_project.is_means_raw"], "model.sdna_project.is_hh_store_tc_transpose": ["model.sdna_project.is_hh_store_tc", "model.sdna_project.is_hh_store_tc"], "model.sdna_project.is_hh_transpose": ["model.sdna_project.exp_geo", "model.sdna_project.exp_geo"], "model.sdna_project.retailer_data_store_full": ["model.sdna_project.avbl_is_percentile", "model.sdna_project.fvh_percentile", "model.sdna_project.is_percentile", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl"], "model.sdna_project.mvh_retailer_dim": ["model.sdna_project.mvh_retailer_dim_temp2", "model.sdna_project.mvh_retailer_dim_temp2"], "model.sdna_project.mvh_retailer_fact": ["model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full", "model.sdna_project.retailer_data_store_full"], "model.sdna_project.retailer_sp_hh_all_store": ["model.sdna_project.mvh_retailer_fact", "model.sdna_project.retailer_sp_msa_drivetime"], "model.sdna_project.retailer_sp_msa_drivetime": ["model.sdna_project.geo_retailer_stg", "model.sdna_project.retailer_sp_zip9_drivetime"], "model.sdna_project.retailer_sp_zip9_drivetime": ["model.sdna_project.dx_msa_xref", "model.sdna_project.dx_msa_xref", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.gsc_msa_z9_drivetime", "model.sdna_project.retailer_data_store_full"], "model.sdna_project.avbl_is_percentile": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.fvh_percentile": ["model.sdna_project.fvh_cs_fs"], "model.sdna_project.is_percentile": ["model.sdna_project.exp_geo_is"], "model.sdna_project.trifecta_is_cap": ["model.sdna_project.exp_geo_is_cg_fvh_iri", "model.sdna_project.is_percentile"], "model.sdna_project.trifecta_is_cap_iri_adjf_avbl": ["model.sdna_project.trifecta_is_cap"], "model.sdna_project.stg_fl_cust": ["model.sdna_project.btg_fl_cust_v"], "model.sdna_project.stg_fl_prod_sales": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.fl_sales"], "model.sdna_project.stg_fl_sales": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.fl_sales_cust_agg"], "model.sdna_project.stg_fl_xref_unique": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_fl_xref"], "model.sdna_project.stg_pbc_cust": ["model.sdna_project.btg_pbc_cust_v"], "model.sdna_project.stg_pbc_sales": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.pbc_sales_cust_agg_no_allied"], "model.sdna_project.stg_pbc_xref_unique": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.btg_msa_pbc_xref"], "model.sdna_project.cm_btg_fl_sales_tdlinx1": ["model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_pbc_sales_tdlinx1": ["model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc": ["model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid"], "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc": ["model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid"], "model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc": ["model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid"], "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc": ["model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid"], "model.sdna_project.btg_fl_retailer_assgnt": [], "model.sdna_project.btg_pbc_new_mkt_loc": [], "model.sdna_project.btg_pbc_retailer_assgnt": [], "model.sdna_project.btg_pbc_route_data": [], "model.sdna_project.btg_pep_calendar": [], "model.sdna_project.btg_ref_calendar": [], "model.sdna_project.fl_cust": [], "model.sdna_project.fl_prod": [], "model.sdna_project.fl_sales_2018": [], "model.sdna_project.fl_sales_2019": [], "model.sdna_project.fl_sales_2020": [], "model.sdna_project.fl_sales_2021": [], "model.sdna_project.mdm_msa_fl_xref": [], "model.sdna_project.mdm_msa_pbc_xref": [], "model.sdna_project.pbc_cust": [], "model.sdna_project.pbc_prod": [], "model.sdna_project.pbc_sales_2018": [], "model.sdna_project.pbc_sales_2019": [], "model.sdna_project.pbc_sales_2020": [], "model.sdna_project.pbc_sales_2021": [], "model.sdna_project.iri_pbc_markets_divs_by_fips": [], "model.sdna_project.iri_rma_store_list": [], "model.sdna_project.iri_srma_sample_stores": [], "model.sdna_project.msa_tdlinx_xref_final": [], "model.sdna_project.p_msa_cust_xref_tdlinx": [], "model.sdna_project.zip_code_priority_report": [], "model.sdna_project.btg_fl_cust_v": ["model.sdna_project.fl_cust"], "model.sdna_project.btg_fl_prod_v": ["model.sdna_project.fl_prod"], "model.sdna_project.btg_fl_retailer_assgnt_excptn_v": ["model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v"], "model.sdna_project.btg_fl_retailer_xref_v": ["model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_retailer_assgnt", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_v"], "model.sdna_project.btg_fl_sales_cust_prod_v": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.stg_fl_xref_unique"], "model.sdna_project.btg_fl_sales_cust_v": ["model.sdna_project.stg_fl_cust", "model.sdna_project.stg_fl_sales", "model.sdna_project.stg_fl_xref_unique"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v": ["model.sdna_project.stg_fl_prod_sales", "model.sdna_project.stg_fl_xref_unique"], "model.sdna_project.btg_fl_sales_cust_wk_v": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_fl_xref", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.stg_fl_cust", "model.sdna_project.stg_fl_cust", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.stg_fl_xref_unique"], "model.sdna_project.btg_fl_sales_v": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.fl_prod", "model.sdna_project.fl_sales"], "model.sdna_project.btg_load_stat": ["model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar", "model.sdna_project.btg_ref_calendar"], "model.sdna_project.btg_msa_fl_xref": ["model.sdna_project.btg_load_stat", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.mdm_msa_fl_xref"], "model.sdna_project.btg_msa_fl_xref_v": ["model.sdna_project.btg_msa_fl_xref"], "model.sdna_project.btg_msa_lat_lon_v": ["model.sdna_project.mdm_msa_fl_xref", "model.sdna_project.mdm_msa_pbc_xref"], "model.sdna_project.btg_msa_pbc_xref": ["model.sdna_project.btg_load_stat", "model.sdna_project.mdm_msa_pbc_xref", "model.sdna_project.pbc_sales_cust_wk_agg"], "model.sdna_project.btg_msa_pbc_xref_v": ["model.sdna_project.btg_msa_pbc_xref"], "model.sdna_project.btg_pbc_cust_v": ["model.sdna_project.pbc_cust"], "model.sdna_project.btg_pbc_prod_v": ["model.sdna_project.pbc_prod"], "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v": ["model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v"], "model.sdna_project.btg_pbc_retailer_xref_v": ["model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_retailer_assgnt", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_v"], "model.sdna_project.btg_pbc_sales_cust_prod_v": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.stg_pbc_xref_unique", "model.sdna_project.stg_pbc_xref_unique"], "model.sdna_project.btg_pbc_sales_cust_v": ["model.sdna_project.stg_pbc_cust", "model.sdna_project.stg_pbc_sales", "model.sdna_project.stg_pbc_xref_unique"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.pbc_sales", "model.sdna_project.stg_pbc_xref_unique"], "model.sdna_project.btg_pbc_sales_cust_wk_v": ["model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.pbc_sales_cust_wk_agg_no_allied", "model.sdna_project.stg_pbc_cust", "model.sdna_project.stg_pbc_xref_unique"], "model.sdna_project.btg_pbc_sales_v": ["model.sdna_project.btg_pbc_cust_v", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_sales"], "model.sdna_project.btg_pep_calendar_v": ["model.sdna_project.btg_pep_calendar"], "model.sdna_project.fl_sales": [], "model.sdna_project.fl_sales_cust_agg": ["model.sdna_project.btg_load_stat", "model.sdna_project.fl_sales"], "model.sdna_project.fl_sales_cust_prod_agg": ["model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.fl_sales", "model.sdna_project.fl_sales"], "model.sdna_project.fl_sales_cust_wk_agg": ["model.sdna_project.fl_sales"], "model.sdna_project.pbc_sales": [], "model.sdna_project.pbc_sales_agg_cust": ["model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.pbc_sales", "model.sdna_project.pbc_sales"], "model.sdna_project.pbc_sales_cust_agg_no_allied": ["model.sdna_project.btg_load_stat", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_sales"], "model.sdna_project.pbc_sales_cust_prod_agg": ["model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.pbc_sales", "model.sdna_project.pbc_sales"], "model.sdna_project.pbc_sales_cust_wk_agg": ["model.sdna_project.pbc_sales"], "model.sdna_project.pbc_sales_cust_wk_agg_no_allied": ["model.sdna_project.pbc_prod", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_sales", "model.sdna_project.pbc_sales"], "model.sdna_project.btg_fl_prod_upc_sale_seq": ["model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.btg_pbc_prod_upc_sale_seq": ["model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v"], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc": ["model.sdna_project.btg_pep_calendar", "model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v"], "model.sdna_project.cm_btg_fl_sales_cust_prod_upc": ["model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc"], "model.sdna_project.cm_btg_fl_sales_cust_prod_v": ["model.sdna_project.cm_btg_fl_sales_cust_prod_upc", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid": ["model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_cust_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v"], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc": ["model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v": ["model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc": ["model.sdna_project.btg_pep_calendar", "model.sdna_project.btg_pep_calendar", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v": ["model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_tdlinx1", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid": ["model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_sales_cust_prod_v"], "model.sdna_project.cm_btg_pbc_sales_cust_prod_upc": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc"], "model.sdna_project.cm_btg_pbc_sales_cust_prod_v": ["model.sdna_project.cm_btg_pbc_sales_cust_prod_upc", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid": ["model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_cust_v", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v"], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v": ["model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_pbc_sales_tdlinx1", "model.sdna_project.iri_pbc_markets_divs_by_fips", "model.sdna_project.iri_rma_store_list", "model.sdna_project.iri_srma_sample_stores", "model.sdna_project.msa_tdlinx_xref_final", "model.sdna_project.zip_code_priority_report", "model.sdna_project.zip_code_priority_report"], "model.sdna_project.dx_fl_prod": ["model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.fl_prod", "model.sdna_project.fl_prod"], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend": ["model.sdna_project.dx_fl_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_store_attr"], "model.sdna_project.dx_pbc_prod": ["model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.pbc_prod", "model.sdna_project.pbc_prod"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend": ["model.sdna_project.btg_pbc_new_mkt_loc", "model.sdna_project.btg_pbc_route_data", "model.sdna_project.dx_pbc_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_store_attr"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_WM": [], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_WM": [], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_WM": [], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_WM": [], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_WM": [], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_WM": [], "model.sdna_project.dx_retailer_trade_area": [], "model.sdna_project.mvh_demog_data": [], "model.sdna_project.mvh_retailer_prod_attr_data": [], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_sc": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_wm": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_sc": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_wm": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend"], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_sc": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend"], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_wm": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_sc": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_wm": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend"], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend"], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend"], "model.sdna_project.dx_id_sc": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc"], "model.sdna_project.dx_id_wm": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"], "model.sdna_project.dx_retailer_trade_area_sc": ["model.sdna_project.dx_id_sc", "model.sdna_project.dx_retailer_trade_area"], "model.sdna_project.dx_retailer_trade_area_wm": ["model.sdna_project.dx_id_wm", "model.sdna_project.dx_retailer_trade_area"], "model.sdna_project.mvh_demog_data_sc": ["model.sdna_project.dx_id_sc", "model.sdna_project.mvh_demog_data"], "model.sdna_project.mvh_demog_data_wm": ["model.sdna_project.dx_id_wm", "model.sdna_project.mvh_demog_data"], "model.sdna_project.mvh_retailer_prod_attr_data_sc": ["model.sdna_project.dx_id_sc", "model.sdna_project.mvh_retailer_prod_attr_data"], "model.sdna_project.mvh_retailer_prod_attr_data_wm": ["model.sdna_project.dx_id_wm", "model.sdna_project.mvh_retailer_prod_attr_data"], "seed.sdna_project.field_column_mapping_sdna_mx": [], "seed.sdna_project.field_column_mapping_sdna_us_hh": [], "seed.sdna_project.field_column_mapping_walmart": [], "test.sdna_project.unique_stg_lookup_geo_code": ["model.sdna_project.stg_lookup"], "test.sdna_project.not_null_stg_lookup_geo_code": ["model.sdna_project.stg_lookup"], "test.sdna_project.not_null_stg_mobility_data_geo_code": ["model.sdna_project.stg_mobility_data"], "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_": ["model.sdna_project.stg_lookup", "model.sdna_project.stg_mobility_data"], "test.sdna_project.not_null_mobility_adm1_mx_geo_code": ["model.sdna_project.mobility_adm1_mx"], "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_": ["model.sdna_project.mobility_adm1_mx", "model.sdna_project.stg_lookup"], "test.sdna_project.not_null_mobility_adm1_mx_activity_index_total": ["model.sdna_project.mobility_adm1_mx"], "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X258": [], "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261": [], "source.sdna_project.iri.MVH_IRI_PROSCORES_X261": []}, "child_map": {"model.sdna_project.inegi_2pbi_stg": ["model.sdna_project.inegi_2pbi"], "model.sdna_project.mx_stores_stg": ["model.sdna_project.mx_stores"], "model.sdna_project.stg_dataplor_coordinates": ["model.sdna_project.mapping_id_cliente_dataplor_all"], "model.sdna_project.stg_mx_store_coordinates": ["model.sdna_project.mapping_id_cliente_dataplor_all"], "model.sdna_project.inegi2_step1": ["model.sdna_project.inegi2_step2"], "model.sdna_project.inegi2_step2": ["model.sdna_project.inegi2_step3"], "model.sdna_project.inegi2_step3": ["model.sdna_project.inegi2_step4"], "model.sdna_project.inegi2_step4": ["model.sdna_project.inegi2_step5"], "model.sdna_project.inegi2_step5": ["model.sdna_project.inegi_2"], "model.sdna_project.stg_lookup": ["model.sdna_project.mobility_adm1_mx", "test.sdna_project.not_null_stg_lookup_geo_code", "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_", "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_", "test.sdna_project.unique_stg_lookup_geo_code"], "model.sdna_project.stg_mobility_data": ["model.sdna_project.mobility_adm1_mx", "test.sdna_project.not_null_stg_mobility_data_geo_code", "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_"], "model.sdna_project.tradearea_df_lf": ["model.sdna_project.tradearea"], "model.sdna_project.tradearea_df_sf": ["model.sdna_project.tradearea"], "model.sdna_project.tradearea_r_lf": ["model.sdna_project.tradearea"], "model.sdna_project.tradearea_r_sf": ["model.sdna_project.tradearea"], "model.sdna_project.tradearea_u_lf": ["model.sdna_project.tradearea"], "model.sdna_project.tradearea_u_sf": ["model.sdna_project.tradearea"], "model.sdna_project.dataplor": ["model.sdna_project.stg_dataplor_coordinates", "model.sdna_project.store_poi_counts"], "model.sdna_project.dls_latam_ins_categoria": ["model.sdna_project.mx_products"], "model.sdna_project.dls_latam_ins_cia_ruta": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_maestrocliente": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_nivelcliente": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_producto": ["model.sdna_project.mx_products", "model.sdna_project.mx_sales_wk"], "model.sdna_project.dls_latam_ins_ruta": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_semana": ["model.sdna_project.mx_sales_current_and_last_year", "model.sdna_project.mx_sales_current_and_last_year", "model.sdna_project.mx_sales_des_trimestre", "model.sdna_project.mx_sales_periodo", "model.sdna_project.mx_sales_wk"], "model.sdna_project.dls_latam_ins_sucursal": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_tipocliente": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_tiporuta": ["model.sdna_project.mx_stores_stg"], "model.sdna_project.dls_latam_ins_vtaclipro_sem_v": ["model.sdna_project.mx_products", "model.sdna_project.mx_sales_wk", "model.sdna_project.mx_stores_stg"], "model.sdna_project.inegi_2_stg": ["model.sdna_project.inegi2_step1"], "model.sdna_project.inegi_stg": ["model.sdna_project.inegi"], "model.sdna_project.nse_stg": ["model.sdna_project.nse"], "model.sdna_project.urbanicity_stg": ["model.sdna_project.urbanicity"], "model.sdna_project.inegi": ["model.sdna_project.inegi2_step5"], "model.sdna_project.inegi_2": ["model.sdna_project.inegi_2pbi_stg", "model.sdna_project.tradearea_df_lf", "model.sdna_project.tradearea_df_sf", "model.sdna_project.tradearea_r_lf", "model.sdna_project.tradearea_r_sf", "model.sdna_project.tradearea_u_lf", "model.sdna_project.tradearea_u_sf"], "model.sdna_project.inegi_2pbi": [], "model.sdna_project.mapping_id_cliente_dataplor_all": ["model.sdna_project.store_poi_counts"], "model.sdna_project.mapping_id_cliente_quadkey_all": ["model.sdna_project.store_mobility"], "model.sdna_project.mx_products": [], "model.sdna_project.mx_sales_current_and_last_year": [], "model.sdna_project.mx_sales_des_trimestre": [], "model.sdna_project.mx_sales_l26_wk": [], "model.sdna_project.mx_sales_l52_wk": [], "model.sdna_project.mx_sales_periodo": [], "model.sdna_project.mx_sales_wk": ["model.sdna_project.mx_sales_current_and_last_year", "model.sdna_project.mx_sales_current_and_last_year", "model.sdna_project.mx_sales_des_trimestre", "model.sdna_project.mx_sales_l26_wk", "model.sdna_project.mx_sales_l52_wk", "model.sdna_project.mx_sales_periodo"], "model.sdna_project.mx_stores": ["model.sdna_project.mapping_id_cliente_quadkey_all", "model.sdna_project.stg_mx_store_coordinates", "model.sdna_project.tradearea_df_lf", "model.sdna_project.tradearea_df_sf", "model.sdna_project.tradearea_r_lf", "model.sdna_project.tradearea_r_sf", "model.sdna_project.tradearea_u_lf", "model.sdna_project.tradearea_u_sf"], "model.sdna_project.nse": ["model.sdna_project.inegi2_step4", "model.sdna_project.inegi_2pbi"], "model.sdna_project.store_mobility": [], "model.sdna_project.store_poi_counts": [], "model.sdna_project.tradearea": [], "model.sdna_project.urbanicity": ["model.sdna_project.inegi2_step2"], "model.sdna_project.mobility_adm1_mx": ["test.sdna_project.not_null_mobility_adm1_mx_activity_index_total", "test.sdna_project.not_null_mobility_adm1_mx_geo_code", "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_"], "model.sdna_project.dx_fl_sales_cust_wk_prod": ["model.sdna_project.dx_fl_prod", "model.sdna_project.dx_fl_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod_extend", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.dx_msa_xref_der": ["model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.dx_pbc_sales_cust_wk_prod": ["model.sdna_project.dx_pbc_prod", "model.sdna_project.dx_pbc_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.exp_geo_temp": ["model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_null", "model.sdna_project.exp_geo_null"], "model.sdna_project.geo_retailer_stg_temp": ["model.sdna_project.geo_retailer_stg", "model.sdna_project.geo_retailer_stg"], "model.sdna_project.mvh_retailer_dim_temp1": ["model.sdna_project.mvh_retailer_dim_temp2", "model.sdna_project.mvh_retailer_dim_temp2"], "model.sdna_project.mvh_retailer_dim_temp2": ["model.sdna_project.mvh_retailer_dim", "model.sdna_project.mvh_retailer_dim"], "model.sdna_project.avbl_is_percentile_1": [], "model.sdna_project.avbl_is_percentile_2": [], "model.sdna_project.avbl_is_percentile_3": [], "model.sdna_project.avbl_is_percentile_4": [], "model.sdna_project.avbl_is_percentile_5": [], "model.sdna_project.is_percentile_1": [], "model.sdna_project.is_percentile_2": [], "model.sdna_project.is_percentile_3": [], "model.sdna_project.is_percentile_4": [], "model.sdna_project.is_percentile_5": [], "model.sdna_project.is_percentile_6": [], "model.sdna_project.is_percentile_7": [], "model.sdna_project.is_percentile_8": [], "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp": ["model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_1", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_2", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_3", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_4", "model.sdna_project.avbl_is_percentile_5", "model.sdna_project.avbl_is_percentile_5", "model.sdna_project.avbl_is_percentile_5", "model.sdna_project.avbl_is_percentile_5", "model.sdna_project.avbl_is_percentile_5", "model.sdna_project.avbl_is_percentile_5"], "model.sdna_project.dx_fl_trade_chnl_lkp": ["model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.dx_msa_xref": ["model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_msa_xref_der", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.retailer_sp_zip9_drivetime", "model.sdna_project.retailer_sp_zip9_drivetime"], "model.sdna_project.dx_pbc_trade_chnl_lkp": ["model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.fsv_gsc_z9_drivetime": [], "model.sdna_project.fsv_is_coeff_raw": [], "model.sdna_project.fsv_is_means_raw": [], "model.sdna_project.fsv_stores": [], "model.sdna_project.fvh_cs_coeff_raw": ["model.sdna_project.fvh_currentspend"], "model.sdna_project.fvh_fs_coeff_raw": ["model.sdna_project.fvh_t_value"], "model.sdna_project.fvh_life_stage_raw": ["model.sdna_project.fvh_life_stage_stg", "model.sdna_project.fvh_life_stage_stg"], "model.sdna_project.fvh_t_test_raw": ["model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability"], "model.sdna_project.cbsa_list": ["model.sdna_project.exp_geo_is_cg"], "model.sdna_project.gsc_msa_z9_drivetime": ["model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.retailer_sp_zip9_drivetime", "model.sdna_project.retailer_sp_zip9_drivetime"], "model.sdna_project.mvh_retailers_aldi": ["model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info"], "model.sdna_project.mvh_retailers_tj": ["model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info"], "model.sdna_project.mvh_retailers_wf": ["model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info"], "model.sdna_project.iri_pepsi_fb_raw": ["model.sdna_project.iri_all"], "model.sdna_project.is_coeff_raw_stg": ["model.sdna_project.is_coeff_raw"], "model.sdna_project.is_means_raw": ["model.sdna_project.is_hh_store_tc", "model.sdna_project.is_hh_store_tc"], "model.sdna_project.experian_cv_stg": ["model.sdna_project.exp_geo", "model.sdna_project.exp_geo", "model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_temp"], "model.sdna_project.exp_fvh": ["model.sdna_project.fvh_cluster"], "model.sdna_project.exp_geo_is_cg_fvh": ["model.sdna_project.exp_geo_is_cg_fvh_iri"], "model.sdna_project.fvh_cluster": ["model.sdna_project.fvh_currentspend"], "model.sdna_project.fvh_cs_fs": ["model.sdna_project.exp_geo_is_cg_fvh", "model.sdna_project.fvh_percentile"], "model.sdna_project.fvh_currentspend": ["model.sdna_project.fvh_t_value"], "model.sdna_project.fvh_life_stage_stg": ["model.sdna_project.fvh_cs_fs"], "model.sdna_project.fvh_probability": ["model.sdna_project.fvh_cs_fs"], "model.sdna_project.fvh_t_value": ["model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability", "model.sdna_project.fvh_probability"], "model.sdna_project.exp_geo_is_cg": ["model.sdna_project.exp_fvh", "model.sdna_project.exp_geo_is_cg_fvh"], "model.sdna_project.dx_store_attr": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend", "model.sdna_project.geo_retailer_stg_temp", "model.sdna_project.geo_retailer_stg_temp"], "model.sdna_project.exp_geo": ["model.sdna_project.exp_geo_is", "model.sdna_project.exp_geo_is", "model.sdna_project.is_hh_transpose", "model.sdna_project.is_hh_transpose"], "model.sdna_project.exp_geo_lmtd_cv": ["model.sdna_project.exp_geo", "model.sdna_project.exp_geo"], "model.sdna_project.exp_geo_null": ["model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_lmtd_cv"], "model.sdna_project.geo_new_retailer_info": ["model.sdna_project.geo_retailer_stg_temp", "model.sdna_project.geo_retailer_stg_temp"], "model.sdna_project.geo_retailer_stg": ["model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.geo_retailer_zip9_info", "model.sdna_project.mvh_retailer_dim_temp1", "model.sdna_project.retailer_sp_msa_drivetime"], "model.sdna_project.geo_retailer_zip9_chain_count": ["model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.geo_retailer_zip9_zip5_chain_count", "model.sdna_project.geo_retailer_zip9_zip5_chain_count"], "model.sdna_project.geo_retailer_zip9_info": ["model.sdna_project.geo_retailer_zip9_chain_count", "model.sdna_project.geo_retailer_zip9_chain_count"], "model.sdna_project.geo_retailer_zip9_zip5_chain_count": ["model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_lmtd_cv", "model.sdna_project.exp_geo_temp", "model.sdna_project.exp_geo_temp"], "model.sdna_project.exp_geo_is_cg_fvh_iri": ["model.sdna_project.trifecta_is_cap"], "model.sdna_project.iri_all": ["model.sdna_project.exp_geo_is_cg_fvh_iri"], "model.sdna_project.exp_geo_is": ["model.sdna_project.exp_geo_is_cg", "model.sdna_project.exp_geo_is_cg", "model.sdna_project.is_percentile", "model.sdna_project.is_percentile_1", "model.sdna_project.is_percentile_2", "model.sdna_project.is_percentile_3", "model.sdna_project.is_percentile_4", "model.sdna_project.is_percentile_5", "model.sdna_project.is_percentile_6", "model.sdna_project.is_percentile_7", "model.sdna_project.is_percentile_8"], "model.sdna_project.is_coeff_raw": ["model.sdna_project.is_hh_store_tc", "model.sdna_project.is_hh_store_tc"], "model.sdna_project.is_hh_store_tc": ["model.sdna_project.is_hh_store_tc_transpose", "model.sdna_project.is_hh_store_tc_transpose"], "model.sdna_project.is_hh_store_tc_transpose": ["model.sdna_project.exp_geo_is", "model.sdna_project.exp_geo_is"], "model.sdna_project.is_hh_transpose": ["model.sdna_project.is_hh_store_tc", "model.sdna_project.is_hh_store_tc"], "model.sdna_project.retailer_data_store_full": ["model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.mvh_retailer_fact", "model.sdna_project.retailer_sp_zip9_drivetime"], "model.sdna_project.mvh_retailer_dim": [], "model.sdna_project.mvh_retailer_fact": ["model.sdna_project.retailer_sp_hh_all_store"], "model.sdna_project.retailer_sp_hh_all_store": [], "model.sdna_project.retailer_sp_msa_drivetime": ["model.sdna_project.retailer_sp_hh_all_store"], "model.sdna_project.retailer_sp_zip9_drivetime": ["model.sdna_project.retailer_sp_msa_drivetime"], "model.sdna_project.avbl_is_percentile": ["model.sdna_project.retailer_data_store_full"], "model.sdna_project.fvh_percentile": ["model.sdna_project.retailer_data_store_full"], "model.sdna_project.is_percentile": ["model.sdna_project.retailer_data_store_full", "model.sdna_project.trifecta_is_cap"], "model.sdna_project.trifecta_is_cap": ["model.sdna_project.trifecta_is_cap_iri_adjf_avbl"], "model.sdna_project.trifecta_is_cap_iri_adjf_avbl": ["model.sdna_project.retailer_data_store_full", "model.sdna_project.trifecta_is_cap_iri_adjf_avbl_tmp"], "model.sdna_project.stg_fl_cust": ["model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_fl_sales_cust_wk_v"], "model.sdna_project.stg_fl_prod_sales": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v"], "model.sdna_project.stg_fl_sales": ["model.sdna_project.btg_fl_sales_cust_v"], "model.sdna_project.stg_fl_xref_unique": ["model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_sales_cust_v", "model.sdna_project.btg_fl_sales_cust_wk_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_fl_sales_cust_wk_v"], "model.sdna_project.stg_pbc_cust": ["model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_wk_v"], "model.sdna_project.stg_pbc_sales": ["model.sdna_project.btg_pbc_sales_cust_v"], "model.sdna_project.stg_pbc_xref_unique": ["model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_v"], "model.sdna_project.cm_btg_fl_sales_tdlinx1": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v"], "model.sdna_project.cm_btg_pbc_sales_tdlinx1": ["model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v"], "model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc": ["model.sdna_project.cm_btg_fl_sales_cust_prod_upc"], "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc": ["model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc"], "model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc": ["model.sdna_project.cm_btg_pbc_sales_cust_prod_upc"], "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc": ["model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc"], "model.sdna_project.btg_fl_retailer_assgnt": ["model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v"], "model.sdna_project.btg_pbc_new_mkt_loc": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"], "model.sdna_project.btg_pbc_retailer_assgnt": ["model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v"], "model.sdna_project.btg_pbc_route_data": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"], "model.sdna_project.btg_pep_calendar": ["model.sdna_project.btg_pep_calendar_v", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc"], "model.sdna_project.btg_ref_calendar": ["model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat", "model.sdna_project.btg_load_stat"], "model.sdna_project.fl_cust": ["model.sdna_project.btg_fl_cust_v"], "model.sdna_project.fl_prod": ["model.sdna_project.btg_fl_prod_v", "model.sdna_project.btg_fl_sales_v", "model.sdna_project.dx_fl_prod", "model.sdna_project.dx_fl_prod"], "model.sdna_project.fl_sales_2018": [], "model.sdna_project.fl_sales_2019": [], "model.sdna_project.fl_sales_2020": [], "model.sdna_project.fl_sales_2021": [], "model.sdna_project.mdm_msa_fl_xref": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_lat_lon_v"], "model.sdna_project.mdm_msa_pbc_xref": ["model.sdna_project.btg_msa_lat_lon_v", "model.sdna_project.btg_msa_pbc_xref"], "model.sdna_project.pbc_cust": ["model.sdna_project.btg_pbc_cust_v"], "model.sdna_project.pbc_prod": ["model.sdna_project.btg_pbc_prod_v", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_v", "model.sdna_project.dx_pbc_prod", "model.sdna_project.dx_pbc_prod", "model.sdna_project.pbc_sales_cust_agg_no_allied", "model.sdna_project.pbc_sales_cust_wk_agg_no_allied", "model.sdna_project.pbc_sales_cust_wk_agg_no_allied"], "model.sdna_project.pbc_sales_2018": [], "model.sdna_project.pbc_sales_2019": [], "model.sdna_project.pbc_sales_2020": [], "model.sdna_project.pbc_sales_2021": [], "model.sdna_project.iri_pbc_markets_divs_by_fips": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"], "model.sdna_project.iri_rma_store_list": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"], "model.sdna_project.iri_srma_sample_stores": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"], "model.sdna_project.msa_tdlinx_xref_final": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"], "model.sdna_project.p_msa_cust_xref_tdlinx": [], "model.sdna_project.zip_code_priority_report": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_tdlinx1", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_tdlinx1"], "model.sdna_project.btg_fl_cust_v": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "model.sdna_project.btg_fl_sales_v", "model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.stg_fl_cust", "model.sdna_project.stg_fl_prod_sales"], "model.sdna_project.btg_fl_prod_v": ["model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.btg_fl_sales_cust_prod_v_extend", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.stg_fl_prod_sales"], "model.sdna_project.btg_fl_retailer_assgnt_excptn_v": [], "model.sdna_project.btg_fl_retailer_xref_v": ["model.sdna_project.btg_fl_retailer_assgnt_excptn_v", "model.sdna_project.btg_fl_retailer_assgnt_excptn_v", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.btg_fl_sales_cust_prod_v": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend", "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid"], "model.sdna_project.btg_fl_sales_cust_v": ["model.sdna_project.btg_fl_retailer_assgnt_excptn_v", "model.sdna_project.btg_fl_retailer_assgnt_excptn_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.btg_fl_retailer_xref_v", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v": ["model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.btg_fl_prod_upc_sale_seq", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid", "model.sdna_project.dx_fl_sales_cust_wk_prod", "model.sdna_project.dx_fl_sales_cust_wk_prod"], "model.sdna_project.btg_fl_sales_cust_wk_v": [], "model.sdna_project.btg_fl_sales_v": [], "model.sdna_project.btg_load_stat": ["model.sdna_project.btg_msa_fl_xref", "model.sdna_project.btg_msa_pbc_xref", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.fl_sales_cust_agg", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.pbc_sales_agg_cust", "model.sdna_project.pbc_sales_agg_cust", "model.sdna_project.pbc_sales_cust_agg_no_allied", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.pbc_sales_cust_prod_agg"], "model.sdna_project.btg_msa_fl_xref": ["model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_msa_fl_xref_v", "model.sdna_project.stg_fl_prod_sales", "model.sdna_project.stg_fl_sales", "model.sdna_project.stg_fl_xref_unique", "model.sdna_project.stg_fl_xref_unique"], "model.sdna_project.btg_msa_fl_xref_v": [], "model.sdna_project.btg_msa_lat_lon_v": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info", "model.sdna_project.geo_new_retailer_info"], "model.sdna_project.btg_msa_pbc_xref": ["model.sdna_project.btg_msa_pbc_xref_v", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_v", "model.sdna_project.stg_pbc_sales", "model.sdna_project.stg_pbc_xref_unique", "model.sdna_project.stg_pbc_xref_unique"], "model.sdna_project.btg_msa_pbc_xref_v": [], "model.sdna_project.btg_pbc_cust_v": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.btg_pbc_sales_v", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.stg_pbc_cust"], "model.sdna_project.btg_pbc_prod_v": ["model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid"], "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v": [], "model.sdna_project.btg_pbc_retailer_xref_v": ["model.sdna_project.btg_pbc_retailer_assgnt_excptn_v", "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.btg_pbc_sales_cust_prod_v": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid"], "model.sdna_project.btg_pbc_sales_cust_v": ["model.sdna_project.btg_pbc_retailer_assgnt_excptn_v", "model.sdna_project.btg_pbc_retailer_assgnt_excptn_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.btg_pbc_retailer_xref_v", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr", "model.sdna_project.dx_store_attr"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v": ["model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.btg_pbc_prod_upc_sale_seq", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid", "model.sdna_project.dx_pbc_sales_cust_wk_prod", "model.sdna_project.dx_pbc_sales_cust_wk_prod"], "model.sdna_project.btg_pbc_sales_cust_wk_v": [], "model.sdna_project.btg_pbc_sales_v": [], "model.sdna_project.btg_pep_calendar_v": [], "model.sdna_project.fl_sales": ["model.sdna_project.btg_fl_sales_v", "model.sdna_project.fl_sales_cust_agg", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.fl_sales_cust_prod_agg", "model.sdna_project.fl_sales_cust_wk_agg", "model.sdna_project.stg_fl_prod_sales"], "model.sdna_project.fl_sales_cust_agg": ["model.sdna_project.stg_fl_sales"], "model.sdna_project.fl_sales_cust_prod_agg": ["model.sdna_project.btg_fl_sales_cust_prod_v", "model.sdna_project.btg_fl_sales_cust_prod_v"], "model.sdna_project.fl_sales_cust_wk_agg": ["model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_fl_sales_cust_wk_v", "model.sdna_project.btg_msa_fl_xref"], "model.sdna_project.pbc_sales": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.btg_pbc_sales_v", "model.sdna_project.pbc_sales_agg_cust", "model.sdna_project.pbc_sales_agg_cust", "model.sdna_project.pbc_sales_cust_agg_no_allied", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.pbc_sales_cust_prod_agg", "model.sdna_project.pbc_sales_cust_wk_agg", "model.sdna_project.pbc_sales_cust_wk_agg_no_allied", "model.sdna_project.pbc_sales_cust_wk_agg_no_allied"], "model.sdna_project.pbc_sales_agg_cust": [], "model.sdna_project.pbc_sales_cust_agg_no_allied": ["model.sdna_project.stg_pbc_sales"], "model.sdna_project.pbc_sales_cust_prod_agg": ["model.sdna_project.btg_pbc_sales_cust_prod_v", "model.sdna_project.btg_pbc_sales_cust_prod_v"], "model.sdna_project.pbc_sales_cust_wk_agg": ["model.sdna_project.btg_msa_pbc_xref"], "model.sdna_project.pbc_sales_cust_wk_agg_no_allied": ["model.sdna_project.btg_pbc_sales_cust_wk_v"], "model.sdna_project.btg_fl_prod_upc_sale_seq": ["model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc", "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend": ["model.sdna_project.btg_fl_sales_cust_prod_v_extend_sc", "model.sdna_project.btg_fl_sales_cust_prod_v_extend_wm"], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend": ["model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_sc", "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_wm"], "model.sdna_project.btg_pbc_prod_upc_sale_seq": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc", "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc"], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend": ["model.sdna_project.btg_pbc_sales_cust_prod_v_extend_sc", "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_wm"], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend": ["model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_sc", "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_wm"], "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v"], "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_v": [], "model.sdna_project.cm_btg_fl_sales_cust_prod_invenid": ["model.sdna_project.cm_stage_btg_fl_sales_cust_prod_upc"], "model.sdna_project.cm_btg_fl_sales_cust_prod_upc": ["model.sdna_project.cm_btg_fl_sales_cust_prod_v"], "model.sdna_project.cm_btg_fl_sales_cust_prod_v": [], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_invenid": ["model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_fl_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_upc": ["model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v"], "model.sdna_project.cm_btg_fl_sales_cust_wk_prod_v": [], "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc": ["model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v"], "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_v": [], "model.sdna_project.cm_btg_pbc_sales_cust_prod_invenid": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_prod_upc"], "model.sdna_project.cm_btg_pbc_sales_cust_prod_upc": ["model.sdna_project.cm_btg_pbc_sales_cust_prod_v"], "model.sdna_project.cm_btg_pbc_sales_cust_prod_v": [], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_invenid": ["model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc", "model.sdna_project.cm_stage_btg_pbc_sales_cust_wk_prod_upc"], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_upc": ["model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_pd_prod_upc", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v", "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v"], "model.sdna_project.cm_btg_pbc_sales_cust_wk_prod_v": [], "model.sdna_project.dx_fl_prod": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend"], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend": ["model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc", "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm"], "model.sdna_project.dx_pbc_prod": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend": ["model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc", "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_WM": [], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_WM": [], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_WM": [], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_WM": [], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_WM": [], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_WM": [], "model.sdna_project.dx_retailer_trade_area": ["model.sdna_project.dx_retailer_trade_area_sc", "model.sdna_project.dx_retailer_trade_area_wm"], "model.sdna_project.mvh_demog_data": ["model.sdna_project.mvh_demog_data_sc", "model.sdna_project.mvh_demog_data_wm"], "model.sdna_project.mvh_retailer_prod_attr_data": ["model.sdna_project.mvh_retailer_prod_attr_data_sc", "model.sdna_project.mvh_retailer_prod_attr_data_wm"], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_sc": [], "model.sdna_project.btg_fl_sales_cust_prod_v_extend_wm": [], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_sc": [], "model.sdna_project.btg_fl_sales_cust_wk_prod_v_extend_wm": [], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_sc": [], "model.sdna_project.btg_pbc_sales_cust_prod_v_extend_wm": [], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_sc": [], "model.sdna_project.btg_pbc_sales_cust_wk_prod_v_extend_wm": [], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_sc": ["model.sdna_project.dx_id_sc"], "model.sdna_project.dx_fl_sales_cust_wk_prod_extend_wm": ["model.sdna_project.dx_id_wm"], "model.sdna_project.dx_id_sc": ["model.sdna_project.dx_retailer_trade_area_sc", "model.sdna_project.mvh_demog_data_sc", "model.sdna_project.mvh_retailer_prod_attr_data_sc"], "model.sdna_project.dx_id_wm": ["model.sdna_project.dx_retailer_trade_area_wm", "model.sdna_project.mvh_demog_data_wm", "model.sdna_project.mvh_retailer_prod_attr_data_wm"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_sc": ["model.sdna_project.dx_id_sc"], "model.sdna_project.dx_pbc_sales_cust_wk_prod_extend_wm": ["model.sdna_project.dx_id_wm"], "model.sdna_project.dx_retailer_trade_area_sc": [], "model.sdna_project.dx_retailer_trade_area_wm": [], "model.sdna_project.mvh_demog_data_sc": [], "model.sdna_project.mvh_demog_data_wm": [], "model.sdna_project.mvh_retailer_prod_attr_data_sc": [], "model.sdna_project.mvh_retailer_prod_attr_data_wm": [], "seed.sdna_project.field_column_mapping_sdna_mx": [], "seed.sdna_project.field_column_mapping_sdna_us_hh": [], "seed.sdna_project.field_column_mapping_walmart": [], "test.sdna_project.unique_stg_lookup_geo_code": [], "test.sdna_project.not_null_stg_lookup_geo_code": [], "test.sdna_project.not_null_stg_mobility_data_geo_code": [], "test.sdna_project.relationships_stg_mobility_data_geo_code__geo_code__ref_stg_lookup_": [], "test.sdna_project.not_null_mobility_adm1_mx_geo_code": [], "test.sdna_project.relationships_mobility_adm1_mx_geo_code__geo_code__ref_stg_lookup_": [], "test.sdna_project.not_null_mobility_adm1_mx_activity_index_total": [], "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X258": [], "source.sdna_project.experian.MVH_CV_LIVING_UNIT_X261": ["model.sdna_project.experian_cv_stg"], "source.sdna_project.iri.MVH_IRI_PROSCORES_X261": ["model.sdna_project.iri_all"]}}